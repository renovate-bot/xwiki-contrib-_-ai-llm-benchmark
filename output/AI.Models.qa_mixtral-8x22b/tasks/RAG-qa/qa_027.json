{
  "id": "qa_027",
  "prompt": "Comment configurer la synchronisation de groupe entre XWiki et mon fournisseur OpenID Connect?\nJ'utilise un fournisseur OpenID Connect qui prend en charge les revendications de groupe, et je souhaite synchroniser ces groupes avec les groupes XWiki. Quel est le processus pour le configurer?",
  "expected_answer": "Pour configurer la synchronisation de groupe entre XWiki et votre fournisseur OpenID Connect:\n1. Localisez le fichier `xwiki.properties` dans le r\u00e9pertoire d'installation de XWiki.\n2. Ouvrez le fichier avec un \u00e9diteur de texte.\n3. Configurez la synchronisation de groupe en d\u00e9finissant la propri\u00e9t\u00e9 `oidc.groups.claim` sur le nom de la revendication utilis\u00e9e par votre fournisseur OpenID Connect pour envoyer des informations de groupe. Par exemple:\n```java\n#-# Le nom de la revendication utilis\u00e9e pour obtenir la liste des groupes auxquels appartient l'utilisateur.\n# oidc.groups.claim=groupes\n```\nRemplacez `groupes` par le nom de revendication r\u00e9el fourni par votre fournisseur OpenID Connect.\n1. Si votre fournisseur OpenID Connect envoie des adh\u00e9sions de groupe en tant qu'attribut de valeur unique d\u00e9limit\u00e9 par un caract\u00e8re sp\u00e9cifique (par exemple, une virgule), configurez la propri\u00e9t\u00e9 `oidc.groups.separator` avec le caract\u00e8re appropri\u00e9:\n```java\n#-# Si le fournisseur d'identit\u00e9 renvoie des adh\u00e9sions de groupe en tant qu'attribut de valeur unique d\u00e9limit\u00e9 avec un caract\u00e8re, par exemple:\n# oidc.groups.separator=,\n```\nRemplacez la virgule par le s\u00e9parateur r\u00e9el utilis\u00e9 par votre fournisseur.\n1. Si vous souhaitez mapper les groupes synchronis\u00e9s \u00e0 des groupes XWiki sp\u00e9cifiques, configurez la propri\u00e9t\u00e9 `oidc.groups.mapping` avec les mappages appropri\u00e9s:\n```java\n# oidc.groups.mapping=XWiki.\"MyXWikiGroup\"=group1\n# oidc.groups.mapping=XWiki.\"MyXWikiGroup2\"=group2\n```\nRemplacez `MyXWikiGroup` et `MyXWikiGroup2` par les noms des groupes XWiki que vous souhaitez mapper, et `group1` et `group2` par les noms de groupe r\u00e9els fournis par votre fournisseur OpenID Connect.\n1. Enregistrez le fichier `xwiki.properties` et red\u00e9marrez votre instance XWiki pour que les modifications prennent effet.",
  "ai_answer": "Sources: https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/ \nhttps://www.xwiki.org/xwiki/bin/view/Documentation/AdminGuide/Authentication/ \n\n\nPour configurer la synchronisation de groupe entre XWiki et votre fournisseur OpenID Connect, vous pouvez utiliser la revendication de groupe `xwiki_groups` en l'ajoutant \u00e0 la propri\u00e9t\u00e9 `oidc.userinfoclaims` dans le fichier `xwiki.properties`.\n\nVoici le processus de configuration :\n\n1. Ouvrez le fichier `xwiki.properties` de votre instance XWiki.\n2. Ajoutez la revendication de groupe `xwiki_groups` \u00e0 la propri\u00e9t\u00e9 `oidc.userinfoclaims` en utilisant la syntaxe suivante :\n```\noidc.userinfoclaims=email,name,xwiki_groups\n```\n3. Enregistrez le fichier `xwiki.properties`.\n\nUne fois cela fait, XWiki utilisera la revendication `xwiki_groups` pour synchroniser les groupes de votre fournisseur OpenID Connect avec les groupes XWiki. Si les groupes dans la revendication ne contiennent pas le pr\u00e9fixe `wiki:XWiki.`, XWiki les cr\u00e9era automatiquement si n\u00e9cessaire.\n\nSi vous souhaitez d\u00e9finir une correspondance entre les groupes XWiki et les groupes du fournisseur OpenID Connect, vous pouvez utiliser la propri\u00e9t\u00e9 `oidc.groups.mapping` dans le fichier `xwiki.properties`. Par exemple, pour mapper le groupe `admin` du fournisseur OpenID Connect au groupe `XWiki.Admin` dans XWiki, vous pouvez utiliser la syntaxe suivante :\n```\noidc.groups.mapping=XWiki.Admin=admin\n```\nIl est \u00e9galement possible de mettre en \u0153uvre votre propre synchronisation de groupe personnalis\u00e9e en utilisant des \u00e9couteurs. Pour plus d'informations, consultez la section \"Listeners\" de la documentation de l'extension OpenID Connect Authenticator.",
  "sources": [
    {
      "collection_id": "Eval",
      "document_id": "extensions:Extension.OpenID Connect.OpenID Connect Authenticator.WebHome",
      "url": "https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/",
      "content": "#-# The authentication management class.  \nxwiki.authentication.authclass=org.xwiki.contrib.oidc.auth.OIDCAuthServiceImpl### xwiki.properties\n\n#-# The base URL of the OpenId Connect Provider to use as starting point to discover the provider configuration.  \n#-# See following endpoints properties if the provider is does not support OpenID Connect discovery.  \n#-# If not indicated and not custom endpoint is provided, it will be asked to the user.  \n# oidc.provider=https://xwikiorg-node1.xwikisas.com/xwiki/oidc  \n  \n#-# The generic OpenId Connect endpoints to use to communicate with the provider.  \n#-# It&#x27;s generally not needed when providing the provider discovery endpoint (which is supposed to provide those enpoints).  \n# oidc.endpoint.authorization=https://xwikiorg-node1.xwikisas.com/xwiki/oidc/authorization  \n# oidc.endpoint.token=https://xwikiorg-node1.xwikisas.com/xwiki/oidc/token  \n# oidc.endpoint.userinfo=https://xwikiorg-node1.xwikisas.com/xwiki/oidc/userinfo  \n# oidc.endpoint.logout=https://xwikiorg-node1.xwikisas.com/xwiki/oidc/logout  \n  \n#-# It&#x27;s possible to add custom HTTP headers to the endpoint (generally only needed for bad or non-oidc providers)  \n#-# by adding the suffix &quot;.headers&quot; to the endpoint property key and listing the custom headers using key:value format.  \n#-# Note that it&#x27;s not taken into account for the oidc.endpoint.authorization endpoint because it&#x27;s used as a redirect.  \n#-# Here is an example to send &quot;Accept: application/json&quot; and &quot;SomeOtherHeader: header&quot; HTTP headers with the userinfo request.  \n# oidc.endpoint.userinfo.headers=Accept:application/json  \n# oidc.endpoint.userinfo.headers=SomeOtherHeader:header value  \n  \n#-# The scopes to use when redirecting to the provider  \n#-# The standard OpenID Connection scopes are:  \n#-# \\* openid: Informs the authorisation server that the client is making an OpenID Connect request (REQUIRED).  \n",
      "similarity_score": 13.729754447937012,
      "vector": null
    },
    {
      "collection_id": "Eval",
      "document_id": "xwiki:Documentation.AdminGuide.Authentication.WebHome",
      "url": "https://www.xwiki.org/xwiki/bin/view/Documentation/AdminGuide/Authentication/",
      "content": "## Container Authentication\n\nDelegates authentication to the Servlet Container. If it fails it falls back to the standard XWiki authentication.\n\nTo configure XWiki to use it, specify:\n\nxwiki.authentication.authclass=com.xpn.xwiki.user.impl.xwiki.AppServerTrustedAuthServiceImplFor users to be actually created and not just set as context user you must set in xwiki.cfg configuration file (if the property does not already exist, create it):\n\nxwiki.authentication.createuser=empty## OpenId Connect Authentication\n\nSee the [OpenId Connect Authenticator Extension](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/).\n\n## Active Directory\n\nIf you&#x27;re looking to connect XWiki to an Active Directory server, you currently have 2 options:\n\n* Using the manual and generic approach using the [LDAP Authenticator extension](https://extensions.xwiki.org/xwiki/bin/view/Extension/LDAP/Authenticator/)\n* Using the dedicated [Active Directory Application](https://store.xwiki.com/xwiki/bin/view/Extension/ActiveDirectoryApplication) which is a paying application dedicated to simplifying the integration of Active Directory with XWiki. The Active Directory Application allows you to easily connect your Active Directory server to XWiki using a **visual editor**, update\u00a0**advanced configuration** settings without restarting the application server, **technical support** provided by [XWiki SAS](https://xwiki.com/), etc.\n\n## LDAP\n\nSee the [LDAP Authenticator extension](https://extensions.xwiki.org/xwiki/bin/view/Extension/LDAP/Authenticator/).\n\nThe deprecated LDAP core authenticator (for XWiki &lt; 7.4) can be found on [OldLDAPAuthenticator](https://www.xwiki.org/xwiki/bin/view/Documentation/AdminGuide/Authentication/OldLDAPAuthenticator/).\n\n",
      "similarity_score": 13.373527526855469,
      "vector": null
    },
    {
      "collection_id": "Eval",
      "document_id": "extensions:Extension.OpenID Connect.OpenID Connect Authenticator.WebHome",
      "url": "https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/",
      "content": "# Group synchronization\n\nThe default group synchronization is enabled by adding the claim xwiki\\_groups to the property oidc.userinfoclaims in the xwiki.properties file.\n\nBy default this synchronization expect to receive the list of group names (without the `wiki:XWiki.` prefix) in which the user should be placed (groups are automatically created when they don&#x27;t exist). You can also define a mapping between the XWiki groups and the provider groups using oidc.groups.mapping property.\n\nIt&#x27;s also possible to implement your own custom group synchronization in a listener. See [Listeners section](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/#HListeners).\n\n# Customization\n\n## Templates\n\nThe authenticator uses a template to ask the user for the target provider when it&#x27;s not provided in the configuration. This template can be overwritten through the standard [template system](https://extensions.xwiki.org/xwiki/bin/view/Extension/Template%20Module).\n\nThe name of the template is oidc/client/provider.vm.\n\n## Listeners\n\nIt&#x27;s possible to implement an event [listener](https://extensions.xwiki.org/xwiki/bin/view/Extension/Observation%20Module%20Local) and be notified during user profile update to add more to this process or do other things after it:\n\n* org.xwiki.contrib.oidc.event.OIDCUserUpdating to modify the user profile before it being saved\n* org.xwiki.contrib.oidc.event.OIDCUserUpdated to do something after the user profile has been saved\n\n# Troubleshooting\n\n## Enable DEBUG log\n\nSee [Logging Admin Guide](https://xwiki.org/xwiki/bin/view/Documentation/AdminGuide/Logging).\n\nThe specific packages to track for OpenID Connect module is org.xwiki.contrib.oidc. There is several ways to enable debug log.\n\n",
      "similarity_score": 0.820569634437561,
      "vector": null
    },
    {
      "collection_id": "Eval",
      "document_id": "extensions:Extension.OpenID Connect.OpenID Connect Authenticator.WebHome",
      "url": "https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/",
      "content": "* [Prerequisites &amp; Installation Instructions](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/#HPrerequisites26InstallationInstructions)\n* [Dependencies](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/#HDependencies)\n# Description\n\nAllow an XWiki instance to authenticate on an OpenId Connect provider. It also performs automatic synchronization.\n\nSee also [OpenID Connect Provider](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Provider/).\n\n![oidc_client_provider.png](https://extensions.xwiki.org/xwiki/bin/download/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/WebHome/oidc_client_provider.png?rev=1.1)\n\nRelease notes can be found on [OpenID Connect project page](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/#HReleaseNotes).\n\n# Main limitations\n\n* [Automatically authenticate user when coming back](https://jira.xwiki.org/browse/OIDC-16)\n\n# Configuration\n\n## Configuration Guides for specific systems\n\n### Lemon LDAP / Open PAAS\n\nA [configuration guide](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/ConfigurationLemonLDAP/) is available to connect XWiki to LemonLDAP / OpenPAAS using the OpenIDC XWiki client.\n\n### OpenID Authentication with Keycloak\n\nA [configuration example for Keycloak](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/OpenID%20Authentication%20with%20Keycloak/) is available.\n\n### Univention Corporate Server\n\nA [configuration example for Univention Corporate Server (UCS)](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/OpenID%20Authentication%20with%20UCS/) is available.\n\n## Configuration files\n\n### xwiki.cfg\n\n",
      "similarity_score": 0.8118218183517456,
      "vector": null
    },
    {
      "collection_id": "Eval",
      "document_id": "extensions:Extension.OpenID Connect.OpenID Connect Authenticator.WebHome",
      "url": "https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/",
      "content": "# Dependencies\n\nDependencies for this extension (org.xwiki.contrib.oidc:oidc-authenticator 2.8.6):\n\n* org.xwiki.platform:xwiki-platform-oldcore 14.10\n* com.nimbusds:oauth2-oidc-sdk 11.10.1\n* [org.xwiki.contrib.oidc:oidc-provider](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Provider/) 2.8.6\n* org.xwiki.contrib.oidc:oidc-authenticator-configuration 2.8.6\n* org.xwiki.contrib.oidc:oidc-authenticator-user 2.8.6\n\n\n",
      "similarity_score": 0.7638007402420044,
      "vector": null
    }
  ],
  "usage": {
    "prompt_tokens": 2893,
    "completion_tokens": 464,
    "total_tokens": 3357
  },
  "average_power_draw": null,
  "energy_consumption": null,
  "energy_per_input_token": null,
  "energy_per_output_token": null,
  "energy_per_total_token": null
}