{
  "id": "qa_006",
  "prompt": "Can I customize the user profile fields that are populated from the OpenID Connect provider in XWiki?\nI want to map additional user profile fields from my OpenID Connect provider to XWiki user properties. How can I achieve this?",
  "expected_answer": "Yes, you can customize the user profile fields that are populated from the OpenID Connect provider by mapping them in the `xwiki.properties` file.\n\nTo map additional user profile fields, use the `oidc.user.mapping` property. Here's an example of how to map custom properties:\n\n```\n# oidc.user.mapping=myxproperty1=${oidc.user.subject}\n# oidc.user.mapping=myxproperty2=myprefix-${oidc.user.subject}\n```\n\nReplace `myxproperty1` and `myxproperty2` with the actual XWiki user property names, and `${oidc.user.subject}` with the appropriate variable based on the data provided by your OpenID Connect provider.\n\nAfter configuring the mappings, save the `xwiki.properties` file and restart XWiki to apply the changes.",
  "ai_answer": "https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/ \nhttps://extensions.xwiki.org/xwiki/bin/view/Extension/LDAP/Authenticator/ \n\n\nYes, you can customize the user profile fields that are populated from the OpenID Connect provider in XWiki. To map additional user profile fields from your OpenID Connect provider to XWiki user properties, you can use the `oidc.user.mapping` property in the `xwiki.properties` file.\n\nHere\u2019s how you can achieve this:\n\n1. **Open the `xwiki.properties` file**: This file is typically located in the `WEB-INF` directory of your XWiki installation.\n\n2. **Add the mapping**: You can define mappings using the `oidc.user.mapping` property. The syntax for mapping is as follows:\n   ```\n   oidc.user.mapping=myxproperty1=${oidc.user.subject}\n   oidc.user.mapping=myxproperty2=myprefix-${oidc.user.subject}\n   ```\n   In this example:\n   - `myxproperty1` and `myxproperty2` are the names of the XWiki user properties you want to populate.\n   - `${oidc.user.subject}` is a placeholder for the corresponding field from the OpenID Connect provider.\n\n3. **Define additional properties**: You can add as many mappings as needed, ensuring that the property names correspond to the fields you want to populate in the XWiki user profile.\n\n4. **Restart XWiki**: After making changes to the `xwiki.properties` file, restart your XWiki instance to apply the changes.\n\nBy following these steps, you can successfully map additional user profile fields from your OpenID Connect provider to XWiki user properties.",
  "sources": [
    {
      "collection_id": "Eval",
      "document_id": "extensions:Extension.OpenID Connect.OpenID Connect Authenticator.WebHome",
      "url": "https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/",
      "content": "#-# The following suffixes can be added:  \n#-# \\* &quot;.\\_lowerCase&quot;: the lower case version of the string  \n#-# \\* &quot;.\\_upperCase&quot;: the upper case version of the string\u00a0  \n#-# \\* &quot;.\\_clean&quot;: a version of the string stripped from &quot;.&quot;, &quot;:&quot;, &quot;,&quot;, &quot;@&quot;, &quot;^&quot; characters and &quot;\\s&quot; (all forms of white spaces).  \n#-# \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0It can itself be suffixed with &quot;.\\_lowerCase&quot; and &quot;.\\_upperCase&quot;.  \n#-#  \n#-# The variable syntax also have other features (fallback value, etc.) detailed on https://commons.apache.org/proper/commons-text/apidocs/org/apache/commons/text/StringSubstitutor.html.  \n#-#\u00a0  \n#-# The default is:\u00a0  \n# oidc.user.nameFormater=${oidc.issuer.host.\\_clean}-${oidc.user.preferredUsername.\\_clean}  \n  \n#-# The pattern to use to generate the unique identifier of the user in the OpenId Connect provider.  \n#-# It is used to avoid collisions with user have similar name.  \n#-#\u00a0  \n#-# The syntax is the same than the one described for oidc.user.nameFormater property.  \n#-#\u00a0  \n#-# The default is:\u00a0  \n# oidc.user.subjectFormater=${oidc.user.subject}  \n  \n#-# It&#x27;s possible to associate non standard properties coming from the OpenID Connect provider with the XWiki user.  \n#-# It&#x27;s a map with the name of the XWiki user property and a format similar to the one defined in oidc.user.nameFormater for the OpenID Connect side.  \n#-#\u00a0  \n# oidc.user.mapping=myxproperty1=${oidc.user.subject}  \n# oidc.user.mapping=myxproperty2=myprefix-${oidc.user.subject}  \n  \n#-# The righs each new user should have on its own profile as a comma (only comma, no white space allowed) separated list. Setting a right also implies that all the others users don&#x27;t have it.  \n#-# For example if you want that only users have view right on their profile but thay can modify their own profile you could use:  \n# oidc.user.oidc.user.ownProfileRights=view,edit  \n#-#\u00a0  \n",
      "similarity_score": 0.863273024559021,
      "vector": null
    },
    {
      "collection_id": "Eval",
      "document_id": "extensions:Extension.OpenID Connect.OpenID Connect Authenticator.WebHome",
      "url": "https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/",
      "content": "## Authentication with a domain-based instance\n\nWhen XWiki is configured as a domain-based instance, users will not be automatically authenticated on every wiki by default, as the OIDC authenticator does not rely on the property xwiki.authentication.cookiedomains in xwiki.cfg.\n\nTo still allow users to be automatically authenticated when accessing one of the wikis of the farm, you will have to update the configuration of the session cookie of your servlet container so that this cookie gets set on a top-level domain, encompassing every wiki of farm. If your XWiki instance has very different domains for its wikis, this fix will not work.\n\nWhen using Tomcat as a servlet container, it&#x27;s possible to change the domain of the cookie JSESSIONID by adding the attribute sessionCookieDomain to context.xml as such :\n\n&lt;Context sessionCookieDomain=&quot;mytld.org&quot;&gt;  \n...  \n&lt;/Context&gt;# Endpoints\n\n## Callback\n\npath: **authenticator/callback**\n\n## [Back-Channel Logout](https://openid.net/specs/openid-connect-backchannel-1_0.html)\n\npath: **authenticator/backchannel\\_logout**\n\n# Bypass OpenID Connect\n\nAs indicated in the previous section you can disable OpenID Connect using the property oidc.skipped in the xwiki.properties file.\n\nIt&#x27;s also possible to skip OpenId Connect temporarily using a URL parameter: for example https://mydomain/xwiki/bin/view/Main/?oidc.skipped=true.\n\n",
      "similarity_score": 0.8513456583023071,
      "vector": null
    },
    {
      "collection_id": "Eval",
      "document_id": "extensions:Extension.OpenID Connect.OpenID Connect Authenticator.WebHome",
      "url": "https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/",
      "content": "# Group synchronization\n\nThe default group synchronization is enabled by adding the claim xwiki\\_groups to the property oidc.userinfoclaims in the xwiki.properties file.\n\nBy default this synchronization expect to receive the list of group names (without the `wiki:XWiki.` prefix) in which the user should be placed (groups are automatically created when they don&#x27;t exist). You can also define a mapping between the XWiki groups and the provider groups using oidc.groups.mapping property.\n\nIt&#x27;s also possible to implement your own custom group synchronization in a listener. See [Listeners section](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/#HListeners).\n\n# Customization\n\n## Templates\n\nThe authenticator uses a template to ask the user for the target provider when it&#x27;s not provided in the configuration. This template can be overwritten through the standard [template system](https://extensions.xwiki.org/xwiki/bin/view/Extension/Template%20Module).\n\nThe name of the template is oidc/client/provider.vm.\n\n## Listeners\n\nIt&#x27;s possible to implement an event [listener](https://extensions.xwiki.org/xwiki/bin/view/Extension/Observation%20Module%20Local) and be notified during user profile update to add more to this process or do other things after it:\n\n* org.xwiki.contrib.oidc.event.OIDCUserUpdating to modify the user profile before it being saved\n* org.xwiki.contrib.oidc.event.OIDCUserUpdated to do something after the user profile has been saved\n\n# Troubleshooting\n\n## Enable DEBUG log\n\nSee [Logging Admin Guide](https://xwiki.org/xwiki/bin/view/Documentation/AdminGuide/Logging).\n\nThe specific packages to track for OpenID Connect module is org.xwiki.contrib.oidc. There is several ways to enable debug log.\n\n",
      "similarity_score": 0.8472936153411865,
      "vector": null
    },
    {
      "collection_id": "Eval",
      "document_id": "extensions:Extension.OpenID Connect.OpenID Connect Authenticator.WebHome",
      "url": "https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/",
      "content": "# oidc.groups.mapping=MyXWikiGroup2=my-oidc-group3  \n  \n#-# The groups the user need to belong to be allowed to authenticate.  \n#-# Not taken into account if not set or empty.  \n#-#\u00a0  \n# oidc.groups.allowed=  \n  \n#-# If the user belong to one of these groups it won&#x27;t be allowed to authenticate  \n#-# Not taken into account if not set or empty.  \n#-#\u00a0  \n# oidc.groups.forbidden=  \n  \n#-# If set, only group names with this prefix will be provisioned  \n#-# Not taken into account if not set or empty.  \n#-#\u00a0  \n# oidc.groups.prefix=  \n  \n#-# If the identity provider returns group memberships as a single value attribute delimited with a char, for example:  \n#-# {  \n#-# \u00a0\u00a0&quot;sub&quot; \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0: &quot;248289761001&quot;,  \n#-# \u00a0\u00a0&quot;name&quot; \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0: &quot;Jane Doe&quot;,  \n#-# \u00a0\u00a0&quot;given\\_name&quot; \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0: &quot;Jane&quot;,  \n#-# \u00a0\u00a0&quot;family\\_name&quot; \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0: &quot;Doe&quot;,  \n#-# \u00a0\u00a0&quot;preferred\\_username&quot; : &quot;j.doe&quot;,  \n#-# \u00a0\u00a0&quot;email&quot; \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0: &quot;[[email\u00a0protected]](https://extensions.xwiki.org/cdn-cgi/l/email-protection)&quot;,  \n#-# \u00a0\u00a0&quot;picture&quot; \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0: &quot;http://example.com/janedoe/me.jpg&quot;,  \n#-# \u00a0\u00a0&quot;groups&quot; \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0: &quot;group1,group2&quot;  \n#-# }  \n#-# you can set here the separator char to get the list of groups the user belong to.\u00a0  \n#-# If not set, group memberships are evaluated as a multi valued attribute.  \n#-#\u00a0  \n# oidc.groups.separator=  \n  \n#-# The custom claims to request to the provider for the UserInfo  \n#-#\u00a0  \n#-# The available custom claims are:  \n#-# xwiki\\_groups (or whatever you indicated in oidc.groups.claim): the groups a user belong to in the provider (see &quot;Group synchronization&quot; section for more details)  \n#-# xwiki\\_user\\_&lt;fieldname&gt;: the suffix to use to request any field in the user profile document (generally when the provider is XWiki)\u00a0  \n#-# The default is:  \n",
      "similarity_score": 0.8471199870109558,
      "vector": null
    },
    {
      "collection_id": "Eval",
      "document_id": "extensions:Extension.LDAP.Authenticator.WebHome",
      "url": "https://extensions.xwiki.org/xwiki/bin/view/Extension/LDAP/Authenticator/",
      "content": "#-# The following kind of groups are supported:  \n#-# \\* LDAP static groups (users/subgroups are listed statically in the group object)  \n#-# \\* [Since 3.3M1] LDAP organization units (users/subgroups are sub object of the provided organization unit)  \n#-# \\* [Since 3.3M1] LDAP filter (users/groups are object found in a search with the provided filter)  \n# xwiki.authentication.ldap.exclude\\_group=cn=admin,ou=groups,o=MegaNova,c=US  \n  \n#-# Specifies the LDAP attribute containing the unique user identifier. It&#x27;s also used by default as identifier on XWiki side for the user profile page name.  \n#-# The default is:  \n# xwiki.authentication.ldap.UID\\_attr=cn  \n  \n#-# The potential LDAP groups classes. Separated by commas.  \n#-# The default is group,groupOfNames,groupOfUniqueNames,dynamicGroup,dynamicGroupAux,groupWiseDistributionList,posixGroup,apple-group  \n# xwiki.authentication.ldap.group\\_classes=group,groupOfNames,groupOfUniqueNames,dynamicGroup,dynamicGroupAux,groupWiseDistributionList,posixGroup,apple-group  \n  \n#-# The potential names of the LDAP groups fields containings the members. Separated by commas.  \n#-# The default is member,uniqueMember,memberUid  \n# xwiki.authentication.ldap.group\\_memberfields=member,uniqueMember,memberUid  \n  \n#-# Retrieve the following fields from LDAP and store them in the XWiki user object (xwiki-attribute=ldap-attribute).  \n#-# You can add any custom field you want in the XWiki user profile in the user profile section of the wiki administration.  \n#-# You can find all the field defined in the user profile in the page XWiki.XWikiUsers and here are some of the important ones:  \n#-# \\* first\\_name  \n#-# \\* last\\_name  \n#-# \\* email  \n#-# \\* company  \n#-# \\* address  \n#-# \\* phone  \n#-# \\* comment (a free form text about the user)  \n#-# By default the list is empty  \nxwiki.authentication.ldap.fields\\_mapping=last\\_name=sn,first\\_name=givenName,email=mail  \n  \n",
      "similarity_score": 0.836509108543396,
      "vector": null
    }
  ],
  "usage": {
    "prompt_tokens": 2547,
    "completion_tokens": 314,
    "total_tokens": 2861
  },
  "average_power_draw": null,
  "energy_consumption": null,
  "energy_per_input_token": null,
  "energy_per_output_token": null,
  "energy_per_total_token": null
}