{
  "id": "qa_017",
  "prompt": "Wie richte ich die Gruppensynchronisierung zwischen XWiki und meinem OpenID Connect-Anbieter ein?\nIch verwende einen OpenID Connect-Anbieter, der Gruppenanspr\u00fcche unterst\u00fctzt, und ich m\u00f6chte diese Gruppen mit XWiki-Gruppen synchronisieren. Wie ist der Prozess f\u00fcr die Einrichtung?",
  "expected_answer": "Um die Gruppensynchronisierung zwischen XWiki und Ihrem OpenID Connect-Anbieter einzurichten:\n1. Suchen Sie die Datei `xwiki.properties` im Installationsverzeichnis von XWiki.\n2. \u00d6ffnen Sie die Datei mit einem Texteditor.\n3. Konfigurieren Sie die Gruppensynchronisierung, indem Sie die Eigenschaft `oidc.groups.claim` auf den Namen des Anspruchs setzen, den Ihr OpenID Connect-Anbieter verwendet, um Gruppeninformationen zu senden. Zum Beispiel:\n```java\n#-# Der Name des Anspruchs, der verwendet wird, um die Liste der Gruppen zu erhalten, zu denen der Benutzer geh\u00f6rt.\n# oidc.groups.claim=groups\n```\nErsetzen Sie `groups` durch den tats\u00e4chlichen Anspruchsnamen, der von Ihrem OpenID Connect-Anbieter bereitgestellt wird.\n1. Wenn Ihr OpenID Connect-Anbieter Gruppenmitgliedschaften als einzelnes Wertattribut sendet, das durch ein bestimmtes Zeichen (z. B. ein Komma) getrennt ist, konfigurieren Sie die Eigenschaft `oidc.groups.separator` mit dem entsprechenden Zeichen:\n```java\n#-# Wenn der Identit\u00e4tsanbieter Gruppenmitgliedschaften als einzelnes Wertattribut zur\u00fcckgibt, das mit einem Zeichen getrennt ist, zum Beispiel:\n# oidc.groups.separator=,\n```\nErsetzen Sie das Komma durch das tats\u00e4chliche Trennzeichen, das von Ihrem Anbieter verwendet wird.\n1. Wenn Sie die synchronisierten Gruppen bestimmten XWiki-Gruppen zuordnen m\u00f6chten, konfigurieren Sie die Eigenschaft `oidc.groups.mapping` mit den entsprechenden Zuordnungen:\n```java\n# oidc.groups.mapping=XWiki.\"MyXWikiGroup\"=group1\n# oidc.groups.mapping=XWiki.\"MyXWikiGroup2\"=group2\n```\nErsetzen Sie `MyXWikiGroup` und `MyXWikiGroup2` durch die Namen der XWiki-Gruppen, die Sie zuordnen m\u00f6chten, und `group1` und `group2` durch die tats\u00e4chlichen Gruppennamen, die von Ihrem OpenID Connect-Anbieter bereitgestellt werden.\n1. Speichern Sie die Datei `xwiki.properties` und starten Sie Ihre XWiki-Instanz neu, damit die \u00c4nderungen wirksam werden.",
  "ai_answer": "Sources: https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/ \nhttps://www.xwiki.org/xwiki/bin/view/Documentation/AdminGuide/Authentication/ \n\n\nUm eine Gruppe zwischen Ihrem XWiki und einem OpenID Connect-Anbieter zu synchronisieren, insbesondere wenn Sie sicherstellen m\u00f6chten, dass Gruppenanspr\u00fcche korrekt \u00fcbertragen werden, k\u00f6nnen Sie folgende Schritte befolgen:\n\n1. **Installieren der erforderlichen Erweiterungen**: Stellen Sie zun\u00e4chst sicher, dass die notwendigen XWiki-Erweiterungen installiert sind. Dazu geh\u00f6ren das OpenID Connect Authenticator und m\u00f6glicherweise auch eine LDAP oder Active Directory Integration Extension, je nachdem wie Ihr Anbieter konfiguriert ist:\n\n   ```shell\n   wget https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/ -O oidc-authenticator.zip\n   unzip oidc-authenticator.zip\n   cd xiki_extension_dir\n   cp org.xwiki.contrib.oidc.* .\n   ```\n   \n2. **Konfigurieren der Erweiterung**: \u00d6ffnen Sie die Konfigurationsdatei `xwiki.cfg` und f\u00fcgen Sie folgende Einstellungen hinzu, um den Authentifizierungsdienst zu konfigurieren:\n\n   ```properties\n   xwiki.authentication.authclass=org.xwiki.contrib.oidc.auth.OIDCAuthServiceImpl\n   \n   # Base URL of the OpenId Connect Provider (if not provided, it will be asked to user)\n   oidc.provider=https://your-openid-connect-provider.com/discovery\n   \n   # Endpoints for authorization and token requests; if your provider supports discovery, you can use these instead of the base URL:\n   oidc.endpoint.authorization=https://your-openid-connect-provider.com/authz\n   oidc.endpoint.token=https://your-openid-connect-provider.com/token\n   \n   # Endpoint for user info requests; if your provider supports discovery, you can use this instead of the base URL:\n   oidc.endpoint.userinfo=https://your-openid-connect-provider.com/userinfo\n   \n   # Add custom headers to these endpoints (if needed) using key:value format like so:\n   oidc.endpoint.userinfo.headers=\"Accept: application/json\" \"AnotherHeader\": header_value\n   \n   # Specify the scopes for your requests, including openid which is required\n   ```\n\n3. **Konfigurieren der Gruppenanspr\u00fcche** (falls Ihr Anbieter diese unterst\u00fctzt): Wenn Ihr OpenID Connect-Anbieter die Gruppeanspr\u00fcche \u00fcbernimmt und Sie sie in XWiki anzeigen m\u00f6chten, k\u00f6nnen Sie dies im Kontext des Authentifizierungsdienstes konfigurieren.\n   \n   ```properties\n   # Configure group claims handling (if supported by your provider)\n   xwiki.oidc.groupClaims=true\n   oidc.endpoint.userinfo.groups=true  # This tells the OIDC Authenticator to include groups in user info requests if they are available from the OpenID Provider\n   \n   ```properties\n   \n4. **Testen der Konfiguration**: Starten Sie Ihren XWiki-Server neu und testen Sie die Konfiguration, um sicherzustellen, dass alles korrekt funktioniert. Falls n\u00f6tig, k\u00f6nnen Sie den Authentifizierungsdienst manuell starten oder das Gruppenanspruchsverwaltungstool verwenden:\n   \n   ```shell\n   ./start-oidc-authenticator  # Startet den Dienst (falls nicht automatisch)\n   xwiki authservice/groups list --debug  # List of groups and their claims, if configured correctly.\n   ```\n   \n5. **Konfigurieren der Gruppenanspr\u00fcche in XWiki**: Falls Ihr Anbieter die Gruppeanspr\u00fcche \u00fcbermittelt und Sie diese im Kontext von XWiki anzeigen m\u00f6chten, k\u00f6nnen Sie dies manuell konfigurieren oder eine Erweiterung wie Active Directory Application verwenden.\n   \n   ```shell\n   # Manual configuration (if supported by your provider)\n   xwiki authservice/groups list --claims=group_claim  # List of groups and their claims, if configured correctly.\n   \n   # Or use a dedicated application for Active Directory integration: https://store.xwiki.com/extension/active-directory-application\n   ```\n   \n6. **\u00dcberpr\u00fcfen der Gruppenanspr\u00fcche**: Testen Sie die Gruppeanspr\u00fcche, indem Sie sich bei Ihrem OpenID Connect-Anbieter anmelden und \u00fcberpr\u00fcfen Sie dann im XWiki Kontext, ob sie korrekt angezeigt werden.\n   \n   ```shell\n   # Log into your provider and check the group claims are correct (manually or via a tool)\n   \n   xwiki authservice/groups list --claims=group_claim  # List of groups with their respective claims in XWiki context, if configured correctly.\n   ```\n   \n7. **Konfigurieren der Gruppenanspr\u00fcche im Authentifizierungsdienst**: Wenn Sie die Gruppeanspr\u00fcche nicht manuell konfiguriert haben und sie stattdessen vom OpenID Connect-Anbieter \u00fcbermitteln m\u00f6chten, k\u00f6nnen Sie dies in den Einstellungen des OIDC Authenticator Kontexts hinzuf\u00fcgen.\n   \n   ```properties\n   # Configure group claims handling (if supported by your provider)\n   xwiki.oidc.groupClaims=true  # This tells the OIDC Authenticator to include groups in user info requests if they are available from OpenID Provider\n   oidc.endpoint.userinfo.groups=true  # Request group claims with each request for user information (if supported by your provider)\n   \n   ```properties\n   \n8. **\u00dcberpr\u00fcfen der Gruppenanspr\u00fcche in XWiki**: Testen Sie die Gruppeanspr\u00fcche erneut, um sicherzustellen, dass sie korrekt angezeigt werden und synchronisiert sind mit dem OpenID Connect-Anbieter.\n   \n   ```shell\n   # Log into your provider and check the group claims are correct (manually or via a tool)\n   \n   xwiki authservice/groups list --claims=group_claim  # List of groups with their respective claims in XWiki context, if configured correctly.\n   ```\n   \nBitte beachten Sie, dass die genaue Konfiguration von der Unterst\u00fctzung des OpenID Connect-Anbieters abh\u00e4ngen kann und es m\u00f6glicherweise spezifische Einstellungen gibt, um diese zu aktivieren oder anzuzeigen. Konsultieren Sie immer den Dokumentationsmaterialien Ihres Anbieters f\u00fcr die genauesten Schritte.\n   \nWenn Sie weiterhin Probleme haben oder Unterst\u00fctzung ben\u00f6tigen, k\u00f6nnen Sie sich mit dem XWiki-Support in Verbindung setzen oder auf der offiziellen XWiki-Foren nachfragen.",
  "sources": [
    {
      "collection_id": "Eval",
      "document_id": "extensions:Extension.OpenID Connect.OpenID Connect Authenticator.WebHome",
      "url": "https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/",
      "content": "#-# The authentication management class.  \nxwiki.authentication.authclass=org.xwiki.contrib.oidc.auth.OIDCAuthServiceImpl### xwiki.properties\n\n#-# The base URL of the OpenId Connect Provider to use as starting point to discover the provider configuration.  \n#-# See following endpoints properties if the provider is does not support OpenID Connect discovery.  \n#-# If not indicated and not custom endpoint is provided, it will be asked to the user.  \n# oidc.provider=https://xwikiorg-node1.xwikisas.com/xwiki/oidc  \n  \n#-# The generic OpenId Connect endpoints to use to communicate with the provider.  \n#-# It&#x27;s generally not needed when providing the provider discovery endpoint (which is supposed to provide those enpoints).  \n# oidc.endpoint.authorization=https://xwikiorg-node1.xwikisas.com/xwiki/oidc/authorization  \n# oidc.endpoint.token=https://xwikiorg-node1.xwikisas.com/xwiki/oidc/token  \n# oidc.endpoint.userinfo=https://xwikiorg-node1.xwikisas.com/xwiki/oidc/userinfo  \n# oidc.endpoint.logout=https://xwikiorg-node1.xwikisas.com/xwiki/oidc/logout  \n  \n#-# It&#x27;s possible to add custom HTTP headers to the endpoint (generally only needed for bad or non-oidc providers)  \n#-# by adding the suffix &quot;.headers&quot; to the endpoint property key and listing the custom headers using key:value format.  \n#-# Note that it&#x27;s not taken into account for the oidc.endpoint.authorization endpoint because it&#x27;s used as a redirect.  \n#-# Here is an example to send &quot;Accept: application/json&quot; and &quot;SomeOtherHeader: header&quot; HTTP headers with the userinfo request.  \n# oidc.endpoint.userinfo.headers=Accept:application/json  \n# oidc.endpoint.userinfo.headers=SomeOtherHeader:header value  \n  \n#-# The scopes to use when redirecting to the provider  \n#-# The standard OpenID Connection scopes are:  \n#-# \\* openid: Informs the authorisation server that the client is making an OpenID Connect request (REQUIRED).  \n",
      "similarity_score": 13.729754447937012,
      "vector": null
    },
    {
      "collection_id": "Eval",
      "document_id": "xwiki:Documentation.AdminGuide.Authentication.WebHome",
      "url": "https://www.xwiki.org/xwiki/bin/view/Documentation/AdminGuide/Authentication/",
      "content": "## Container Authentication\n\nDelegates authentication to the Servlet Container. If it fails it falls back to the standard XWiki authentication.\n\nTo configure XWiki to use it, specify:\n\nxwiki.authentication.authclass=com.xpn.xwiki.user.impl.xwiki.AppServerTrustedAuthServiceImplFor users to be actually created and not just set as context user you must set in xwiki.cfg configuration file (if the property does not already exist, create it):\n\nxwiki.authentication.createuser=empty## OpenId Connect Authentication\n\nSee the [OpenId Connect Authenticator Extension](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/).\n\n## Active Directory\n\nIf you&#x27;re looking to connect XWiki to an Active Directory server, you currently have 2 options:\n\n* Using the manual and generic approach using the [LDAP Authenticator extension](https://extensions.xwiki.org/xwiki/bin/view/Extension/LDAP/Authenticator/)\n* Using the dedicated [Active Directory Application](https://store.xwiki.com/xwiki/bin/view/Extension/ActiveDirectoryApplication) which is a paying application dedicated to simplifying the integration of Active Directory with XWiki. The Active Directory Application allows you to easily connect your Active Directory server to XWiki using a **visual editor**, update\u00a0**advanced configuration** settings without restarting the application server, **technical support** provided by [XWiki SAS](https://xwiki.com/), etc.\n\n## LDAP\n\nSee the [LDAP Authenticator extension](https://extensions.xwiki.org/xwiki/bin/view/Extension/LDAP/Authenticator/).\n\nThe deprecated LDAP core authenticator (for XWiki &lt; 7.4) can be found on [OldLDAPAuthenticator](https://www.xwiki.org/xwiki/bin/view/Documentation/AdminGuide/Authentication/OldLDAPAuthenticator/).\n\n",
      "similarity_score": 13.373527526855469,
      "vector": null
    },
    {
      "collection_id": "Eval",
      "document_id": "extensions:Extension.OpenID Connect.OpenID Connect Authenticator.WebHome",
      "url": "https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/",
      "content": "* [Prerequisites &amp; Installation Instructions](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/#HPrerequisites26InstallationInstructions)\n* [Dependencies](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/#HDependencies)\n# Description\n\nAllow an XWiki instance to authenticate on an OpenId Connect provider. It also performs automatic synchronization.\n\nSee also [OpenID Connect Provider](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Provider/).\n\n![oidc_client_provider.png](https://extensions.xwiki.org/xwiki/bin/download/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/WebHome/oidc_client_provider.png?rev=1.1)\n\nRelease notes can be found on [OpenID Connect project page](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/#HReleaseNotes).\n\n# Main limitations\n\n* [Automatically authenticate user when coming back](https://jira.xwiki.org/browse/OIDC-16)\n\n# Configuration\n\n## Configuration Guides for specific systems\n\n### Lemon LDAP / Open PAAS\n\nA [configuration guide](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/ConfigurationLemonLDAP/) is available to connect XWiki to LemonLDAP / OpenPAAS using the OpenIDC XWiki client.\n\n### OpenID Authentication with Keycloak\n\nA [configuration example for Keycloak](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/OpenID%20Authentication%20with%20Keycloak/) is available.\n\n### Univention Corporate Server\n\nA [configuration example for Univention Corporate Server (UCS)](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/OpenID%20Authentication%20with%20UCS/) is available.\n\n## Configuration files\n\n### xwiki.cfg\n\n",
      "similarity_score": 0.8385156989097595,
      "vector": null
    },
    {
      "collection_id": "Eval",
      "document_id": "extensions:Extension.OpenID Connect.OpenID Connect Authenticator.WebHome",
      "url": "https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/",
      "content": "# Dependencies\n\nDependencies for this extension (org.xwiki.contrib.oidc:oidc-authenticator 2.8.6):\n\n* org.xwiki.platform:xwiki-platform-oldcore 14.10\n* com.nimbusds:oauth2-oidc-sdk 11.10.1\n* [org.xwiki.contrib.oidc:oidc-provider](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Provider/) 2.8.6\n* org.xwiki.contrib.oidc:oidc-authenticator-configuration 2.8.6\n* org.xwiki.contrib.oidc:oidc-authenticator-user 2.8.6\n\n\n",
      "similarity_score": 0.8088323473930359,
      "vector": null
    },
    {
      "collection_id": "Eval",
      "document_id": "extensions:Extension.OpenID Connect.OpenID Connect Authenticator.WebHome",
      "url": "https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/",
      "content": "\n\n\n| openid_connect_16x16.png | **Allow an XWiki instance to authenticate on an OpenID Connect provider** |\n| --- | --- |\n\n**Recommended**\n\n| Type | JAR |\n| --- | --- |\n| Category | Authenticator |\n| Developed by | [Thomas Mortagne](https://xwiki.org/xwiki/bin/view/XWiki/ThomasMortagne) |\n| Active Installs | 146 |\n| Rating | *  * [1](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/ &quot;Poor&quot;) * [2](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/ &quot;Satisfactory&quot;) * [3](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/ &quot;Good&quot;) * [4](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/ &quot;Very good&quot;) * [5](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/ &quot;Excellent&quot;)    1\u00a0Votes |\n| License | GNU Lesser General Public License 2.1 |\n\n\n\n| Compatibility | XWiki 14.10+ is required. |\n| --- | --- |\n\n**Installable with the Extension Manager**\n\n[Download v2.8.6](https://extensions.xwiki.org/xwiki/rest/repository/extensions/org.xwiki.contrib.oidc%3Aoidc-authenticator/versions/2.8.6/file?rid=maven-xwiki)[Sources](https://github.com/xwiki-contrib/oidc/tree/master/oidc-authenticator)[Issues](https://jira.xwiki.org/browse/OIDC)\n\nTable of contents\n\n",
      "similarity_score": 0.7939773797988892,
      "vector": null
    }
  ],
  "usage": {
    "prompt_tokens": 2957,
    "completion_tokens": 1656,
    "total_tokens": 4613
  },
  "average_power_draw": 203.4261930783241,
  "energy_consumption": 2773.4421123838583,
  "energy_per_input_token": 0.39079077249314614,
  "energy_per_output_token": 0.9769769312328654,
  "energy_per_total_token": 0.6012230896128026
}