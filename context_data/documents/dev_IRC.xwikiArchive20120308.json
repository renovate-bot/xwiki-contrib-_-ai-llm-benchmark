{"id": "dev:IRC.xwikiArchive20120308", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20120308", "title": "IRC Archive for channel #xwiki on 08 March 2012 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n00:05\u00a0<CIA-120>\u00a0Sergiu Dumitriu\u000f master\u000f \\* r0953397\u000f https://github.com/xwiki/xwiki-platform/commit/0953397af272a0a43e4336756bc4903f4fa0a174 \u000f/ (5 files in 4 dirs):\u000f Merge branch 'XWIKI-7597' of https://github.com/evalica/xwiki-platform - http://git.io/PB3o0w  \n00:05\u00a0<CIA-120>\u00a0Sergiu Dumitriu\u000f master\u000f \\* r98b38db\u000f https://github.com/xwiki/xwiki-platform/commit/98b38db8cad217899654702b26dbbf07cd60ddfd \u000f/ (2 files):\u000f XWIKI-7597: Add new colortheme variables for the gradients introduced by 3.4 and allow their modification from the colorthemes wizard ...  \n00:06\u00a0<CIA-120>\u00a0Sergiu Dumitriu\u000f master\u000f \\* rfe199b8\u000f https://github.com/xwiki/xwiki-enterprise/commit/fe199b8614092dda8d1d59124198956565d67f8d \u000f/ (8 files):\u000f Merge branch 'XE-1122' of https://github.com/evalica/xwiki-enterprise - http://git.io/ZKm0nQ  \n00:07\u00a0<CIA-120>\u00a0Ecaterina Moraru (Valica)\u000f stable-3.5.x\u000f \\* rb6e7be0\u000f https://github.com/xwiki/xwiki-enterprise/commit/b6e7be0ceeafae1fc74e88e73bd3e8a54b97858a \u000f/ (8 files):\u000f XE-1122: Add new colortheme variables for the gradients introduced by 3.4 and allow their modification from the colorthemes wizard ...  \n00:08\u00a0<CIA-120>\u00a0Ecaterina Moraru (Valica)\u000f stable-3.5.x\u000f \\* r40d75a9\u000f https://github.com/xwiki/xwiki-platform/commit/40d75a96c939a86a2bb6872fe19092e35a649be1 \u000f/ (5 files in 4 dirs):\u000f XWIKI-7597: Add new colortheme variables for the gradients introduced by 3.4 and allow their modification from the colorthemes wizard ...  \n00:08\u00a0<CIA-120>\u00a0Sergiu Dumitriu\u000f stable-3.5.x\u000f \\* rcca0a25\u000f https://github.com/xwiki/xwiki-platform/commit/cca0a2572ac9e6af6c9f8895b99a6d0032056a66 \u000f/ (2 files):\u000f XWIKI-7597: Add new colortheme variables for the gradients introduced by 3.4 and allow their modification from the colorthemes wizard ...  \n00:18\u00a0<jvdrean>\u00a0has joined #xwiki  \n00:19\u00a0<jvdrean1>\u00a0has joined #xwiki  \n00:19\u00a0<jvdrean>\u00a0has quit  \n00:27\u00a0<CIA-120>\u00a0Sergiu Dumitriu\u000f master\u000f \\* r26a852e\u000f https://github.com/xwiki/xwiki-platform/commit/26a852ef463a806f1a19f3354d4b655391ea930b \u000f/ xwiki-platform-core/xwiki-platform-web/src/main/webapp/templates/colorThemeInit.vm :\u000f XWIKI-7597: Add new colortheme variables for the gradients introduced by 3.4 and allow their modification from the colorthemes wizard ...  \n00:27\u00a0<CIA-120>\u00a0Sergiu Dumitriu\u000f stable-3.5.x\u000f \\* r1f0d0d3\u000f https://github.com/xwiki/xwiki-platform/commit/1f0d0d30219a486a8267bd2c7ac965e4266cb9d0 \u000f/ xwiki-platform-core/xwiki-platform-web/src/main/webapp/templates/colorThemeInit.vm :\u000f XWIKI-7597: Add new colortheme variables for the gradients introduced by 3.4 and allow their modification from the colorthemes wizard ...  \n00:28\u00a0<CIA-120>\u00a0Sergiu Dumitriu\u000f master\u000f \\* r26c8350\u000f https://github.com/xwiki/xwiki-platform/commit/26c83509378d8e28b53b1c213feac45bdd44d337 \u000f/ xwiki-platform-core/xwiki-platform-web/src/main/webapp/templates/colorThemeInit.vm :\u000f [misc] Removed extra white space - http://git.io/UYzMfQ  \n00:45\u00a0<vmassol>\u00a0has quit  \n01:07\u00a0<jvdrean1>\u00a0has quit  \n01:49\u00a0<npm>\u00a0has joined #xwiki  \n01:54\u00a0<cjd>\u00a0has quit  \n02:01\u00a0<cjd>\u00a0has joined #xwiki  \n02:36\u00a0<rrodriguez>\u00a0has quit  \n05:56\u00a0<Denis>\u00a0has joined #xwiki  \n05:59\u00a0<Denis1>\u00a0has quit  \n07:29\u00a0<rrodriguez>\u00a0has joined #xwiki  \n08:02\u00a0<vmassol>\u00a0has joined #xwiki  \n08:07\u00a0<tmortagne>\u00a0has joined #xwiki  \n08:30\u00a0<mflorea>\u00a0has joined #xwiki  \n08:51\u00a0<silviar>\u00a0has joined #xwiki  \n09:03\u00a0<rrodriguez>\u00a0has quit  \n09:18\u00a0<jvdrean>\u00a0has joined #xwiki  \n09:26\u00a0<vmassol>\u00a0seems there's a vagrant plugin for jenkins out there: http://strongspace.com/rtyler/public/vagrant-plugin-yay.png :)  \n09:26\u00a0<+sburjan`>\u00a0that's cool.  \n09:27\u00a0<+sburjan`>\u00a0it will mek the integration between vagrant and jenkins easier  \n09:52\u00a0<+sburjan`>\u00a0we could setup an entire environment with this script  \n09:52\u00a0<+sburjan`>\u00a0\\*just\\* with this script  \n09:52\u00a0<+sburjan`>\u00a0and some basic provisioning with puppet, and we're good to go, at least fox Linux machines  \n09:53\u00a0<silviar>\u00a0has quit  \n09:54\u00a0<vmassol>\u00a0without this plugin you can read this: http://codeslife.com/2011/10/21/make-ci-easier-with-jenkins-ci-and-vagrant/  \n09:54\u00a0<vmassol>\u00a0some other reads (haven't read them):  \n09:55\u00a0<vmassol>\u00a0http://codeslife.com/tag/jenkins/  \n09:55\u00a0<vmassol>\u00a0btw the plugin is here: https://github.com/rtyler/vagrant-plugin  \n09:56\u00a0<vmassol>\u00a0it's being developed (it's very recent)  \n09:58\u00a0<gdelhumeau>\u00a0has joined #xwiki  \n09:59\u00a0<lucaa>\u00a0has joined #xwiki  \n10:02\u00a0<CIA-120>\u00a0Marius Dumitru Florea\u000f master\u000f \\* reab39b5\u000f https://github.com/xwiki/xwiki-platform/commit/eab39b5383a1ee1097eb1bc53b2ea75897715f1d \u000f/ xwiki-platform-core/xwiki-platform-web/src/main/webapp/templates/preview.vm :\u000f XWIKI-6934: Preview action doesn't displays the page's title - http://git.io/jfpiDA  \n10:02\u00a0<CIA-120>\u00a0Marius Dumitru Florea\u000f stable-3.5.x\u000f \\* r91bb4e4\u000f https://github.com/xwiki/xwiki-platform/commit/91bb4e46465fa565a51b74ffcc03c47a694f069e \u000f/ xwiki-platform-core/xwiki-platform-web/src/main/webapp/templates/preview.vm :\u000f XWIKI-6934: Preview action doesn't displays the page's title - http://git.io/hr9FSA  \n10:04\u00a0<CIA-120>\u00a0Marius Dumitru Florea\u000f master\u000f \\* ra9a2a6d\u000f https://github.com/xwiki/xwiki-enterprise/commit/a9a2a6d94cb3e6f877273e67e049ac7fedb1eb8e \u000f/ xwiki-enterprise-test/xwiki-enterprise-test-ui/src/test/it/org/xwiki/test/ui/EditWikiTest.java :\u000f XWIKI-6934: Preview action doesn't displays the page's title ...  \n10:04\u00a0<CIA-120>\u00a0Marius Dumitru Florea\u000f stable-3.5.x\u000f \\* r0e5373a\u000f https://github.com/xwiki/xwiki-enterprise/commit/0e5373a7c34094f6af2319d13efc79d71750ab57 \u000f/ xwiki-enterprise-test/xwiki-enterprise-test-ui/src/test/it/org/xwiki/test/ui/EditWikiTest.java :\u000f XWIKI-6934: Preview action doesn't displays the page's title ...  \n10:04\u00a0<silviar>\u00a0has joined #xwiki  \n10:05\u00a0<mflorea>\u00a0has quit  \n10:47\u00a0<Enygma`>\u00a0has joined #xwiki  \n10:52\u00a0<evalica>\u00a0has joined #xwiki  \n11:23\u00a0<florinciu>\u00a0has joined #xwiki  \n11:40\u00a0<sburjan>\u00a0has joined #xwiki  \n11:44\u00a0<mflorea>\u00a0has joined #xwiki  \n12:51\u00a0<+sburjan>\u00a0vmassol: I have finished editing the Cache Macro documentation.  \n12:52\u00a0<vmassol>\u00a0sburjan: ok thanks I'll fix a few things  \n12:52\u00a0<vmassol>\u00a0btw the max isn't what you say I think  \n12:52\u00a0<vmassol>\u00a0it's 2^31-1  \n12:52\u00a0<+sburjan>\u00a0I got the content from the JIRA issue XWIKI-7043  \n12:53\u00a0<+sburjan>\u00a0from the comments  \n12:53\u00a0<vmassol>\u00a0http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Integer.html#MAX\\_VALUE  \n12:53\u00a0<vmassol>\u00a0mm I don't recall why I mentioned it :)  \n12:53\u00a0<vmassol>\u00a0ah I know  \n12:53\u00a0<vmassol>\u00a0the integer can go to 2^31 -1  \n12:54\u00a0<vmassol>\u00a0but the cache implementation myabe only supports that value mentioned  \n12:54\u00a0<vmassol>\u00a0anyway if I said it I must have checked it :)  \n12:54\u00a0<vmassol>\u00a0so it should be ok  \n12:54\u00a0<+sburjan>\u00a0might be  \n12:54\u00a0<+sburjan>\u00a0you could add some warnings about threads, etc  \n12:54\u00a0<vmassol>\u00a0yes that + the other param you missed  \n12:54\u00a0<+sburjan>\u00a0there is another param ? :o  \n12:55\u00a0<+sburjan>\u00a0:) didn;t knew  \n12:55\u00a0<vmassol>\u00a0you also didn't put the default values  \n12:55\u00a0<vmassol>\u00a0and the fact it's optional  \n12:56\u00a0<vmassol>\u00a0lunch time  \n12:56\u00a0<+sburjan>\u00a0I'll add them  \n13:06\u00a0<+sburjan>\u00a0done  \n13:11\u00a0<+sburjan>\u00a0not somplete because I didn't know all the details  \n13:11\u00a0<+sburjan>\u00a0\\*complete  \n13:37\u00a0<xwikibot>\u00a0has joined #xwiki  \n13:55\u00a0<vmassol>\u00a0evalica: I've added this for you: http://extensions.xwiki.org/xwiki/bin/view/Extension/Cache+Macro#HLimitations  \n13:55\u00a0<vmassol>\u00a0:)  \n13:55\u00a0<vmassol>\u00a0(I've also added doc about the threads)  \n13:56\u00a0<vmassol>\u00a0tmortagne: can you confirm that infinispan also creates one thread per cache in our default config?  \n13:56\u00a0<+tmortagne>\u00a0vmassol: no it does not  \n13:56\u00a0<vmassol>\u00a0it has one single thread?  \n13:56\u00a0<+tmortagne>\u00a0that was jbosscache  \n13:56\u00a0<vmassol>\u00a0for all cahces?  \n13:57\u00a0<+tmortagne>\u00a0it does not create as many thread as jboss used to do for sure  \n13:57\u00a0<+evalica>\u00a0vmassol: that's why the layout problems - thanks  \n13:58\u00a0<+tmortagne>\u00a0and eviction eviction is done synchronously so I don't see why it would have a thread by cache like jbosscache  \n13:58\u00a0<vmassol>\u00a0ok I'll amend the doc saying that it's only for jbosscache  \n13:58\u00a0<vmassol>\u00a0so evalica it's not as bad as I feared yesterday :)  \n13:58\u00a0<vmassol>\u00a0tmortagne: do you know what overhead we have in infinispan by creating lots of caches?  \n13:59\u00a0<+tmortagne>\u00a0also probably for that reason creating a new cache is veru quick in infinispan while it was prettty expensive in josscache  \n13:59\u00a0<+tmortagne>\u00a0memory \u00a0guess  \n13:59\u00a0<+tmortagne>\u00a0caches are never destroyed, right ?  \n14:00\u00a0<vmassol>\u00a0nope  \n14:00\u00a0<vmassol>\u00a0they're not destroyed  \n14:00\u00a0<+tmortagne>\u00a0it's one cache per what ?  \n14:01\u00a0<+tmortagne>\u00a0document ?  \n14:02\u00a0<vmassol>\u00a0no  \n14:02\u00a0<vmassol>\u00a0per combination of (timeToLive,maxEntries)  \n14:03\u00a0<+tmortagne>\u00a0ok so probably not that much caches then since I guess we tend to use the same values  \n14:06\u00a0<Denis>\u00a0has quit  \n14:11\u00a0<Denis>\u00a0has joined #xwiki  \n14:23\u00a0<tekzilla>\u00a0has quit  \n14:24\u00a0<vmassol>\u00a0has quit  \n14:25\u00a0<tekzilla>\u00a0has joined #xwiki  \n14:32\u00a0<vmassol>\u00a0has joined #xwiki  \n14:51\u00a0<CIA-120>\u00a0tmortagne\u000f master\u000f \\* rff17079\u000f https://github.com/xwiki/xwiki-commons/commit/ff17079b6efec1c6ea2eacd31078205d877f0172 \u000f/ (61 files in 18 dirs):\u000f XCOMMONS-122: Move classloader module to commons ...  \n14:58\u00a0<CIA-120>\u00a0tmortagne\u000f master\u000f \\* ra82c557\u000f https://github.com/xwiki/xwiki-commons/commit/a82c5578a3d2fdeba3301cd3f07ce5c3c8085840 \u000f/ (3 files in 2 dirs):\u000f XCOMMONS-124: Redefine default license formats instead of creating new ...  \n15:05\u00a0<CIA-120>\u00a0tmortagne\u000f master\u000f \\* r23e014d\u000f https://github.com/xwiki/xwiki-commons/commit/23e014d2cb1ccdea3e9ec2e97be0fcdd771683df \u000f/ xwiki-commons-tools/xwiki-commons-tool-validation-resources/src/main/resources/license-batch-definition.xml :\u000f XCOMMONS-124: Redefine default license formats instead of creating new ...  \n15:13\u00a0<CIA-120>\u00a0Vincent Massol\u000f master\u000f \\* r334b9ad\u000f https://github.com/xwiki/xwiki-commons/commit/334b9ad1e287a7d42f22f212cacf605b8760aff4 \u000f/ xwiki-commons-core/xwiki-commons-test/src/main/java/org/xwiki/test/AbstractMockingComponentTestCase.java :\u000f XWIKI-7598: Fix handling of Loggers when automatically mocking Component dependencies ...  \n15:15\u00a0<vmassol>\u00a0has quit  \n15:22\u00a0<vmassol>\u00a0has joined #xwiki  \n15:27\u00a0<CIA-120>\u00a0tmortagne\u000f master\u000f \\* r6cf9f77\u000f https://github.com/xwiki/xwiki-platform/commit/6cf9f77249117d935edd329bf567d689603a82e0 \u000f/ (304 files in 93 dirs):\u000f XWIKI-7604: Move classloader module to commons ...  \n15:28\u00a0<cjd>\u00a0has quit  \n15:30\u00a0<cjd>\u00a0has joined #xwiki  \n15:39\u00a0<cjd>\u00a0has quit  \n15:52\u00a0<cjd>\u00a0has joined #xwiki  \n15:58\u00a0<CIA-120>\u00a0tmortagne\u000f master\u000f \\* r93a0616\u000f https://github.com/xwiki/xwiki-platform/commit/93a061668a328d88a0fa47dc297508623290609c \u000f/ xwiki-platform-core/xwiki-platform-test/pom.xml :\u000f XWIKI-7605: Move extension module to commons - http://git.io/H3vqCA  \n16:07\u00a0<CIA-120>\u00a0tmortagne\u000f master\u000f \\* r4aa9675\u000f https://github.com/xwiki/xwiki-enterprise/commit/4aa967538c10576373083d4092a40b254b39dbf9 \u000f/ xwiki-enterprise-web/pom.xml :\u000f XWIKI-7605: Move extension module to commons - http://git.io/8KQ3pA  \n16:07\u00a0<CIA-120>\u00a0tmortagne\u000f master\u000f \\* rb34c840\u000f https://github.com/xwiki/xwiki-enterprise/commit/b34c8404c7463a4f60c687359308c963ad95cd6f \u000f/ (2 files in 2 dirs):\u000f XWIKI-7605: Move extension module to commons - http://git.io/7Pvymw  \n16:09\u00a0<cjd>\u00a0has quit  \n16:10\u00a0<cjd>\u00a0has joined #xwiki  \n16:15\u00a0<vmassol>\u00a0I broke some tests again\u2026 grr\u2026. fixing  \n16:18\u00a0<cjd>\u00a0has quit  \n16:25\u00a0<cjd>\u00a0has joined #xwiki  \n16:35\u00a0<CIA-120>\u00a0Vincent Massol\u000f master\u000f \\* ra2a94a2\u000f https://github.com/xwiki/xwiki-commons/commit/a2a94a250e5ec4f704c71568b2005ad9820f7b24 \u000f/ xwiki-commons-core/xwiki-commons-test/src/main/java/org/xwiki/test/AbstractMockingComponentTestCase.java :\u000f XWIKI-7598: Fix handling of Loggers when automatically mocking Component dependencies ...  \n16:44\u00a0<vmassol>\u00a0let's hope I've succeeded in stabilizing AbstractMockingComponentTestCase now :)  \n16:57\u00a0<gdelhumeau>\u00a0has quit  \n17:09\u00a0<florinciu>\u00a0has quit  \n17:13\u00a0<gdelhumeau>\u00a0has joined #xwiki  \n17:22\u00a0<CIA-120>\u00a0Marius Dumitru Florea\u000f stable-3.5.x\u000f \\* r2349669\u000f https://github.com/xwiki/xwiki-platform/commit/23496697a8d0ab8e39d693ea9244565e2e0b695c \u000f/ (5 files in 5 dirs):\u000f XWIKI-7573: WYSWIG Editor Undo Level is limited to 10 ...  \n17:23\u00a0<CIA-120>\u00a0Marius Dumitru Florea\u000f master\u000f \\* r054d48b\u000f https://github.com/xwiki/xwiki-platform/commit/054d48b8b28c79872829a85853fd5969e4d2215f \u000f/ (5 files in 5 dirs):\u000f XWIKI-7573: WYSWIG Editor Undo Level is limited to 10 ...  \n17:23\u00a0<CIA-120>\u00a0Marius Dumitru Florea\u000f master\u000f \\* r220b606\u000f https://github.com/xwiki/xwiki-platform/commit/220b6060f6ee0e79f69480a99e4ca1d43e015b9e \u000f/ (305 files in 94 dirs):\u000f Merge branch 'master' of github.com:xwiki/xwiki-platform - http://git.io/Vh4K8Q  \n17:29\u00a0<cjd>\u00a0has quit  \n17:30\u00a0<cjd>\u00a0has joined #xwiki  \n17:31\u00a0<silviar>\u00a0has quit  \n17:36\u00a0<CIA-120>\u00a0Marius Dumitru Florea\u000f stable-3.5.x\u000f \\* r0372345\u000f https://github.com/xwiki/xwiki-enterprise/commit/037234568338824a32c0c6901ca4deb329e75e53 \u000f/ xwiki-enterprise-test/xwiki-enterprise-test-ui/src/test/it/org/xwiki/test/ui/appwithinminutes/LiveTableEditorTest.java :\u000f Attempt to fix flickering test. ...  \n17:37\u00a0<CIA-120>\u00a0Marius Dumitru Florea\u000f master\u000f \\* rec13cdb\u000f https://github.com/xwiki/xwiki-enterprise/commit/ec13cdb6c42c0162c47958530b11b1bb1ef53fbb \u000f/ xwiki-enterprise-test/xwiki-enterprise-test-ui/src/test/it/org/xwiki/test/ui/appwithinminutes/LiveTableEditorTest.java :\u000f Attempt to fix flickering test. - http://git.io/D7ZIOQ  \n17:40\u00a0<cjd>\u00a0has quit  \n17:45\u00a0<sburjan>\u00a0has quit  \n17:47\u00a0<cjd>\u00a0has joined #xwiki  \n17:58\u00a0<cjd>\u00a0has quit  \n17:58\u00a0<CIA-120>\u00a0tmortagne\u000f master\u000f \\* rd7bdf06\u000f https://github.com/xwiki/xwiki-enterprise/commit/d7bdf06422e36bd1b61866ccbdf4c0b62c38eedc \u000f/ xwiki-enterprise-web/pom.xml :\u000f XWIKI-7605: Move extension module to commons ...  \n18:02\u00a0<pgmjsd>\u00a0hey folks, just posted to the users list about a strange JavaScript behavior with the 'add tags' box. \u00a0\u00a0Wedges my browser up every time.  \n18:21\u00a0<@sdumitriu>\u00a0Hey pgmjsd  \n18:21\u00a0<@sdumitriu>\u00a0Did you get my reply?  \n18:42\u00a0<CIA-120>\u00a0Ecaterina Moraru (Valica)\u000f stable-3.5.x\u000f \\* rcbeb3a5\u000f https://github.com/xwiki/xwiki-platform/commit/cbeb3a5f2f1b1e240a13e0a5c2409c6d825bb6c7 \u000f/ xwiki-platform-core/xwiki-platform-web/src/main/webapp/templates/colorThemeInit.vm :\u000f XWIKI-7597: Add new colortheme variables for the gradients introduced by 3.4 and allow their modification from the colorthemes wizard ...  \n18:44\u00a0<CIA-120>\u00a0Ecaterina Moraru (Valica)\u000f master\u000f \\* r8a56261\u000f https://github.com/xwiki/xwiki-platform/commit/8a5626176bc32c5a5b434fc2e88ecde1086e2dae \u000f/ xwiki-platform-core/xwiki-platform-web/src/main/webapp/templates/colorThemeInit.vm :\u000f XWIKI-7597: Add new colortheme variables for the gradients introduced by 3.4 and allow their modification from the colorthemes wizard ...  \n18:45\u00a0<abusenius>\u00a0has joined #xwiki  \n18:52\u00a0<gdelhumeau>\u00a0has quit  \n18:53\u00a0<vmassol>\u00a0fyi I've pushed 3.5M1 and 3.5 in maven central  \n18:55\u00a0<evalica>\u00a0has quit  \n19:08\u00a0<CIA-120>\u00a0tmortagne\u000f master\u000f \\* r25ffc17\u000f https://github.com/xwiki/xwiki-commons/commit/25ffc17544e95461045359c822e617633fc0736d \u000f/ (18 files in 7 dirs):\u000f XCOMMONS-126: Extract multi classloader managemenr from Extension Manager - http://git.io/-zEUmw  \n19:09\u00a0<evalica>\u00a0has joined #xwiki  \n19:09\u00a0<evalica>\u00a0has quit  \n19:10\u00a0<CIA-120>\u00a0tmortagne\u000f master\u000f \\* r3ca0e7b\u000f https://github.com/xwiki/xwiki-platform/commit/3ca0e7bc838c419f6e9295c8c1229a9609a0d22e \u000f/ xwiki-platform-core/xwiki-platform-rendering/xwiki-platform-rendering-macros/xwiki-platform-rendering-macro-script/pom.xml :\u000f XWIKI-7604: Move classloader module to commons - http://git.io/JQi5Wg  \n19:10\u00a0<CIA-120>\u00a0tmortagne\u000f master\u000f \\* rc33bbf5\u000f https://github.com/xwiki/xwiki-platform/commit/c33bbf57ddb6dd1ef69cf25ca7952751a4d0d9dd \u000f/ xwiki-platform-core/xwiki-platform-extension/xwiki-platform-extension-xwiki/src/main/java/org/xwiki/extension/xwiki/internal/JarExtensionExecutionContextInitializer.java :\u000f XCOMMONS-126: Extract multi classloader managemenr from Extension Manager - http://git.io/CqucBw  \n19:10\u00a0<+tmortagne>\u00a0vmassol: cool  \n19:13\u00a0<Enygma`>\u00a0has quit  \n19:27\u00a0<CIA-120>\u00a0tmortagne\u000f master\u000f \\* r3923e26\u000f https://github.com/xwiki/xwiki-platform/commit/3923e2675e78716a70657f678b4457a6e8f4607e \u000f/ (8 files in 8 dirs):\u000f XCOMMONS-126: Extract multi classloader management from Extension Manager - http://git.io/jxHIaA  \n19:28\u00a0<mflorea>\u00a0has quit  \n19:29\u00a0<cjd>\u00a0has joined #xwiki  \n19:29\u00a0<CIA-120>\u00a0tmortagne\u000f master\u000f \\* rf935f06\u000f https://github.com/xwiki/xwiki-enterprise/commit/f935f06825e84f6dde9018146d11d0540ec177b5 \u000f/ xwiki-enterprise-web/pom.xml :\u000f XCOMMONS-126: Extract multi classloader management from Extension ...  \n19:35\u00a0<cjd>\u00a0has quit  \n19:36\u00a0<cjd>\u00a0has joined #xwiki  \n19:42\u00a0<tmortagne>\u00a0has quit  \n19:46\u00a0<cjd>\u00a0has quit  \n19:47\u00a0<cjd>\u00a0has joined #xwiki  \n19:49\u00a0<abusenius>\u00a0has quit  \n19:49\u00a0<abusenius>\u00a0has joined #xwiki  \n19:56\u00a0<vmassol>\u00a0cjd, sdumitriu: I have a strange problem with the hibernate store and maybe you have some idea about it. Let me explain  \n19:56\u00a0<vmassol>\u00a0I have a thread and on it I have created a clean context  \n19:56\u00a0<vmassol>\u00a0on this thread I create a doc if it doesn't exist and save it  \n19:57\u00a0<vmassol>\u00a0now if I delete the doc on the main thread (using XE UI) then the other thread fails to save the doc  \n19:57\u00a0<vmassol>\u00a0with: org.hibernate.StaleStateException: Batch update returned unexpected row count from update [1]; actual row count: 0; expected: 1  \n19:58\u00a0<vmassol>\u00a0I wonder what's not in sync on both threads  \n19:58\u00a0<@cjd>\u00a0delete before save and is it on myisam?  \n19:58\u00a0<vmassol>\u00a0hsqldb  \n19:58\u00a0<vmassol>\u00a0(no mysql)  \n19:59\u00a0<vmassol>\u00a0delete is before save yes  \n19:59\u00a0<@cjd>\u00a0hmm  \n19:59\u00a0<vmassol>\u00a0both operation happen manually so there's no race  \n19:59\u00a0<@cjd>\u00a0sounds like save -> load -> delete -> commit (nothing to commit!)  \n20:00\u00a0<vmassol>\u00a0what I know is that on the thread doing the save it gets the doc from the cache but that's becuase the on the main thread the doc was dleted in the UI and thus an empty doc is put in the cache  \n20:01\u00a0<@cjd>\u00a0but I didn't think the saved document should be available to the other thread because the db hasn't committed it yet so it \"doesn't exist\"  \n20:01\u00a0<vmassol>\u00a0delete commits tot he DB immediztely right?  \n20:01\u00a0<vmassol>\u00a0and on the thread that saves it creates a new hib session when it wants to save  \n20:02\u00a0<@cjd>\u00a0I'd have to check, what's important is whether or not the save commits immedietly.  \n20:02\u00a0<vmassol>\u00a0it looks as if there's some hibernate caching done underneath  \n20:02\u00a0<vmassol>\u00a0and that cache has some threadlocal  \n20:03\u00a0<vmassol>\u00a0when you delete a doc in the UI  \n20:03\u00a0<vmassol>\u00a0it's saved to the DB no?  \n20:03\u00a0<vmassol>\u00a0(again there's no problem of speed, since I have waited more than 30 minutes between both actions in some cases)  \n20:04\u00a0<@cjd>\u00a0ahh so it is indeed no race condition  \n20:04\u00a0<vmassol>\u00a0yep it's not  \n20:05\u00a0<@cjd>\u00a0and if there are transactions which live over 1/2 hour, that is a bug.  \n20:06\u00a0<vmassol>\u00a0well there's an endTransaction in deleteDoc  \n20:06\u00a0<vmassol>\u00a0\\* deleteXWikiDoc  \n20:07\u00a0<vmassol>\u00a0and bTransaction is set to true on the first line in deleteXWikiDoc  \n20:07\u00a0<@cjd>\u00a0indeed, beginTransaction() and endTransaction() don't necessarily do that. If there is a prior open tx, they will continue to use it and will not close it. But I don't think that is the issue here.  \n20:08\u00a0<@cjd>\u00a0bTransaction = bTransaction && beginTransaction(sfactory, context); <-- if there's already an open tx, this will set bTrans to false.  \n20:08\u00a0<vmassol>\u00a0yep just seen that  \n20:08\u00a0<vmassol>\u00a0but I also don't think tht's the problem  \n20:08\u00a0<@cjd>\u00a0agreed  \n20:08\u00a0<vmassol>\u00a0I've also checked that  \n20:08\u00a0<vmassol>\u00a0hibsession and hibtransaction are not set before the save  \n20:08\u00a0<vmassol>\u00a0(in the context)  \n20:10\u00a0<@sdumitriu>\u00a0vmassol: Which version? Might it be the ArchiveCache in XWikiContext?  \n20:10\u00a0<vmassol>\u00a04.0 snapshot from a few minutes ago  \n20:11\u00a0<vmassol>\u00a0archivecache?  \n20:11\u00a0<vmassol>\u00a0what is this?  \n20:11\u00a0<vmassol>\u00a0any pointer so that I can look it up?  \n20:12\u00a0<lucaa>\u00a0has quit  \n20:12\u00a0<@cjd>\u00a0What comes to my mind is \"what happens if you create a document which was never persistent and doesn't exist, then try to delete it\"  \n20:13\u00a0<@sdumitriu>\u00a0http://jira.xwiki.org/browse/XWIKI-7585  \n20:13\u00a0<@sdumitriu>\u00a0And https://github.com/xwiki/xwiki-platform/commit/5f74492  \n20:13\u00a0<vmassol>\u00a0sergiu yes I remember this  \n20:13\u00a0<vmassol>\u00a0but I have an up to date version  \n20:13\u00a0<vmassol>\u00a0let me check the commit  \n20:13\u00a0<@sdumitriu>\u00a0So you're on master  \n20:14\u00a0<@sdumitriu>\u00a0The problem with the batch update is that it doesn't say what entity failed  \n20:14\u00a0<vmassol>\u00a0yep it's hard to track  \n20:14\u00a0<@sdumitriu>\u00a0It's not always the document itself, might be something related  \n20:15\u00a0<@cjd>\u00a0<3 JDO persistence by reachability  \n20:16\u00a0<vmassol>\u00a0sdumitriu: could my bug be caaused by your commit fro XWIKI-7585?  \n20:18\u00a0<@sdumitriu>\u00a0It shouldn't be caused by it, on the contrary  \n20:18\u00a0<@sdumitriu>\u00a0Since it wasn't fixed, then it probably isn't related  \n20:19\u00a0<@sdumitriu>\u00a0Can you try to call flushCache?  \n20:19\u00a0<vmassol>\u00a0yep I'm doign that :)  \n20:19\u00a0<@sdumitriu>\u00a0Before trying to work with the document in the background thread  \n20:19\u00a0<vmassol>\u00a0doing = I'm trying it  \n20:19\u00a0<@sdumitriu>\u00a0Does your document have an xclass in it?  \n20:19\u00a0<vmassol>\u00a0no  \n20:19\u00a0<vmassol>\u00a0it has an xobject though  \n20:30\u00a0<vmassol>\u00a0doesn't help  \n20:30\u00a0<vmassol>\u00a0(the flushcache)  \n20:31\u00a0<vmassol>\u00a0here's what I get: https://gist.github.com/2002888  \n20:31\u00a0<vmassol>\u00a0(as you can see in the script I have added: #set ($discard = $xwiki.getXWiki().flushCache($xcontext.getContext()))  \n20:31\u00a0<vmassol>\u00a0hmm I need to check one thing though  \n20:32\u00a0<vmassol>\u00a0I'm running as superadmin  \n20:32\u00a0<vmassol>\u00a0but I should have PR I think  \n20:32\u00a0<vmassol>\u00a0checking  \n20:33\u00a0<vmassol>\u00a0yes I have PR  \n20:41\u00a0<vmassol>\u00a0if anyone has any idea for debugging this....  \n20:41\u00a0<vmassol>\u00a0(I'm a bit out of ideas)  \n20:45\u00a0<vmassol>\u00a0I also get this one from time to time: https://gist.github.com/2000161  \n20:45\u00a0<vmassol>\u00a0Caused by: org.hibernate.ObjectNotFoundException: No row with the given identifier exists: [com.xpn.xwiki.doc.rcs.XWikiRCSNodeContent#com.xpn.xwiki.doc.rcs.XWikiRCSNodeId@36ed86a[docId=3057829950801507393,version=1.2]]  \n20:46\u00a0<vmassol>\u00a0it's strange that I don't always get the same error. I get those 2 possibilities  \n21:24\u00a0<sdumitriu>\u00a0has quit  \n21:42\u00a0<sdumitriu>\u00a0has joined #xwiki  \n21:59\u00a0<sdumitriu1>\u00a0has joined #xwiki  \n22:01\u00a0<sdumitriu>\u00a0has quit  \n22:09\u00a0<cjd>\u00a0has quit  \n22:09\u00a0<cjd>\u00a0has joined #xwiki  \n22:27\u00a0<jvdrean>\u00a0has quit  \n22:41\u00a0<abusenius>\u00a0has quit  \n23:38\u00a0<vmassol>\u00a0has quit  \n23:39\u00a0<sdumitriu>\u00a0has joined #xwiki  \n23:41\u00a0<sdumitriu1>\u00a0has quit  \n\n"}