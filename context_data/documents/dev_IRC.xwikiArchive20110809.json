{"id": "dev:IRC.xwikiArchive20110809", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20110809", "title": "IRC Archive for channel #xwiki - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n00:02\u00a0<rrodriguez>\u00a0has quit  \n00:02\u00a0<sdumitriu>\u00a0has quit  \n00:04\u00a0<JuanDaugherty>\u00a0http://dev.xwiki.org/xwiki/bin/view/Community/Building also says to use svn  \n00:07\u00a0<finbrein>\u00a0has quit  \n00:11\u00a0<vmassol>\u00a0JuanDaugherty: thanks, we haven't updated all our docs.  \n00:11\u00a0<vmassol>\u00a0fixed for this one  \n00:11\u00a0<vmassol>\u00a0time for bed now, nn  \n00:12\u00a0<rrodriguez>\u00a0has joined #xwiki  \n00:13\u00a0<vmassol>\u00a0has quit  \n00:21\u00a0<sdumitriu>\u00a0has joined #xwiki  \n00:23\u00a0<jvdrean>\u00a0has quit  \n00:23\u00a0<sdumitriu>\u00a0has quit  \n00:25\u00a0<sdumitriu>\u00a0has joined #xwiki  \n01:28\u00a0<rrodriguez>\u00a0has quit  \n01:28\u00a0<sdumitriu>\u00a0has quit  \n01:46\u00a0<sdumitriu>\u00a0has joined #xwiki  \n03:06\u00a0<sburjan\\_>\u00a0has joined #xwiki  \n03:10\u00a0<sburjan`>\u00a0has quit  \n03:10\u00a0<sburjan\\_>\u00a0is now known as <sburjan`>  \n04:23\u00a0<sdumitriu>\u00a0has quit  \n04:24\u00a0<sdumitriu>\u00a0has joined #xwiki  \n05:30\u00a0<DrLou>\u00a0has quit  \n06:04\u00a0<finbrein>\u00a0has joined #xwiki  \n06:04\u00a0<sdumitriu>\u00a0has quit  \n06:06\u00a0<sdumitriu>\u00a0has joined #xwiki  \n06:08\u00a0<finbrein>\u00a0has quit  \n07:26\u00a0<lucaa>\u00a0has quit  \n09:20\u00a0<tmortagne>\u00a0has joined #xwiki  \n09:20\u00a0<sdumitriu>\u00a0has quit  \n09:21\u00a0<sdumitriu>\u00a0has joined #xwiki  \n09:35\u00a0<vmassol>\u00a0has joined #xwiki  \n09:35\u00a0<sdumitriu>\u00a0has quit  \n09:37\u00a0<sdumitriu>\u00a0has joined #xwiki  \n09:55\u00a0<sburjan>\u00a0has joined #xwiki  \n10:00\u00a0<+sburjan>\u00a0vmassol: starting to fix the annotationsTest according to your comments  \n10:00\u00a0<+sburjan>\u00a0(good morning)  \n10:00\u00a0<vmassol>\u00a0sbok  \n10:00\u00a0<vmassol>\u00a0s/sbok/ok/  \n10:00\u00a0<vmassol>\u00a0gm  \n10:01\u00a0<sdumitriu>\u00a0has quit  \n10:02\u00a0<+sburjan>\u00a0can I ask questions ? there are things I don't fully understand  \n10:03\u00a0<sdumitriu>\u00a0has joined #xwiki  \n10:03\u00a0<vmassol>\u00a0yes  \n10:04\u00a0<+sburjan>\u00a0you said in one place that 3 single comment lines should be made javadoc  \n10:04\u00a0<+sburjan>\u00a0so javadoc must be multiple comment lines ?  \n10:05\u00a0<vmassol>\u00a0javadoc is javadoc  \n10:05\u00a0<vmassol>\u00a0google it  \n10:05\u00a0<vmassol>\u00a0all class and method comments must be using the javadoc format  \n10:06\u00a0<+sburjan>\u00a0oh, you meran author, version, etc  \n10:06\u00a0<vmassol>\u00a0no  \n10:06\u00a0<+sburjan>\u00a0\\*mean  \n10:06\u00a0<vmassol>\u00a0we don't have author version for methods  \n10:06\u00a0<vmassol>\u00a0I really mean the javadoc format  \n10:06\u00a0<vmassol>\u00a0please google it and take the first link and read it  \n10:06\u00a0<rrodriguez>\u00a0has joined #xwiki  \n10:06\u00a0<vmassol>\u00a0you'll understand better  \n10:07\u00a0<vmassol>\u00a0sburjan: you should also fully read these:  \n10:07\u00a0<vmassol>\u00a0http://dev.xwiki.org/xwiki/bin/view/Community/DevelopmentPractices  \n10:08\u00a0<vmassol>\u00a0http://dev.xwiki.org/xwiki/bin/view/Community/JavaCodeStyle  \n10:09\u00a0<+tmortagne>\u00a0sburjan: if you are using Eclipse import https://raw.github.com/xwiki/xwiki-commons/master/xwiki-commons-tools/xwiki-commons-tool-validation-resources/src/main/resources/codetemplates-eclipse.xml and then do alt+shift+j on a method or class  \n10:09\u00a0<sdumitriu>\u00a0has quit  \n10:09\u00a0<+tmortagne>\u00a0or alt+ctrl+j I don't remember  \n10:10\u00a0<vmassol>\u00a0on idea it's ctrl+j  \n10:10\u00a0<+tmortagne>\u00a0it's alt+shift+j  \n10:10\u00a0<vmassol>\u00a0(ah no, ctrl+j is to show the javadoc)  \n10:11\u00a0<+tmortagne>\u00a0btw just found wrongly formatted javadoc on com.xpn.xwiki.XWiki  \n10:12\u00a0<evalica>\u00a0has joined #xwiki  \n10:15\u00a0<Enygma`>\u00a0has joined #xwiki  \n10:19\u00a0<+tmortagne>\u00a0vmassol: is XWikiMessageTool really the cleanest thing we can show as example ? :)  \n10:20\u00a0<vmassol>\u00a0where?  \n10:20\u00a0<vmassol>\u00a0(it's not for sure)  \n10:20\u00a0<+tmortagne>\u00a0at the top of the page  \n10:20\u00a0<+tmortagne>\u00a0For examples of \"clean\" classes see the following classes and their unit tests:ZipExplorerPlugin\\*.java (main sources|tests)XWikiMessageTool.java (main sources|tests)  \n10:20\u00a0<vmassol>\u00a0indeed that was a long time ago when I started cleaning things  \n10:20\u00a0<vmassol>\u00a0feel free to update it  \n10:20\u00a0<+tmortagne>\u00a0yea thinking  \n10:24\u00a0<lucaa>\u00a0has joined #xwiki  \n10:27\u00a0<+tmortagne>\u00a0vmassol: DefaultObservationManager seems to be a good candidate  \n10:27\u00a0<vmassol>\u00a0k  \n10:27\u00a0<+tmortagne>\u00a0updating the doc  \n10:27\u00a0<+tmortagne>\u00a0no need to put several  \n10:28\u00a0<lucaa1>\u00a0has joined #xwiki  \n10:30\u00a0<+tmortagne>\u00a0done  \n10:30\u00a0<lucaa>\u00a0has quit  \n10:38\u00a0<+sburjan>\u00a0vmassol: I am trying to add the version field to javadoc  \n10:38\u00a0<+sburjan>\u00a0but I don't know the syntax so the number to be generated automatically  \n10:38\u00a0<+sburjan>\u00a0I wrote: \u00a0\\* @version $Id:$ but I don;t know if it's correct  \n10:40\u00a0<+tmortagne>\u00a0sburjan: do what I indicated you for Eclipse  \n10:40\u00a0<+tmortagne>\u00a0@version tag is automatically added  \n10:40\u00a0<+sburjan>\u00a0thanks  \n10:43\u00a0<vmassol>\u00a0sburjan: just look at the doc we have  \n10:43\u00a0<+sburjan>\u00a0I fixed it  \n10:43\u00a0<vmassol>\u00a0http://dev.xwiki.org/xwiki/bin/view/Community/JavaCodeStyle  \n10:43\u00a0<vmassol>\u00a0again you need to read these docs: http://dev.xwiki.org/xwiki/bin/view/Community/JavaCodeStyle  \n10:43\u00a0<vmassol>\u00a0it's important  \n10:44\u00a0<vmassol>\u00a0all commits must follow them  \n10:46\u00a0<vmassol>\u00a0I'm going to try to fix this flickering test: http://tinycoke.com/\\_6rIPFce29rgbE/screen\\_shot\\_2011-08-09\\_at\\_10.45.32\\_am.png  \n10:46\u00a0<vmassol>\u00a0guys we still need help from committers to fix failing tests  \n10:46\u00a0<vmassol>\u00a0latest failing tests: http://ci.xwiki.org/job/xwiki-enterprise-test-ui/org.xwiki.enterprise$xwiki-enterprise-test-ui/31/testReport/  \n10:46\u00a0<vmassol>\u00a0we need someone to help on fixing the Import tests  \n10:56\u00a0<jvdrean>\u00a0has joined #xwiki  \n11:00\u00a0<lucaa>\u00a0has joined #xwiki  \n11:02\u00a0<lucaa1>\u00a0has quit  \n11:08\u00a0<lucaa>\u00a0has quit  \n11:22\u00a0<lucaa>\u00a0has joined #xwiki  \n11:38\u00a0<silviar>\u00a0has joined #xwiki  \n11:49\u00a0<rrodriguez>\u00a0has quit  \n11:59\u00a0<silviar>\u00a0has quit  \n12:09\u00a0<vmassol>\u00a0guys I have a hard time fixing the flickering for https://github.com/xwiki/xwiki-enterprise/blob/aaecb9414b3cdd15f00332086505e30788016f57/xwiki-enterprise-test/xwiki-enterprise-test-ui/src/test/it/org/xwiki/test/ui/AttachmentTest.java  \n12:09\u00a0<vmassol>\u00a0the issue is that sometimes  \n12:10\u00a0<vmassol>\u00a0at line 71  \n12:10\u00a0<vmassol>\u00a0(ie when the user clicks on the attachment to display its content)  \n12:10\u00a0<vmassol>\u00a0the returned result on screen is empty  \n12:10\u00a0<vmassol>\u00a0so the click works fine  \n12:10\u00a0<vmassol>\u00a0but the attachment content displayed is just empty  \n12:10\u00a0<vmassol>\u00a0more precisely it contains:  \n12:10\u00a0<vmassol>\u00a0<html xmlns=\"http://www.w3.org/1999/xhtml\"><head></head><body><pre></pre></body></html>  \n12:10\u00a0<vmassol>\u00a0instead of  \n12:11\u00a0<vmassol>\u00a0<html xmlns=\"http://www.w3.org/1999/xhtml\"><head></head><body><pre>This is a small attachment.</pre></body></html>  \n12:11\u00a0<vmassol>\u00a0I have no clue what can lead to this  \n12:11\u00a0<vmassol>\u00a0any idea?  \n12:29\u00a0<vmassol>\u00a0tmortagne: no thanks for your last commit! http://tinycoke.com/\\_6rp2A7KrO8DDQ/screen\\_shot\\_2011-08-09\\_at\\_12.20.32\\_pm.png ;)  \n12:30\u00a0<vmassol>\u00a0(I had 5 screenful of commits like this to click)  \n12:33\u00a0<+tmortagne>\u00a0vmassol: that's the issue with big merges  \n12:35\u00a0<vmassol>\u00a0so nobody to help out with the flickering test\u2026.?  \n12:37\u00a0<+sburjan>\u00a0vmassol: I am at the final stage, try fixing the issue when deleting an annotation the modal appears in top left corner  \n12:38\u00a0<+sburjan>\u00a0this might take some time  \n12:38\u00a0<vmassol>\u00a0ok  \n12:38\u00a0<vmassol>\u00a0tmortagne: btw agent1 seems to not execute tests: http://ci.xwiki.org/  \n12:39\u00a0<vmassol>\u00a0(as you wanted)  \n12:39\u00a0<silviar>\u00a0has joined #xwiki  \n12:39\u00a0<vmassol>\u00a0yuck 7 test failures more in last run : http://ci.xwiki.org/job/xwiki-enterprise-test-ui/org.xwiki.enterprise$xwiki-enterprise-test-ui/32/testReport/  \n12:39\u00a0<vmassol>\u00a0cjdelisle: invitation tests failures  \n12:39\u00a0<vmassol>\u00a0could you have a look cjdelisle?  \n12:44\u00a0<+sburjan>\u00a0vmassol: fixed it, but you won't like it. But I can't find another way. I will commit now  \n12:52\u00a0<DrLou>\u00a0has joined #xwiki  \n12:57\u00a0<vmassol>\u00a0one more flickering test: http://ci.xwiki.org/job/xwiki-enterprise-test-wysiwyg/org.xwiki.enterprise$xwiki-enterprise-test-wysiwyg/30/testReport/  \n13:03\u00a0<pulasthi>\u00a0has joined #xwiki  \n13:04\u00a0<pulasthi>\u00a0cjdelisle: hi  \n13:05\u00a0<@cjdelisle>\u00a0howdy  \n13:06\u00a0<pulasthi>\u00a0i tried to build the new xwiki-store-DN bu keep getting an error  \n13:06\u00a0<pulasthi>\u00a0http://paste.ubuntu.com/661839/  \n13:06\u00a0<@cjdelisle>\u00a0oops sorry :)  \n13:06\u00a0<pulasthi>\u00a0there still not in the repo right?  \n13:07\u00a0<@cjdelisle>\u00a0I added a bunch more code to -store but I didn't think it was safe to commit yet so it's sitting locally on a branch  \n13:07\u00a0<pulasthi>\u00a0so how can i get them?  \n13:07\u00a0<@cjdelisle>\u00a0I will push the branch to the main repo and you will have to checkout the xwiki-platform, switch to the branch, and build xwiki-platform-store first.  \n13:09\u00a0<vmassol>\u00a0tmortagne: again....  \n13:10\u00a0<+tmortagne>\u00a0vmassol: yea now its the other way  \n13:10\u00a0<pulasthi>\u00a0i have a checkout of xwiki-platform so just have to do a pull right?  \n13:10\u00a0<+tmortagne>\u00a0i'm done now, I promise  \n13:32\u00a0<cjdelisle>\u00a0has quit  \n13:35\u00a0<+sburjan>\u00a0vmassol: I committed. you can review the code now  \n14:10\u00a0<pulasthi>\u00a0has quit  \n14:11\u00a0<lucaa>\u00a0has quit  \n14:18\u00a0<lucaa>\u00a0has joined #xwiki  \n14:21\u00a0<Lycurgus>\u00a0has joined #xwiki  \n14:52\u00a0<pulasthi>\u00a0has joined #xwiki  \n14:52\u00a0<pulasthi>\u00a0has quit  \n15:13\u00a0<qwebirc14467>\u00a0has joined #xwiki  \n15:14\u00a0<qwebirc14467>\u00a0Hey guys, got a question for you. \u00a0What is the difference between the templates defined through dataclasses, and the files in webapps\\xwiki\\templates ?  \n15:25\u00a0<+tmortagne>\u00a0qwebirc14467: it's two totally different things actually, the first one is a document \"example\" and the other is basically a UI/action related script  \n15:32\u00a0<abusenius>\u00a0has joined #xwiki  \n15:41\u00a0<qwebirc14467>\u00a0tmortagne: okay, so for example the xwiki.Registration form, \u00a0that uses an script right? So there is no defined dataclass/document template right?  \n15:42\u00a0<+tmortagne>\u00a0qwebirc14467: I don't know very well \u00a0xwiki.Registration form  \n15:43\u00a0<qwebirc14467>\u00a0Im trying to create a form, and i was pointed to that example, but Im having a hard time grasping the whole thing. It seems like the registration form has fields that are created in it, almost replacing the way the are created through a dataclass?  \n15:44\u00a0<+tmortagne>\u00a0if the idea is to replace the registration form by something else it's probably in a wiki page yes  \n15:59\u00a0<cjdelisle>\u00a0has joined #xwiki  \n16:05\u00a0<pulasthi>\u00a0has joined #xwiki  \n16:05\u00a0<pulasthi>\u00a0has quit  \n16:06\u00a0<pulasthi>\u00a0has joined #xwiki  \n16:10\u00a0<jvelociter>\u00a0has joined #xwiki  \n16:25\u00a0<pulasthi>\u00a0cjdelisle: hi did you push the changes  \n16:25\u00a0<pulasthi>\u00a0:)  \n16:27\u00a0<@cjdelisle>\u00a0I did not I was busy, I will get right in that.  \n16:27\u00a0<pulasthi>\u00a0ok no problem :)  \n16:31\u00a0<+jvelociter>\u00a0Hi guys  \n16:31\u00a0<+jvelociter>\u00a0git question..  \n16:32\u00a0<+jvelociter>\u00a0I'm trying to add track an upstream branch on a clone of a fork  \n16:32\u00a0<+jvelociter>\u00a0but fail :)  \n16:32\u00a0<+jvelociter>\u00a0I'm trying this  \n16:32\u00a0<+tmortagne>\u00a0cjdelisle: qwebirc14467 had a registration form extensibility question earlier if you have some time  \n16:32\u00a0<+tmortagne>\u00a0qwebirc14467: still here ?  \n16:33\u00a0<+jvelociter>\u00a0git branch --set-upstream branch-solely-on-fork upstream/stable-3.0.x  \n16:33\u00a0<+jvelociter>\u00a0it fails with fatal: Not a valid object name: 'upstream/stable-3.0.x'.  \n16:33\u00a0<vmassol>\u00a0jvelociter: sorry but I haven't reach level 99 of git proficiency yet  \n16:33\u00a0<+jvelociter>\u00a0my .git/config is http://pastebin.com/cxfALnfM  \n16:34\u00a0<+jvelociter>\u00a0(I want to track stable-3.0.x-cloudbees-openid to upstream/stable-3.0.x)  \n16:35\u00a0<+jvelociter>\u00a0vmassol: yeah I think that's a lifetime quest :)  \n16:36\u00a0<@cjdelisle>\u00a0qwebirc14467: Yup, I'm here if you have any registration form questions.  \n16:36\u00a0<vmassol>\u00a0I need someone to take over as build manager starting tomorrow  \n16:36\u00a0<vmassol>\u00a0(I'm on holidays starting tomorrow till end of week)  \n16:36\u00a0<vmassol>\u00a0better volunteer or I'll designate someone!  \n16:36\u00a0<vmassol>\u00a0and the price is 2 weeks of BM if you don't volunteer!  \n16:37\u00a0<vmassol>\u00a0cjdelisle: been a while since you did it I think\u2026 wdyt?  \n16:38\u00a0<+tmortagne>\u00a0I can only starting with August 22, before I'm in holidays most of the time  \n16:38\u00a0<@cjdelisle>\u00a0If you like I will fight with it.  \n16:38\u00a0<+jvelociter>\u00a0cjdelisle: any insights on my git question ?  \n16:39\u00a0<@cjdelisle>\u00a0nop  \n16:39\u00a0<+jvelociter>\u00a0ok  \n16:40\u00a0<vmassol>\u00a0cjdelisle: you're volunteering? \u00a0cool  \n16:40\u00a0<vmassol>\u00a0you're lucky it's a small week  \n16:40\u00a0<vmassol>\u00a0I already did 2 days  \n16:43\u00a0<+sburjan>\u00a0vmassol: my commit is on github, when you have time you can take a look at it  \n16:43\u00a0<vmassol>\u00a0sburjan: yep thanks, I'm debugging a test  \n16:44\u00a0<vmassol>\u00a0been doing it for the past 8 hours already\u2026  \n16:44\u00a0<vmassol>\u00a0and still not much progress  \n16:44\u00a0<+sburjan>\u00a0there are 4 commits in one.. so you should take a look at it from local  \n16:44\u00a0<+tmortagne>\u00a0but in this case it's a real bug ;)  \n16:47\u00a0<+abusenius>\u00a0jvelociter: can you try to set the url of upstream to [[email\u00a0protected]](https://dev.xwiki.org/cdn-cgi/l/email-protection):xwiki/xwiki-enterprise.git (note the : instead of slash), run \"git remote update\" and try again?  \n16:48\u00a0<+abusenius>\u00a0(not sure it helps, but the url is definitely wrong)  \n16:49\u00a0<+abusenius>\u00a0ah, its read only url  \n16:49\u00a0<+abusenius>\u00a0then its strange  \n16:49\u00a0<pulasthi>\u00a0has left #xwiki  \n16:52\u00a0<+jvelociter>\u00a0alex: trying with the r/w address  \n16:52\u00a0<qwebirc14467>\u00a0cjdelisle: \u00a0Hey, sorry I got sidetracked. \u00a0I do have more questions on the Registration Form if you have a second. \u00a0The fields that are created in the form, are those just like creating dataclasses or are they defined some where else already?? What if you wanted to use a defined class, but incorporate the validation, would that be possible? Does that make sense?  \n16:52\u00a0<+abusenius>\u00a0jvelociter: it might want to redownload the whole repository, better backup  \n16:52\u00a0<+abusenius>\u00a0s/repository/history/  \n16:53\u00a0<@cjdelisle>\u00a0qwebirc14467: They are defined in the code/content of the registration page itself  \n16:53\u00a0<silviar>\u00a0has quit  \n16:54\u00a0<@cjdelisle>\u00a0edit XWiki.Registration in wiki edit mode and you will find the configuration at the top  \n16:54\u00a0<@cjdelisle>\u00a0there's a huge comment explaining how the configuration works.  \n16:54\u00a0<+abusenius>\u00a0general question: is there a nice/commonly used way or API to show a confirmation message when an AJAX request fails?  \n16:55\u00a0<+jvelociter>\u00a0abusenius: ok, I succeeded with the help of thomas  \n16:55\u00a0<qwebirc14467>\u00a0okay, thats what i though. Right I see that. I was just curious if you could just reference existing classes and use their definitions  \n16:55\u00a0<+abusenius>\u00a0related to XWIKI-6784  \n16:55\u00a0<+jvelociter>\u00a0I did not fetch before doing the -set-upstream  \n16:56\u00a0<+abusenius>\u00a0I need to pass the resubmission url to ajax, and then show this page to user  \n16:56\u00a0<@cjdelisle>\u00a0qwebirc14467: It is possible and I began work on it but stopped because it couldn't express the entire power of the registration forum without nested objects.  \n16:57\u00a0<+abusenius>\u00a0I can invent something to pass the url with json and redirect to that url from java script, but maybe there is a better way?  \n17:01\u00a0<qwebirc14467>\u00a0cjdelisle: Well im actually trying to just use that Registration as a guide and create a different type of form. that just simply creates a new page with whatever data was added into the form. Would that be possible to do with a defined class?  \n17:02\u00a0<@cjdelisle>\u00a0It would but you would need to write a converer which read the objects from the page and converted them into the velocity construct which the Registration form eats.  \n17:03\u00a0<@cjdelisle>\u00a0I was planning on doing that but I found the lack of nested objects too limiting.  \n17:07\u00a0<qwebirc14467>\u00a0okay...trying to process what you said, not sure I can handle that. lol.  \n17:08\u00a0<@cjdelisle>\u00a0If you want to take a look at the XWiki.Registration page and ask any questions about it, that might give you a handle on how it works.  \n17:17\u00a0<qwebirc14467>\u00a0Will do. \u00a0One more really quick, does a form exist already that just adds the data to the specified page? That might be easier to look at than everything needed to register a user  \n17:18\u00a0<lucaa>\u00a0has quit  \n17:20\u00a0<@cjdelisle>\u00a0I recommend you use the registration form for that type of thing and change what you do with the submitted data, there is another way but it relies on very old code and you will find odd bugs which it will be hard for me to help with.  \n17:22\u00a0<qwebirc14467>\u00a0yes i tried that method first and didnt get very far. Okay Ill mess around some more and probably will be bothering you again sometime soon. Thank you!  \n17:23\u00a0<sburjan>\u00a0has quit  \n17:30\u00a0<@cjdelisle>\u00a0sure thing, any tome  \n17:30\u00a0<@cjdelisle>\u00a0\\*time  \n18:55\u00a0<qwebirc14467>\u00a0cjdelisle: Still there? \u00a0Using the fields, such as in Registration Form, how would you have a database query as a parameter for one of the fields, and show as a drop down or something?  \n18:56\u00a0<@cjdelisle>\u00a0heh now that I just recommended you use that, there is something for doing exactly that in the older system  \n18:57\u00a0<@cjdelisle>\u00a0It's called DBListProperty  \n18:59\u00a0<qwebirc14467>\u00a0okay right, i have played with that. Okay but there isnt a spot for that using the new way?  \n19:00\u00a0<@cjdelisle>\u00a0I don't think the form builder for registration supports drop down menus.  \n19:01\u00a0<qwebirc14467>\u00a0okay forgive me, what counts as the form builder?  \n19:01\u00a0<@cjdelisle>\u00a0by that I mean the code which builds the forms for the registration page, it's a series of velocity macros.  \n19:02\u00a0<qwebirc14467>\u00a0the code in that page, or referencing somewhere else?  \n19:03\u00a0<@cjdelisle>\u00a0I have to look, it used to be but I think it might have been moved.  \n19:04\u00a0<jvdrean>\u00a0has quit  \n19:06\u00a0<tmortagne>\u00a0has quit  \n19:07\u00a0<@cjdelisle>\u00a0it's all still in XWiki.Registration  \n19:09\u00a0<vmassol>\u00a0cjdelisle: wow deleting a document is very unperformant\u2026. it starts by copying the doc to the recycle bin and this involves loading all attachments from the DB, then to delete to doc all attachments are again loaded from the DB  \n19:10\u00a0<vmassol>\u00a0(s/attachment/attachment content/)  \n19:10\u00a0<qwebirc14467>\u00a0Okay got it. Thanks for checking.  \n19:11\u00a0<@cjdelisle>\u00a0It doesn't make a lot of sense that they would be loaded twice to delete them.  \n19:12\u00a0<vmassol>\u00a0yep my thought too  \n19:13\u00a0<@cjdelisle>\u00a0I was looking at the attachment test which I wrote so horribly, I don't see how you are getting around waiting for the attachment apne to load  \n19:13\u00a0<vmassol>\u00a0the horrible part was the if for the attachment order  \n19:14\u00a0<vmassol>\u00a0re attachment pane we're waiting for it to load already but there' a flicker there too which I'll fix after  \n19:14\u00a0<vmassol>\u00a0right now I'm after a more tricky issue  \n19:14\u00a0<vmassol>\u00a0just spent 10 hours on it so far  \n19:14\u00a0<vmassol>\u00a0and nowhere finished\u2026. :(  \n19:14\u00a0<@cjdelisle>\u00a0Sorry about that. It was an evolution.  \n19:15\u00a0<vmassol>\u00a0the issue is that sometimes FileItem 's input stream returns an empty stream  \n19:15\u00a0<@cjdelisle>\u00a0an if statement was not in my grand plan ;)  \n19:17\u00a0<@cjdelisle>\u00a0Oh if you need PR in a pane and you can't wait, parseGroovyFromPage is still there.  \n19:17\u00a0<vmassol>\u00a0ok thanks\u2026.  \n19:18\u00a0<vmassol>\u00a0hope you don't consider this a real solution though ;)  \n19:19\u00a0<@cjdelisle>\u00a0What is your ultimate solution to handing out PR when authorized?  \n19:19\u00a0<@cjdelisle>\u00a0How would you like it to work?  \n19:20\u00a0<vmassol>\u00a0sorry but I'd like to finish hunting down that bug first  \n19:20\u00a0<vmassol>\u00a0it's been eluding me for 10 hours  \n19:20\u00a0<vmassol>\u00a0and I need to find it!  \n19:20\u00a0<@cjdelisle>\u00a0heh  \n19:24\u00a0<sdumitriu>\u00a0has joined #xwiki  \n19:26\u00a0<vmassol>\u00a0cjdelisle: since you now the attachment code can I ask you something?  \n19:26\u00a0<vmassol>\u00a0s/now/know/  \n19:26\u00a0<@cjdelisle>\u00a0you can ask, I'll try to remember ;)  \n19:26\u00a0<vmassol>\u00a0I see something strange  \n19:26\u00a0<vmassol>\u00a0in XWikiAttachment.toXML() for ex  \n19:27\u00a0<vmassol>\u00a0it does:  \n19:27\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0wr.writeBase64(el, getAttachment\\_content().getContentInputStream());  \n19:27\u00a0<vmassol>\u00a0what's worrying me is what happens if  \n19:27\u00a0<vmassol>\u00a0toXML is called twice in a row for ex  \n19:27\u00a0<vmassol>\u00a0the input stream will be empty the second time  \n19:27\u00a0<@cjdelisle>\u00a0checking...  \n19:27\u00a0<vmassol>\u00a0since it would have been read the first time  \n19:29\u00a0<vmassol>\u00a0hmm actually it'll work  \n19:29\u00a0<vmassol>\u00a0since DiskFileItem.getInputStream returns a new stream every time  \n19:29\u00a0<vmassol>\u00a0so forget that  \n19:29\u00a0<@cjdelisle>\u00a0return new AutoCloseInputStream(this.file.getInputStream()); <-- that should always start at the beginning.  \n19:30\u00a0<vmassol>\u00a0yes  \n19:30\u00a0<@cjdelisle>\u00a0When I wrote that, I cheated and looked carefully at the source code to FileItem to make sure everything was going to work.  \n19:31\u00a0<vmassol>\u00a0btw you wrote something that doesn't look completely right:  \n19:31\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0final DiskFileItem dfi = new DiskFileItem(null, null, false, null, 10000, new File(tempFileLocation));  \n19:31\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0// This causes the temp file to be created.  \n19:31\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0dfi.getOutputStream();  \n19:32\u00a0<vmassol>\u00a0the last line doesn't create the temp file  \n19:32\u00a0<vmassol>\u00a0actually I know what you meant  \n19:33\u00a0<vmassol>\u00a0it's not the file on the filesystem that is created  \n19:33\u00a0<vmassol>\u00a0but the File object in memory  \n19:33\u00a0<vmassol>\u00a0you cheated a bit  \n19:33\u00a0<vmassol>\u00a0so that getStoreLocation() wouldn't return null  \n19:33\u00a0<vmassol>\u00a0the comment is misleading  \n19:34\u00a0<@cjdelisle>\u00a0I'm pretty sure I thought I was creating a file, look at that carefully because that might be my bug.  \n19:36\u00a0<@cjdelisle>\u00a0ahh never mind, there is no file until after 10kb have been written so it is a bad comment afterall.  \n19:36\u00a0<vmassol>\u00a0yes  \n19:36\u00a0<vmassol>\u00a0but  \n19:36\u00a0<vmassol>\u00a0you need the File object created for getStoreLocation to not return null  \n19:41\u00a0<vmassol>\u00a0hmmm  \n19:42\u00a0<vmassol>\u00a0so we actually load the content of the attachments when we attach them to a document  \n19:42\u00a0<vmassol>\u00a0I thought we were loading the attachment content only when we needed it  \n19:42\u00a0<@cjdelisle>\u00a0where are you looking?  \n19:42\u00a0<vmassol>\u00a0saveDocument  \n19:43\u00a0<vmassol>\u00a0called by upload action  \n19:43\u00a0<vmassol>\u00a0hmm that's normal  \n19:44\u00a0<@cjdelisle>\u00a0where does saveDocument load the content of attachments?  \n19:44\u00a0<vmassol>\u00a0calls saveAttahcmentList  \n19:44\u00a0<vmassol>\u00a0which calls saveAttachment  \n19:44\u00a0<vmassol>\u00a0but there's a flag there:  \n19:45\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0if (attachment.isContentDirty()) {  \n19:45\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0attachment.updateContentArchive(context);  \n19:45\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0}  \n19:46\u00a0<@cjdelisle>\u00a0Yes, the new attachment is IIRC uploaded into a file item, then it's pulled from the file item and pushed to the DB.  \n19:46\u00a0<@cjdelisle>\u00a0ahh no sneakier  \n19:47\u00a0<@cjdelisle>\u00a0Uploaded to a Fileitem, streamed to another FileItem (because /me is too lazy to replace the fileupload plugin) then streamed to the DB.  \n19:51\u00a0<@cjdelisle>\u00a0Has the infra team said anything about changing the /etc/hosts file on agent3 so that we don't need the -DpreferIPv4Stack in the pom.xml?  \n19:51\u00a0<vmassol>\u00a0I don't think we asked anything have we?  \n19:52\u00a0<@cjdelisle>\u00a0Oh, I thought it had been. I don't think that is right to not have any ip6 entries in the hosts file.  \n19:53\u00a0<@cjdelisle>\u00a0And that preferIPv4Stack should not be needed.  \n19:53\u00a0<vmassol>\u00a0I think you should send a mail on the infra list  \n19:53\u00a0<vmassol>\u00a0we need to start using it as our comm channel between infra and community  \n19:54\u00a0<@cjdelisle>\u00a0sure thing  \n19:55\u00a0<@cjdelisle>\u00a0Actually I assumed when they asked if it had been modified that they were going to add them back.  \n19:55\u00a0<vmassol>\u00a0they asked for another reason  \n19:55\u00a0<vmassol>\u00a0there was a strange and invalid entry in the hosts file  \n19:56\u00a0<@cjdelisle>\u00a0did they tell you what it was?  \n19:56\u00a0<vmassol>\u00a0yes  \n19:56\u00a0<vmassol>\u00a0their question was:  \n19:57\u00a0<vmassol>\u00a0\"  \n19:57\u00a0<vmassol>\u00a0do you know if someone modified /etc/hosts on node3?  \n19:57\u00a0<vmassol>\u00a0178.32.188.4 node3.ovh.net \u00a0node3 localhost localhost.localdomain  \n19:57\u00a0<vmassol>\u00a0\"  \n19:57\u00a0<vmassol>\u00a0I guess alex fixed it  \n19:58\u00a0<@cjdelisle>\u00a0I have been checking it (to see if they added back the ip6 stuff) and it still looks like that.  \n19:58\u00a0<vmassol>\u00a0ok  \n19:58\u00a0<@cjdelisle>\u00a0mm localhost should be 127.0.0.1  \n19:59\u00a0<vmassol>\u00a0ok going to stop debugging for now\u2026 I hit something that doesn't make sense....  \n19:59\u00a0<vmassol>\u00a0and I can't figure out why  \n19:59\u00a0<@cjdelisle>\u00a0the fact that sometimes the inputstream is empty?  \n20:00\u00a0<vmassol>\u00a0I get some SOP log I put on the console  \n20:00\u00a0<vmassol>\u00a0but the debugger didn't stop on the breakpoint I had set before it's printed  \n20:00\u00a0<@cjdelisle>\u00a0ahh  \n20:00\u00a0<@cjdelisle>\u00a0I won't be much help with that one  \n20:00\u00a0<vmassol>\u00a0eah  \n20:00\u00a0<vmassol>\u00a0yeah  \n20:01\u00a0<vmassol>\u00a0I'd love to get some help though  \n20:01\u00a0<vmassol>\u00a0it's very easy to reproduce the issue  \n20:01\u00a0<vmassol>\u00a0and since I'm off starting tomorrow  \n20:01\u00a0<vmassol>\u00a0maybe I can help how to reproduce to you?  \n20:01\u00a0<vmassol>\u00a0s/help/show/  \n20:02\u00a0<vmassol>\u00a0here are the steps:  \n20:02\u00a0<vmassol>\u00a01) add an @Intermittent annotatiob:  \n20:02\u00a0<@cjdelisle>\u00a0yes if you can give me info about it I will definitely look.  \n20:02\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0@Intermittent  \n20:02\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0public void testUploadDownloadTwoAttachments() throws Exception  \n20:02\u00a0<vmassol>\u00a0then run that test  \n20:02\u00a0<vmassol>\u00a0it'll run 100 times  \n20:03\u00a0<vmassol>\u00a0out of those 100 times you'll find it working most of the time  \n20:03\u00a0<vmassol>\u00a0but you'll also find 2 cases where it breaks  \n20:03\u00a0<@cjdelisle>\u00a0so it only happens with 2 attachments  \n20:03\u00a0<vmassol>\u00a0case 1: sometimes the click on the attachment tab fails. I haven't looked into this one but it's easy enough to fix  \n20:04\u00a0<vmassol>\u00a0case 2 (the interesting one I've tried to track): one of the asserts will fail:  \n20:04\u00a0<vmassol>\u00a0Assert.assertEquals(\"This is a small attachment.\", getDriver().findElement(By.tagName(\"html\")).getText());  \n20:04\u00a0<vmassol>\u00a0or  \n20:04\u00a0<vmassol>\u00a0Assert.assertEquals(\"This is another small attachment.\", getDriver().findElement(By.tagName(\"html\")).getText());  \n20:04\u00a0<vmassol>\u00a0the found text will be empty  \n20:05\u00a0<@cjdelisle>\u00a0I would approach that by doing a storage test which did the same thing at a lower level.  \n20:05\u00a0<vmassol>\u00a0if you check DownloadAction.renderContent()  \n20:05\u00a0<vmassol>\u00a0it does:  \n20:05\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0response.setContentLength(attachment.getContentSize(context));  \n20:05\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0stream = attachment.getContentInputStream(context);  \n20:05\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0IOUtils.copy(stream, response.getOutputStream());  \n20:05\u00a0<vmassol>\u00a0when it fails, \"stream\" is a stream with no content inside (0 bytes)  \n20:06\u00a0<vmassol>\u00a0so the returned output to the test is an empty page  \n20:06\u00a0<@cjdelisle>\u00a0ahh so you added a breakpoint?  \n20:06\u00a0<vmassol>\u00a0(without any content)  \n20:06\u00a0<vmassol>\u00a0I added lots of breakpoints everywhere  \n20:06\u00a0<vmassol>\u00a0the question is in finding why stream can have an empty content from time to time  \n20:07\u00a0<vmassol>\u00a0note that I've disabled the lucene thread when doing my tests  \n20:07\u00a0<vmassol>\u00a0so that I could exclude a threading issue  \n20:07\u00a0<vmassol>\u00a0what's fun is:  \n20:07\u00a0<@cjdelisle>\u00a0I wonder if it's in the upload or the download end  \n20:07\u00a0<vmassol>\u00a0if you put a breakpoint on IOUtils.copy(stream, response.getOutputStream());  \n20:08\u00a0<vmassol>\u00a0(ie just before it executes)  \n20:08\u00a0<vmassol>\u00a0you can then check that the stream has a 0 bytes content  \n20:08\u00a0<vmassol>\u00a0BUT  \n20:08\u00a0<vmassol>\u00a0if you access attachment.getContentInputStream in your debugger  \n20:08\u00a0<vmassol>\u00a0it'll correctly report a valid stream with 28 or 34 bytes  \n20:08\u00a0<@cjdelisle>\u00a0ahh  \n20:08\u00a0<@cjdelisle>\u00a0so it is in the downloader  \n20:08\u00a0<vmassol>\u00a0(depending whether it fails on the attachment 1 or 2)  \n20:09\u00a0<@cjdelisle>\u00a0it's uploading okay but sometimes it fails to download.  \n20:09\u00a0<vmassol>\u00a0I tried to go further but couldn't reach any conclusive thing  \n20:09\u00a0<@cjdelisle>\u00a0ok and there's no telling whether it will be the first or second attachment where it happens...  \n20:10\u00a0<vmassol>\u00a0it can fail on either  \n20:11\u00a0<@cjdelisle>\u00a0sounds like something that could be patched in to the core code with a unit test that uses a long loop  \n20:11\u00a0<vmassol>\u00a0I don't think we should have automated tests that are not 100% sure and that run all the time  \n20:12\u00a0<vmassol>\u00a0the best thing here  \n20:12\u00a0<vmassol>\u00a0is find the problem and write a unit tests for it  \n20:12\u00a0<vmassol>\u00a0but for your debugging purpose you could of course write a big loop  \n20:12\u00a0<@cjdelisle>\u00a0yea I'm just talking about a way to inject a test into the core and run it, I'd remove the loop after we knew what it was.  \n20:13\u00a0<vmassol>\u00a0ok  \n20:13\u00a0<vmassol>\u00a0that said  \n20:13\u00a0<vmassol>\u00a0the issue is very easy to reproduce with the steps I've listed  \n20:14\u00a0<vmassol>\u00a0the ui tests part doesn't add too much overhead  \n20:14\u00a0<@cjdelisle>\u00a0yup, I tend to start isolating the piece of code that's breaking  \n20:14\u00a0<vmassol>\u00a0got to go, I'm sorry to dump that on you cjdelisle....  \n20:14\u00a0<@cjdelisle>\u00a0no problem  \n20:14\u00a0<sdumitriu>\u00a0has quit  \n20:15\u00a0<@cjdelisle>\u00a0I've been pretty lazy this summer, need to get back in to it.  \n20:15\u00a0<vmassol>\u00a0:)  \n20:15\u00a0<vmassol>\u00a0has quit  \n20:34\u00a0<sdumitriu>\u00a0has joined #xwiki  \n20:55\u00a0<mbryant>\u00a0has joined #xwiki  \n20:56\u00a0<mbryant>\u00a0Hey guys quick question for you guys. \u00a0I am trying to build a status page of some processing pragmatically in java, what on a highlevel would be the proper, component calls or flow to the xwiki api to build and publish a page  \n20:59\u00a0<@cjdelisle>\u00a0is your process going to be in the same vm as xwiki?  \n20:59\u00a0<sdumitriu>\u00a0has quit  \n21:00\u00a0<abusenius>\u00a0has quit  \n21:11\u00a0<qwebirc14467>\u00a0has quit  \n21:18\u00a0<sdumitriu>\u00a0has joined #xwiki  \n21:27\u00a0<mbryant>\u00a0@cjdelisle yes, I am  \n21:32\u00a0<jvdrean>\u00a0has joined #xwiki  \n21:32\u00a0<sdumitriu>\u00a0has quit  \n21:32\u00a0<mbryant>\u00a0has quit  \n21:34\u00a0<sdumitriu>\u00a0has joined #xwiki  \n21:57\u00a0<evalica>\u00a0has quit  \n22:07\u00a0<lucaa>\u00a0has joined #xwiki  \n23:51\u00a0<jvelociter>\u00a0has quit  \n\n"}