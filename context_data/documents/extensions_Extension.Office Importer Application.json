{"id": "extensions:Extension.Office Importer Application", "url": "https://www.xwiki.org/xwiki/bin/view/Documentation/UserGuide/Features/OfficeImporter", "title": "Office Importer Application", "collection": "Eval", "mimetype": "text/markdown", "language": "en", "content": "\n\n\n| x-office-document.png | **Import Office documents, spreadsheets and presentations into wiki pages (most major office suite formats are supported)** |\n| --- | --- |\n\n\n\n| Type | XAR |\n| --- | --- |\n| Category |  |\n| Developed by | [XWiki Development Team](https://xwiki.org/xwiki/bin/view/XWiki/XWikiTeam) |\n| Rating | *  * [1](https://www.xwiki.org/xwiki/bin/view/Documentation/UserGuide/Features/OfficeImporter \"Poor\") * [2](https://www.xwiki.org/xwiki/bin/view/Documentation/UserGuide/Features/OfficeImporter \"Satisfactory\") * [3](https://www.xwiki.org/xwiki/bin/view/Documentation/UserGuide/Features/OfficeImporter \"Good\") * [4](https://www.xwiki.org/xwiki/bin/view/Documentation/UserGuide/Features/OfficeImporter \"Very good\") * [5](https://www.xwiki.org/xwiki/bin/view/Documentation/UserGuide/Features/OfficeImporter \"Excellent\")    3\u00a0Votes |\n| License | GNU Lesser General Public License 2.1 |\n\n\n\n| Bundled With | XWiki Standard |\n| --- | --- |\n| Compatibility | * XWiki 1.8.4+ * OpenOffice 3.0 or above * XWiki [1.8.4 - 10.11] with LibreOffice [3.6 - 6.0] * XWiki 10.11+ with LibreOffice 3.6+ * The Office Importer requires a back-end Open Office or Libre Office server for its operations. * The Office Importer supports Office 2007 file formats only starting with XWiki version 2.2 Milestone 1. * The Office Importer used with Libre Office below 6.2 might led to timeouts when a [TOC Macro](https://www.xwiki.org/xwiki/bin/view/Extension/TOC%20Macro) is used (see [XWIKI-16129](http://jira.xwiki.org/browse/XWIKI-16129)). * The Office Importer below 10.11.8 with Libre Office 6.1+ won't embed the pictures when exporting the documents (see also [XWIKI-16503](https://jira.xwiki.org/browse/XWIKI-16503)). |\n\n**Installable with the Extension Manager**\n\n[Download v8.3](https://www.xwiki.org/xwiki/rest/repository/extensions/org.xwiki.platform%3Axwiki-platform-office-ui/versions/8.3/file?rid=maven-xwiki)[Sources](https://github.com/xwiki/xwiki-platform/tree/master/xwiki-platform-core/xwiki-platform-office/xwiki-platform-office-ui/)[Issues](http://jira.xwiki.org/jira/browse/XWIKI)\n\nTable of contents\n\n* [Description](https://www.xwiki.org/xwiki/bin/view/Documentation/UserGuide/Features/OfficeImporter#HDescription)\n\t+ [How to use](https://www.xwiki.org/xwiki/bin/view/Documentation/UserGuide/Features/OfficeImporter#HHowtouse)\n\t\t- [Create Page from Office](https://www.xwiki.org/xwiki/bin/view/Documentation/UserGuide/Features/OfficeImporter#HCreatePagefromOffice)\n\t\t- [WYSIWYG Editor](https://www.xwiki.org/xwiki/bin/view/Documentation/UserGuide/Features/OfficeImporter#HWYSIWYGEditor)\n* [Prerequisites & Installation Instructions](https://www.xwiki.org/xwiki/bin/view/Documentation/UserGuide/Features/OfficeImporter#HPrerequisites26InstallationInstructions)\n\t+ [Configuration Tutorials](https://www.xwiki.org/xwiki/bin/view/Documentation/UserGuide/Features/OfficeImporter#HConfigurationTutorials)\n\t+ [Internally managed OpenOffice server process (default)](https://www.xwiki.org/xwiki/bin/view/Documentation/UserGuide/Features/OfficeImporter#HInternallymanagedOpenOfficeserverprocess28default29)\n\t+ [Externally managed (local) OpenOffice server process](https://www.xwiki.org/xwiki/bin/view/Documentation/UserGuide/Features/OfficeImporter#HExternallymanaged28local29OpenOfficeserverprocess)\n\t+ [Auto start / Auto connect (feature)](https://www.xwiki.org/xwiki/bin/view/Documentation/UserGuide/Features/OfficeImporter#HAutostart2FAutoconnect28feature29)\n* [Dependencies](https://www.xwiki.org/xwiki/bin/view/Documentation/UserGuide/Features/OfficeImporter#HDependencies)\n# Description\n\nYou should also check the [Office Macro](https://www.xwiki.org/xwiki/bin/view/Extension/Office%20Macro).\n\nThe Office Importer Application allows users to easily import Office documents like Word documents, spreadsheets and PowerPoint presentations into wiki pages.\u00a0\n\nThe Office Importer features include:\n\n* Convert existing documents into wiki pages\n* Use common office suites as wiki authoring tools\n\n## How to use\n\n[Once XWiki is configured correctly](https://extensions.xwiki.org/xwiki/bin/view/Extension/Office%20Importer%20Application#HConfigurationTutorials) (and the Libre Office server is started), the Office Importer can be used in 2 ways.\n\n### Create Page from Office\n\nWhen creating a new page fill the page name and select the special \"Page from Office\" page type then click on Create.\n\n[![Import-Office-File-in-XWiki.png](https://www.xwiki.org/xwiki/bin/download/Extension/Office%20Importer%20Application/Import-Office-File-in-XWiki.png?rev=1.1)](https://www.xwiki.org/xwiki/bin/download/Extension/Office%20Importer%20Application/Import-Office-File-in-XWiki.png?rev=1.1)\n\nYou'll be taken to the Office Importer form where you can specify the office file to import and some options that control how the content will be imported.\n\n![Office-Importer-Wizard.png](https://www.xwiki.org/xwiki/bin/download/Extension/Office%20Importer%20Application/Office-Importer-Wizard.png?rev=1.2)\n\nThe following fields are available:\n\n* **Office document**: allows you to upload the office document to import\n* **Target page**: (read-only) shows where the content will be imported\n* **Overwrite existing content**: shown only when the target wiki page exists already, allows you to control whether to overwrite or not its content\n* **Filter styles**: strip out unnecessary styling information from the result\n* **Split document**: create multiple pages from a single office document (based on heading levels to split)\n* **Heading levels to split**: choose the heading levels to split the office content on; selected heading levels and their corresponding sections will be imported in separate child pages, linked from the parent page\n* **Child pages naming**: shown only when the target wiki page is terminal, allows to control how the \"child\" wiki pages, created as a result of the split operation, are named; the following naming methods are available:\n\t+ *Heading names*: the heading name is used as the page name; this option is the only one that makes sense when the target wiki page is not terminal, which is why the \"Child pages naming\" field is not shown in this case;\n\t+ *Main page name and heading*: the heading name is appended to the name of the target wiki page\n\t+ *Main page name and numbering*: an index (counter) is appended to the name of the target wiki page\n* XWiki 14.10.2+, 15.0+ **Terminal Child Pages**: shown only for advanced users and only when the target page is not terminal, allows to control whether the \"child\" pages created by the split operation are terminal or not\n\nXWiki 14.10.2+, 15.0+ The office document is imported asynchronously upon clicking on the Import button. A notification message shown at the bottom of the page is used to indicate the progress and the outcome of the import. I case of a successful import the user is redirected automatically to the target wiki page.\n\n### WYSIWYG Editor\n\nThe WYSIWYG editor provides two ways to import office content:\n\n* Select the \"Import Office file\" option from the **+** (plus) drop down on the editor toolbar:  \n[![Import-Office-file-in-XWiki-from-WYSIWYG-editor.png](https://www.xwiki.org/xwiki/bin/download/Extension/Office%20Importer%20Application/Import-Office-file-in-XWiki-from-WYSIWYG-editor.png?rev=1.2)](https://www.xwiki.org/xwiki/bin/download/Extension/Office%20Importer%20Application/Import-Office-file-in-XWiki-from-WYSIWYG-editor.png?rev=1.2)\n* You can copy paste sections from an Office file directly into the rich text area. See the [CKEditor Integration](https://www.xwiki.org/xwiki/bin/view/Extension/CKEditor%20Integration/#HOfficeImport) documentation for more information.\n\n# Prerequisites & Installation Instructions\n\nWe recommend using the [Extension Manager](http://extensions.xwiki.org/xwiki/bin/view/Extension/Extension+Manager+Application) to install this extension (Make sure that the text \"Installable with the Extension Manager\" is displayed at the top right location on this page to know if this extension can be installed with the Extension Manager). Note that installing Extensions when being offline is currently not supported and you'd need to use some [complex manual method](https://xwiki.org/xwiki/bin/view/Documentation/AdminGuide/Installation/#HOthermethods).\n\nYou can also use the following manual method, which is useful if this extension cannot be installed with the Extension Manager or if you're using an old version of XWiki that doesn't have the Extension Manager:\n\n1. Log in the wiki with a user having Administration rights\n2. Go to the Administration page and select the Import category\n3. Follow the on-screen instructions to upload the downloaded XAR\n4. Click on the uploaded XAR and follow the instructions\n5. You'll also need to install all [dependent Extensions](https://www.xwiki.org/xwiki/bin/view/Documentation/UserGuide/Features/OfficeImporter#HDependencies) that are not already installed in your wiki\n\n  \nThe Office Importer application comes pre-bundled with XWiki versions greater than 1.8M1, so there is no need for a manual installation. The Office Importer makes use of a running Libre Office server to convert office documents into HTML before they are finally transformed into XWiki 2.0 syntax. Thus, a Libre Office server instance is required on the server computer which hosts your XWiki installation. Beginning with XWiki 1.8.4 you can configure a Libre Office or an OpenOffice server in the following ways described below.\n\n## Configuration Tutorials\n\n* Activating a LibreOffice server in 2 steps\n\n![Import-Office-files-in-XWiki-2-steps.gif](https://www.xwiki.org/xwiki/bin/download/Extension/Office%20Importer%20Application/Import-Office-files-in-XWiki-2-steps.gif?rev=1.1)\n\n* [Video example](https://www.youtube.com/watch?v=QP_N5U_GIJY)\u00a0of activating an OpenOffice server starting with 7.4.3 versions\n\nIf you've installed the Office Importer by installing a XAR it might happen that you've chosen options that reset Programming Rights (which are needed for this application). If this is the case you'll have to re-save the Office Importer Admin page. Go to Administer Wiki, click on the Office Server, and then change the link to : <http://hostname:8080/xwiki/bin/edit/XWiki/OfficeImporterAdmin?editor=wiki.> Click the Save and View button, and then try starting the server again.\n\n## Internally managed OpenOffice server process (default)\n\nThis is a very easy (and safe) option where your XWiki application takes care of managing the OpenOffice server process for you. To configure the OpenOffice server management scheme, you can use the WEB-INF/xwiki.properties configuration file:\n\nIn order to run the Office Importer configured as \"Internally managed server instance\" on the Windows platform you need to:\n\n* use a newer version of an Office application (for ex. LibreOffice 5+)\n* set openoffice.autoStart=true\n* use a similar format to this one for the homePath variable: openoffice.homePath=C:\\Program Files (x86)\\\\LibreOffice 5\n#-------------------------------------------------------------------------------------  \n# Settings for the OpenOffice server instance consumed by the OfficeImporter component  \n#-------------------------------------------------------------------------------------  \n  \n#-# [Since 1.9M2]  \n#-# Type of the openoffice server instance used by officeimporter component.  \n#-# 0 - Internally managed server instance. (Default)  \n#-# 1 - Externally managed (local) server instance.  \n# openoffice.serverType = 0  \n  \n#-# [Since 12.1RC1]  \n#-# Port numbers used for connecting to the openoffice server instance.  \n#-# For an internally managed server instance, it will create the process for all ports.  \n#-# For an externally managed server instance, only the first server port is taken into account.  \n# openoffice.serverPorts = 8100,8101  \n  \n#-# [Since 1.9M2]  \n#-# If the openoffice server should be started / connected upon XE start.  \n#-# Default value is false  \n# openoffice.autoStart = false  \n  \n#-# [Since 1.8RC3]  \n#-# Path to openoffice installation (serverType:0 only).  \n#-# If no path is provided, a default value will be calculated based on the operating environment.  \n# openoffice.homePath = /opt/openoffice.org3/  \n  \n#-# [Since 1.8RC3]  \n#-# Path to openoffice execution profile (serverType:0 only).  \n#-# If no path is provided, a default value will be calculated based on the operating environment.  \n# openoffice.profilePath = /home/user/.openoffice.org/3  \n  \n#-# [Since 1.8RC3]  \n#-# Maximum number of simultaneous conversion tasks to be handled by a single openoffice process (serverType:0 only).  \n#-# Default value is 50  \n# openoffice.maxTasksPerProcess = 50  \n  \n#-# [Since 1.8RC3]  \n#-# Timeout for conversion tasks (in milliseconds) (serverType:0 only).  \n#-# Default value is 60 seconds  \n# openoffice.taskExecutionTimeout = 60000XWiki <12.1 the property openoffice.serverPort should be used with only one value instead of openoffice.serverPorts.\n\nXWiki <11.10.11, <12.6.3, <12.8 the default value of property openoffice.taskExecutionTimeout was 30 seconds, it has been changed to 1 min afterwards.\n\nDefault values for homePath and profilePath configuration options will be calculated based on your operating environment. Even though this is the case, this calculation might not yield accurate results for some systems. So it's a good idea to configure these values manually by editing the xwiki.properties file.\n\nIf your XWiki instance fails to automatically locate the install path of the OO server, here are some default install paths of the OO on different operating systems:\n\n* **Microsoft Windows XP/Vista/7**:Example for OpenOffice 3 (32-bit):\n\nopenoffice.profilePath=C:/Users/{user}/AppData/Roaming/openOffice.org/3  \nopenoffice.homePath=C:/Program Files/OpenOffice.org 3Example for LibreOffice 3.4 (32-bit):\n\nopenoffice.profilePath=C:/Users/{user}/AppData/Roaming/LibreOffice/3  \nopenoffice.homePath=C:/Program Files/LibreOffice 3.4Example for OpenOffice 3 (64-bit):\n\nopenoffice.profilePath=C:/Users/{user}/AppData/Roaming/openOffice.org/3  \nopenoffice.homePath=C:/Program Files (x86)/OpenOffice.org 3Example for LibreOffice 3.4 (64-bit):\n\nopenoffice.profilePath=C:/Users/{user}/AppData/Roaming/LibreOffice/3  \nopenoffice.homePath=C:/Program Files (x86)/LibreOffice 3.4\n\t+ The example paths above are for LibreOffice 3.4.x. For LibreOffice 3.3.x you have to replace the \"3.4\" in the path by \"3.3\".\n\t+ The correct path to the LibreOffice's executable directory should be openoffice.homePath=C:/Program Files/LibreOffice 3.4/program, but XWiki automatically adds /program to the given path for a Windows environment.\n* **Ubuntu Linux (10.04)**:openoffice.homePath=/usr/lib/openoffice/\n* **Ubuntu Linux (11.10)**:openoffice.homePath=/usr/lib/libreoffice/\n* **Fedora**:See the [Guide for Fedora](https://www.xwiki.org/xwiki/bin/view/Extension/Office%20Importer%20Application%20Linux).\n* **Mac OSX**:Example for LibreOffice:\n\nopenoffice.homePath=/Applications/LibreOffice.app/Contents\n\nIf you leave your XWiki application to manage the OpenOffice server process (which is the default behaviour), your Office Importer admin UI will look something like below:\n\n![admin1.png](https://www.xwiki.org/xwiki/bin/download/Extension/Office%20Importer%20Application/admin1.png?rev=1.1)\n\n## Externally managed (local) OpenOffice server process\n\nThis option allows you (the system admin) to control the OpenOffice server process as desired. This is very useful if you wish to customize OpenOffice server start-up parameters. You can configure this behaviour within the xwiki.properties file as shown below:\n\n#----------------------------------------------------------------------------------  \n# Settings for the OpenOffice server instance consumed by the OfficeImporter component  \n#----------------------------------------------------------------------------------  \n   \n#-# Type of the openoffice server instance used by officeimporter component.  \n#-# 0 - Internally managed server instance.  \n#-# 1 - Externally managed (local) server instance.  \nopenoffice.serverType=1  \n  \n#-# Port number used for connecting to the openoffice server instance.   \n# openoffice.serverPort=8100  \n  \n#-# If the openoffice server should be started / connected upon XE start.  \n# openoffice.autoStart=falseFor the profilePath configuration option, you need to have an OpenOffice profile directory created somewhere on the system. This can be a problem in server environments where launching OpenOffice is not an option. In such situations you can create an OpenOffice profile on a local computer and upload it to the server running XE.\n\nOnce XWiki is configured in this manner, an OpenOffice server must be manually started as a separate process. You can issue the following command to accomplish this:\n\nsoffice -headless -accept=\"socket,host=127.0.0.1,port=8100;urp;\" -nofirststartwizardDon't forget to replace <soffice> with the path to your OpenOffice executable. More information regarding OpenOffice server deployment is provided [here](http://www.artofsolving.com/node/10). Also note that the Office Importer admin UI will change reflecting the new configuration as shown below:\n\n![admin2.png](https://www.xwiki.org/xwiki/bin/download/Extension/Office%20Importer%20Application/admin2.png?rev=1.1)\n\nLinux users may refer to additional installation notes [here](https://www.xwiki.org/xwiki/bin/view/Extension/Office%20Importer%20Application%20Linux).\n\n## Auto start / Auto connect (feature)\n\nThis feature was introduced beginning with the XWiki 1.8.4 version. With this option enabled, you don't need to worry about starting / connecting the OpenOffice server from the Office Importer admin UI every time you restart XE. This option can be configured from **xwiki.properties** file as shown below:\n\n#-# If the openoffice server should be started / connected upon XE start.  \nopenoffice.autoStart=true# Dependencies\n\nDependencies for this extension (org.xwiki.platform:xwiki-platform-office-ui 8.3):\n\n* org.xwiki.platform:xwiki-platform-office-importer 8.3\n* [org.xwiki.commons:xwiki-commons-component-api](https://www.xwiki.org/xwiki/bin/view/Extension/Component%20Module) 8.3\n\n\n"}