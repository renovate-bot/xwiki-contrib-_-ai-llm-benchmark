{"id": "dev:IRC.xwikiArchive20140102", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20140102", "title": "IRC Archive for channel #xwiki on 02 January 2014 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<vmassol>\u00a0has joined #xwiki  \n00:38\u00a0<polx>\u00a0has quit  \n00:42\u00a0<vmassol>\u00a0has quit  \n01:37\u00a0<vmassol>\u00a0has joined #xwiki  \n01:43\u00a0<vmassol>\u00a0has quit  \n02:38\u00a0<vmassol>\u00a0has joined #xwiki  \n02:42\u00a0<vmassol>\u00a0has quit  \n03:39\u00a0<vmassol>\u00a0has joined #xwiki  \n03:45\u00a0<vmassol>\u00a0has quit  \n04:39\u00a0<vmassol>\u00a0has joined #xwiki  \n04:45\u00a0<vmassol>\u00a0has quit  \n05:40\u00a0<vmassol>\u00a0has joined #xwiki  \n05:44\u00a0<vmassol>\u00a0has quit  \n06:41\u00a0<vmassol>\u00a0has joined #xwiki  \n06:46\u00a0<vmassol>\u00a0has quit  \n07:42\u00a0<vmassol>\u00a0has joined #xwiki  \n07:46\u00a0<vmassol>\u00a0has quit  \n08:27\u00a0<DarkKnightCZ>\u00a0has joined #xwiki  \n08:33\u00a0<DarkKnightCZ>\u00a0is there a way, how to make server-specific configuration file for component? my component has specific command to run which can vary (depending on OS), but to achieve proper sandboxing, i can't load it from document  \n08:34\u00a0<vmassol>\u00a0has joined #xwiki  \n08:36\u00a0<vmassol1>\u00a0has joined #xwiki  \n08:36\u00a0<vmassol>\u00a0has quit  \n08:40\u00a0<vmassol1>\u00a0has quit  \n08:41\u00a0<polx>\u00a0has joined #xwiki  \n08:51\u00a0<polx>\u00a0has quit  \n08:54\u00a0<polx>\u00a0has joined #xwiki  \n08:58\u00a0<cjd>\u00a0has joined #xwiki  \n09:13\u00a0<polx>\u00a0has quit  \n09:29\u00a0<tmortagne>\u00a0has joined #xwiki  \n09:37\u00a0<vmassol>\u00a0has joined #xwiki  \n09:41\u00a0<j-simard>\u00a0has joined #xwiki  \n09:41\u00a0<vmassol>\u00a0has quit  \n09:54\u00a0<DarkKnightCZ>\u00a0tmortagne: hi, can i have a question about job logging? i've set request id as we've previously discussed, and it works, it creates directory for that request, but all it saves is serialized job instance, no logs created with logger... any ideas?  \n09:54\u00a0<tmortagne>\u00a0DarkKnightCZ: it's not a serialized job instance  \n09:54\u00a0<tmortagne>\u00a0it's a serialized job status  \n09:54\u00a0<tmortagne>\u00a0and log is part of the ststus  \n09:55\u00a0<tmortagne>\u00a0so you will find the log in there too  \n09:55\u00a0<tmortagne>\u00a0only it's stored as XML and not as plain text  \n09:56\u00a0<lucaa>\u00a0has joined #xwiki  \n09:59\u00a0<DarkKnightCZ>\u00a0oh, ok, i will test in in a sec (i was using stdout for testing purposes)  \n10:02\u00a0<j-simard>\u00a0has quit  \n10:04\u00a0<j-simard>\u00a0has joined #xwiki  \n10:05\u00a0<vmassol>\u00a0has joined #xwiki  \n10:10\u00a0<DarkKnightCZ>\u00a0tmortagne: nope, status.xml contains only info about loglistener (name and empty concurrentlinkedqueue), for logging i use logger from AbstractJob  \n10:13\u00a0<tmortagne>\u00a0DarkKnightCZ: do you overwrite AbstractJob#jobStarting(), that's what enable the log listener  \n10:13\u00a0<tmortagne>\u00a0?  \n10:13\u00a0<DarkKnightCZ>\u00a0nope, only getType and runInternal  \n10:15\u00a0<tmortagne>\u00a0what log level are you logging ?  \n10:15\u00a0<tmortagne>\u00a0debug ?  \n10:16\u00a0<DarkKnightCZ>\u00a0info  \n10:16\u00a0<tmortagne>\u00a0I don't understand, looks like your don't receive any log  \n10:16\u00a0<tmortagne>\u00a0logListener is the log  \n10:17\u00a0<tmortagne>\u00a0it's a queue containing the log received  \n10:17\u00a0<tmortagne>\u00a0I can assure you it works well in many other jobs  \n10:18\u00a0<tmortagne>\u00a0are you able to put breakpoints and debug a bit ?  \n10:18\u00a0<DarkKnightCZ>\u00a0hmm, this is the only thing i get is https://ezcrypt.it/DI7n#vAv2VQaz67968lSbWFFaAqxo  \n10:18\u00a0<tmortagne>\u00a0yes this is an empty log  \n10:19\u00a0<DarkKnightCZ>\u00a0yep, i'm able to debug anything, just don't know how :)  \n10:19\u00a0<tmortagne>\u00a0the field \"queue\" contains the log  \n10:19\u00a0<tmortagne>\u00a0ok, first thing first: you did not changed logback from something else did you ?  \n10:20\u00a0<tmortagne>\u00a0s/from/for/  \n10:21\u00a0<DarkKnightCZ>\u00a0nope, should be default  \n10:21\u00a0<tmortagne>\u00a0I guess the first thing to check is AbstractJobStatus#startListening()  \n10:21\u00a0<tmortagne>\u00a0well no  \n10:21\u00a0<vmassol>\u00a0hi guys, should we upgrade to commons lang 3.2 or wait for 6.0M1? I think we should 1) wait for 6.0M1 and 2) create a branch now for releasing 5.4 on a branch to make sure we don't introduce anything dangerous for 5.3 and to allow us to start committing stuff for 6.0 if we need to, wdyt?  \n10:22\u00a0<tmortagne>\u00a0we see it's called since the LogQueueListener is created  \n10:22\u00a0<vmassol>\u00a0if one of you agrees, I'll send a proposal email  \n10:22\u00a0<vmassol>\u00a0:)  \n10:23\u00a0<tmortagne>\u00a0vmassol: \u00a0being able to commit stuff in 6.0 would be nice but commons-lang is not dangerous IMO  \n10:23\u00a0<vmassol>\u00a0I have a list of dep upgrades to do but I'd rather do that in 6.0  \n10:24\u00a0<vmassol>\u00a0just to be extra safe and for 5.4 I don't think we should commit stuff that don't fix a known problem, just to be on the safe side  \n10:24\u00a0<ekarlso>\u00a0what's the improvements for 6 vs 5 series ?  \n10:24\u00a0<vmassol>\u00a0ekarlso: 6 isn't done yet :)  \n10:24\u00a0<tmortagne>\u00a0ekarlso: nothing really defined yet  \n10:24\u00a0<ekarlso>\u00a0ah  \n10:25\u00a0<vmassol>\u00a0if you want to help please fill our survey!  \n10:25\u00a0<vmassol>\u00a0:)  \n10:25\u00a0<vmassol>\u00a0ekarlso: http://markmail.org/thread/hu4y3nheka2nkrqk  \n10:26\u00a0<tmortagne>\u00a0DarkKnightCZ: you are not creating a job from another or something fancy like this ?  \n10:26\u00a0<vmassol>\u00a0ah just seen sergiu committed 3.2 on master already  \n10:26\u00a0<tmortagne>\u00a0yes  \n10:26\u00a0<tmortagne>\u00a0I tough that's why you were asking  \n10:27\u00a0<vmassol>\u00a0nope I had received the upgrade email from commons lang ;)  \n10:27\u00a0<DarkKnightCZ>\u00a0tmortagne: nope, jobs are created from script service  \n10:28\u00a0<tmortagne>\u00a0DarkKnightCZ: you are logging inside runInternal(), right ?  \n10:28\u00a0<DarkKnightCZ>\u00a0yep  \n10:29\u00a0<tmortagne>\u00a0could you put a breakpoint in org.xwiki.logging.event.LogQueueListener#onEvent and see if you receive your log ?  \n10:30\u00a0<DarkKnightCZ>\u00a0hmm, i'm not sure i can use breakpoints (xwiki runs under jetty, remote machine)  \n10:31\u00a0<tmortagne>\u00a0you could remotely debug it  \n10:31\u00a0<tmortagne>\u00a0just need to open some port  \n10:31\u00a0<tmortagne>\u00a0or you test your job locally in a new instance  \n10:32\u00a0<DarkKnightCZ>\u00a0jwdp?  \n10:32\u00a0<DarkKnightCZ>\u00a0\\*jdwp  \n10:33\u00a0<tmortagne>\u00a0probably (did not know it had a special name :))  \n10:34\u00a0<tmortagne>\u00a0it's called \"remote java application\" in Eclipse debug configuration  \n10:34\u00a0<DarkKnightCZ>\u00a0yes... but i need to clone whole wiki, don't i ?  \n10:35\u00a0<tmortagne>\u00a0if you want to test locally yes but if you just want to to a remote debug no, you just start in debug mode  \n10:35\u00a0<tmortagne>\u00a0and open debug port  \n10:39\u00a0<tmortagne>\u00a0DarkKnightCZ: befre starting breakpoint etc could you look at solr status  \n10:39\u00a0<tmortagne>\u00a0jobs/status/solr/indexer  \n10:39\u00a0<tmortagne>\u00a0since that's your model AFAIR  \n10:39\u00a0<tmortagne>\u00a0or at least it's supposed to be very similar to you use case  \n10:39\u00a0<tmortagne>\u00a0I can see I have logs on my side in this job status  \n10:40\u00a0<DarkKnightCZ>\u00a0ok, will look in a sec  \n10:41\u00a0<tmortagne>\u00a0in every jobs log you are supposed to have as a minimum \"Starting job of type [{}] with identifier [{}]\" and \"Finished job of type [{}] with identifier [{}]\"  \n10:41\u00a0<tmortagne>\u00a0an between them the actual custom logs of this job  \n10:43\u00a0<DarkKnightCZ>\u00a0hmm, weird  \n10:43\u00a0<DarkKnightCZ>\u00a0if error error occurs, logs are there  \n10:48\u00a0<DarkKnightCZ>\u00a0tmortagne: could be the problem logback? since there is <root level=\"warn\">, i guess it ignores anything less important (and since is not printed into stdout, it's not logged at all)  \n10:50\u00a0<tmortagne>\u00a0DarkKnightCZ: could be, I tough the default was info but looks like it's the default only for \"org.xwiki\"  \n10:50\u00a0<tmortagne>\u00a0if logback ignores it then yes your status won't contain it  \n11:03\u00a0<DarkKnightCZ>\u00a0tmortagne: yep, after changing root to info, everything is logged  \n11:03\u00a0<tmortagne>\u00a0I have no idea why we have warn by default, seems to me it should be info, vmassol any idea ?  \n11:03\u00a0<vmassol>\u00a0because we would have too many logs with info  \n11:04\u00a0<vmassol>\u00a0several of fwk we use log a lot of stuff as info  \n11:04\u00a0<tmortagne>\u00a0vmassol: we already have things like <logger name=\"org.hibernate\" level=\"warn\"/> in the configuration  \n11:04\u00a0<vmassol>\u00a0this is different  \n11:04\u00a0<tmortagne>\u00a0which is useless btw since it's the default  \n11:04\u00a0<vmassol>\u00a0for hibernate the only reason I put those  \n11:05\u00a0<vmassol>\u00a0is to let user be able to know the names and change them to debug store issues  \n11:05\u00a0<vmassol>\u00a0(ie replace \"warn\" by \"trace\")  \n11:05\u00a0<vmassol>\u00a0it's documentation  \n11:06\u00a0<vmassol>\u00a0said differently we want to control our logs  \n11:06\u00a0<vmassol>\u00a0which is why we put info for xwiki and warn for others  \n11:13\u00a0<vmassol>\u00a0different topic: Could be interesting to use in our xwiki-platform-url module: https://github.com/smola/galimatias  \n11:14\u00a0<tmortagne>\u00a0looks ice  \n11:14\u00a0<tmortagne>\u00a0nice  \n11:15\u00a0<tmortagne>\u00a0but no maven central and no real release yet  \n11:17\u00a0<vmassol>\u00a0ah they're working on doc  \n11:17\u00a0<vmassol>\u00a0yesterday there was a TODO under the maven section :)  \n11:49\u00a0<DarkKnightCZ>\u00a0hmm, can i achieve redirecting after upload using FileUploader widget? if i set xredirect input, it only shows content of document in small window  \n12:54\u00a0<vmassol>\u00a0hey today is BFD actually  \n12:54\u00a0<vmassol>\u00a0:)  \n12:54\u00a0<vmassol>\u00a0(had forgotten about it)  \n12:55\u00a0<vmassol>\u00a0tmortagne: should we do it or not?  \n13:29\u00a0<vmassol>\u00a0tmortagne: just built XE and the Admin user is still not there  \n13:29\u00a0<vmassol>\u00a0didn't you fix this already?  \n13:30\u00a0<vmassol>\u00a0(downloaded XE, removed data dir and used DW to populate the wiki)  \n13:31\u00a0<vmassol>\u00a0I also have the warnings:  \n13:31\u00a0<vmassol>\u00a02014-01-02 13:19:24,658 [http://localhost:8080/xwiki/bin/distribution/XWiki/Distribution] WARN \u00a0o.x.v.i.DefaultVelocityEngine \u00a0- Cannot retrieve method isCause from object of class java.lang.reflect.UndeclaredThrowableException due to security restrictions.  \n13:51\u00a0<tmortagne>\u00a0vmassol: totally forgot about BFD too, we should probably do it I think  \n13:54\u00a0<tmortagne>\u00a0as for Admin usr issue, I found and fixed a XAR import bugs but I don't know if that was all the issues, maybe there is something else. Did not had time to look at DW specifically  \n13:55\u00a0<vmassol>\u00a0creating BFD dashboard in jira and sending email  \n14:02\u00a0<vmassol>\u00a0sent  \n14:37\u00a0<vmassol>\u00a0has quit  \n14:46\u00a0<vmassol>\u00a0has joined #xwiki  \n16:22\u00a0<vmassol>\u00a0tmortagne: for 2014, I wish you to be able to write wizard without a \"y\" :)  \n16:23\u00a0<vmassol>\u00a0(kidding)  \n16:23\u00a0<tmortagne>\u00a0yea...  \n16:26\u00a0<DarkKnightCZ>\u00a0has left #xwiki  \n16:33\u00a0<vmassol>\u00a0tmortagne: XE is really broken  \n16:33\u00a0<vmassol>\u00a0I cannot even create a page  \n16:34\u00a0<vmassol>\u00a0the save fails  \n16:34\u00a0<vmassol>\u00a0Caused by: java.lang.NullPointerException  \n16:34\u00a0<vmassol> at com.xpn.xwiki.api.Api.getXWikiContext(Api.java:72)  \n16:35\u00a0<vmassol>\u00a0to reproduce:  \n16:35\u00a0<vmassol>\u00a0- build or download XE  \n16:35\u00a0<vmassol>\u00a0- remove data/ dir  \n16:35\u00a0<vmassol>\u00a0- restart and install with DW  \n16:35\u00a0<vmassol>\u00a0- log in as superadmin  \n16:35\u00a0<vmassol>\u00a0- create page and save  \n16:36\u00a0<tmortagne>\u00a0vmassol: you don't have an error before that ? because have a nullpointer here does not make much sense  \n16:36\u00a0<vmassol>\u00a0I had it when I raised the issue with DW and Admin user before the holiday  \n16:37\u00a0<vmassol>\u00a0before it was ok  \n16:37\u00a0<vmassol>\u00a0(I'm referring to the email entitled \"[xwiki-devs] DW is broken in 5.4M1-SNAPSHOT\")  \n16:37\u00a0<tmortagne>\u00a0I don't remember this nullpointer  \n16:37\u00a0<vmassol>\u00a0I didn't mention it in this email  \n16:37\u00a0<vmassol>\u00a0but I had it at that time too  \n16:37\u00a0<vmassol>\u00a0ie on 13/12/2013  \n16:38\u00a0<vmassol>\u00a0before that date I didn't have it  \n16:38\u00a0<tmortagne>\u00a0I don't see what change could have cause not having a execution context anymore  \n16:38\u00a0<vmassol>\u00a0I don't know either  \n16:38\u00a0<vmassol>\u00a0could you verify you have it too?  \n16:39\u00a0<vmassol>\u00a0(to make sure it's not something local)  \n16:39\u00a0<tmortagne>\u00a0platform builds well not this nullpointer is obviously not always the case  \n16:39\u00a0<tmortagne>\u00a0s/not/so/  \n16:40\u00a0<vmassol>\u00a0I didn't rebuild platform on my side, just enterprise  \n16:40\u00a0<vmassol>\u00a0but CI should have built it  \n16:40\u00a0<tmortagne>\u00a0yes it did built it for sure  \n16:41\u00a0<tmortagne>\u00a0and it seems ok (at least for saving a page, there is no test with empty database and DW)  \n16:57\u00a0<tmortagne>\u00a0vmassol: I reproduce the missing Admin user (looks like it cannot import it, will check the XML and debug to see what it does not like) but appart from this XE works well for me using superadmin for example, no weird nullpointer on xcontext  \n16:57\u00a0<vmassol>\u00a0strange  \n16:58\u00a0<vmassol>\u00a0the page I'm creating is:  \n16:58\u00a0<tmortagne>\u00a0note that I restarted wfter having installed the page to enable superadmin  \n16:58\u00a0<vmassol>\u00a0WikiStressTestCode.FromRequest  \n16:58\u00a0<vmassol>\u00a0yep me too  \n16:59\u00a0<tmortagne>\u00a0I'm actually a bit surprised it works that well (thinking about UI extension and things like this associated to a user that does not exist)  \n16:59\u00a0<vmassol>\u00a0:)  \n16:59\u00a0<vmassol>\u00a0indeed\u2026  \n17:00\u00a0<tmortagne>\u00a0I did not even get a single error about failing to register extensions  \n17:00\u00a0<vmassol>\u00a0yep  \n17:01\u00a0<tmortagne>\u00a0so looks like they have been properly registered but not sure why excatly  \n17:01\u00a0<tmortagne>\u00a0anyway one thing after another, checking why it does not like Admin document XML  \n17:02\u00a0<vmassol>\u00a0ok  \n17:02\u00a0<tmortagne>\u00a0according to the error it sound like it contain a object property which does not exist in the class  \n17:03\u00a0<tmortagne>\u00a0(something I need to bulletproof in wikistream)  \n17:04\u00a0<vmassol>\u00a0I can save Sandbox.WebHome for ex  \n17:05\u00a0<vmassol>\u00a0creating a new page in Sandbox worked too  \n17:06\u00a0<vmassol>\u00a0ok I know  \n17:07\u00a0<vmassol>\u00a0it's related to the content  \n17:07\u00a0<vmassol>\u00a0see http://jira.xwiki.org/browse/XWIKI-9833  \n17:07\u00a0<vmassol>\u00a0if you try to copy paste the first script content  \n17:07\u00a0<vmassol>\u00a0you'll get the NPE  \n17:07\u00a0<vmassol>\u00a0and that's probably because the Admin user doesn't exist or something like this  \n17:08\u00a0<vmassol>\u00a0(I have tested this page on previous versions and it worked well)  \n17:42\u00a0<UCC>\u00a0has joined #xwiki  \n17:46\u00a0<vmassol>\u00a0so we have a wrong property in our Admin user page?  \n17:47\u00a0<vmassol>\u00a0(tmortagne)  \n17:47\u00a0<tmortagne>\u00a0vmassol: I did not checked yet but wikistream was not supporting it for sure  \n17:47\u00a0<tmortagne>\u00a0I will look at it now  \n17:47\u00a0<vmassol>\u00a0ok  \n17:50\u00a0<tmortagne>\u00a0vmassol: found it I think: pageWidth  \n17:50\u00a0<tmortagne>\u00a0\u00a0\u00a0\u00a0\u00a0<property>  \n17:50\u00a0<tmortagne>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<pageWidth>default</pageWidth>  \n17:51\u00a0<tmortagne>\u00a0can't find it in the <class>  \n17:51\u00a0<tmortagne>\u00a0no idea what it was supposed to be  \n17:51\u00a0<tmortagne>\u00a0I'm not much surprised given the age of that page  \n17:52\u00a0<tmortagne>\u00a0it's the only one  \n17:52\u00a0<tmortagne>\u00a0removing it from the XML  \n17:57\u00a0<vmassol>\u00a0ok  \n17:57\u00a0<vmassol>\u00a0I think it was the default number of pixels when editing a page  \n17:58\u00a0<vmassol>\u00a0horizontal viewport size  \n17:59\u00a0<vmassol>\u00a0tmortagne: seems we have lots of pages in git with this property...  \n17:59\u00a0<vmassol>\u00a0not a lot but many  \n17:59\u00a0<tmortagne>\u00a0I'm still surprise it ended up like this, having a property in a document that is not anymore in the standard class why not but having a property in an object which is not defined in the class in this object itself makes it quite a crappy state when it was exported  \n17:59\u00a0<vmassol>\u00a0but we class definitions for some pages  \n18:00\u00a0<vmassol>\u00a0(in the xml)  \n18:00\u00a0<vmassol>\u00a0ah no  \n18:00\u00a0<vmassol>\u00a0they're here in the class definition  \n18:00\u00a0<vmassol>\u00a0in ColorThemes.WebPreferences.xml  \n18:00\u00a0<vmassol>\u00a0and in some test pages  \n18:01\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<prettyName>Preferred page width</prettyName>  \n18:01\u00a0<vmassol>\u00a0so that's what I thought I think  \n18:01\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<values>default|640|800|1024|1280|1600</values>  \n18:02\u00a0<vmassol>\u00a0it's even in hibernate.cfg.xml but commented out  \n18:02\u00a0<tmortagne>\u00a0vmassol: I reviewed the DW log and Admin was the only one with the async issue between object property and object class but yes we should cleanup a bit  \n18:02\u00a0<vmassol>\u00a0for: \u00a0\u00a0\u00a0\u00a0<!-- XWikiPreferences custom mapping -->  \n18:02\u00a0<vmassol>\u00a0euh not hibernate but mapping files  \n18:11\u00a0<j-simard>\u00a0has quit  \n18:21\u00a0<tmortagne>\u00a0has quit  \n19:28\u00a0<cjd>\u00a0has quit  \n19:51\u00a0<lucaa>\u00a0has quit  \n20:31\u00a0<UCC>\u00a0has quit  \n21:14\u00a0<UCC>\u00a0has joined #xwiki  \n21:33\u00a0<lucaa>\u00a0has joined #xwiki  \n22:39\u00a0<UCC>\u00a0has quit  \n22:48\u00a0<polx>\u00a0has joined #xwiki  \n23:20\u00a0<lucaa>\u00a0has quit  \n23:26\u00a0<UCC>\u00a0has joined #xwiki  \n23:37\u00a0<polx>\u00a0has quit  \n23:45\u00a0<vmassol>\u00a0has quit\n"}