{"id": "dev:IRC.xwikiArchive20121128", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20121128", "title": "IRC Archive for channel #xwiki on 28 November 2012 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<vmassol>\u00a0has joined #xwiki  \n00:55\u00a0<jvdrean>\u00a0has quit  \n01:00\u00a0<jvelo>\u00a0has joined #xwiki  \n01:56\u00a0<Denis>\u00a0has quit  \n02:17\u00a0<polx>\u00a0has quit  \n03:02\u00a0<sdumitriu>\u00a0has quit  \n04:09\u00a0<tekzilla>\u00a0has quit  \n04:11\u00a0<tekzilla>\u00a0has joined #xwiki  \n04:11\u00a0<sdumitriu1>\u00a0has quit  \n04:15\u00a0<sdumitriu>\u00a0has joined #xwiki  \n04:30\u00a0<Denis>\u00a0has joined #xwiki  \n04:52\u00a0<sburjan`>\u00a0has quit  \n05:03\u00a0<SvenDowideit>\u00a0has quit  \n06:00\u00a0<SvenDowideit>\u00a0has joined #xwiki  \n06:04\u00a0<Denis>\u00a0has quit  \n06:04\u00a0<SvenDowideit>\u00a0has quit  \n06:05\u00a0<SvenDowideit>\u00a0has joined #xwiki  \n06:08\u00a0<SvenDowideit>\u00a0has quit  \n06:16\u00a0<SvenDowideit>\u00a0has joined #xwiki  \n06:16\u00a0<SvenDowideit>\u00a0has quit  \n06:17\u00a0<SvenDowideit>\u00a0has joined #xwiki  \n08:29\u00a0<polx>\u00a0has joined #xwiki  \n08:32\u00a0<vmassol>\u00a0has quit  \n08:34\u00a0<sburjan`>\u00a0has joined #xwiki  \n08:44\u00a0<Denis>\u00a0has joined #xwiki  \n08:56\u00a0<mflorea>\u00a0has joined #xwiki  \n09:03\u00a0<msmeria>\u00a0has joined #xwiki  \n09:22\u00a0<jvdrean>\u00a0has joined #xwiki  \n09:35\u00a0<jvdrean>\u00a0has quit  \n09:44\u00a0<vmassol>\u00a0has joined #xwiki  \n09:46\u00a0<tdelafosse>\u00a0has joined #xwiki  \n10:00\u00a0<jvdrean>\u00a0has joined #xwiki  \n10:27\u00a0<Slashman>\u00a0has joined #xwiki  \n10:38\u00a0<vmassol>\u00a0has quit  \n10:40\u00a0<vmassol>\u00a0has joined #xwiki  \n10:50\u00a0<sburjan>\u00a0has joined #xwiki  \n10:52\u00a0<sburjan>\u00a0hello everyone  \n10:52\u00a0<Slashman>\u00a0has quit  \n10:54\u00a0<Slashman>\u00a0has joined #xwiki  \n10:55\u00a0<silviar>\u00a0has joined #xwiki  \n11:12\u00a0<evalica>\u00a0has joined #xwiki  \n11:12\u00a0<Enygma`>\u00a0has joined #xwiki  \n11:32\u00a0<jvelo>\u00a0hi Enygma`  \n11:33\u00a0<jvelo>\u00a0I've tried again the lucene 4.0.0 migration against current master. I haven't tested thoroughly yet, but so far it seems functional.  \n11:33\u00a0<jvelo>\u00a0I've tried to upgrade solr to 4.0.0 after that  \n11:33\u00a0<jvelo>\u00a0it builds fine, but when I try to index the wiki I get this exception: http://pastebin.com/raw.php?i=HvhZ3EBt  \n11:45\u00a0<polx>\u00a0has quit  \n11:49\u00a0<polx>\u00a0has joined #xwiki  \n12:01\u00a0<Enygma`>\u00a0jvelo: maybe in Solr 4.0 it is now mandatory that a solr.xml file also exists. Try adding this file (named solr.xml) in the data/solr/ directory  \n12:01\u00a0<jvelo>\u00a0Enygma`: Empty ?  \n12:01\u00a0<jvelo>\u00a0or is a minimal conf needed ?  \n12:02\u00a0<Enygma`>\u00a0http://pastebin.com/py72iQqE  \n12:02\u00a0<Enygma`>\u00a0forgot to paste :)  \n12:02\u00a0<jvelo>\u00a0thanks. Will try that this afternoon  \n12:03\u00a0<Enygma`>\u00a0jvelo: not sure this will fix it though. I would have to look deeper to understand what`s going on  \n12:03\u00a0<jvelo>\u00a0OK, I'll let you know in any case  \n12:11\u00a0<jvdrean>\u00a0has quit  \n12:42\u00a0<vmassol>\u00a0has quit  \n12:48\u00a0<vmassol>\u00a0has joined #xwiki  \n12:53\u00a0<jvdrean>\u00a0has joined #xwiki  \n13:05\u00a0<mflorea>\u00a0has quit  \n13:22\u00a0<Slashman>\u00a0has quit  \n13:36\u00a0<Slashman>\u00a0has joined #xwiki  \n14:06\u00a0<zykes->\u00a0http://pastebin.com/XkV5c0m2 < anyone got a clue on this?  \n14:13\u00a0<zykes->\u00a0my wiki is currently borked  \n14:18\u00a0<mflorea>\u00a0has joined #xwiki  \n14:27\u00a0<zykes->\u00a0anyone that can help me ? http://pastebin.com/XkV5c0m2 < I am not good at debugging java stuff  \n14:38\u00a0<vmassol>\u00a0going to restart xwiki.org to upgrade it to 4.3  \n16:32\u00a0<xwikibot>\u00a0has joined #xwiki  \n16:32\u00a0<vmassol>\u00a0yeah he's back!  \n16:32\u00a0<vmassol>\u00a0xwikibot: welcome back :)  \n16:33\u00a0<vmassol>\u00a0XWIKI-8531  \n16:37\u00a0<Enygma`>\u00a0jvelo: cool! Yes, I know that exception. You only get it in the admin section. I probably removed something (JS?) related to locking the XWiki preferences page that will need to be fixed at one point, but it`s nothing major.  \n16:38\u00a0<jvelo>\u00a0Enygma`: OK, maybe I can help with that. I'll send a VOTE for the lucene 4.0.0 migration ASAP, it would be cool to have that in 4.4 IMO  \n16:39\u00a0<Enygma`>\u00a0jvelo: ok, sounds good.  \n16:39\u00a0<jvelo>\u00a0about solr.xml I guess it has to be copied over programmatically, right ?  \n16:39\u00a0<jvelo>\u00a0I'll let you handle this piece if you don't mind  \n16:39\u00a0<jvelo>\u00a0or I can do it if you give me some pointers where it should happen  \n16:39\u00a0<Enygma`>\u00a0jvelo: yes, sure.  \n16:40\u00a0<Enygma`>\u00a0I`ll handle it  \n16:40\u00a0<jvelo>\u00a0OK  \n16:46\u00a0<vmassol>\u00a0cjd: http://extensions.xwiki.org/xwiki/bin/view/Extension/Restore+Documents  \n16:47\u00a0<vmassol>\u00a0grr\u2026 again  \n16:47\u00a0<vmassol>\u00a0I mixe again the space delete and documet delete buttons  \n16:48\u00a0<vmassol>\u00a0:(  \n16:49\u00a0<Enygma`>\u00a0maybe we should use \"Delete Space\" and \"Delete Page\" like we do for \"Watch Space\" and \"Administer Space\"  \n16:49\u00a0<vmassol>\u00a0yes definitely  \n16:49\u00a0<vmassol>\u00a0and list what will be deleted  \n16:49\u00a0<vmassol>\u00a0in the confirmation dialog box  \n16:51\u00a0<jvelo>\u00a0Enygma`: do you have some time to answer a couple of questions I have about XWiki's solr integration ?  \n16:51\u00a0<jvelo>\u00a0not very complex, I just want to make sure I understand right  \n16:52\u00a0<sburjan>\u00a0tmortagne: thanks. and sorry for my mistake.  \n16:52\u00a0<Enygma`>\u00a0jvelo: sure, go ahead  \n16:53\u00a0<jvelo>\u00a0OK here it goes: as I understand right now every object property is indexed with field type \"string\", is that right ?  \n16:53\u00a0<jvelo>\u00a0actuall \"text\\_general\" to be precise  \n16:53\u00a0<Enygma`>\u00a0yes, according to the schema  \n16:54\u00a0<jvelo>\u00a0OK. There is no way currently to have a property indexed with an other type ?  \n16:54\u00a0<Enygma`>\u00a0what do you have in mind?  \n16:54\u00a0<jvelo>\u00a0my use case is geo  \n16:55\u00a0<jvelo>\u00a0but there could be other uses  \n16:55\u00a0<jvelo>\u00a0(for instance numbers be indexed as numbers)  \n16:56\u00a0<Enygma`>\u00a0I guess we would need to use a field name for every type that we want to index separately  \n16:57\u00a0<jvelo>\u00a0OK. then at index time we check the class of the property passed  \n16:57\u00a0<jvelo>\u00a0and use the type accordingly  \n16:58\u00a0<Enygma`>\u00a0something like <field name=\"propertyvalue\\_number\" type=\"number\"/> <field name=\"propertyvalue\\_date\" type=\"tdate\"/> etc...  \n16:58\u00a0<Enygma`>\u00a0and yes, at index time, we choose the right field to store the property in  \n16:59\u00a0<Enygma`>\u00a0as for query... this might get tricky  \n16:59\u00a0<Enygma`>\u00a0jvelo: are you familiar with the current details in lucene?  \n16:59\u00a0<Enygma`>\u00a0on this matter  \n17:00\u00a0<jvelo>\u00a0No, but I will check this out  \n17:00\u00a0<jvelo>\u00a0Maybe there's no use case beside geo  \n17:00\u00a0<jvelo>\u00a0in which case we could have just an extra field for that  \n17:01\u00a0<msmeria>\u00a0has quit  \n17:02\u00a0<jvelo>\u00a0i.e store the geo object (coords, or shape, etc.) in both \"general\\_text\" and \"geo\" fields  \n17:03\u00a0<jvelo>\u00a0but I doubt you want to search geo objects as plain text anyway  \n17:04\u00a0<jvelo>\u00a0while it makes sense for email, static list, etc. which are in reality actual string properties  \n17:04\u00a0<jvelo>\u00a0for numbers I don't know. Maybe lucene/solr can actually make sense of the number and it can be used in computations, in which case it would have value being stored independently  \n17:04\u00a0<Enygma`>\u00a0jvelo: it seems that we currently index strings in lucene  \n17:05\u00a0<zykes->\u00a0How can I debug this? \"SEVERE: The web application [/xwiki] appears to have started a thread named [Thread-2] but has failed to stop it. This is very likely to create a memory leak\". Sorry for asking again but i'm clueless onto why my wiki fails  \n17:05\u00a0<jvelo>\u00a0Enygma`: basically we're facing the same challenge as with translations. Except here the number of types is known in advance  \n17:06\u00a0<Enygma`>\u00a0jvelo: more or less. Everything seems to be handled in solr with just adding more fields to the index :)  \n17:06\u00a0<jvelo>\u00a0hehe :) That's actually an argument for schemaless engines  \n17:07\u00a0<Enygma`>\u00a0with lucene, we seem to be indexing properties as \"ClassReference.propertyName:value\"  \n17:08\u00a0<Enygma`>\u00a0that is rather nice for building queries, but for displaying results in the Search application for instance (in a generic way) is quite a mess.  \n17:08\u00a0<Enygma`>\u00a0in Solr, I`m using propertyvalue and propertyname together with class  \n17:09\u00a0<zykes->\u00a0would be really nice with some help, I even tried to enable root level logging to debug  \n17:09\u00a0<Enygma`>\u00a0but actually, in Solr I`m handling properties as first class documents  \n17:09\u00a0<jvelo>\u00a0which makes sense  \n17:09\u00a0<Enygma`>\u00a0while in Lucene we only have XWiki Documents  \n17:09\u00a0<Enygma`>\u00a0with fields (properties) attached to them  \n17:10\u00a0<Enygma`>\u00a0you can`t really query for objects or properties in Lucene`s schema  \n17:10\u00a0<jvelo>\u00a0Enygma`: yes you can  \n17:10\u00a0<jvelo>\u00a0we are doing in the search suggest for example  \n17:10\u00a0<jvelo>\u00a0ah you mean querying FOR  \n17:11\u00a0<jvelo>\u00a0I see  \n17:11\u00a0<Enygma`>\u00a0is search suggest we are quering for documents, filtering by property values  \n17:11\u00a0<jvelo>\u00a0indeed, we only get back documents  \n17:11\u00a0<Enygma`>\u00a0right  \n17:11\u00a0<Enygma`>\u00a0though I agree that maybe 90% of the search usecase is to get documents  \n17:12\u00a0<Enygma`>\u00a0but since, AFAIK, we want to decouple search from storage, maybe search would be used more :P  \n17:12\u00a0<Enygma`>\u00a0for applications  \n17:12\u00a0<jvelo>\u00a0yes actually it makes sense to use search as much as possible vs. DB calls  \n17:12\u00a0<Enygma`>\u00a0HQL should be less performant than Search  \n17:13\u00a0<Enygma`>\u00a0and now that search is accessible with XWiki`s Query API, applications are free to choose :)  \n17:13\u00a0<Enygma`>\u00a0anyway  \n17:13\u00a0<Enygma`>\u00a0right  \n17:14\u00a0<vmassol>\u00a0testing:  \n17:14\u00a0<vmassol>\u00a0a  \n17:14\u00a0<vmassol>\u00a0b  \n17:14\u00a0<vmassol>\u00a0c  \n17:14\u00a0<vmassol>\u00a0d  \n17:14\u00a0<vmassol>\u00a0e  \n17:14\u00a0<vmassol>\u00a0f  \n17:14\u00a0<vmassol>\u00a0g  \n17:14\u00a0<vmassol>\u00a0ds  \n17:14\u00a0<vmassol>\u00a0d  \n17:14\u00a0<vmassol>\u00a0d  \n17:14\u00a0<vmassol>\u00a0snif\u2026 still not working fine....  \n17:14\u00a0<Enygma`>\u00a0there is another problem as well. Searching usually stores indexed versions of content. If you also store the content, you will get the index too fat.  \n17:15\u00a0<Enygma`>\u00a0heck... why not dump the DB alltogether and use the index for storing XWiki documents and data? :D  \n17:15\u00a0<Enygma`>\u00a0using a solr/lucene based storage :)  \n17:17\u00a0<zykes->\u00a0Seriously, how can I debug something like this? http://paste.ubuntu.com/1394787/  \n17:17\u00a0<jvelo>\u00a0Enygma`: you can ask not to store  \n17:17\u00a0<jvelo>\u00a0but indeed, you can also use an index as a noSQL datastore  \n17:18\u00a0<jvelo>\u00a0elasticsearch supports the notion of snapshotting I think  \n17:18\u00a0<jvelo>\u00a0for persistency  \n17:18\u00a0<jvelo>\u00a0I don't know about solr  \n17:19\u00a0<zykes->\u00a0jvelo: or anyone ?  \n17:20\u00a0<jvelo>\u00a0zykes-: it's pretty clear no ? \"java.lang.NoClassDefFoundError: org/apache/http/message/ParserCursor\"  \n17:20\u00a0<jvelo>\u00a0you miss a jar probably  \n17:21\u00a0<zykes->\u00a0something new in 4.3 or ?  \n17:21\u00a0<zykes->\u00a0and not it's not clear when it you've barely worked with tomcat before  \n17:22\u00a0<zykes->\u00a0the library is there: /var/lib/tomcat7/webapps/xwiki/WEB-INF/lib/httpcore-4.2.2.jar  \n17:27\u00a0<zykes->\u00a0jvelo: what else can it be ?  \n17:28\u00a0<Enygma`>\u00a0zykes-: when do you get that?  \n17:28\u00a0<zykes->\u00a0Enygma`: when I start 'service tomcat7 setart'  \n17:30\u00a0<Enygma`>\u00a0zykes-: what do you get if you only do service tomcat stop and then start  \n17:30\u00a0<Enygma`>\u00a0?  \n17:30\u00a0<Enygma`>\u00a0does tomcat close successfully?  \n17:31\u00a0<Enygma`>\u00a0try to isolate the two events (stop and start) and see which one is causing problems  \n17:31\u00a0<jvelo>\u00a0has quit  \n17:32\u00a0<zykes->\u00a0the log I pasted Enygma` is from the startup only  \n17:39\u00a0<zykes->\u00a0nothing exciting there Enygma`  \n17:39\u00a0<tmortagne>\u00a0sburjan: you are mixing too things  \n17:39\u00a0<tmortagne>\u00a0the translation keys are a platform thing  \n17:39\u00a0<tmortagne>\u00a0but translations themself are for l10n wiki  \n17:40\u00a0<sburjan>\u00a0ok, then I moved then wrongly \u00a0:(  \n17:40\u00a0<tmortagne>\u00a0yep  \n17:40\u00a0<jvelo>\u00a0has joined #xwiki  \n17:40\u00a0<sburjan>\u00a0fixing  \n17:40\u00a0<tmortagne>\u00a0that's why I did not moved them ;)  \n17:40\u00a0<sburjan>\u00a0so you report missing translations on platform, but missing keys on l10n  \n17:41\u00a0<sburjan>\u00a0other way around :)  \n17:42\u00a0<tmortagne>\u00a0yes other way around :)  \n17:45\u00a0<polx>\u00a0has quit  \n17:46\u00a0<Enygma`>\u00a0zykes-: don`t know. Try making sure your tomcat is completely dead before starting it again. All I can see from that exception is that your tomcat tells the xwiki webapp to stop, and it does that twice. That should not happen at startup, but I`m not familiar with how tomcat manages its webapps, so I don`t know the reason (error, bad config, etc).  \n17:48\u00a0<abusenius>\u00a0has joined #xwiki  \n17:53\u00a0<jvelo>\u00a0has quit  \n17:56\u00a0<zykes->\u00a0Enygma`: how do you start it then ?  \n17:59\u00a0<jvelo>\u00a0has joined #xwiki  \n18:04\u00a0<sburjan>\u00a0has quit  \n18:06\u00a0<zykes->\u00a0how the hell am I supposed to debug this?!  \n18:08\u00a0<Enygma`>\u00a0zykes-: I only asked to do a \"ps awux | grep tomcat\" and \"ps awux | grep java\" to make sure everything is closed before starting tomcat again. I`m afraid I can`t help you more on this issue.  \n18:11\u00a0<Enygma`>\u00a0zykes-: not sure if it`s your same problem http://stackoverflow.com/questions/4945153/illegal-access-this-web-application-instance-has-been-stopped-already  \n18:19\u00a0<zykes->\u00a0Enygma`: I get alot of these: 2012-11-28 09:15:21,124 [pool-2-thread-1] ERROR ltInstalledExtensionRepository - Invalid extension [org.xwiki.enterprise:xwiki-enterprise-ui-4.3] on namespace [], it will not be loaded  \n18:19\u00a0<zykes->\u00a0http://paste.ubuntu.com/1394937/ < that possibly the error or ?  \n18:29\u00a0<Enygma`>\u00a0zykes-: that certainly looks bad. Maybe tmortagne could tell you more.  \n18:30\u00a0<evalica>\u00a0has quit  \n18:33\u00a0<tmortagne>\u00a0http://paste.ubuntu.com/1394937/ seems to indicate that you have a lot of duplicated jars  \n18:33\u00a0<tmortagne>\u00a0all the \"WARN \u00a0.c.a.ComponentAnnotationLoader\"  \n18:33\u00a0<tmortagne>\u00a0did you do an upgrade or something ?  \n18:33\u00a0<tmortagne>\u00a0did not followed your conversation  \n18:33\u00a0<tmortagne>\u00a0zykes-:  \n18:33\u00a0<zykes->\u00a0tmortagne: yes I did a upgrade  \n18:34\u00a0<tmortagne>\u00a0zykes-: looks like you kept the previous jars and just added the new ones  \n18:34\u00a0<tmortagne>\u00a0itt's probably why you have all theses issues  \n18:34\u00a0<zykes->\u00a0how can I clean up that then ?  \n18:35\u00a0<tmortagne>\u00a0unzip the war and a new clean folder, move there the configuration to want to keep and things like this  \n18:35\u00a0<zykes->\u00a0isn't extensions stored another place ?  \n18:35\u00a0<tmortagne>\u00a0yes but you don't need to move them  \n18:36\u00a0<zykes->\u00a0hmmm, k  \n18:36\u00a0<tmortagne>\u00a0you need to make sure you have the same configuration that's all  \n18:36\u00a0<tmortagne>\u00a0and the new clean war will get the extension from the same place  \n18:36\u00a0<tmortagne>\u00a0you should never unpack a new WAR over an old install  \n18:37\u00a0<tmortagne>\u00a0always create a new clean one and move only things you want to keep  \n18:37\u00a0<zykes->\u00a0I did that :p  \n18:37\u00a0<tmortagne>\u00a0does not seems so  \n18:37\u00a0<tmortagne>\u00a0since you have both versions of the JARs in the same place  \n18:37\u00a0<zykes->\u00a0hmmms  \n18:38\u00a0<Enygma`>\u00a0has quit  \n18:38\u00a0<vmassol>\u00a0has quit  \n18:38\u00a0<tmortagne>\u00a0zykes-: in case you are using a debian based system yopu might be interested in the debian packages which makes all that a lot easier  \n18:38\u00a0<tmortagne>\u00a0and safer  \n18:39\u00a0<tmortagne>\u00a0( see http://platform.xwiki.org/xwiki/bin/view/AdminGuide/InstallationViaAPT )  \n18:40\u00a0<tmortagne>\u00a0has quit  \n18:44\u00a0<silviar>\u00a0has quit  \n18:46\u00a0<mflorea>\u00a0has quit  \n19:10\u00a0<polx>\u00a0has joined #xwiki  \n19:18\u00a0<polx>\u00a0has quit  \n19:22\u00a0<jvelo>\u00a0has quit  \n19:23\u00a0<Denis>\u00a0has joined #xwiki  \n19:24\u00a0<Slashman>\u00a0has quit  \n19:36\u00a0<tdelafosse>\u00a0has quit  \n19:54\u00a0<SvenDowideit>\u00a0has quit  \n19:55\u00a0<SvenDowideit>\u00a0has joined #xwiki  \n20:11\u00a0<vmassol>\u00a0has joined #xwiki  \n20:42\u00a0<polx>\u00a0has joined #xwiki  \n20:52\u00a0<sdumitriu1>\u00a0has joined #xwiki  \n21:12\u00a0<polx>\u00a0has quit  \n21:14\u00a0<polx>\u00a0has joined #xwiki  \n21:15\u00a0<mflorea>\u00a0has joined #xwiki  \n21:24\u00a0<polx>\u00a0has quit  \n21:26\u00a0<polx>\u00a0has joined #xwiki  \n21:43\u00a0<polx>\u00a0has quit  \n21:46\u00a0<vmassol>\u00a0cool thanks AndreasJonsson  \n21:46\u00a0<vmassol>\u00a0:)  \n21:56\u00a0<polx>\u00a0has joined #xwiki  \n21:56\u00a0<vmassol>\u00a0has quit  \n22:13\u00a0<sburjan\\_>\u00a0has joined #xwiki  \n22:22\u00a0<mflorea>\u00a0has quit  \n22:22\u00a0<sburjan`>\u00a0has quit  \n22:22\u00a0<sburjan\\_>\u00a0is now known as <sburjan`>  \n22:28\u00a0<vmassol>\u00a0has joined #xwiki  \n22:31\u00a0<mflorea>\u00a0has joined #xwiki  \n22:36\u00a0<vmassol>\u00a0has quit  \n22:52\u00a0<jvelo>\u00a0has joined #xwiki  \n22:56\u00a0<abusenius>\u00a0has quit  \n23:01\u00a0<mflorea>\u00a0has quit  \n23:26\u00a0<polx>\u00a0has quit  \n23:28\u00a0<polx>\u00a0has joined #xwiki  \n23:32\u00a0<vmassol>\u00a0has joined #xwiki  \n23:37\u00a0<vmassol>\u00a0has quit  \n23:55\u00a0<polx>\u00a0has quit\n"}