{"id": "dev:IRC.xwikiArchive20120127", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20120127", "title": "IRC Archive for channel #xwiki on 27 January 2012 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n00:14\u00a0<abusenius>\u00a0has quit  \n00:44\u00a0<SvenDowideit>\u00a0has quit  \n00:44\u00a0<SvenDowideit>\u00a0has joined #xwiki  \n00:48\u00a0<Enygma`1>\u00a0has quit  \n00:59\u00a0<tekzilla>\u00a0has quit  \n01:00\u00a0<tekzilla>\u00a0has joined #xwiki  \n02:06\u00a0<xwikibot>\u00a0has joined #xwiki  \n02:27\u00a0<xwikibot>\u00a0has joined #xwiki  \n02:46\u00a0<xwikibot>\u00a0has joined #xwiki  \n03:00\u00a0<sdumitriu>\u00a0has quit  \n04:00\u00a0<sdumitriu>\u00a0has joined #xwiki  \n05:14\u00a0<DrLou>\u00a0has quit  \n05:22\u00a0<sdumitriu>\u00a0has quit  \n06:00\u00a0<Denis2>\u00a0has joined #xwiki  \n06:00\u00a0<Denis>\u00a0has quit  \n06:40\u00a0<vmassol>\u00a0has joined #xwiki  \n07:02\u00a0<vmassol>\u00a0has quit  \n07:26\u00a0<cjdelisle>\u00a0is now known as <cjd>  \n08:05\u00a0<mflorea>\u00a0has joined #xwiki  \n08:52\u00a0<Denis2>\u00a0is now known as <Denis>  \n09:16\u00a0<tmortagne>\u00a0has joined #xwiki  \n09:28\u00a0<helge>\u00a0Good morning everybody in the channel. Since it was late yesterday, I raise my question again. I am trying XWiki 3.4 on Linux with Tomcat7 and PostgreSQL. Some Wiki Pages can not render history versions properly. I get error messages like:  \n09:28\u00a0<helge>\u00a0Wrapped Exception: Error number 2002 in 2: Error parsing xml Wrapped Exception: Error on line 111 of document \u00a0: An invalid XML character (Unicode: 0x1c) was found in the element content of the document. Nested exception: An invalid XML character (Unicode: 0x1c) was found in the element content of the document.  \n09:31\u00a0<helge>\u00a0Database encoding is UTF8, also tomcat server.xml, xwiki.cg and web.xml are set to UTF-8.  \n09:35\u00a0<kayasaman>\u00a0has joined #xwiki  \n09:39\u00a0<@cjd>\u00a0can you pastebin the whole exception w/ the stack trace?  \n09:49\u00a0<Enygma`>\u00a0has joined #xwiki  \n10:03\u00a0<xipe\\_>\u00a0has quit  \n10:05\u00a0<sburjan\\_>\u00a0has joined #xwiki  \n10:09\u00a0<sburjan`>\u00a0has quit  \n10:09\u00a0<sburjan\\_>\u00a0is now known as <sburjan`>  \n11:04\u00a0<kwoot>\u00a0has joined #xwiki  \n11:12\u00a0<evalica>\u00a0has joined #xwiki  \n11:46\u00a0<xipe\\_>\u00a0has joined #xwiki  \n12:12\u00a0<sdumitriu>\u00a0has joined #xwiki  \n12:44\u00a0<helge>\u00a0This is the complete exception:  \n12:44\u00a0<helge>\u00a0Detailed information: \u00a0\u00a0\u00a0\u00a0\u00a0Error number 3103 in 3: Exception while reading version [2.1] for document id [1.494.379.305] Wrapped Exception: Error number 2002 in 2: Error parsing xml Wrapped Exception: Error on line 111 of document \u00a0: An invalid XML character (Unicode: 0x1c) was found in the element content of the document. Nested exception: An invalid XML character (Unicode: 0x1c) was found in the element content of the document. com.xp  \n12:47\u00a0<@sdumitriu>\u00a0That really looks like wrong encoding to me... Do you have raw access to the database to get the exact content of the table row?  \n12:52\u00a0<helge>\u00a0Sorry, here is the link to pastebin: http://pastebin.de/22793  \n12:56\u00a0<helge>\u00a0here is the database encoding: http://pastebin.de/22795  \n12:56\u00a0<kwoot>\u00a0has quit  \n12:59\u00a0<@sdumitriu>\u00a0helge: I don't know postgresql that well, but mysql allows tables (and even columns) to have different encoding; can you check if the xwikircs table has the right encoding?  \n13:04\u00a0<helge>\u00a0Thank you Dumitriu, I will check that.  \n13:34\u00a0<kayasaman>\u00a0has quit  \n13:35\u00a0<mflorea>\u00a0has quit  \n13:44\u00a0<@sdumitriu>\u00a0helge: Are you the one that reported http://jira.xwiki.org/browse/XE-1102 ?  \n13:54\u00a0<helge>\u00a0Dumitriu: I did not report this issue before. Meanwhile I learned that Postgres does not support enconding on a Teble level. Hence, xwikircs shuld be UTF-8 since tha tatabase is so.  \n13:55\u00a0<@sdumitriu>\u00a0Can you pastebin the table schemas for xwikidoc and xwikircs?  \n14:08\u00a0<kayasaman>\u00a0has joined #xwiki  \n14:14\u00a0<mflorea>\u00a0has joined #xwiki  \n14:26\u00a0<helge>\u00a0here is xwikidoc schema: http://pastebin.de/22801  \n14:28\u00a0<helge>\u00a0this is xwikircs: http://pastebin.de/22803  \n14:32\u00a0<@sdumitriu>\u00a0That looks good...  \n14:34\u00a0<@cjd>\u00a0try \\l in psql just to make sure it's utf8  \n14:36\u00a0<kayasaman>\u00a0has quit  \n14:38\u00a0<CIA-32>\u00a0tmortagne\u000f master\u000f \\* rdf962b9\u000f \u000f/ (24 files in 8 dirs):\u000f XWIKI-7456: Jar extensions are reloaded even if no jar has been ...  \n14:42\u00a0<helge>\u00a0\\l output is: \u00a0xwiki \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0| postgres | UTF8 \u00a0\u00a0\u00a0\u00a0| de\\_DE.UTF-8 | de\\_DE.UTF-8 |  \n15:03\u00a0<+tmortagne>\u00a0sdumitriu: just created XWIKI-7457, it's pretty recent since I think I used it in 3.4  \n15:04\u00a0<+tmortagne>\u00a0(but did not tried 3.4 final)  \n15:23\u00a0<DrLou\\_>\u00a0has joined #xwiki  \n15:24\u00a0<+tmortagne>\u00a0sdumitriu: just checked and it works well on 3.4 final  \n15:24\u00a0<+tmortagne>\u00a0copy pasted some js error I get in firebug when loading the page  \n15:30\u00a0<@sdumitriu>\u00a0tmortagne: I'll look  \n15:31\u00a0<+tmortagne>\u00a0sdumitriu: ok thanks, currently testing with a jetty/hsqldb build from jenkins  \n15:31\u00a0<@sdumitriu>\u00a0helge: Can you try one more thing? Extract xwiki.hbm.xml from WEB-INF/lib/xwiki-platform-legacy-oldcore-\\*.jar into WEB-INF/classes and change the \"content\" property of the \"XWikiRCSNodeContent\" class from \"materialized\\_clob\" to \"text\", then restart the server  \n15:31\u00a0<@sdumitriu>\u00a0It won't work for the existing history, but try to create a new document  \n15:32\u00a0<+tmortagne>\u00a0seems to work with latest jetty/hsqldb build  \n15:35\u00a0<+tmortagne>\u00a0sdumitriu: do you use smartclient for it ?  \n15:37\u00a0<@sdumitriu>\u00a0No  \n15:37\u00a0<@sdumitriu>\u00a0It's just some JS  \n15:37\u00a0<+tmortagne>\u00a0ok so I don't see why it does not work in xwiki-debug-eclipse  \n15:38\u00a0<@sdumitriu>\u00a0Does it include prototype.js?  \n15:40\u00a0<+tmortagne>\u00a0isn't prototype in xwiki-platform-web ?  \n15:40\u00a0<@sdumitriu>\u00a0Yes  \n15:41\u00a0<@sdumitriu>\u00a0tmortagne: Ah, again it has lots of \"get\" inserted  \n15:41\u00a0<+tmortagne>\u00a0and I can find a resources/js/prototype/prototype.js  \n15:41\u00a0<@sdumitriu>\u00a0rhino version  \n15:41\u00a0<@sdumitriu>\u00a0Check the classpath  \n15:43\u00a0<+tmortagne>\u00a0to find a rhino jar ?  \n15:44\u00a0<+tmortagne>\u00a0not sure what you mean by \"it has lots of \"get\" inserted\"  \n15:44\u00a0<@sdumitriu>\u00a0.down(\"div\").toggleClassName(\"hidden\")}get );  \n15:47\u00a0<+tmortagne>\u00a0so what should I search ?  \n15:47\u00a0<@sdumitriu>\u00a0batik-js or rhino  \n15:48\u00a0<+tmortagne>\u00a0I should have or not have it ?  \n15:48\u00a0<+tmortagne>\u00a0not have it, right ?  \n15:48\u00a0<+tmortagne>\u00a0I found batik-js which is not in the jetty/hsqldb package  \n15:49\u00a0<+tmortagne>\u00a0that's weird it's the first time have this kind of issue with xwiki-debug-eclipse  \n15:50\u00a0<@sdumitriu>\u00a0Not have  \n15:51\u00a0<@sdumitriu>\u00a0Check why it's being pulled  \n15:52\u00a0<+tmortagne>\u00a0hmm less error after removing it (it comes from olcore->fop) but still the get thing  \n15:53\u00a0<+tmortagne>\u00a0and I don't have rhino  \n15:53\u00a0<+tmortagne>\u00a0maybe browser cache  \n15:54\u00a0<+tmortagne>\u00a0yep that was it, better after a cache refresh  \n15:54\u00a0<+tmortagne>\u00a0sdumitriu: thanks  \n15:57\u00a0<CIA-32>\u00a0tmortagne\u000f master\u000f \\* rbb438e7\u000f \u000f/ pom.xml :\u000f batik-js cause lots of issues with prototype - http://git.io/HzyUmw  \n16:03\u00a0<+tmortagne>\u00a0sdumitriu: just got \"Unknown macro: warn\" on AddExtensions, looks like there is one left somewhere  \n16:06\u00a0<+tmortagne>\u00a0on InstalledExtensions too (probably the same one I guess)  \n16:11\u00a0<@sdumitriu>\u00a0Checking  \n16:12\u00a0<@sdumitriu>\u00a0It's supposed to be the same macro  \n16:13\u00a0<@sdumitriu>\u00a0Checking if there's some code that doesn't call the macro and instead prints its own log  \n16:14\u00a0<@sdumitriu>\u00a0Nope, shouldn't happen  \n16:14\u00a0<@sdumitriu>\u00a0Are you sure you're using the right version?  \n16:15\u00a0<@sdumitriu>\u00a0Ah, wait  \n16:16\u00a0<@sdumitriu>\u00a0You lost my change  \n16:17\u00a0<@sdumitriu>\u00a0Check my github comment  \n16:20\u00a0<helge>\u00a0@sdumitriu: I did as you suggested and will try to reproduce the error in a new page. I keep you informed. Thanks a lot, Helge.  \n16:24\u00a0<@sdumitriu>\u00a0tmortagne: You'll be the release manager for 3.5 or for 4.0?  \n16:25\u00a0<+tmortagne>\u00a0sdumitriu: 40  \n16:25\u00a0<+tmortagne>\u00a04.0  \n16:25\u00a0<@sdumitriu>\u00a0And mflorea for 3.5?  \n16:25\u00a0<+tmortagne>\u00a0didn't mfloreasaif he would do 3.5 ?  \n16:25\u00a0<+mflorea>\u00a0yes  \n16:26\u00a0<+mflorea>\u00a0I said I will do 3.5  \n16:26\u00a0<@sdumitriu>\u00a0Great  \n16:32\u00a0<CIA-32>\u00a0tmortagne\u000f master\u000f \\* r91093a3\u000f \u000f/ xwiki-platform-core/xwiki-platform-extension/xwiki-platform-extension-ui/src/main/resources/XWiki/ExtensionManagerMacros.xml :\u000f XWIKI-7458: Getting \"Unknown macro: warn\" instead of the actual warning when installing/uninstalling an extension - http://git.io/1pquyg  \n16:47\u00a0<evalica1>\u00a0has joined #xwiki  \n16:48\u00a0<Enygma`1>\u00a0has joined #xwiki  \n16:50\u00a0<Enygma`>\u00a0has quit  \n16:52\u00a0<evalica>\u00a0has quit  \n16:56\u00a0<vmassol>\u00a0has joined #xwiki  \n16:56\u00a0<helge>\u00a0@sdumitriu: I could not reproduce the Encoding Exception, but I get another error when I want to see versions of documents which worked fine before: http://pastebin.de/22810  \n17:07\u00a0<+mflorea>\u00a0sdumitriu, vmassol, tmortagne: [quick vote] PropertyClass has many displayXYZ methods, where XYZ in {Custom, Edit, Hidden, View}. For all display modes, except \"Custom\", there is a display method signature that returns a String. displayCustom put the result in a StringBuffer that is received as a parameter. I'd like to add the missing signatures, same as for the rest of display modes.  \n17:07\u00a0<+mflorea>\u00a0I need this for AppWithinMinutes  \n17:08\u00a0<+mflorea>\u00a0i.e. I need a displayCustom that returns a String instead of taking a StringBuffer as parameter  \n17:09\u00a0<+mflorea>\u00a0all the rest, displayView, displayEdit, displayHidden, have this signature  \n17:09\u00a0<@sdumitriu>\u00a0+1  \n17:09\u00a0<@sdumitriu>\u00a0StringBuffer is bad for performance, anyway  \n17:09\u00a0<+mflorea>\u00a0yes  \n17:09\u00a0<@sdumitriu>\u00a0That method should be deprecated  \n17:10\u00a0<+mflorea>\u00a0was replaced with StringBuilder  \n17:12\u00a0<+tmortagne>\u00a0+1 and same comment about StringBuffer that should never be used for things like that since StringBuilder exists  \n17:12\u00a0<+mflorea>\u00a0yes, this API is pretty old  \n17:12\u00a0<+tmortagne>\u00a0yep  \n17:17\u00a0<CIA-32>\u00a0tmortagne\u000f master\u000f \\* rdc6ef31\u000f \u000f/ xwiki-platform-core/xwiki-platform-extension/xwiki-platform-extension-handlers/xwiki-platform-extension-handler-jar/src/main/java/org/xwiki/extension/jar/internal/handler/JarExtensionHandler.java :\u000f XWIKI-7460: Jar handler should allow components in any order in the ...  \n17:53\u00a0<mflorea>\u00a0has quit  \n17:58\u00a0<tmortagne>\u00a0has quit  \n18:24\u00a0<abusenius>\u00a0has joined #xwiki  \n19:27\u00a0<npm>\u00a0has quit  \n19:27\u00a0<helge>\u00a0has quit  \n21:27\u00a0<vmassol>\u00a0has quit  \n22:13\u00a0<Denis>\u00a0has quit  \n22:23\u00a0<kayasaman>\u00a0has joined #xwiki  \n22:36\u00a0<rrodriguez>\u00a0has joined #xwiki  \n22:46\u00a0<rrodriguez>\u00a0has quit  \n22:47\u00a0<rrodriguez>\u00a0has joined #xwiki  \n22:50\u00a0<evalica1>\u00a0has quit  \n23:05\u00a0<sburjan`>\u00a0what was that  \n23:05\u00a0<@sdumitriu>\u00a0Whu, Wurst?  \n23:05\u00a0<sburjan`>\u00a0yes  \n23:05\u00a0<@sdumitriu>\u00a0Advertisement for free cam sex  \n23:06\u00a0<@sdumitriu>\u00a0Actually I don't remember if it was free or not  \n23:06\u00a0<@sdumitriu>\u00a0Probably \u00a0jot  \n23:06\u00a0<@sdumitriu>\u00a0not  \n23:06\u00a0<sburjan`>\u00a0:))  \n23:07\u00a0<sburjan`>\u00a0i see the bot still confuses modifying users  \n23:07\u00a0<@sdumitriu>\u00a0Yep  \n23:07\u00a0<@sdumitriu>\u00a0Make a bug report and I'll fix it  \n23:07\u00a0<@sdumitriu>\u00a0Not on the bot, on oldcore  \n23:08\u00a0<sburjan`>\u00a0this comes from oldcore ?  \n23:08\u00a0<sburjan`>\u00a0related to Events ?  \n23:11\u00a0<@sdumitriu>\u00a0Related to the event listener that removes deleted users from groups  \n\n"}