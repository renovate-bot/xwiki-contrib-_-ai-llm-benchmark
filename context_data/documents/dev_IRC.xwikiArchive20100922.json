{"id": "dev:IRC.xwikiArchive20100922", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20100922", "title": "IRC Archive for channel #xwiki - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\nphancox joined #xwiki at 00:07  \nflaviusolaru left at 00:07 (Quit: Leaving.  \nrrodriguez\\_ - (00:10): sdumitriu\\_: don't you think it is worth to include XAADMINISTRATION 1.38 with XE 2.4.1? Excuse me if this is simply not possible due the live cycle of new patches.  \nsdumitriu - (00:10): It would be possible, maybe Thomas will include it  \nrrodriguez\\_ - (00:17): Thanks.  \nsdumitriu left at 00:18 (Quit: Leaving.  \nmflorea left at 00:24 (Quit: Leaving.  \njvdrean joined #xwiki at 00:33  \njvdrean left at 00:35 (Client Quit  \nEnygma` left at 00:37 (Read error: Connection reset by peer  \nEnygma` joined #xwiki at 00:37  \nEnygma` left at 00:55 (Ping timeout: 252 seconds  \nrrodriguez\\_ left at 01:23 (Quit: rrodriguez\\_  \nvenkatesh joined #xwiki at 04:40  \nabusenius left at 04:45 (Read error: Operation timed out  \nrrodriguez joined #xwiki at 06:58  \nztane\\_ left at 07:00 (Remote host closed the connection  \nztane left at 07:00 (Remote host closed the connection  \nDenis left at 07:04 (Ping timeout: 276 seconds  \nDenis joined #xwiki at 07:09  \nvmassol joined #xwiki at 08:04  \nmflorea joined #xwiki at 08:05  \nvmassol left at 08:06 (Client Quit  \nmflorea left at 08:16 (Quit: Leaving.  \nmflorea joined #xwiki at 08:17  \nrrodriguez left at 08:18 (Quit: rrodriguez  \nasrfel joined #xwiki at 08:26  \njvdrean joined #xwiki at 08:40  \nkwoot joined #xwiki at 08:42  \nsburjan joined #xwiki at 09:06  \nEnygma` joined #xwiki at 09:09  \narkub joined #xwiki at 09:21  \njvdrean left at 09:26 (Quit: Leaving.  \ntmortagne joined #xwiki at 09:30  \nkwoot left at 09:35 (Ping timeout: 252 seconds  \nlucaa joined #xwiki at 09:37  \nEnygma` left at 09:38 (Ping timeout: 265 seconds  \nrrodriguez joined #xwiki at 09:38  \nEnygma` joined #xwiki at 09:40  \njvdrean joined #xwiki at 10:05  \nmflorea - (10:12): tmortagne: when a wiki macro is evaluated, the context document is the document that hold the macro definition. I was expecting it to be the document that uses the macro. The problem is that if you have a parameter that is a reference and you want to resolve it relative to the current document, you don't get the right entity reference. I think this was discussed before but I don't remember what was the conclusion.  \njvdrean left at 10:13 (Read error: Connection reset by peer  \njvdrean1 joined #xwiki at 10:13  \ntmortagne - (10:14): mflorea: use $doc which is not the same as $context.doc in wiki macros  \nmflorea - (10:14): tmortagne: I'm not using $doc, I'm calling a service that use document access bridge to get the current document  \ntmortagne - (10:14): the problem is that currently having the wiki macro document as context document is the only way to execute is with the proper user rights  \ntmortagne - (10:15): so currently there is nothing we can do at wiki macro level  \ntmortagne - (10:15): we need to refactor the way programming right is tested  \nmflorea - (10:15): I see, then what option do I have? It doesn't feel right to pass the current doc reference to the service  \ntmortagne - (10:15): see http://jira.xwiki.org/jira/browse/XWIKI-4262  \nmflorea - (10:16): (this is another reason for making the office preview macro a Java macro)  \ntmortagne - (10:19): mflorea: what does the service do ?  \nmflorea - (10:21): preview the specified attachment, i.e. convert it to HTML and return the result. The attachment is specified by its reference, which can be relative. So you can write $services.officepreview(\"file.doc\", false)  \ntmortagne - (10:22): can't you give the full reference of the attachment for now ?  \nbblfish left at 10:22 (Quit: Leaving.  \ntmortagne - (10:23): you resolve it in the wiki macro before calling officepreview  \ntmortagne - (10:24): you can give $doc.documentReference to teh resolver  \ntmortagne - (10:24): s/teh/the/  \nmflorea - (10:24): can I resolve the relative reference in velocity? I think I need groovy. Anyway, I prefer to write a Java macro than doing this, since the officepreview macro is just a wrapper for the office preview service  \ntmortagne - (10:25): i think there is a service for resolving reference  \ntmortagne - (10:25): let me check  \ntmortagne - (10:27): indeed ModelScriptService does have any variable supporting custom resolver parameters  \ntmortagne - (10:27): but it should  \ntmortagne - (10:27): s/variable/method/  \ntmortagne - (10:27): the important things is that there is a $services.model  \nmflorea - (10:28): ok, so it can be enhanced  \ntmortagne - (10:28): yes and should be  \ntmortagne - (10:29): actually there should be a method to get a reolver/serializer i think to not add helper methods indefinitely directly in the model service  \nkwoot joined #xwiki at 10:32  \ntmortagne left at 10:35 (Read error: Connection reset by peer  \ntmortagne joined #xwiki at 10:35  \nbblfish joined #xwiki at 10:43  \nvmassol joined #xwiki at 10:44  \nbblfish left at 10:49 (Ping timeout: 276 seconds  \nsdumitriu joined #xwiki at 10:49  \nlpereira joined #xwiki at 10:53  \nsilviar joined #xwiki at 10:54  \nphancox left #xwiki at 10:56  \nbblfish joined #xwiki at 11:03  \ntmortagne - (11:12): guys, i'm currentlt preparing the 2.4.1 release, say it quickly if there is any blocker  \nsdumitriu - (11:13): No regressions, AFAIK  \nsdumitriu - (11:13): Don't release the new skins, use the old ones  \nsdumitriu - (11:13): Don't use the new panels  \nsdumitriu - (11:14): The rest should be OK  \ntmortagne - (11:14): ok (whould be nice to lock down the version in XE pom when an app/skin/plugin become incompatible)  \ntmortagne - (11:16): silviar: don't touch it too much i still have it in edit on my side  \nabusenius joined #xwiki at 11:17  \nrrodriguez left at 11:18 (Quit: rrodriguez  \nsilviar - (11:21): tmortagne: Hi! I only fixed the macros; no more editing for this doc planned any time soon  \ntmortagne - (11:22): silviar: this is actually a bug it the macro itself, they where in the right place ;)  \ntmortagne - (11:24): fixed  \nsilviar - (11:24): yup, there was the macro bug and \u00a0also some spelling issues :)  \nsilviar - (11:24): great!  \nEnygma` left at 11:32 (Quit: Leaving.  \nEnygma` joined #xwiki at 11:32  \nabusenius left at 11:39 (Ping timeout: 272 seconds  \nrrodriguez joined #xwiki at 11:41  \nsilviar left at 11:50 (Quit: Leaving.  \nvmassol left at 12:00 (Quit: Leaving.  \nvmassol joined #xwiki at 12:00  \nrrodriguez left at 12:01 (Quit: rrodriguez  \ncjdelisle - (12:37): Would it be too ugly to get the velocityContext from the context and use that to get $doc for the OfficePreview macro?  \ntmortagne - (12:44): cjdelisle: yes it would be pretty ugly to do that in a java service which should not know about this wiki macro specific hack plus, what is even worst, having to depends on velocity in a component that should not even know about it at all  \ncjdelisle - (12:45): I was thinking for the wiki macro but I guess then the problem is resolving the full reference.  \ntmortagne - (12:46): cjdelisle: the wiki macros does not have any issue to get the current document  \ncjdelisle - (12:46): Ok, I guess I didn't understand the problem then.  \ntmortagne - (12:47): the problem is that the service itself is looking at current document  \ntmortagne - (12:47): when you only give the attachement name and not its full reference  \ntmortagne - (12:47): bu at service level you loose the velocity context and only count on context document  \ntmortagne - (12:48): the only solution is to find a clean way to fix XWIKI-4262  \ncjdelisle - (12:49): Everything always seems to come back to \"put signatures on scripts and make them portable\"  \nrrodriguez joined #xwiki at 12:50  \nflorinciu joined #xwiki at 12:54  \nrrodriguez left at 12:55 (Client Quit  \nrrodriguez joined #xwiki at 12:57  \nabusenius joined #xwiki at 13:05  \narkub left at 13:05 (Ping timeout: 272 seconds  \nsilviar joined #xwiki at 13:17  \nrrodriguez left at 13:20 (Quit: rrodriguez  \nrrodriguez joined #xwiki at 13:22  \nflaviusolaru joined #xwiki at 13:22  \nabusenius left at 13:26 (Ping timeout: 276 seconds  \ntmortagne - (13:27): yep  \narkub joined #xwiki at 13:52  \nrrodriguez left at 14:00 (Quit: rrodriguez  \nrrodriguez joined #xwiki at 14:06  \njvdrean1 left at 14:10 (Quit: Leaving.  \njvdrean joined #xwiki at 14:11  \nmflorea - (14:12): tmortagne: \u00a0what happens if I set the cache size to 0 or -1?  \nmflorea - (14:12): LRUEvictionConfiguration lec = new LRUEvictionConfiguration();  \nmflorea - (14:12): lec.setMaxEntries(0);  \nmflorea - (14:12): Can I use -1 to disable the cache?  \njvdrean left at 14:12 (Client Quit  \ntmortagne - (14:13): mflorea: infinite i think i would need to check to be sure  \ntmortagne - (14:14): it's possible 0 is 0 entries, i.e. disable the cache as you say but it's not really disabled  \ntmortagne - (14:14): let me finish something and i'm looking  \nmflorea - (14:14): ok, thanks  \ntmortagne - (14:19): btw i don't see the point of disabling cache from JAVA, if it's for a test in a runtime you can use configuration for to setup any configuration of any cache  \ntmortagne - (14:19): (see http://code.xwiki.org/xwiki/bin/view/Modules/CacheModule)  \nabusenius joined #xwiki at 14:20  \ntmortagne - (14:36): mflorea:  \ntmortagne - (14:36): -1: infinite, there is no maximum  \ntmortagne - (14:36): 0: as far as i can see in the source (could not find documentation on that on jbosscache doc) it means that the cache contains 0 element maximum which mean that any element that you put in it will be automatically evicted  \nmflorea - (14:36): tmortagne: I see, thanks a lot!  \ntmortagne - (14:37): but eviction in JBossCache is a bit tricky, it a daemon thread which check the cache at some interval  \ntmortagne - (14:37): so you cache entry will be in the cache for 5 seconds max by default i think  \nmflorea - (14:37): ah, so the entry could stay in cache for a while before the daemon is triggered  \nmflorea - (14:37): right  \ntmortagne - (14:38): you can force another value for the interval if you like, but again wouldn't it be easier for you to do it from configuration ? unless it's for unit tests ?  \ntmortagne - (14:40): mflorea: you can set the custom property \"wakeupinterval\" to an int in millisecond to change the eviction thread wakeup interval  \ntmortagne - (14:41): in the EntryEvictionConfiguration part  \ntmortagne - (14:42): so for you it's  \ntmortagne - (14:42): lec.put(\"wakeupinterval\", 1000);  \ntmortagne - (14:42): or less  \nmflorea - (14:43): ok, but calling the daemon too often might be costly. anyway, I was just curios, I as documenting the cacheSize config property of officepreview component and I didn't knew what happens if the users sets this to 0 or a negative value.  \ntmortagne - (14:43): ok  \nmflorea - (14:44): thanks for the explanation ;)  \ntmortagne - (14:44): np :)  \nasrfel left at 14:44 (Quit: Leaving.  \nasrfel joined #xwiki at 14:45  \ntmortagne - (14:45): mflorea: is it really needed to have this cacheSize property ?  \ntmortagne - (14:45): would this be commonly changed  \ntmortagne - (14:45): since there is already a system to set any cache configuration  \nmflorea - (14:46): I inherited from Asiri. I haven't though about it.  \ntmortagne - (14:46): and with a lot more than just the cache size  \ntmortagne - (14:46): IMO until it's really needed you should remove that  \nmflorea - (14:46): ok, so you say that you can configure the cache of the officepreview component in a better way?  \ntmortagne - (14:47): you can settup any cache using http://code.xwiki.org/xwiki/bin/view/Modules/CacheModule#HOverwritecacheconfigurationinconfigurationfile28implementationspecific29  \ntmortagne - (14:47): you just need to know it's id  \ntmortagne - (14:48): the id put into CacheConfiguration  \nmflorea - (14:48): ok, so I could set this id instead of using the cacheSize configuration property  \ntmortagne - (14:48): and it's better because you are configuring directly with the implementation configuration so you can really settup anything (and there is a lot of thing you can control in jboxxcache)  \nmflorea - (14:49): the id is not set right now  \ntmortagne - (14:49): mflorea: you have to set an id anyway  \nmflorea - (14:50): http://svn.xwiki.org/svnroot/xwiki/platform/core/trunk/xwiki-officepreview/src/main/java/org/xwiki/officepreview/internal/AbstractOfficePreviewBuilder.java  \nmflorea - (14:50): look for the initialize method, no Id is set  \ntmortagne - (14:50): mflorea: ok but it does not mean it's right :)  \nmflorea - (14:52): indeed  \ntmortagne - (14:52): look pretty much anywhere else in xwiki and you will see an id set  \nmflorea - (14:53): ok, I'll remove the cacheSize propperty and set the id  \ntmortagne - (14:53): it's working in most case without it but the cache module document say you should set it ;)  \nmflorea - (14:53): I guess the id should be the name of the module, i.e. officepreview  \n\n"}