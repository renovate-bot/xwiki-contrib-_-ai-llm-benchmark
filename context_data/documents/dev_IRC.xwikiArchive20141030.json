{"id": "dev:IRC.xwikiArchive20141030", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20141030", "title": "IRC Archive for channel #xwiki on 30 October 2014 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<vmassol>\u00a0has quit  \n00:43\u00a0<vmassol>\u00a0has joined #xwiki  \n00:47\u00a0<vmassol>\u00a0interesting for us: http://blog.getbootstrap.com/2014/10/29/bootstrap-3-3-0-released/  \n01:29\u00a0<vmassol>\u00a0has quit  \n02:18\u00a0<ebullient1>\u00a0has joined #xwiki  \n02:21\u00a0<ebullient>\u00a0has quit  \n07:08\u00a0<msmeria>\u00a0has joined #xwiki  \n07:14\u00a0<mflorea>\u00a0has joined #xwiki  \n08:26\u00a0<KermitTheFragger>\u00a0has joined #xwiki  \n08:29\u00a0<Lyes>\u00a0has joined #xwiki  \n08:30\u00a0<Lyes>\u00a0has quit  \n08:32\u00a0<Lyes>\u00a0has joined #xwiki  \n08:41\u00a0<AFKGeek>\u00a0has joined #xwiki  \n08:44\u00a0<mflorea>\u00a0has quit  \n08:52\u00a0<vmassol>\u00a0has joined #xwiki  \n08:53\u00a0<cjd>\u00a0has joined #xwiki  \n09:15\u00a0<woshilapin>\u00a0has joined #xwiki  \n09:16\u00a0<DarkKnightCZ>\u00a0has joined #xwiki  \n09:29\u00a0<vmassol>\u00a0good morning  \n09:29\u00a0<vmassol>\u00a0reminder: BFD today :)  \n09:34\u00a0<gdelhumeau>\u00a0has joined #xwiki  \n09:52\u00a0<mflorea>\u00a0has joined #xwiki  \n09:52\u00a0<mflorea>\u00a0has quit  \n09:52\u00a0<mflorea1>\u00a0has joined #xwiki  \n09:53\u00a0<yaronr>\u00a0has joined #xwiki  \n09:54\u00a0<yaronr>\u00a0Trying to run xWiki w/ tomcat 7 & mysql. Getting the following error: Cannot load JDBC driver class 'com.mysql.jdbc.Driver'. \u00a0Yes, I have placed the mysql-connector-..jar in the webapps/xwiki/WEB-INF/lib (and also tried the tomcat/lib)  \n09:55\u00a0<cjd>\u00a0has quit  \n09:57\u00a0<cjd>\u00a0has joined #xwiki  \n09:59\u00a0<vmassol>\u00a0note: edy forgot to send the BFD email remainder but today is BFD :)  \n10:06\u00a0<woshilapin>\u00a0has quit  \n10:08\u00a0<woshilapin>\u00a0has joined #xwiki  \n10:09\u00a0<yaronr>\u00a0has left #xwiki  \n10:20\u00a0<tmortagne>\u00a0has joined #xwiki  \n10:38\u00a0<lucaa>\u00a0has joined #xwiki  \n10:41\u00a0<evalica>\u00a0has joined #xwiki  \n10:42\u00a0<Enygma`>\u00a0has joined #xwiki  \n10:44\u00a0<lucaa>\u00a0has quit  \n10:56\u00a0<lucaa>\u00a0has joined #xwiki  \n11:21\u00a0<gdelhumeau>\u00a0guys, I have found a stupid bug  \n11:21\u00a0<gdelhumeau>\u00a0$mathtool.toDouble(\"2.1\") depends on the locale  \n11:21\u00a0<gdelhumeau>\u00a0on my french computer, \".\" means nothing  \n11:21\u00a0<gdelhumeau>\u00a0so it returns \"2\"  \n11:22\u00a0<gdelhumeau>\u00a0but $mathtool.toDouble(\"2,1\") returns \"2.1\"  \n11:23\u00a0<ClemensR>\u00a0has joined #xwiki  \n11:24\u00a0<vmassol>\u00a0interesting....  \n11:24\u00a0<vmassol>\u00a0indeed  \n11:24\u00a0<vmassol>\u00a0public Number toNumber(Object num) {  \n11:24\u00a0<vmassol>\u00a0}  \n11:24\u00a0<vmassol>\u00a0but  \n11:24\u00a0<vmassol>\u00a0there's a set locale I believe  \n11:25\u00a0<vmassol>\u00a0wait checking  \n11:25\u00a0<vmassol>\u00a0it's a bug of our usage  \n11:25\u00a0<vmassol>\u00a0not of the tool  \n11:25\u00a0<vmassol>\u00a0you need to call setLocale() first  \n11:25\u00a0<gdelhumeau>\u00a0XWIKI-11343  \n11:26\u00a0<vmassol>\u00a0I've replied  \n11:28\u00a0<Enygma`>\u00a0yeah, that is a real PITA that I think nobody considers until it bytes  \n11:28\u00a0<vmassol>\u00a0bites ;)  \n11:28\u00a0<gdelhumeau>\u00a0replied too  \n11:28\u00a0<Enygma`>\u00a0yeah, was about to currect :)  \n11:28\u00a0<Enygma`>\u00a0\\*correct  \n11:28\u00a0<gdelhumeau>\u00a0do we have a velocity tool to get any locale we want?  \n11:28\u00a0<vmassol>\u00a0errrr  \n11:28\u00a0<vmassol>\u00a0$mathtool.setLocale() in this case  \n11:29\u00a0<vmassol>\u00a0you want to get the current locale?  \n11:29\u00a0<vmassol>\u00a0$mathttol.getLocale()  \n11:30\u00a0<vmassol>\u00a0not sure I understand what you want ;)  \n11:30\u00a0<gdelhumeau>\u00a0protected void setLocale(java.util.Locale locale)  \n11:30\u00a0<gdelhumeau>\u00a0I want the english locale  \n11:30\u00a0<gdelhumeau>\u00a0I don't want the current one  \n11:30\u00a0<vmassol>\u00a0so what's the issue?  \n11:30\u00a0<vmassol>\u00a0we force using \"2.1\"?  \n11:30\u00a0<gdelhumeau>\u00a0I already have the current one and it is the issue  \n11:30\u00a0<vmassol>\u00a0it's a harcoded string  \n11:30\u00a0<vmassol>\u00a0oh it's the wiki syntax  \n11:30\u00a0<tmortagne>\u00a0gdelhumeau: you don't need to create a Locale instance, it will be converter automatically  \n11:30\u00a0<tmortagne>\u00a0just put a string in parameter  \n11:30\u00a0<vmassol>\u00a0so you want to force to use the english locale  \n11:30\u00a0<vmassol>\u00a0right?  \n11:30\u00a0<gdelhumeau>\u00a0right  \n11:31\u00a0<Enygma`>\u00a0can we pretty please do something about this annoying bug [ERROR] Failed to execute goal org.xwiki.platform:xwiki-platform-tool-packager-plugin:6.3-SNAPSHOT:package (default) on project xwiki-platform-activeinstalls-test-tests: Failed to dispose XWiki context: Cache 'configuration.document.space' is in 'TERMINATED' state and so it does not accept new invocations. Either restart it or recreate the cache container. -> [Help 1]?  \n11:31\u00a0<Enygma`>\u00a0http://ci.xwiki.org/job/xwiki-platform/318/console  \n11:31\u00a0<tmortagne>\u00a0s/converter/converted/  \n11:31\u00a0<Enygma`>\u00a0\"Cache 'configuration.document.space' is in 'TERMINATED' state and so it does not accept new invocations. Either restart it or recreate the cache container. \"  \n11:31\u00a0<ClemensR>\u00a0gdelhumeau: better scrap the conversion in the mathtool at all ... it is not really needed  \n11:31\u00a0<Enygma`>\u00a0it keeps annoying us for the past 1-2 weeks  \n11:32\u00a0<gdelhumeau>\u00a0tmortagne: but setLocale is not public actually  \n11:32\u00a0<vmassol>\u00a0indeed gdelhumeau the issue  \n11:32\u00a0<vmassol>\u00a0is that the way the mathtool works  \n11:32\u00a0<vmassol>\u00a0is that you need to set the locale in its config  \n11:32\u00a0<vmassol>\u00a0which doesn't work for us  \n11:32\u00a0<gdelhumeau>\u00a0ClemensR: yes. It is used in some places to do some comparision: syntax < currentSyntax, stuff like that  \n11:32\u00a0<gdelhumeau>\u00a0ClemensR: I did not want to change the logic of it  \n11:32\u00a0<yaronr>\u00a0has joined #xwiki  \n11:32\u00a0<ClemensR>\u00a0oh, duh :(  \n11:33\u00a0<vmassol>\u00a0for example: http://www.java2s.com/Code/Java/Velocity/VelocityNumberToolCurrencyLocale.htm  \n11:33\u00a0<yaronr>\u00a0Where are xwiki extensions stored? on the filesystem or in the DB?  \n11:33\u00a0<vmassol>\u00a0bad example  \n11:33\u00a0<Enygma`>\u00a0tmortagne: any idea about this caching issue and what might cause it http://ci.xwiki.org/job/xwiki-platform/318/console ?  \n11:34\u00a0<Enygma`>\u00a0I also see it some times when I close my local wiki  \n11:34\u00a0<gdelhumeau>\u00a0yaronr: most of them are on the DB  \n11:34\u00a0<gdelhumeau>\u00a0the others can not be installed via Extension Manager, and are on the FS  \n11:34\u00a0<tmortagne>\u00a0Enygma`: it's probably an order issue when the component are disposed  \n11:34\u00a0<Enygma`>\u00a0most likely  \n11:35\u00a0<Enygma`>\u00a0gdelhumeau: did we re-enable http://ci.xwiki.org/job/xwiki-enterprise-test-webstandards/ ?  \n11:35\u00a0<yaronr>\u00a0gdelhumeau thanks. Is three a way to install them via shell?  \n11:35\u00a0<ClemensR>\u00a0the information which extensions are installed on the wiki is stored on the file system, too (I think)  \n11:35\u00a0<gdelhumeau>\u00a0Enygma`: I did it, yes  \n11:35\u00a0<tmortagne>\u00a0or maybe packager doing some weird thing since we don't seems to have the issue with a standard XE  \n11:35\u00a0<gdelhumeau>\u00a0But the HTML5 violations remains  \n11:35\u00a0<vmassol>\u00a0gdelhumeau: replied  \n11:35\u00a0<gdelhumeau>\u00a0but at least it is no longer an XHTML1 validator  \n11:36\u00a0<tmortagne>\u00a0yaronr: filesystem  \n11:36\u00a0<tmortagne>\u00a0in the configured permanent directory  \n11:36\u00a0<Enygma`>\u00a0tmortagne: but we have it with standard xe too, when closing the instance.  \n11:36\u00a0<yaronr>\u00a0tmortagne and is it possible to install them using shell commands?  \n11:37\u00a0<Enygma`>\u00a0gdelhumeau: so why not better disable it since it is not progressing anyway?  \n11:37\u00a0<tmortagne>\u00a0yaronr: just putting them in the right place in the filesystem is not enough since there is caching on XWiki side so it has to go through XWiki APIs  \n11:37\u00a0<gdelhumeau>\u00a0Enygma`: to have the list of the violations  \n11:38\u00a0<gdelhumeau>\u00a0I already fixed some of them  \n11:38\u00a0<gdelhumeau>\u00a0now the problem comes from the htmlCleaner I guess  \n11:38\u00a0<Enygma`>\u00a0gdelhumeau: ok, if you are working on it.  \n11:38\u00a0<gdelhumeau>\u00a0yaronr: maybe using curl to call the good XWiki URLs ;)  \n11:38\u00a0<yaronr>\u00a0tmortagne I'm creating a Docker based xwiki image. I got it running, and logged on. Some wizard started, yada yada yada. Question is - can I pre-configure the docker image with the extensions, so that when it fires up for the first time it will be 'fully configured'  \n11:39\u00a0<gdelhumeau>\u00a0Enygma`: I don't think it is gonna be fixed for 6.3 thought  \n11:40\u00a0<Enygma`>\u00a0gdelhumeau: I wanted to avoid having that costly job execute every time since 1000+ failed tests make jenkins slow.  \n11:40\u00a0<tmortagne>\u00a0yaronr: yes you could, that's pretty much what we do in the jetty/hsqldb distribution  \n11:40\u00a0<Enygma`>\u00a0gdelhumeau: perhaps you can enable it only when you are working on it, wdyt?  \n11:40\u00a0<tmortagne>\u00a0it generate a preconfigured extension index using a Maven plugin  \n11:40\u00a0<tmortagne>\u00a0see https://github.com/xwiki/xwiki-enterprise/tree/master/xwiki-enterprise-data/xwiki-enterprise-data-hsqldb  \n11:40\u00a0<vmassol>\u00a0yaronr: very nice, I was interested in doing this too! (a docker image)  \n11:41\u00a0<vmassol>\u00a0don't kno if you plan to share it but that would be awesome  \n11:41\u00a0<vmassol>\u00a0at least share the dockerfile maybe?  \n11:41\u00a0<yaronr>\u00a0vmassol I'm like 90% there: https://registry.hub.docker.com/u/yaronr/xwiki-tomcat7/  \n11:41\u00a0<vmassol>\u00a0great  \n11:42\u00a0<vmassol>\u00a0ah so the mysql isn't included in the image  \n11:42\u00a0<vmassol>\u00a0?  \n11:42\u00a0<yaronr>\u00a0vmassol the only part that's remaining is to make the image fully configured.  \n11:42\u00a0<yaronr>\u00a0vmassol right  \n11:42\u00a0<yaronr>\u00a0usually you would already have a db somewhere  \n11:42\u00a0<yaronr>\u00a0otherwise, create a mysql image  \n11:43\u00a0<vmassol>\u00a0yeah I guess  \n11:43\u00a0<yaronr>\u00a0but the thing is - the images are best if they're ephemeral. The state is stored in the DB, and (unfortunately) file system - for the extensions  \n11:43\u00a0<cjd>\u00a0this is pretty standard for docker, the idea is that the data is stored outside of the image  \n11:44\u00a0<yaronr>\u00a0cjd yup. but in the case of extensions - I do want it as part of the image.  \n11:45\u00a0<yaronr>\u00a0In my setup, nodes in the cluster come and go, and something takes care of running services on top of the cluster. xwiki is just another service  \n11:45\u00a0<yaronr>\u00a0so if xwiki gets stopped on one node and started on another, I want it to have the exact same setup.  \n11:46\u00a0<yaronr>\u00a0best way is to just have that as part of the image.  \n11:46\u00a0<cjd>\u00a0apache--jwhateverconnector-->xwiki/tomcat ?  \n11:46\u00a0<yaronr>\u00a0cjd for example (if I understand what you just said ;-) \u00a0)  \n11:46\u00a0<yaronr>\u00a0so as part of the image, I already copy the mysql connector jar.  \n11:47\u00a0<cjd>\u00a0just inquiring about the stack/frontend you're using  \n11:47\u00a0<yaronr>\u00a0but how do I copy the extensions? the ones that are added during the wizard that runs the first time?  \n11:47\u00a0<yaronr>\u00a0cjd tomcat7, openjdk-7, debian  \n11:47\u00a0<ClemensR>\u00a0ah, that moving around of the extension state dir between nodes sound familiar to me ... unfortunately I have not got a good solution for this either (using some hardwritten rsync scripts, because our nodes \"know each other\")  \n11:48\u00a0<cjd>\u00a0mm what's in front of tomcat7 ? \u00a0apache?  \n11:48\u00a0<yaronr>\u00a0ClemensR crude & effective solution: commit the image after initial setup, and push to a local registry.  \n11:48\u00a0<yaronr>\u00a0ClemensR super elegant solution: clustered file system for the WEB-INF dir  \n11:49\u00a0<yaronr>\u00a0cjd nothing. I have HAProxy on another image that's in front of everything (including xwiki)  \n11:49\u00a0<cjd>\u00a0ahh ok  \n11:49\u00a0<cjd>\u00a0haptoxy---http--->tomcat7  \n11:49\u00a0<yaronr>\u00a0cjd but as a side issue. the days where you had to put something in front of tomcat to support heavy load or whatever - are long gone.  \n11:50\u00a0<yaronr>\u00a0cjd I just finished a demo where I supported tens of thousands of concurrent users on a single t1.micro instance running Tomcat (with nothing in front of it)  \n11:50\u00a0<yaronr>\u00a0cjd of course it has to be tuned..  \n11:50\u00a0<cjd>\u00a0/nod  \n11:50\u00a0<yaronr>\u00a0AmazonELB --> HAProxy --> Tomcat7  \n11:50\u00a0<ClemensR>\u00a0yaronr: about the extensions: clustered file system needed for the enviroment.permDir variable instead. our admins would like to implement that, but I am not fully convinced there is no simpler solution  \n11:50\u00a0<cjd>\u00a0haproxy seems more for keeping multiple tomcats live at any given time and killing them if they crash  \n11:51\u00a0<cjd>\u00a0also unwrapping https  \n11:51\u00a0<gdelhumeau>\u00a0Enygma`: Ok, I enable it only on demand  \n11:51\u00a0<yaronr>\u00a0ClemensR can you explain what the enviroment.permDir \u00a0is? I just touched xwiki for the first time yesterday, so sorry if it's a noob question  \n11:52\u00a0<yaronr>\u00a0cjd it's more complicated. Killing and re-starting is taken care of by something (systemd), but not all nodes run everything. There's discovery, which updates haproxy config on the fly on what runs where  \n11:52\u00a0<Lyes>\u00a0has quit  \n11:53\u00a0<cjd>\u00a0systemd in production, oh my  \n11:53\u00a0<yaronr>\u00a0what's the default admin password BTW? and is there a way to set it as part of the command line / config files?  \n11:53\u00a0<cjd>\u00a0xwiki.cfg -> superadmin  \n11:53\u00a0<yaronr>\u00a0cjd actually CoreOS. my oh my :)  \n11:53\u00a0<cjd>\u00a0ahh, cool  \n11:54\u00a0<cjd>\u00a0I know a few of the maintainers  \n11:54\u00a0<yaronr>\u00a0cjd may the force be with them  \n11:54\u00a0<ClemensR>\u00a0yaronr: \u00a0see WEB-INF/xwiki.properties, \u00a0config variable environment.permanentDirectory \u00a0\u00a0... this is the directory where XWiki stores it information on the file system  \n11:55\u00a0<cjd>\u00a0I'll have to give it a try at some point, I use ubuntu because I can install ZFS with 2 lines of code and it recompiles the modules when the kernel is updated  \n11:55\u00a0<ClemensR>\u00a0this includes stare of the extensions, the serach index files, and possibly attachment files  \n11:55\u00a0<cjd>\u00a0s/code/bash/ :)  \n11:55\u00a0<yaronr>\u00a0ClemensR AHA. So extensions etc - anything I install - goes either in the DB or permanentDirectory?  \n11:55\u00a0<ClemensR>\u00a0yaronr: Admin \u00a0passwd is admin, and that is stored in the XWiki.Admin page ... in the DB  \n11:56\u00a0<vmassol>\u00a0yaronr: yes  \n11:56\u00a0<vmassol>\u00a0hold on  \n11:56\u00a0<vmassol>\u00a0all described here: http://platform.xwiki.org/xwiki/bin/view/AdminGuide/Backup  \n11:56\u00a0<vmassol>\u00a0that should help you understand  \n11:57\u00a0<yaronr>\u00a0thank you guys!  \n11:57\u00a0<yaronr>\u00a0feel free to give the docker image a spin, let me know if something's broken.  \n11:58\u00a0<vmassol>\u00a0cool, once it's done from your POV you could add it to http://platform.xwiki.org/xwiki/bin/view/AdminGuide/Installation  \n11:59\u00a0<yaronr>\u00a0vmassol my config is a bit opinionated, especially towards mysql  \n11:59\u00a0<vmassol>\u00a0ok we just need to make sure not to promote it as THE way to install xwiki but more as an example for those interested indocker  \n12:00\u00a0<vmassol>\u00a0there's a tutorial section too that could fit  \n12:00\u00a0<yaronr>\u00a0vmassol let's do this. give it a try, and if it works - then you can put it in the tutorial. if not - i'll fix it  \n12:01\u00a0<vmassol>\u00a0ok  \n12:02\u00a0<yaronr>\u00a0what's the default permanent directory ?  \n12:04\u00a0<ClemensR>\u00a0the directory where the environment.permanentDirectory points to. \u00a0If not set, it uses some tmp-dir in tiomcat  \n12:04\u00a0<tmortagne>\u00a0yaronr: if nothing is set it's asking for the application server temp folder and print a warning  \n12:05\u00a0<tmortagne>\u00a0usually we set something  \n12:05\u00a0<tmortagne>\u00a0the debian package use /var/lib/xwiki  \n12:05\u00a0<yaronr>\u00a0tmortagne yes, I will definitely set something in the dockerfile  \n12:05\u00a0<tmortagne>\u00a0(talking about http://platform.xwiki.org/xwiki/bin/view/AdminGuide/InstallationViaAPT)  \n12:06\u00a0<yaronr>\u00a0tmortagne yeah, there's an issue with the apt install. the version that's supposed to install just xwiki (without tomcat or mysql) - installs everything: tomcat, mysql, mysql client, pearl (!?)  \n12:07\u00a0<yaronr>\u00a0so I installed it via war file in my dockerfile  \n12:07\u00a0<yaronr>\u00a0going for lunch. catch you guys later  \n12:07\u00a0<tmortagne>\u00a0yaronr: I don't understand  \n12:07\u00a0<tmortagne>\u00a0xwiki-enterprise-common does not install tomcat, mysql etc  \n12:09\u00a0<tmortagne>\u00a0there is only \"dbconfig-common (>= 1.8.0), ttf-dejavu, java7-runtime-headless | java7-runtime\" in Depends do there is no way you end up with tomcat and mysql using that package  \n12:10\u00a0<tmortagne>\u00a0I doubt you tried the right one  \n12:42\u00a0<lucaa>\u00a0has quit  \n13:05\u00a0<yaronr>\u00a0tmortagne reg. install via apt: xwiki-enterprise-common is supposed to install just xwiki, without tomcat / mysql. In reality, it installs all of those, + a bunch of other things that I'm not sure are required.  \n13:11\u00a0<tmortagne>\u00a0has quit  \n13:11\u00a0<tmortagne>\u00a0has joined #xwiki  \n13:15\u00a0<tmortagne>\u00a0yaronr: again this is impossible, it does not declare any dependency on those. You probably forced to install the Recommends  \n13:15\u00a0<yaronr>\u00a0tmortagne I think that must be it  \n13:16\u00a0<yaronr>\u00a0so what does it install? just the war file? how does it know where to place it?  \n13:17\u00a0<tmortagne>\u00a0it's the other way around  \n13:18\u00a0<tmortagne>\u00a0xwiki-enterprise-common put the files and the link to tomcat is done by tomcat package  \n13:18\u00a0<tmortagne>\u00a0it install http://platform.xwiki.org/xwiki/bin/view/AdminGuide/InstallationViaAPT#HXWiki basically  \n13:18\u00a0<tmortagne>\u00a0so just the WAR  \n13:18\u00a0<yaronr>\u00a0and it expects a TOMCAT\\_HOME or something?  \n13:19\u00a0<tmortagne>\u00a0just put it somewhere more or less standard and expose XWiki configuration as /etc/xwiki  \n13:19\u00a0<tmortagne>\u00a0no  \n13:19\u00a0<tmortagne>\u00a0this pckage does not expect anything  \n13:19\u00a0<tmortagne>\u00a0it does not even know what tomcat is  \n13:20\u00a0<tmortagne>\u00a0it's another package which make sure tomcat is loading this WAR  \n13:20\u00a0<tmortagne>\u00a0all the pakages are defined on https://github.com/xwiki/xwiki-enterprise/tree/master/xwiki-enterprise-installers/xwiki-enterprise-installer-debian  \n13:21\u00a0<tmortagne>\u00a0xwiki-enterprise-common job is just to deal with XWiki only files, how the application server is accessing it and where does XWiki connect is not its concern  \n13:22\u00a0<tmortagne>\u00a0each package job is detailed in platform.xwiki.org/xwiki/bin/view/AdminGuide/InstallationViaAPT  \n13:22\u00a0<tmortagne>\u00a0http://platform.xwiki.org/xwiki/bin/view/AdminGuide/InstallationViaAPT  \n13:23\u00a0<tmortagne>\u00a0the base package of all the others is xwiki-enterprise-common and then the other add database connection, application server link, etc...  \n13:23\u00a0<tmortagne>\u00a0there is packages provided for tomcat but it would be any other application server  \n13:23\u00a0<tmortagne>\u00a0same for the database  \n13:23\u00a0<yaronr>\u00a0tmortagne what do you think, should the image be with the default extensions installed, or 'vanilla' ?  \n13:24\u00a0<yaronr>\u00a0I think most people would use the default extensions, and maybe change them later, so it would make sense for the image to be with the extensions  \n13:24\u00a0<tmortagne>\u00a0I'm not really a docker best practice expert but I guess most people will expect to have the default UI alredy there  \n13:24\u00a0<tmortagne>\u00a0like with the jetty/hsqldb distribution  \n13:26\u00a0<yaronr>\u00a0tmortagne yes I think so too (docker is so new, if someone tells you he's a best practice expert - take it with a grain of salt)  \n13:26\u00a0<tmortagne>\u00a0the debian package let Distribution Wizard do the job mostly because I did not spend the time making it available by default  \n13:26\u00a0<tmortagne>\u00a0so it's mostly laziness on my side  \n13:27\u00a0<yaronr>\u00a0tmortagne so I have two options now: 1) Add the extensions manually (via the web interfact), 2) find a way to do it via bash. \u00a0The downside of (1) - I will not be able to provide an automated build.  \n13:27\u00a0<yaronr>\u00a0Can you help me with (2) ?  \n13:28\u00a0<yaronr>\u00a0I can do git (I think) as part of the build process, if it helps  \n13:28\u00a0<tmortagne>\u00a0the issue with 2) is not so much the extensions index  \n13:29\u00a0<tmortagne>\u00a0but the UI has to be imported in the database at some point  \n13:29\u00a0<yaronr>\u00a0well the users will eventually login to the image  \n13:29\u00a0<yaronr>\u00a0or.. to the ui using the image  \n13:29\u00a0<tmortagne>\u00a0jetty/hsqldb pre-generate a database because it's easy with hsqldb to do that but with MySQL it has to be done at runtime  \n13:30\u00a0<tmortagne>\u00a0for a first version you could start with what the debian package do, let Distribution Wizard download and install the default UI  \n13:32\u00a0<yaronr>\u00a0but that's only when it installs tomcat as well, right?  \n13:32\u00a0<tmortagne>\u00a0having the UI installed means that at some point you have to run XWiki and import all the XAR during the build  \n13:32\u00a0<tmortagne>\u00a0it's not related to tomcat  \n13:33\u00a0<tmortagne>\u00a0when everything is setup and you have an empty database XWiki show you the Distribution Wizard to finish the install  \n13:33\u00a0<tmortagne>\u00a0right now it means install the default UI  \n13:33\u00a0<tmortagne>\u00a0in 7.x it will probably mean chose a flavor  \n13:33\u00a0<tmortagne>\u00a0choose  \n13:33\u00a0<ClemensR>\u00a0I rememeber a colleague of mine has written some wild java code that takes a \\*.xar-file (XWiki \u00a0export format) as input and imports it to the database ... but that was for xwiki 2.1 and some years ago ...  \n13:34\u00a0<yaronr>\u00a0yeah but the database during build is not the same as the one in production. It's not even the same user / entity / organization..  \n13:34\u00a0<yaronr>\u00a0docker hub builds the image, use X uses it..  \n13:34\u00a0<tmortagne>\u00a0ClemensR: importing a XAR is not very hard if you are in Java since you can reuse XWiki API, it's another matter in bash  \n13:35\u00a0<yaronr>\u00a0I can do a small Java helper class and run it via bash  \n13:35\u00a0<yaronr>\u00a0But it can't depend on a DB instance being there  \n13:35\u00a0<tmortagne>\u00a0maybe what is not clear is that the UI is not really located on filesystem  \n13:36\u00a0<tmortagne>\u00a0what is on filesystem is just the extension file  \n13:36\u00a0<tmortagne>\u00a0the actual UI is in the DB  \n13:36\u00a0<yaronr>\u00a0tmortagne I was assuming that by 'extension file' you mean UI files (jsp, servlets, css..)  \n13:36\u00a0<tmortagne>\u00a0no  \n13:36\u00a0<yaronr>\u00a0so what is it exactly?  \n13:36\u00a0<yaronr>\u00a0and why isn't it on the DB ?  \n13:37\u00a0<tmortagne>\u00a0by default UI I mean the XWiki pages that represent the default UI  \n13:37\u00a0<tmortagne>\u00a0and those wiki pages are in the database  \n13:37\u00a0<yaronr>\u00a0let me ask this, then: If I tear down my xwiki server, and re-create it - using a DB that was previously set and configured, with UI etc. What will happen?  \n13:39\u00a0<yaronr>\u00a0(while you're thinking, I'm trying it out :) )  \n13:39\u00a0<ClemensR>\u00a0if the \"permanentDir\" is restored somehow, then nothing :) \u00a0you just get the wiki back  \n13:39\u00a0<tmortagne>\u00a0there is two different things in XWiki, there is the skin which is on filesystem and contain very basic minimum features (edit a wiki page, import a XAR) and there is the XWiki Enterprise UI with all it's application which is scripts in wiki pages  \n13:40\u00a0<tmortagne>\u00a0when you start with en empty DB you don't have much features and the first thing DW does is importing XWiki Enterprise wiki pages  \n13:40\u00a0<yaronr>\u00a0permanent dir is nuked, db exists and is not empty. what will happen?  \n13:41\u00a0<tmortagne>\u00a0depends what you mean by not empty  \n13:41\u00a0<tmortagne>\u00a0if you take jetty/hsqldb distribution for example and remove the permanent dir what will happen if that visually you won't see any difference but XWiki won't know anymore what extensions are installed  \n13:41\u00a0<yaronr>\u00a0I ran an instance, logged in to the UI, followed the wizard, completed, created a 'hello world' page.  \n13:41\u00a0<yaronr>\u00a0then nuked the instance, and started a new one  \n13:41\u00a0<tmortagne>\u00a0even if those extension are still working and in the DB  \n13:42\u00a0<tmortagne>\u00a0you loose the extension index basically  \n13:42\u00a0<tmortagne>\u00a0that for XAR  \n13:42\u00a0<ClemensR>\u00a0I guess at teh first requrst (possibly after logging in as Admin) the DistributionWizard will pop up and be confused about which XWiki UI is installed, if the permDir-extensions state \u00a0is removed  \n13:42\u00a0<tmortagne>\u00a0if you have jar extensions in there you will also loose them  \n13:42\u00a0<tmortagne>\u00a0since jar example are loaded at startup in the classloader  \n13:42\u00a0<yaronr>\u00a0Well, it's initializing at 50%. let's see :)  \n13:43\u00a0<ClemensR>\u00a0ah, yes, I forgot about these jar extensions ... yes, they will be gome  \n13:43\u00a0<yaronr>\u00a0so far no errors in the log  \n13:43\u00a0<tmortagne>\u00a0usually you don't have any jar extension by default since there is only wiki page in the defaut UI  \n13:43\u00a0<ClemensR>\u00a0usually this means that some UI pages will still eb there, but show error messages ...  \n13:43\u00a0<yaronr>\u00a0well, are you ready for this?  \n13:43\u00a0<tmortagne>\u00a0but if you install a jar extensoin later and remove your extension index then you will loose this extension  \n13:44\u00a0<yaronr>\u00a0not sure if its the browser cache or not, but it looks like it just works  \n13:44\u00a0<yaronr>\u00a0let me nuke the cache  \n13:44\u00a0<ClemensR>\u00a0the home page should still be there  \n13:44\u00a0<tmortagne>\u00a0yaronr: yes it works, as I said eveything in the DB still works  \n13:44\u00a0<ClemensR>\u00a0no cache, it rally is,. but if you log in ad Admin  \n13:44\u00a0<tmortagne>\u00a0but XWiki does not have any idea what is installed  \n13:44\u00a0<yaronr>\u00a0ah no  \n13:44\u00a0<yaronr>\u00a0'distribution wizard' again  \n13:44\u00a0<tmortagne>\u00a0you have have wiki pages not related to any extension  \n13:45\u00a0<ClemensR>\u00a0as Admin, the distribution wizard will show up and ask you about your xwiki version  \n13:45\u00a0<tmortagne>\u00a0if you skip the DW you will get the UI as it was before  \n13:45\u00a0<ClemensR>\u00a0because the UI pages atre stroed i the DB, but the state that they are installed and in which version, is in the 'extensions;' state dir  \n13:45\u00a0<yaronr>\u00a0it's not sure if it's an upgrade or not. let's say 'upgrade'  \n13:45\u00a0<tmortagne>\u00a0you get the DW because you deleted the status saying that the DW is all done  \n13:46\u00a0<yaronr>\u00a0repair  \n13:46\u00a0<ClemensR>\u00a0wait, I am trying to get the same with my jetty-hsql-DB ...  \n13:46\u00a0<tmortagne>\u00a0repair means that you restore the extension index basically  \n13:46\u00a0<tmortagne>\u00a0you will get back more or less what used to be in the permanent directory  \n13:47\u00a0<Lyes>\u00a0has joined #xwiki  \n13:47\u00a0<tmortagne>\u00a0this repair helper has been made to make easier upgrade pre-extension installs  \n13:47\u00a0<yaronr>\u00a0so guys, here's a question: is it technically feasible to store EVERYTHING in the DB? have no reliance on file system (at least for the first boot) ?  \n13:48\u00a0<yaronr>\u00a0That would make xWiki much easier to maintain and do HA with. All the state is in the DB.  \n13:48\u00a0<tmortagne>\u00a0right now no it's not  \n13:48\u00a0<yaronr>\u00a0I know, just asking if it's possible (and not terribly complex)  \n13:49\u00a0<yaronr>\u00a0ok so whatever I've done to it, it's recoverable. that's good.  \n13:50\u00a0<yaronr>\u00a0Now I need to figure out some mechanism for persisting this second-class state :)  \n13:50\u00a0<yaronr>\u00a0maybe some sort of sync to S3  \n13:51\u00a0<OSIMasson>\u00a0has quit  \n13:52\u00a0<D-Spair>\u00a0has quit  \n13:56\u00a0<vmassol1>\u00a0has joined #xwiki  \n13:56\u00a0<ClemensR>\u00a0storing the extensions state (with the jars) in some database might be quite tricky, and need a big blog aside of the problem of keeping things in sync ...  \n13:56\u00a0<yaronr>\u00a0BTW. Does xWiki clustering take care of syncing the permanentDirectory between nodes?  \n13:57\u00a0<DarkKnightCZ>\u00a0has quit  \n13:57\u00a0<ClemensR>\u00a0no it does not, you are supposed to provide the file system cluster (or NFS) for it  \n13:57\u00a0<yaronr>\u00a0ok, got it  \n13:58\u00a0<DarkKnightCZ>\u00a0has joined #xwiki  \n13:59\u00a0<ClemensR>\u00a0a completely different question: if I install an extension that defines it own type of events, and then try to listen to that event in a \"ComponentMethod\" object, it seems I cannot import the event class. Is there any way to make this working ?  \n14:01\u00a0<D-Spair>\u00a0has joined #xwiki  \n14:03\u00a0<ClemensR>\u00a0like the DocumentPublishingEvent from http://extensions.xwiki.org/xwiki/bin/view/Extension/XWiki+Publication+Workflow+Application and then following http://extensions.xwiki.org/xwiki/bin/view/Extension/WikiComponent+Module#HImplementingmethods  \n14:05\u00a0<tmortagne>\u00a0yaronr: regarding XWiki clustering yes and no  \n14:06\u00a0<tmortagne>\u00a0when you install an extension on one node it's it's status is updated on the others nodes too  \n14:07\u00a0<tmortagne>\u00a0XWiki clustering is not based on file sysnchronisation, it's about sharing events between nodes, when one node install an extension the others know it and update their index  \n14:07\u00a0<tmortagne>\u00a0but this is something specifically supported by extension manager, not a general clustering support  \n14:07\u00a0<tmortagne>\u00a0for example I don't think there is such support for filesystem attachments  \n14:09\u00a0<tmortagne>\u00a0ClemensR: you are talking about wiki component here ?  \n14:10\u00a0<yaronr>\u00a0tmortagne let's say I have 3 nodes, I install a bunch of extensions yada yada yada - and add a fourth node. Will this fourth node get a 'log of events' or something, so that it can catch up with the rest of the cluster?  \n14:11\u00a0<ClemensR>\u00a0tmortagne: yes, adding an event listener in a wiki page, and trying to listen to an event defined in a jar-extension  \n14:11\u00a0<tmortagne>\u00a0no, it react to events but if it's not synchronized from the start it won't ask other nodes if there is some extension it does not have at startup  \n14:12\u00a0<tmortagne>\u00a0ClemensR: is the jar you installed in the same wiki that the wiki component you are trying to create ?  \n14:13\u00a0<ebullient1>\u00a0has quit  \n14:14\u00a0<ClemensR>\u00a0yes it is the same wiki (but a sub wiki to be sure)  \n14:15\u00a0<tmortagne>\u00a0I'm not sure what classloader wiki component code is using, maybe it does not take into account the context and only look at root classloader  \n14:15\u00a0<ClemensR>\u00a0ah, but its a quite an old xwiki version over here where I try thing, so that is possibly why  \n14:15\u00a0<tmortagne>\u00a0in any case this use case should work  \n14:16\u00a0<tmortagne>\u00a0could be  \n14:16\u00a0<tmortagne>\u00a0extension manager automatically set the current thread classloader to the right one based on the context so most of the time it's working well but I don't know well wiki component code  \n14:18\u00a0<tmortagne>\u00a0ClemensR: do you have an error, a stack trace or something ?  \n14:19\u00a0<ClemensR>\u00a0I better recheck with the current version ...  \n14:19\u00a0<tmortagne>\u00a0what can't be loaded exactly in your case ? the role ?  \n14:20\u00a0<tmortagne>\u00a0ComponentMethod is just one method of the role  \n14:20\u00a0<tmortagne>\u00a0so if it does not find the listener it should fail before even looking at methods  \n14:22\u00a0<tmortagne>\u00a0it seems t be using Thread.currentThread().getContextClassLoader() to load the role type so that should be ok I think  \n14:22\u00a0<tmortagne>\u00a0but if you can reproduce with recent version don't hesitate to create a jira, it should be easy to debug  \n14:22\u00a0<ClemensR>\u00a0yup, it is just the old XWiki version over here, sorry for the noise - \u00a0works flawlessly with 6.2.2  \n14:22\u00a0<tmortagne>\u00a0ok cool  \n14:22\u00a0<ClemensR>\u00a0should press folks to update ...  \n14:38\u00a0<lucaa>\u00a0has joined #xwiki  \n14:47\u00a0<ebullient1>\u00a0has joined #xwiki  \n15:02\u00a0<msmeria>\u00a0has quit  \n15:14\u00a0<xwikibot>\u00a0has joined #xwiki  \n15:19\u00a0<tmortagne>\u00a0has joined #xwiki  \n15:19\u00a0<yaronr>\u00a0has left #xwiki  \n15:22\u00a0<woshilapin>\u00a0has quit  \n15:28\u00a0<woshilapin>\u00a0has joined #xwiki  \n15:29\u00a0<vmassol1>\u00a0Enygma`: I'm closing http://jira.xwiki.org/browse/XRENDERING-368#  \n15:30\u00a0<vmassol1>\u00a0let me know if my comments are clear and if it's ok with you  \n15:33\u00a0<vmassol1>\u00a0just updated my last comment  \n15:33\u00a0<vmassol1>\u00a0is now known as <vmassol>  \n15:34\u00a0<vmassol>\u00a0and updated agai  \n15:34\u00a0<vmassol>\u00a0again  \n16:01\u00a0<AFKGeek>\u00a0has quit  \n16:15\u00a0<vmassol>\u00a0reminder: we need someone to look at http://jira.xwiki.org/browse/XWIKI-11240  \n16:16\u00a0<OSIMasson>\u00a0has joined #xwiki  \n16:18\u00a0<DarkKnightCZ>\u00a0has quit  \n16:21\u00a0<tmortagne>\u00a0vmassol: did anyone reproduce it on anything else that xwiki.org ?  \n16:22\u00a0<vmassol>\u00a0hmm don't know, in my case it was xwiki.org indeed  \n16:24\u00a0<tmortagne>\u00a0but maybe on xwiki.org someone redefine it in some skin and create a mess but in that case I doubt we can have this kind of issue in 6.3  \n16:24\u00a0<vmassol>\u00a0evalica: you only saw it on xwiki.org too? Do you know if you redefined it in some skin?  \n16:25\u00a0<evalica>\u00a0no - I didn't seen it only on xwiki.org. The issue was reported initially on Forum app which was tested locally on a vanilla XE  \n16:26\u00a0<evalica>\u00a0it was reproduces also by Gabriela on her instances \u2026 locally too  \n16:26\u00a0<evalica>\u00a0the only problem with this issue is being able to reproduce it  \n16:26\u00a0<evalica>\u00a0I reproduce it also on xwiki.org  \n16:27\u00a0<evalica>\u00a0when opening a link \u2026 without previous navigation inside xwiki.org  \n16:42\u00a0<Enygma`>\u00a0vmassol: can you please explain what exactly is invalid in the input in my example of \u00a0XRENDERING-368 ?  \n16:42\u00a0<vmassol>\u00a0Enygma`: seems I wasn't clear in my reply then  \n16:43\u00a0<vmassol>\u00a0\"The problem is that your input is invalid (it generates non inline content since you generate a P and a DIV next to each other.\"  \n16:43\u00a0<Enygma`>\u00a0what is wrong with a P and a DIV next to each other?  \n16:43\u00a0<vmassol>\u00a0hi (((ho)))  \n16:43\u00a0<vmassol>\u00a0it's not inline content!  \n16:43\u00a0<vmassol>\u00a0it's standalone content  \n16:43\u00a0<vmassol>\u00a0and thus cannot be inside a paragrpzh  \n16:43\u00a0<Enygma`>\u00a0I don`t get it  \n16:43\u00a0<tmortagne>\u00a0<div> is not valid in a paragraph  \n16:43\u00a0<vmassol>\u00a0yes  \n16:45\u00a0<Enygma`>\u00a0it's one thing when you control that thought way HTML  \n16:45\u00a0<Enygma`>\u00a0but in wiki syntax you get magic paragraphs everywhere  \n16:45\u00a0<Enygma`>\u00a0so it`s not obvious that this is a possible problem for someone using wiki syntax  \n16:46\u00a0<tmortagne>\u00a0you get a paragraph when you group thing in a paragraph that's all  \n16:46\u00a0<vmassol>\u00a0that\"'s why I have created XRENDERING-90 a long time ago too  \n16:47\u00a0<vmassol>\u00a0but it's far from being on the priority list IMO...  \n16:48\u00a0<Enygma`>\u00a0the problem bites you hard when you are using wiki syntax to generate UIs (so using it programatically)  \n16:48\u00a0<vmassol>\u00a0why?  \n16:48\u00a0<vmassol>\u00a0it's like HTML  \n16:48\u00a0<Enygma`>\u00a0it`s nice and all for writing documentation, but when you write UIs and struggle to avoid using the HTML macro, you get all these wrapping paragraphs everywhere and it`s a real PITA having to work around them  \n16:48\u00a0<vmassol>\u00a0you need to understand what you do  \n16:48\u00a0<vmassol>\u00a0now  \n16:49\u00a0<vmassol>\u00a0using wiki syntax for UI is hard for sure, that's why we need macros for that IMO  \n16:49\u00a0<Enygma`>\u00a0and don`t get me started on block macros that just won`t render in inline mode (like the html macro, message macros, etc)  \n16:49\u00a0<Enygma`>\u00a0macros that what, use the HTML macro in the background?  \n16:49\u00a0<vmassol>\u00a0I don't get you Enygma`  \n16:49\u00a0<vmassol>\u00a0it's the same in HTML  \n16:50\u00a0<vmassol>\u00a0no, re UI, I meant having macros to do as UI building blocks  \n16:51\u00a0<vmassol>\u00a0for forms, tabs, etc  \n16:51\u00a0<Enygma`>\u00a0it`s frustrating that you have to learn all these rendering mechanics to perform things that seem simple at first and you end up wasting a lot of time debugging and figuring out the inner workings of the wiki rendering engine  \n16:51\u00a0<vmassol>\u00a0then don't  \n16:51\u00a0<vmassol>\u00a0:)  \n16:51\u00a0<Enygma`>\u00a0:)  \n16:51\u00a0<vmassol>\u00a0(as a user)  \n16:51\u00a0<vmassol>\u00a0as a user you can just use html  \n16:51\u00a0<vmassol>\u00a0for doing your UI  \n16:52\u00a0<vmassol>\u00a0now  \n16:52\u00a0<vmassol>\u00a0for us we don't want that  \n16:52\u00a0<vmassol>\u00a0at least till now  \n16:52\u00a0<vmassol>\u00a0because we wanted the ability to render into anything  \n16:52\u00a0<vmassol>\u00a0PDF, other syntax, etc  \n16:52\u00a0<Enygma`>\u00a0it even happens when you just want to use a message macro like {{error}} and you have to take care of its mood swings regarding block vs inline :)  \n16:53\u00a0<Enygma`>\u00a0just expressing my frustrations here :)  \n16:53\u00a0<vmassol>\u00a0actually  \n16:54\u00a0<vmassol>\u00a0using the new content macro should help with this  \n16:54\u00a0<vmassol>\u00a0:)  \n16:54\u00a0<vmassol>\u00a0never thought about that  \n16:54\u00a0<vmassol>\u00a0it allows you to mix wiki syntax and HTML properly  \n16:54\u00a0<vmassol>\u00a0s/it allows/it should allow  \n16:54\u00a0<Enygma`>\u00a0how is that?  \n16:55\u00a0<vmassol>\u00a0without using any RawBlock  \n16:55\u00a0<Enygma`>\u00a0I remember you need to specify syntax  \n16:55\u00a0<vmassol>\u00a0yep  \n16:55\u00a0<vmassol>\u00a0{{content synax=\"html/4.01\"}}....  \n16:55\u00a0<Enygma`>\u00a0ah, instead of {{html}} ?  \n16:55\u00a0<vmassol>\u00a0yes, it's the first time I think of this  \n16:56\u00a0<vmassol>\u00a0would be fun to see how it works out  \n16:56\u00a0<vmassol>\u00a0ofc you'd need to be careful to use HTML that can be parsed by our HTML parser  \n16:56\u00a0<Enygma`>\u00a0but does it interpret wiki syntax too?  \n16:56\u00a0<vmassol>\u00a0hmmm  \n16:56\u00a0<vmassol>\u00a0I don't remember what we do with unknown elements  \n16:56\u00a0<Enygma`>\u00a0and from what you`ve just said, I imagine it works with clean=false by default  \n16:57\u00a0<vmassol>\u00a0we probably just discard them so it won't work for things like <form> I guess  \n16:57\u00a0<Enygma`>\u00a0<label> is a common usecase that requires the {{html}} macro :)  \n16:57\u00a0<Enygma`>\u00a0and it`s commonly inline  \n16:57\u00a0<Enygma`>\u00a0so it might still be useful there  \n16:58\u00a0<Enygma`>\u00a0anyway, if it would be a posibility to make the html macro inline, it would be great  \n16:58\u00a0<Enygma`>\u00a0I think we already have an issue opened for this nuissance  \n16:58\u00a0<vmassol>\u00a0so this idea works only if you use HTML that can be parsed  \n16:58\u00a0<vmassol>\u00a0ie transformed into XDOM Blocks  \n16:58\u00a0<vmassol>\u00a0in that case you can write HTML and still get nice Blocks and not RawBlock  \n16:59\u00a0<vmassol>\u00a0it's a limited use case though  \n16:59\u00a0<Enygma`>\u00a0parsed = valid html?  \n17:00\u00a0<tmortagne>\u00a0Enygma`: content macro parse the content to produce a XDOM  \n17:00\u00a0<vmassol>\u00a0if you use \"html/4.01\" then the cleaner is executed yes  \n17:00\u00a0<vmassol>\u00a0if you use \"xhtml/1.0\" then it's not  \n17:00\u00a0<tmortagne>\u00a0so it's about supported html, not even just valid html  \n17:00\u00a0<evalica>\u00a0has quit  \n17:00\u00a0<tmortagne>\u00a0so unusable for thing not supported in XDOM  \n17:00\u00a0<Enygma`>\u00a0I see now...  \n17:00\u00a0<vmassol>\u00a0yep  \n17:01\u00a0<tmortagne>\u00a0so not really a replacement for html macro  \n17:01\u00a0<vmassol>\u00a0yep  \n17:01\u00a0<Lyes>\u00a0has quit  \n17:02\u00a0<tmortagne>\u00a0when the goal is really to produce specifically html that will make sense only in html use case we should simply use html macro, there is no value in trying at all cost to use wiki syntax which never been designed to write a UI and will never be  \n17:02\u00a0<evalica>\u00a0has joined #xwiki  \n17:03\u00a0<evalica>\u00a0has quit  \n17:06\u00a0<tmortagne>\u00a0Enygma`: I don't understand why you say html macro does not support inline, https://github.com/xwiki/xwiki-rendering/blob/master/xwiki-rendering-macros/xwiki-rendering-macro-html/src/main/java/org/xwiki/rendering/internal/macro/html/HTMLMacro.java#L137 is pretty clear  \n17:06\u00a0<vmassol>\u00a0with the issue that not all renderers will understand it  \n17:06\u00a0<vmassol>\u00a0but maybe it's ok  \n17:07\u00a0<tmortagne>\u00a0but of course if you put non inline content in that html macro then yes you get an error since by default the macro make sure to produce valid stuff but it's normal  \n17:07\u00a0<tmortagne>\u00a0vmassol: again i'm talking about a HTML use case  \n17:08\u00a0<vmassol>\u00a0rendering wiki pages is a HTML use case?  \n17:08\u00a0<vmassol>\u00a0because that seems to be Enygma`'s use case  \n17:08\u00a0<tmortagne>\u00a0when you produce a complex UI full of css and js then it will never work anywhere else than a browser so there is no point in trying to not use html from the start  \n17:09\u00a0<vmassol>\u00a0css and js is different  \n17:09\u00a0<vmassol>\u00a0they're in jsx/ssx objects anyway  \n17:10\u00a0<KermitTheFragger>\u00a0has quit  \n17:10\u00a0<vmassol>\u00a0well what we need is some precise best practice for us to know when it's ok to use the html macro and when it's not  \n17:11\u00a0<vmassol>\u00a0this will become even more an issue when templates are converted to use wiki syntax  \n17:13\u00a0<vmassol>\u00a0cjd: any opninion on http://jira.xwiki.org/browse/XWIKI-10841 ?  \n17:13\u00a0<vmassol>\u00a0(maybe you could reply there)  \n17:16\u00a0<cjd>\u00a0commented  \n17:17\u00a0<vmassol>\u00a0cjd: you want to close as won't fix and win a BFD point?  \n17:17\u00a0<cjd>\u00a0sure  \n17:18\u00a0<vmassol>\u00a0mflorea1: this one should be easy for you if you're looking for a quick BFD issue: http://jira.xwiki.org/browse/XWIKI-10834# ;)  \n17:26\u00a0<Enygma`>\u00a0tmortagne: first time I understand it like that. So basically \"hi{{html}}ho{{/html}}ho\" works, but \"hi{{html}}ho<div>hi</div>{{/html}}ho\" does not  \n17:26\u00a0<Enygma`>\u00a0so it's not because the HTML macro is a block macro  \n17:26\u00a0<Enygma`>\u00a0but because the content \\*inside\\* the html macro is \\*not all inline\\*, when using the html macro inline  \n17:27\u00a0<Enygma`>\u00a0this stuff should be written somewhere :|  \n17:27\u00a0<tmortagne>\u00a0Enygma`: if you put clean=false it works  \n17:27\u00a0<Enygma`>\u00a0yes, I have noticed that and have been using that as a workaround  \n17:27\u00a0<tmortagne>\u00a0that's the html macro itself which validate it's content  \n17:27\u00a0<Enygma`>\u00a0without understanding the real problem  \n17:28\u00a0<Enygma`>\u00a0but only after brute force experiments  \n17:28\u00a0<Enygma`>\u00a0and wasted hours  \n17:28\u00a0<silviar>\u00a0has joined #xwiki  \n17:28\u00a0<silviar>\u00a0has quit  \n17:29\u00a0<tmortagne>\u00a0Enygma`: I don't see the point in producing \"hi{{html}}ho<div>hi</div>{{/html}}ho\", with clean=false or not  \n17:29\u00a0<tmortagne>\u00a0since this does not make sense from html point of view  \n17:30\u00a0<tmortagne>\u00a0the fact that you can force it with clean=false does not really change much  \n17:30\u00a0<Enygma`>\u00a0from a wiki syntax user`s point of view, it does  \n17:30\u00a0<Enygma`>\u00a0from this point of view, the HTML macro is used to allow inputing HTML  \n17:30\u00a0<Enygma`>\u00a0the rendering engine`s inner workings are black voodoo magic and should not concern mere mortals :)  \n17:31\u00a0<Enygma`>\u00a0unless properly documented :P  \n17:31\u00a0<Enygma`>\u00a0but I am not going to wave the \"document this!\" flag too much, since I`m better at it either :)  \n17:31\u00a0<tmortagne>\u00a0putting a <div> in the middle of a paragraph does not make any sense whatever user is doing it  \n17:32\u00a0<Enygma`>\u00a0my only complaint here is that you have no way of dreaming this stuff without getting elbow dirty with the documentation or code  \n17:32\u00a0<Enygma`>\u00a0and I have some years with XWiki :)  \n17:33\u00a0<Enygma`>\u00a0or maybe it`s just my experience  \n17:33\u00a0<tmortagne>\u00a0Enygma`: if you feel that there is something missing in http://extensions.xwiki.org/xwiki/bin/view/Extension/HTML+Macro why don't you add it ?  \n17:33\u00a0<vmassol>\u00a0Enygma`: what we should document is in the xwiki syntax page, in the macro section, we should have some mention about inline and standalone I guess  \n17:33\u00a0<Enygma`>\u00a0another related \"issue\" is that when you write HTML in a regular LAMP scenario, the server outputs the html code \\*your write\\* so it's easier to debug.  \n17:34\u00a0<vmassol>\u00a0and yes for each macro we could document if it suppors inline or not  \n17:34\u00a0<Enygma`>\u00a0in XWIki, the server/XWiki does a lot of cleaning so it can get confusing easy :)  \n17:34\u00a0<Enygma`>\u00a0anyway, thanks for the clarifications :)  \n17:35\u00a0<Enygma`>\u00a0just stating conclusions for now, no proposals yet  \n17:36\u00a0<vmassol>\u00a0what's fun is that you're discovering all this 6-7 years after it's been done :)  \n17:37\u00a0<Enygma`>\u00a0has quit  \n17:37\u00a0<vmassol>\u00a0did I make Edy leave? :)  \n17:38\u00a0<mflorea1>\u00a0no, we're having halloween fun :)  \n17:38\u00a0<vmassol>\u00a0oh so he got scared!  \n17:38\u00a0<mflorea1>\u00a0:D  \n17:38\u00a0<vmassol>\u00a0:)  \n17:53\u00a0<Lyes>\u00a0has joined #xwiki  \n18:05\u00a0<evalica>\u00a0has joined #xwiki  \n18:06\u00a0<OSIMasson>\u00a0has quit  \n18:08\u00a0<evalica>\u00a0has quit  \n18:18\u00a0<cjd>\u00a0has quit  \n18:22\u00a0<OSIMasson>\u00a0has joined #xwiki  \n18:33\u00a0<evalica>\u00a0has joined #xwiki  \n18:34\u00a0<evalica>\u00a0has quit  \n18:40\u00a0<gdelhumeau>\u00a0has quit  \n18:50\u00a0<ebullient1>\u00a0has quit  \n18:50\u00a0<evalica>\u00a0has joined #xwiki  \n18:51\u00a0<evalica>\u00a0has quit  \n19:11\u00a0<lucaa>\u00a0has quit  \n19:16\u00a0<ebullient1>\u00a0has joined #xwiki  \n19:18\u00a0<Enygma`>\u00a0has joined #xwiki  \n19:22\u00a0<woshilapin>\u00a0has quit  \n19:27\u00a0<mflorea1>\u00a0has quit  \n19:28\u00a0<Enygma`>\u00a0has quit  \n19:34\u00a0<ClemensR>\u00a0has quit  \n19:40\u00a0<tmortagne>\u00a0has quit  \n19:43\u00a0<Lyes>\u00a0has quit  \n19:43\u00a0<Lyes>\u00a0has joined #xwiki  \n19:51\u00a0<abusenius\\_>\u00a0has joined #xwiki  \n20:00\u00a0<vmassol>\u00a0has quit  \n20:06\u00a0<mflorea>\u00a0has joined #xwiki  \n20:25\u00a0<OSIMasson>\u00a0has quit  \n20:26\u00a0<sdumitriu1>\u00a0has quit  \n20:26\u00a0<mflorea>\u00a0has quit  \n20:33\u00a0<D-Spair>\u00a0has quit  \n20:40\u00a0<D-Spair>\u00a0has joined #xwiki  \n21:02\u00a0<vmassol>\u00a0has joined #xwiki  \n21:12\u00a0<OSIMasson>\u00a0has joined #xwiki  \n22:01\u00a0<sdumitriu>\u00a0has joined #xwiki  \n22:24\u00a0<vmassol>\u00a0has quit  \n22:27\u00a0<OSIMasson>\u00a0has quit  \n22:27\u00a0<vmassol>\u00a0has joined #xwiki  \n22:50\u00a0<momomomomo>\u00a0has joined #xwiki  \n23:23\u00a0<Chuguniy>\u00a0has joined #xwiki  \n23:34\u00a0<vmassol>\u00a0at last we can build with maven 3.2.3 :)  \n23:38\u00a0<abusenius\\_>\u00a0has quit  \n23:58\u00a0<Lyes>\u00a0has quit\n"}