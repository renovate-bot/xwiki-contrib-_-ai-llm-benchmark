{"id": "dev:IRC.xwikiArchive20150520", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20150520", "title": "IRC Archive for channel #xwiki on 20 May 2015 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<vmassol>\u00a0has quit  \n01:04\u00a0<xwikibot>\u00a0has joined #xwiki  \n03:03\u00a0<MasterPiece>\u00a0has quit  \n03:42\u00a0<martin-h>\u00a0has quit  \n04:14\u00a0<martin-h>\u00a0has joined #xwiki  \n04:39\u00a0<sdumitriu>\u00a0has quit  \n04:54\u00a0<sdumitriu>\u00a0has joined #xwiki  \n06:01\u00a0<Denis2>\u00a0has joined #xwiki  \n06:03\u00a0<Denis>\u00a0has quit  \n06:47\u00a0<mflorea>\u00a0has joined #xwiki  \n07:13\u00a0<DarkKnightCZ>\u00a0has joined #xwiki  \n08:16\u00a0<silverdrop>\u00a0has joined #xwiki  \n08:16\u00a0<MasterPiece>\u00a0has joined #xwiki  \n08:23\u00a0<tmortagne>\u00a0has joined #xwiki  \n08:24\u00a0<msmeria>\u00a0has joined #xwiki  \n08:30\u00a0<KermitTheFragger>\u00a0has joined #xwiki  \n08:44\u00a0<MasterPiece>\u00a0has quit  \n08:48\u00a0<vmassol>\u00a0has joined #xwiki  \n08:53\u00a0<vmassol1>\u00a0has joined #xwiki  \n08:54\u00a0<vmassol>\u00a0has quit  \n08:54\u00a0<vmassol1>\u00a0has quit  \n08:54\u00a0<vmassol>\u00a0has joined #xwiki  \n09:10\u00a0<msmeria1>\u00a0has joined #xwiki  \n09:12\u00a0<msmeria>\u00a0has quit  \n09:13\u00a0<msmeria1>\u00a0is now known as <msmeria>  \n09:17\u00a0<msmeria1>\u00a0has joined #xwiki  \n09:18\u00a0<msmeria>\u00a0has quit  \n09:20\u00a0<Slashman>\u00a0has joined #xwiki  \n09:22\u00a0<gsmeria>\u00a0has joined #xwiki  \n09:25\u00a0<msmeria1>\u00a0has quit  \n09:28\u00a0<msmeria>\u00a0has joined #xwiki  \n09:34\u00a0<evalica>\u00a0has quit  \n09:34\u00a0<evalica1>\u00a0has joined #xwiki  \n09:57\u00a0<gdelhumeau>\u00a0has joined #xwiki  \n09:57\u00a0<cjd>\u00a0has joined #xwiki  \n10:15\u00a0<gdelhumeau>\u00a0has quit  \n10:22\u00a0<cjd>\u00a0has quit  \n10:29\u00a0<gdelhumeau>\u00a0has joined #xwiki  \n10:32\u00a0<cjd>\u00a0has joined #xwiki  \n10:38\u00a0<cjd>\u00a0has quit  \n10:38\u00a0<cjd>\u00a0has joined #xwiki  \n10:38\u00a0<martin-h>\u00a0Hi there, we're facing an OutOfMemory issue (heap space) when deleting a Space in xwiki 6.4.4. The space can be exported with success as XAR (85MB), but can't be deleted. -Xmx is currently 2048m  \n10:39\u00a0<martin-h>\u00a0vmassol or tmortagne \u00a0if you have a quick idea... If not I'll increase heap space size...  \n10:40\u00a0<tmortagne>\u00a0export is actually much better than delete around memory handling right now especially if you have some documents with big attachments  \n10:40\u00a0<tmortagne>\u00a0the issue is that it load in memory each document before deleting it so sometime it can be expensive while export is fully streamed  \n10:40\u00a0<cjd>\u00a0do you have FS attachments enabled?  \n10:41\u00a0<tmortagne>\u00a0probably not  \n10:41\u00a0<martin-h>\u00a0not  \n10:41\u00a0<martin-h>\u00a0hi cjd , nice to see you ;)  \n10:41\u00a0<tmortagne>\u00a0that would improve this memory handling round attachment a lot  \n10:41\u00a0<cjd>\u00a0if so, just delete the big attachments (they're recoverable) and only then delete the document, as I recall that fixes the bug  \n10:41\u00a0<tmortagne>\u00a0s/round/around/  \n10:41\u00a0<cjd>\u00a0also hi...  \n10:41\u00a0<tmortagne>\u00a0yes deleting each attachment separately usually helps  \n10:42\u00a0<cjd>\u00a0the bug is that it tries to \"export\" the document into memory to put it in the document trash, that breaks even with FS attachments  \n10:42\u00a0<martin-h>\u00a0but 85M is not that big !?  \n10:42\u00a0<tmortagne>\u00a0it's not really 85M in memory  \n10:42\u00a0<tmortagne>\u00a085M is the size of the compressed XML  \n10:43\u00a0<martin-h>\u00a0understood  \n10:43\u00a0<cjd>\u00a0attachment \\* base64 (to be put into XML) \\* 2 (because Java represents characters using 16 bit entities), it adds up quickly  \n10:43\u00a0<tmortagne>\u00a0XAR file is a just a zip file with XML for each page in it  \n10:43\u00a0<martin-h>\u00a0tmortagne, yes I forgot about the zip part  \n10:43\u00a0<martin-h>\u00a0Nice to you guys to answer so quickly ;)  \n10:44\u00a0<martin-h>\u00a0I mean thanks.  \n10:44\u00a0<tmortagne>\u00a0you're welcome  \n10:44\u00a0<tmortagne>\u00a0was one of those moment when it's calm in here :)  \n10:45\u00a0<martin-h>\u00a0We also opened a issue ticket at Xwiki SAS for a session 'takeover' issue. \u00a0See the video https://box.ow2.org/public.php?service=files&t=8fec919e43abff5229d3423360124571  \n10:46\u00a0<martin-h>\u00a0it's a very frightening issue  \n10:47\u00a0<martin-h>\u00a0it happens that a logged user is \"in the skin\" of another issue  \n10:47\u00a0<cjd>\u00a0one person suddenly becomes logged in as someone else?  \n10:48\u00a0<martin-h>\u00a0yeS  \n10:48\u00a0<cjd>\u00a0That sounds like the tomcat bug, IMO we really need to start setting our own cookies and considering tomcat to be a hostile environment  \n10:49\u00a0<martin-h>\u00a0we are using tomcat 8.X  \n10:49\u00a0<martin-h>\u00a0it happens with xwiki 5.4.6  \n10:50\u00a0<cjd>\u00a0ok, I think we're not using 8.x in SAS's infra so this could be a regression in 8.x, this was a bug before and we worked around it  \n10:51\u00a0<martin-h>\u00a0Oh. I was so happy to update tomcat during the migration process...  \n10:51\u00a0<cjd>\u00a0nothing in XWiki's authentication infrastructure has changed in years  \n10:54\u00a0<tmortagne>\u00a0XWiki look at the current user in the session so that usually mean that tomcat switched sessions for some reason  \n10:55\u00a0<martin-h>\u00a0cjd, what's that tomcat issue exactly ?  \n10:56\u00a0<martin-h>\u00a0could it be related to apache as we are using it at a reverse proxy ?  \n10:56\u00a0<cjd>\u00a0I don't know the exact details, I think sdumitriu knows more about it, basically tomcat was magically switching a user to a different session and he fixed it with a workaround, it would seem that in 8.x they broke our workaround  \n10:56\u00a0<tmortagne>\u00a0cjd: we don't have any workaround anymore, since a while  \n10:57\u00a0<tmortagne>\u00a0we now expect tomcat to do its job and did not notices this issue since a very long time now  \n10:57\u00a0<martin-h>\u00a0maybe because no that much ppl are using tomcat 8 maybe ?  \n10:57\u00a0<tmortagne>\u00a0martin-h: we pretty much always use apache in front of tomcat too  \n10:57\u00a0<gsmeria>\u00a0has quit  \n10:58\u00a0<martin-h>\u00a0and because the issue is not easily reproducible  \n10:58\u00a0<tmortagne>\u00a0I don't think we use tomcat8 much on our side but I'm not a expert on our installations  \n10:58\u00a0<cjd>\u00a0My understanding is we use 7  \n10:58\u00a0<tmortagne>\u00a0mine too  \n10:59\u00a0<cjd>\u00a0So I'm to understand then that the old bug from tomcat 5 or so has returned in 8 ?  \n10:59\u00a0<martin-h>\u00a0as you see in the video, its pretty random :-O  \n11:00\u00a0<martin-h>\u00a0I have to take a look in tomcat issues to investigate  \n11:00\u00a0<martin-h>\u00a0but it could be a huge issue  \n11:01\u00a0<martin-h>\u00a0cjd, do you have a pointer to the tomcat 5 issue ?  \n11:02\u00a0<cjd>\u00a0tmortagne: do you know if it was reported in JIRA ? \u00a0\u00a0I could not find it before  \n11:04\u00a0<tmortagne>\u00a0cjd: talking about time when sdumitriu added a workaround ?  \n11:04\u00a0<tmortagne>\u00a0I think it was  \n11:04\u00a0<tmortagne>\u00a0checking  \n11:04\u00a0<martin-h>\u00a0thanks to you  \n11:04\u00a0<martin-h>\u00a0maybe we can sort this out ;)  \n11:04\u00a0<Enygma`>\u00a0has joined #xwiki  \n11:05\u00a0<tmortagne>\u00a0looks like http://jira.xwiki.org/browse/XWIKI-4109  \n11:06\u00a0<tmortagne>\u00a0actually the workaround was in http://jira.xwiki.org/browse/XWIKI-3342 I think  \n11:06\u00a0<tmortagne>\u00a0can't find the commit associated to XWIKI-4109  \n11:06\u00a0<evalica1>\u00a0is now known as <evalica>  \n11:07\u00a0<tmortagne>\u00a0looks like jira does not see pre svn->github move commits  \n11:07\u00a0<tmortagne>\u00a0that's weird, I think it used to work  \n11:08\u00a0<gsmeria>\u00a0has joined #xwiki  \n11:14\u00a0<ol-ow2>\u00a0has joined #xwiki  \n11:18\u00a0<gsmeria>\u00a0has quit  \n11:20\u00a0<martin-h>\u00a0anyway I don't have time to install a tomcat 7 and try reproducing now, I am hoping that Xwiki SAS is doing something for it right now ;)  \n11:27\u00a0<cjd>\u00a0has quit  \n11:27\u00a0<cjd>\u00a0has joined #xwiki  \n11:41\u00a0<OSIMasson>\u00a0has joined #xwiki  \n11:56\u00a0<tmortagne>\u00a0has quit  \n11:59\u00a0<gsmeria>\u00a0has joined #xwiki  \n12:24\u00a0<Enygma`>\u00a0has quit  \n12:25\u00a0<Enygma`>\u00a0has joined #xwiki  \n12:42\u00a0<gsmeria>\u00a0has quit  \n12:45\u00a0<gsmeria>\u00a0has joined #xwiki  \n13:03\u00a0<DarkKnightCZ>\u00a0has quit  \n13:07\u00a0<vmassol>\u00a0creating contrib project for raluca  \n13:42\u00a0<vmassol>\u00a0done  \n13:42\u00a0<DarkKnightCZ>\u00a0has joined #xwiki  \n13:43\u00a0<vmassol>\u00a0has quit  \n13:44\u00a0<vmassol>\u00a0has joined #xwiki  \n13:58\u00a0<ClemensR>\u00a0has joined #xwiki  \n14:39\u00a0<msmeria1>\u00a0has joined #xwiki  \n14:41\u00a0<msmeria>\u00a0has quit  \n14:42\u00a0<cjd>\u00a0has quit  \n14:42\u00a0<cjd>\u00a0has joined #xwiki  \n14:48\u00a0<OSIMasson>\u00a0has quit  \n15:16\u00a0<tmortagne>\u00a0has joined #xwiki  \n15:24\u00a0<msmeria>\u00a0has joined #xwiki  \n15:25\u00a0<msmeria1>\u00a0has quit  \n15:30\u00a0<OSIMasson>\u00a0has joined #xwiki  \n15:33\u00a0<evalica1>\u00a0has joined #xwiki  \n15:33\u00a0<gsmeria1>\u00a0has joined #xwiki  \n15:33\u00a0<msmeria1>\u00a0has joined #xwiki  \n15:34\u00a0<evalica>\u00a0has quit  \n15:34\u00a0<msmeria>\u00a0has quit  \n15:34\u00a0<Enygma`>\u00a0has quit  \n15:35\u00a0<gsmeria>\u00a0has quit  \n15:41\u00a0<evalica1>\u00a0is now known as <evalica>  \n15:45\u00a0<gsmeria1>\u00a0has quit  \n15:50\u00a0<Enygma`>\u00a0has joined #xwiki  \n16:00\u00a0<gsmeria>\u00a0has joined #xwiki  \n16:03\u00a0<msmeria1>\u00a0has quit  \n16:03\u00a0<vmassol>\u00a0thanks mflorea for the heads up!  \n16:03\u00a0<vmassol>\u00a0(on the list)  \n16:04\u00a0<mflorea>\u00a0vmassol: np  \n16:14\u00a0<gsmeria>\u00a0has quit  \n16:14\u00a0<gsmeria1>\u00a0has joined #xwiki  \n16:15\u00a0<DarkKnightCZ>\u00a0has quit  \n16:17\u00a0<Enygma`>\u00a0has quit  \n16:19\u00a0<evalica>\u00a0has quit  \n16:29\u00a0<cjd>\u00a0has quit  \n16:29\u00a0<cjd>\u00a0has joined #xwiki  \n16:34\u00a0<silverdrop>\u00a0has quit  \n16:44\u00a0<cjd>\u00a0has quit  \n16:44\u00a0<cjd>\u00a0has joined #xwiki  \n16:50\u00a0<gsmeria1>\u00a0has quit  \n16:51\u00a0<sdumitriu>\u00a0Does anyone remember if the rest system works with custom authenticators?  \n16:51\u00a0<sdumitriu>\u00a0Such as https://github.com/xwiki-contrib/xwiki-authenticator-headers ?  \n16:52\u00a0<tmortagne>\u00a0sdumitriu: I think there is some issue at this level but never looked at it in detail  \n16:55\u00a0<OSIMasson>\u00a0has quit  \n16:56\u00a0<OSIMasson>\u00a0has joined #xwiki  \n17:00\u00a0<KermitTheFragger>\u00a0has quit  \n17:13\u00a0<cjd>\u00a0has quit  \n17:23\u00a0<cjd>\u00a0has joined #xwiki  \n17:32\u00a0<ol-ow2>\u00a0has quit  \n17:45\u00a0<cjd>\u00a0has quit  \n17:49\u00a0<ClemensR>\u00a0has left #xwiki  \n17:53\u00a0<MasterPiece>\u00a0has joined #xwiki  \n17:53\u00a0<MasterPiece>\u00a0has quit  \n18:00\u00a0<mflorea>\u00a0has quit  \n18:02\u00a0<gdelhumeau>\u00a0has quit  \n18:26\u00a0<Bugen\\_do>\u00a0has joined #xwiki  \n19:05\u00a0<sdumitriu>\u00a0tmortagne: FYI, the authenticator works fine on /rest/, the issue was that behind mod\\_proxy\\_http, the URLs in the XMLs were wrong  \n19:06\u00a0<tmortagne>\u00a0sdumitriu: ok great news  \n19:06\u00a0<tmortagne>\u00a0I think there is a few jira issue related to auth and RESt still  \n19:06\u00a0<tmortagne>\u00a0checking  \n19:07\u00a0<tmortagne>\u00a0those I remember are probably XWIKI-7093 and XWIKI-6596  \n19:08\u00a0<tmortagne>\u00a0none of those are really an issue for header auth I guess  \n19:16\u00a0<sdumitriu>\u00a0Indeed  \n19:16\u00a0<sdumitriu>\u00a0Thanks for looking into it  \n19:32\u00a0<vmassol>\u00a0has quit  \n19:39\u00a0<MasterPiece>\u00a0has joined #xwiki  \n20:19\u00a0<tmortagne>\u00a0has quit  \n20:32\u00a0<tmortagne>\u00a0has joined #xwiki  \n20:32\u00a0<vmassol>\u00a0has joined #xwiki  \n20:33\u00a0<Slashman>\u00a0has quit  \n20:36\u00a0<tmortagne>\u00a0has quit  \n21:05\u00a0<debajit>\u00a0has joined #xwiki  \n21:08\u00a0<OSIMasson>\u00a0has quit  \n22:13\u00a0<vmassol>\u00a0has quit  \n23:03\u00a0<Bugen\\_do>\u00a0has quit\n"}