{"id": "dev:IRC.xwikiArchive20160707", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20160707", "title": "IRC Archive for channel #xwiki on 07 July 2016 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<Aranjedeath>\u00a0has quit  \n01:45\u00a0<Aranjedeath>\u00a0has joined #xwiki  \n03:16\u00a0<Aranjedeath>\u00a0has quit  \n03:35\u00a0<Aranjedeath>\u00a0has joined #xwiki  \n03:50\u00a0<Aranjedeath>\u00a0has quit  \n03:56\u00a0<Aranjedeath>\u00a0has joined #xwiki  \n04:29\u00a0<Aranjedeath>\u00a0has quit  \n05:42\u00a0<mflorea>\u00a0has joined #xwiki  \n06:49\u00a0<acotiuga>\u00a0has joined #xwiki  \n07:32\u00a0<msmeria>\u00a0has joined #xwiki  \n08:39\u00a0<KermitTheFragger>\u00a0has joined #xwiki  \n08:58\u00a0<mflorea>\u00a0has quit  \n09:26\u00a0<martinus->\u00a0hi there, I need help with Websocket setup at http://extensions.xwiki.org/xwiki/bin/view/Extension/WebSocket  \n09:27\u00a0<martinus->\u00a0especially with TLS setup  \n09:27\u00a0<martinus->\u00a0I've added three config statement in the properties file : websocket.ssl.enable , websocket.ssl.certChainFile , websocket.ssl.pkcs8PrivateKeyFile  \n09:27\u00a0<martinus->\u00a0followed the documentation to convert to PKCS  \n09:28\u00a0<martinus->\u00a0now I see the curl test return the following :  \n09:28\u00a0<martinus->\u00a0\"gnutls\\_handshake() failed: Public key signature verification has failed.\"  \n09:31\u00a0<martinus->\u00a0and in the container log I see [nioEventLoopGroup-3-1] WARN \u00a0.x.c.w.i.NettyWebSocketService - Netty exceptionCaught() [hidden.io.netty.handler.codec.DecoderException: javax.net.ssl.SSLException: Received fatal alert: decrypt\\_error  \n09:32\u00a0<martinus->\u00a0M-cjd, maybe ?  \n09:46\u00a0<mflorea>\u00a0has joined #xwiki  \n09:53\u00a0<tmortagne>\u00a0has joined #xwiki  \n09:58\u00a0<Slashman>\u00a0has joined #xwiki  \n10:01\u00a0<martinus->\u00a0tmortagne, do you know well about TLS config with http://extensions.xwiki.org/xwiki/bin/view/Extension/WebSocket \u00a0?  \n10:01\u00a0<martinus->\u00a0hi :)  \n10:08\u00a0<martinus->\u00a0I think I understand, the cert and chain file should be bundle in a single file  \n10:17\u00a0<evalica>\u00a0has joined #xwiki  \n10:21\u00a0<Enygma`>\u00a0has joined #xwiki  \n10:45\u00a0<vmassol>\u00a0has joined #xwiki  \n10:45\u00a0<vmassol>\u00a0sorry I hadn't noticed I wasn't connected  \n10:45\u00a0<vmassol>\u00a0good morning  \n10:46\u00a0<vmassol>\u00a0mflorea: we have a potnetial issue  \n10:46\u00a0<vmassol>\u00a0RC1 is not released and today is BFD  \n10:46\u00a0<vmassol>\u00a0so this means commits will be done on master...  \n10:47\u00a0<tmortagne>\u00a0we could create the branch right now  \n10:47\u00a0<tmortagne>\u00a0(would not be the first time)  \n10:47\u00a0<vmassol>\u00a0tmortagne: does that work with our release script?  \n10:48\u00a0<vmassol>\u00a0it creates the branch but does it know to not do that if it already exists?  \n10:48\u00a0<tmortagne>\u00a0vmassol: we did it many times, creating the branch before the RC release so I guess it work yes  \n11:04\u00a0<mflorea>\u00a0tmortagne: I have a small issue. WikiComponentBuilder has a method getDocumentReferences() which normally execute a query on the database. The problem is that if this query uses XWQL with doc.object(Some.Class) then this code depends on the class initializer component (otherwise the query fails) so I don't see how to make sure the class initializer is executed before the wiki components are build.  \n11:05\u00a0<mflorea>\u00a0for instance I get this at build time when the XARs are imported  \n11:05\u00a0<mflorea>\u00a0[WARNING] Failed to query the editors defined in wiki pages. Root cause: [QueryException: could not resolve property: roleHint of: com.xpn.xwiki.objects.BaseObject [ select doc.fullName from com.xpn.xwiki.doc.XWikiDocument as doc , com.xpn.xwiki.objects.BaseObject as editor where ( ( editor.roleHint <> '' or ( editor.roleHint is not null and '' is null ) ) ) and doc.fullName=editor.name and editor.className='XWiki.EditorClass' ]]  \n11:05\u00a0<mflorea>\u00a0I guess I have to use HQL instead  \n11:07\u00a0<tmortagne>\u00a0mflorea: by class initializer you mean mandatory document initializer ?  \n11:07\u00a0<mflorea>\u00a0yes  \n11:07\u00a0<tmortagne>\u00a0I relaly don't see why would XWQL be linked to it in any way  \n11:07\u00a0<tmortagne>\u00a0you can use XWQL even if you class is not managerd by a document initalizer  \n11:08\u00a0<mflorea>\u00a0it seems that when XWQL is transformed into HQL it looks for the xclass prop definition  \n11:08\u00a0<mflorea>\u00a0and if the class is missing \u00a0the query tranformation fails  \n11:08\u00a0<mflorea>\u00a0it needs the xprop definition to be able to generate the HQL  \n11:08\u00a0<mflorea>\u00a0to know which tables to join  \n11:08\u00a0<tmortagne>\u00a0sure but if the class does not exist I don't see how you can have document with object of that class  \n11:09\u00a0<mflorea>\u00a0e.g. StringProperty, NumberProperty, etc.  \n11:09\u00a0<mflorea>\u00a0there's no instance/object  \n11:09\u00a0<mflorea>\u00a0the query simply fails to be executed  \n11:09\u00a0<mflorea>\u00a0because XWQL -> HQL translation fails  \n11:10\u00a0<mflorea>\u00a0because it doesn't have the info (class definition) to compute the HQL  \n11:12\u00a0<lkrejci>\u00a0has joined #xwiki  \n11:12\u00a0<tmortagne>\u00a0if your class is created in a mandatory initializer I don't understand why you don't have it, mandatory are called in updateDatabase  \n11:12\u00a0<mflorea>\u00a0wiki components are registered on ApplicationReadyEvent or WikiReadyEvent  \n11:12\u00a0<mflorea>\u00a0https://github.com/xwiki/xwiki-platform/blob/master/xwiki-platform-core/xwiki-platform-component/xwiki-platform-component-wiki/src/main/java/org/xwiki/component/wiki/internal/DefaultWikiComponentManagerEventListener.java#L120  \n11:12\u00a0<tmortagne>\u00a0before any event that wiki component would listen to  \n11:12\u00a0<mflorea>\u00a0I'm talking about build time, not runtime  \n11:13\u00a0<mflorea>\u00a0for instance when running the tests and when the packager plugin imports the XARs  \n11:13\u00a0<mflorea>\u00a0to prepare the XWiki instance  \n11:13\u00a0<tmortagne>\u00a0the packager plugin send a ApplicationReady event when importing XARs ?  \n11:14\u00a0<mflorea>\u00a0it seems so, otherwise I don't see how the WikiComponentBuilder would be triggered  \n11:14\u00a0<mflorea>\u00a0https://gist.github.com/mflorea/b74ca14b39e8861b73c961ff5f552f57  \n11:14\u00a0<tmortagne>\u00a0then that's the bug, the application is all but ready...  \n11:14\u00a0<tmortagne>\u00a0it's not even running at all  \n11:14\u00a0<tmortagne>\u00a0I don't see why you would want to load components in that case  \n11:23\u00a0<vmassol>\u00a0mflorea: I'm ready to commit on master, should I go ahead?  \n11:23\u00a0<mflorea>\u00a0tmortagne: the packager calls XWiki#updateDatabase() which triggers WikiReadyEvent which triggers the WikiComponentBuilder  \n11:24\u00a0<mflorea>\u00a0what's strange is that WikiReadyEvent is fired after initializeMandatoryDocuments is called, so normally the class should be initialized  \n11:26\u00a0<mflorea>\u00a0vmassol: only if it's some important fix that needs to go in RC1  \n11:27\u00a0<vmassol>\u00a0so we don't do the BFD?  \n11:27\u00a0<mflorea>\u00a0you can keep your commits locally for a few hours  \n11:35\u00a0<lkrejci>\u00a0has quit  \n11:37\u00a0<lkrejci>\u00a0has joined #xwiki  \n11:43\u00a0<lkrejci>\u00a0has quit  \n12:00\u00a0<lkrejci>\u00a0has joined #xwiki  \n12:18\u00a0<lkrejci>\u00a0has quit  \n12:18\u00a0<lkrejci>\u00a0has joined #xwiki  \n12:36\u00a0<tmortagne>\u00a0has quit  \n12:47\u00a0<vmassol>\u00a0mflorea: question: in CKEditor, when clicking full screen there are no action buttons to save/cancel/etc and you need to go back to non full scree. Is this done on purpose of something not finished?  \n12:48\u00a0<vmassol>\u00a0(I'm asking since it's different from what we have now with the GWT editor)  \n12:51\u00a0<tmortagne>\u00a0has joined #xwiki  \n13:21\u00a0<mflorea>\u00a0vmassol: http://jira.xwiki.org/browse/CKEDITOR-13, but you can use the shortcut keys  \n13:42\u00a0<vmassol>\u00a0mflorea: ok thanks  \n13:48\u00a0<lkrejci>\u00a0has quit  \n13:48\u00a0<lkrejci>\u00a0has joined #xwiki  \n14:02\u00a0<mflorea>\u00a0tmortagne: do you know if $doc instance is shared between consecutive {{velocity}} macros? e.g. the first one calls $doc.setTitle() and the second one prints $doc.title  \n14:05\u00a0<mflorea>\u00a0it doesn't seem to be the case, but then I don't understand how https://github.com/xwiki/xwiki-platform/blob/master/xwiki-platform-core/xwiki-platform-release/xwiki-platform-release-ui/src/main/resources/ReleaseCode/ReleaseSheet.xml#L46 could have worked so far  \n14:06\u00a0<vmassol>\u00a0mflorea: I'm in a meeting with tmortagne  \n14:06\u00a0<mflorea>\u00a0ok, np  \n14:17\u00a0<msmeria>\u00a0has quit  \n14:28\u00a0<mflorea>\u00a0tmortagne: actually this was working but I broke it with https://github.com/xwiki/xwiki-platform/commit/17199ab6a87dcf687514beefe633f1c6dcaddc6b#diff-c1673965d66ba4a1d73918c20ec75916L171  \n14:28\u00a0<mflorea>\u00a0it seems I can't remove those lines afterall  \n14:28\u00a0<mflorea>\u00a0:(  \n14:29\u00a0<mflorea>\u00a0because it overwrites the $doc binding each time you open a {{velocity}} macro  \n14:38\u00a0<msmeria>\u00a0has joined #xwiki  \n14:39\u00a0<mflorea>\u00a0I need to find a different solution  \n14:40\u00a0<mflorea>\u00a0I think I have a solution  \n15:18\u00a0<lkrejci>\u00a0has quit  \n15:18\u00a0<lkrejci>\u00a0has joined #xwiki  \n15:34\u00a0<msmeria>\u00a0has quit  \n16:03\u00a0<Pbas>\u00a0Hi, a silly question about velocity coding. I have 2 words and I want to check  \n16:03\u00a0<Pbas>\u00a0Any idea/suggestion? Thxs  \n16:04\u00a0<mflorea>\u00a0Pbas https://docs.oracle.com/javase/8/docs/api/java/lang/String.html#compareTo-java.lang.String-  \n16:08\u00a0<Pbas>\u00a0ho thxs! ... but how can i use it with velocity? with $stringtool ?  \n16:13\u00a0<Pbas>\u00a0@mflorea Ok ty I will try an code example I found on xwiki users list: something like  \n16:13\u00a0<Pbas>\u00a0\u00a0#if($lastCommentDate.compareTo($rcDt.toDate()) > -1  \n16:18\u00a0<mflorea>\u00a0Pbas yep  \n16:38\u00a0<Pbas>\u00a0cool thxs a lot :) it's working. I forgot that i can use javadoc (I checked only xwiki/SRD )  \n16:40\u00a0<acotiuga>\u00a0has quit  \n16:47\u00a0<lkrejci>\u00a0has quit  \n16:47\u00a0<lkrejci>\u00a0has joined #xwiki  \n17:04\u00a0<KermitTheFragger>\u00a0has quit  \n17:34\u00a0<mflorea>\u00a0tmortagne: I need to put back the current wysiwyg editor when running XE tests. One way is to use XWikiExecutorSuite.PreStart as in https://github.com/xwiki/xwiki-platform/blob/master/xwiki-platform-core/xwiki-platform-extension/xwiki-platform-extension-test/xwiki-platform-extension-test-tests/src/test/it/org/xwiki/test/ui/AllTests.java#L51  \n17:35\u00a0<mflorea>\u00a0to modify xwiki.properties  \n17:35\u00a0<tmortagne>\u00a0mflorea: back  \n17:38\u00a0<Aranjedeath>\u00a0has joined #xwiki  \n17:38\u00a0<tmortagne>\u00a0mflorea: I just answered you about $doc on github  \n17:38\u00a0<Aranjedeath>\u00a0has quit  \n17:39\u00a0\\*\u00a0Aranjedeath slaps xwikibot   \n17:39\u00a0<vmassol>\u00a0:)  \n17:39\u00a0\\*\u00a0Aranjedeath brings xwikibot a cake  \n17:39\u00a0<vmassol>\u00a0lol  \n17:40\u00a0\\*\u00a0Aranjedeath brings cookies for vmassol   \n17:41\u00a0<tmortagne>\u00a0mflorea: re \"put back the current wysiwyg editor\", yes setting it in xwiki.properties is easy  \n17:41\u00a0<tmortagne>\u00a0we are already setting things like this in various UI test projects  \n17:41\u00a0<mflorea>\u00a0but I need to do it for each text module that creates pages  \n17:41\u00a0<mflorea>\u00a0using the UI and the wysiwyg editor  \n17:42\u00a0<mflorea>\u00a0s/text/test  \n17:42\u00a0<tmortagne>\u00a0there is not many modules that do that in XE  \n17:42\u00a0<mflorea>\u00a0I think I need to do it for test-ui, selenium and wysowyg  \n17:42\u00a0<tmortagne>\u00a0for WYSIWYG for sure :)  \n17:42\u00a0<mflorea>\u00a0yes :)  \n17:43\u00a0<lkrejci>\u00a0has quit  \n17:46\u00a0<mflorea>\u00a0tmortagne: regarding $doc, you mean checking if xcontext.getDoc() != $doc.getDocument(), the issue is that $doc.getDocument() checks for programming rights, and getDoc() returns a clone.  \n17:47\u00a0<tmortagne>\u00a0mflorea: compare the document reference is enough  \n17:47\u00a0<mflorea>\u00a0I see  \n17:47\u00a0<tmortagne>\u00a0xcontext.getDoc() != $doc.getDocument() would nit work anyway since it's cloned  \n17:47\u00a0<tmortagne>\u00a0we could imagine more elaborate thing but I think document reference is enough  \n17:48\u00a0<edvorg>\u00a0has joined #xwiki  \n17:48\u00a0<mflorea>\u00a0ok, I will leave this part for 8.2 final or later, I'll add it to the TODO list on http://jira.xwiki.org/browse/XWIKI-13528  \n17:50\u00a0<mflorea>\u00a0finishing with http://jira.xwiki.org/browse/XE-1562 by putting the current wysiwyg editor back for tests using XWikiExecutorSuite.PreStart  \n17:54\u00a0<tmortagne>\u00a0mflorea: taking care of XWikiScriptContextInitializer  \n17:54\u00a0<mflorea>\u00a0ok, thanks  \n17:58\u00a0<tmortagne>\u00a0mflorea: no problem, also give me an excuse to fix the fact that sdoc is missing in the script context  \n17:59\u00a0<mflorea>\u00a0indeed, I noticed that  \n18:10\u00a0<evalica>\u00a0has quit  \n18:11\u00a0<lkrejci>\u00a0has joined #xwiki  \n18:16\u00a0<tmortagne>\u00a0mflorea: done  \n18:17\u00a0<Enygma`>\u00a0has quit  \n18:31\u00a0<tmortagne>\u00a0has quit  \n18:45\u00a0<lkrejci>\u00a0has quit  \n18:56\u00a0<mflorea>\u00a0has quit  \n19:11\u00a0<lkrejci>\u00a0has joined #xwiki  \n19:36\u00a0<sdumitriu>\u00a0has quit  \n19:37\u00a0<sdumitriu>\u00a0has joined #xwiki  \n19:47\u00a0<lkrejci>\u00a0has quit  \n19:47\u00a0<lkrejci>\u00a0has joined #xwiki  \n19:50\u00a0<Aranjedeath>\u00a0has quit  \n19:56\u00a0<lkrejci>\u00a0has quit  \n20:00\u00a0<lkrejci>\u00a0has joined #xwiki  \n20:49\u00a0<Slashman>\u00a0has quit  \n21:08\u00a0<evalica>\u00a0has joined #xwiki  \n21:13\u00a0<edvorg>\u00a0has quit  \n21:15\u00a0<evalica>\u00a0has quit  \n22:12\u00a0<[d\\_\\_d]>\u00a0has quit  \n22:15\u00a0<moep>\u00a0has quit  \n22:29\u00a0<[d\\_\\_d]>\u00a0has joined #xwiki  \n22:33\u00a0<[d\\_\\_d]>\u00a0has quit  \n22:57\u00a0<[d\\_\\_d]>\u00a0has joined #xwiki  \n23:05\u00a0<vmassol>\u00a0has quit  \n23:09\u00a0<Aranjedeath>\u00a0has joined #xwiki  \n23:24\u00a0<lkrejci>\u00a0has quit  \n23:24\u00a0<lkrejci>\u00a0has joined #xwiki  \n23:24\u00a0<lkrejci>\u00a0has quit  \n23:31\u00a0<moep>\u00a0has joined #xwiki  \n23:32\u00a0<marcules>\u00a0has joined #xwiki  \n23:36\u00a0<moep>\u00a0has quit\n"}