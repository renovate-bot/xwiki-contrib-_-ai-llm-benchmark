{"id": "dev:IRC.xwikiArchive20101021", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20101021", "title": "IRC Archive for channel #xwiki - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\nxwikibot joined #xwiki at 08:36  \nsdumitriu joined #xwiki at 08:43  \nsdumitriu - (08:43): vmassol: Are you sure about the fix-for for XWIKI-2612?  \nvmassol - (08:44): sdumitriu: I think it's fine. I wondered which one to put but since this was done before your branched I think it's fine  \nvmassol - (08:44): s/your/you/  \nsdumitriu - (08:44): K  \nasrfel joined #xwiki at 08:48  \nsburjan joined #xwiki at 08:58  \nStulle joined #xwiki at 09:02  \nStulle - (09:03): morning  \nStulle - (09:04): sburjan: did you get around testing the attachment upload / revisioning? i reported it the day before yesterday along with this server error: http://pastebin.ca/1967063  \nsburjan - (09:04): I thought you solved that  \nStulle - (09:05): nope  \nStulle - (09:07): doesn't work here. just tested it again with Opera 10.63 and IE 8  \nsburjan - (09:08): I will test that  \nStulle - (09:09): thanks  \nsdumitriu - (09:09): Stulle: That's a data problem  \nsdumitriu - (09:09): It can't be reproduced at will  \nsdumitriu - (09:10): Means that you have some fubar data in there  \nStulle - (09:10): sorry, i don't understand that  \nStulle - (09:10): could you explain that?  \nsdumitriu - (09:10): \"Failed to load archive for attachment [[[email\u00a0protected]](https://dev.xwiki.org/cdn-cgi/l/email-protection)\u00e4che]. This attachment is broken, please consider re-uploading it\"  \nsdumitriu - (09:11): The data in the database is bad, and prevents handling the attachment  \nsdumitriu - (09:11): Can you delete it?  \nStulle - (09:11): O\\_o i can  \nStulle - (09:11): and i uploaded it without any problem  \nsdumitriu - (09:11): And then the error comes back?  \nStulle - (09:11): i don't see how it can be bad because the picture shows fine  \nStulle - (09:12): the error can be reproduced with probably any file here  \nsdumitriu - (09:12): It's the archive that is broken, not the file  \nStulle - (09:12): attachment  \nsdumitriu - (09:12): Hm, really?  \nsdumitriu - (09:12): On any document?  \nStulle - (09:12): yep, just tried another document and another attachment (image) and it still fails  \nStulle - (09:13): this time it was PDMLink.Hilfe and Lokale.Hilfe.png  \nStulle - (09:13): but no success either  \nsdumitriu - (09:13): Can you try using a page and filename without any accents? \u00fc and \u00f6 and stuff  \nsdumitriu - (09:13): Hm, you did that  \nStulle - (09:13): yep, hold on  \nsburjan - (09:14): sdumitriu: are you available today ?  \nsdumitriu - (09:14): sburjan: No, not at all  \nStulle - (09:14): okay, so i opened Sandbox.TestPage2 without any changes in that page  \nsdumitriu - (09:14): Just a few minutes to spare now  \nStulle - (09:15): uploaded Lokale.Hilfe.png  \nStulle - (09:15): defaced my local copy  \nsburjan - (09:15): okay. I'll wait for tmortagne then  \nStulle - (09:15): tried to re upload it  \nStulle - (09:15): revision stays at 1.1  \nStulle - (09:15): and it's still the same old thing  \nsdumitriu - (09:15): Again the error?  \nStulle - (09:15): indeed  \nsdumitriu - (09:15): Try this:  \nsdumitriu - (09:16): From the attachment list, click on the version number  \nsdumitriu - (09:16): It should lead to the attachment history table  \nsdumitriu - (09:16): Does that load OK?  \nStulle - (09:16): yep  \nStulle - (09:16): it does  \nStulle - (09:16): and it only states one revision  \nsburjan - (09:17): Stulle: I have no such problem  \nStulle - (09:18): O\\_O the XWiki instance runs on an Windows 7 x64 environment on Tomcat 7.0.2 and PostgreSQL 9.something  \nStulle - (09:18): might it be a Windows-only bug, again?  \nsdumitriu - (09:18): Clicking on the revision from that table displays the image fine?  \nStulle - (09:18): it shows the initially uploaded picture just fine  \njvdrean joined #xwiki at 09:19  \nsdumitriu - (09:19): XWiki should run fine on Windows as well  \nsdumitriu - (09:19): OK, I have to go now  \nsdumitriu - (09:19): Bye  \nsdumitriu left at 09:19 (Quit: Leaving.  \nStulle - (09:19): i know but the other day i found a bug that would only affect XWiki instances on win  \nfmancinelli joined #xwiki at 09:19  \nStulle - (09:19): bye  \nvenkatesh left at 09:19 (Remote host closed the connection  \nStulle - (09:21): so... any other suggestions?  \nrrodriguez left at 09:22 (Quit: rrodriguez  \nfmancinelli left at 09:26 (Ping timeout: 255 seconds  \narkub joined #xwiki at 09:30  \nStulle - (09:40): okay, i have no idea what is causing this error but i can tell this much, now it's even affecting other features, such as reverting a revision of a page from, say 3.1 to 2.1...  \ntmortagne joined #xwiki at 09:41  \nDenis left at 09:42 (Quit: Leaving.  \nDenis joined #xwiki at 09:43  \nsburjan - (09:43): tmortagne: ping  \ntmortagne - (09:47): sburjan: pong  \nsburjan - (09:47): I have investigated with mflorea the OO problem  \nsburjan - (09:48): so basically there wasn't a GUB, I was saving the wrong page  \nsburjan - (09:48): but I'm still not able to start OO from Admin Page  \nsburjan - (09:49): resaved XWikiPreference and still not working  \ntmortagne - (09:50): sburjan: and it's not a priviledge issue ?  \nsburjan - (09:50): well I am admin, edit the page as admin, and save it. Still won't start  \nsburjan - (09:51): do I have to set PR from Rights page \u00a0for Admin ?  \ntmortagne - (09:51): i mean you don't get error about priviledge N  \ntmortagne - (09:51): ?  \nsburjan - (09:52): yes, I get an error. But until now, resaving the XWikiPreference page doesnt fix it now  \ntmortagne - (09:52): AFAIK the only page that matters is XWikiPreference so i don't see what page you could save resave  \nsburjan - (09:53): well this page I'm talking about  \nxipe\\_ left at 09:53 (\\*.net \\*.split  \nnuvolari left at 09:53 (\\*.net \\*.split  \narkub left at 09:53 (\\*.net \\*.split  \nsburjan` left at 09:53 (\\*.net \\*.split  \nmflorea - (09:54): tmortagne: you said that XWiki.XWikiPreferences has Guest as author but on a clean instance (jetty+hsqldb) we see Administrator as the creator and last author, and still we can't start OO from the Admin section  \nmflorea - (09:54): by \"see\" I mean using XWiki/XWikiPreferences?viewer=information  \ntmortagne - (09:55): mflorea: i debugged on a fresh instance and seen that PR was tested on XWikiPReference page and that the user found was XWikiGuest  \nxipe joined #xwiki at 09:55  \narkub joined #xwiki at 09:55  \nsburjan` joined #xwiki at 09:55  \ntmortagne - (09:56): i did not checked the UI  \nnuvolari joined #xwiki at 09:56  \nmflorea - (09:56): hmm, strange, because the UI show different information  \ntmortagne - (09:57): maybe the content author and the author are different  \ntmortagne - (09:57): that happen sometimes  \ntmortagne - (09:57): i did not digged more  \nmflorea - (09:58): maybe, but the fact is that we edit/saved XWiki.XWikiPreferences and we still can't start OO from the Admin section  \nmflorea - (09:59): we then edited/saved XWiki.AdminSheet (which is included by XWiki.XWikiPreferences) and still no success  \ntmortagne - (10:01): there used to be one page to resave to make OO admin UI works for sure  \ntmortagne - (10:02): just checked and resaving XWikiPreference does not help with PR right on EM admin UI  \ntmortagne - (10:02): so it's another page, but that's the page i seen in debug mode  \ntmortagne - (10:02): i don't understand  \ntmortagne - (10:03): hmm  \ntmortagne - (10:03): thinking something  \ntmortagne - (10:04): maybe cjdelisle used the forget PR feature he instroduced recently in Configurable system  \nmflorea - (10:04): (note that we can start OO from the office admin page)  \nvenkatesh joined #xwiki at 10:04  \ntmortagne - (10:05): mflorea: yes the right issue is about admin UI which does not care where is the code, RM has the exact same issue  \nrrodriguez joined #xwiki at 10:06  \ntmortagne - (10:06): retesting in debug mode after saving XWikiPreference  \njvdrean left at 10:06 (Quit: Leaving.  \nfmancinelli joined #xwiki at 10:12  \nvenkatesh left at 10:12 (Quit: Leaving  \njvelociter joined #xwiki at 10:15  \nvenkatesh joined #xwiki at 10:17  \njvelociter - (10:21): Hi guys. I don't know if it's a known issue or not. On XWiki 2.4, in Chrome (Mac OS), I can't give focus to the WYSIWYG paste from clipboard textarea.  \njvelociter - (10:22): (sburjan mflorea )  \nmflorea - (10:22): known, let me give you the jira issue  \ntmortagne - (10:23): mflorea: so just retested and when i call hasProgrammingRights in a script service the context document is \"XWiki.XWikiPreferences\"  \njvelociter - (10:23): OK, great  \nmflorea - (10:23): here it is http://jira.xwiki.org/jira/browse/XWIKI-4503  \ntmortagne - (10:23): so it's related to it for sure  \njvelociter - (10:23): thanks  \ntmortagne - (10:24): diging more to find why it still does not work when XWikiPreference has the proper author  \ntmortagne - (10:24): mflorea: there is something very weird  \nmflorea - (10:24): jvelociter: np  \nmflorea - (10:24): tmortagne: what?  \ntmortagne - (10:25): doc.getContentAuthor(); get me \"XWiki.XWikiGuest\"  \ntmortagne - (10:25): so resaving a document seems to not be enough anymore  \ntmortagne - (10:25): to change the content author  \nmflorea - (10:26): hmm, maybe you have to really change the content, not just save with no changes  \ntmortagne - (10:26): and that's why it does not work anymore to resave XWikiPreference  \ntmortagne - (10:26): looks like we have to critical bug here  \ntmortagne - (10:26): it was not like that before  \ntmortagne - (10:27): s/to/come/  \ntmortagne - (10:27): s/come/some/  \ntmortagne - (10:28): mflorea: just tested modified the content and content author is still XWikiGuest...  \nmflorea - (10:28): :| that's bad  \ntmortagne - (10:28): looks like it never changed whatever  \nrrodriguez left at 10:28 (Quit: rrodriguez  \ntmortagne - (10:28): yes pretty bad  \ntmortagne - (10:29): checking on a \"normal\" document  \ntmortagne - (10:32): hmm looks like it's specific to XWikiPreference or it's something else  \ntmortagne - (10:32): the content author is changed when i test on another document  \ntmortagne - (10:34): i don't understand what's wrong with XWikiPreference, checking the save  \njvdrean joined #xwiki at 10:39  \nEnygma` joined #xwiki at 10:40  \nmflorea - (10:42): tmortagne: indee. I changes shortcuts.vm to display contentAuthor besides author and for XWiki.XWikiPreferences I get author: XWiki.mflorea and contentAuthor: XWiki.XWikiGuest after I save the page with XWiki.mflorea  \ntmortagne - (10:42): i can seen that save set the proper content author even for XWikiPreference when \"$xwiki.getDocument(\"XWiki.XWikiPreference\").getContentAuthor()\" return XWiki.XWikiGuest  \ntmortagne - (10:42): i don't understand a thing  \ntmortagne - (10:42): and it's really specific to XWikiPreferences only  \ntmortagne - (10:42): i don't have that with Test.PR document  \ntmortagne - (10:43): s/when/but/  \ntmortagne - (10:43): i need to check the database  \ntmortagne - (10:45): so, it's not a save issue: the database has XWiki.Admin as content author  \nmflorea - (10:45): then cache?  \ntmortagne - (10:46): hmm  \ntmortagne - (10:46): the content author is set in hibernate store  \nmflorea - (10:46): :) guess what  \ntmortagne - (10:47): but it's working for other docs...  \nmflorea - (10:47): I restarted the server and I have XWiki.mflorea as contentAuthor  \ntmortagne - (10:47): are you able to reproduce the bug on other page ?  \ntmortagne - (10:47): maybe i dreamed it  \ntmortagne - (10:48): retesting  \nmflorea - (10:48): let me check, but I don't think so  \ntmortagne - (10:49): no i did not dreamed it, it's working very well  \nmflorea - (10:49): nop, for other pages the contentAuthos is updated correctly  \nmflorea - (10:49): maybe XWiki.XWikiPreferences is handled in a special way the the cache  \ntmortagne - (10:49): i hope not...  \nevalica joined #xwiki at 10:50  \ntmortagne - (10:55): mflorea: after cjdelisle change saveXWikiDoc now simply remove the document from the cache so i don't understand how we can have cache inconsistency, let's see what happen in loadXWikiDoc  \nsburjan - (10:59): so this seems to be much deeper than we thought  \ntmortagne - (11:10): worst and worst, put a breakpoint in loadXWikiDoc just after a save and the contentauthor of XWikipreference document is right  \ntmortagne - (11:10): as it should be since it loads it form the db, i cheked and it can't find it in the cache  \ntmortagne - (11:12): hmm  \ntmortagne - (11:12): cjdelisle: ping  \ntmortagne - (11:13): i think i remember forget PR system is working by setting the current document author to \"XWiki.XWikiGuest\"...  \ntmortagne - (11:13): that would explain it  \ntmortagne - (11:14): not sure  \ntmortagne - (11:15): it explain it for Admin UI if cjdelisle use it in Configurable system but not when testing on the document itself  \ntmortagne - (11:20): mflorea: the document is right after the call to XWiki#getDocument so it's something that explicitly set contentAuthor to XWikiGuest somewhere, it's not remembered  \ntmortagne - (11:20): are you sure the contentAuthor is right after a restart ?  \ntmortagne - (11:20): i don't understand how it's possible  \nmflorea - (11:23): yes, I'm sure  \nmflorea - (11:23): let me try again  \ntmortagne - (11:24): then i don't understand since it's really not a cache issue for sure  \nsilviar joined #xwiki at 11:25  \nvenkatesh left at 11:27 (Ping timeout: 265 seconds  \ntmortagne - (11:32): but after the first view the document in cache is indeed wrong, but because it's modified by something  \nmflorea - (11:34): tmortagne: there's something wrong with the administration code. I save the page, contentAuthor is guest, I restart the server, contentAuthor is mflorea, I enter one of the administration sesction, contentAuthor becomes guest again. I restart the server, contentAuthor becomes mflorea again. So there is code in administration that temporarily sets contentAuthor to guest  \nmflorea - (11:34): have to leave now, I'll be back after lunch  \nmflorea left at 11:35 (Quit: Leaving.  \ntmortagne - (11:35): haha i found something  \ntmortagne - (11:35): i think i know what's wrong  \ntmortagne - (11:35): and i think it's related to new forget PR system  \ntmortagne - (11:36): ( cjdelisle: i would really need you here )  \njvdrean left at 11:37 (Quit: Leaving.  \ntmortagne - (11:40): creating a blocker jira issue for now  \nvenkatesh joined #xwiki at 11:44  \nvenkatna joined #xwiki at 11:44  \ntmortagne - (11:49): ( cjdelisle: see XWIKI-5601 when you are ready)  \nsburjan - (11:51): good we found this at least  \nsburjan - (11:52): and last  \nvmassol - (11:53): yes good catch!  \nvmassol - (11:54): btw are the office importer tests executed on hudson?  \nsburjan - (11:54): spent my last 2 days figuring if it's me doing something wrong or it's a bug  \nvenkatesh left at 11:55 (Ping timeout: 252 seconds  \nvenkatna left at 11:55 (Ping timeout: 255 seconds  \ntmortagne - (12:00): vmassol: i doubt that  \ntmortagne - (12:00): sicne i doubt we have a OO installed on agents  \ntmortagne - (12:00): s/sicne/since/  \nsburjan - (12:01): yeah, I don' think so either  \nvmassol - (12:04): so that's indeed a problem to catch oo import issues  \nsburjan - (12:05): I usually test that manually  \nsburjan - (12:06): vmassol: http://www.xwiki.org/xwiki/bin/view/Main/ReleaseNotesXWikiEnterprise25 .Can you check the API breakages ? I'm mainly done with polishing, reordering TOC by relevance and importance, etc.  \nvmassol - (12:07): sburjan: it's wrong  \nvmassol - (12:07): needs to be fixed  \nsburjan - (12:07): I know it's wrong, you said it yesterday, but I don't know how to fix it ...  \nvmassol - (12:07): and the RN for M2 and RC1 need to be udpated too for the breakages  \nvmassol - (12:07): I don't have time to work on this now  \nsburjan - (12:07): okay. I'll remind you tomorrow  \nmflorea joined #xwiki at 12:13  \ncjdelisle - (12:21): tmortagne, Configurable changes it's author to protect itself if it has PR  \njvdrean joined #xwiki at 12:23  \nvmassol - (12:26): sburjan: interwiki links section should be moved to xwiki syntax 2.1  \nvmassol - (12:26): since it only works with xwiki syntax 2.1 AFAIR  \nvmassol - (12:26): hmm need to check that  \nvmassol - (12:26): but the syntax that is mentioned is xwiki syntax 2.1  \nvmassol - (12:27): ok I've implemented it for both syntaxes  \nvmassol - (12:27): so we should give examples for both syntaxes  \ntmortagne - (12:27): cjdelisle: ok but see my last messages  \ntmortagne - (12:29): Configurable is one thing, the major issue here is that the system to drop permission modify the document content author in cache  \ncjdelisle - (12:29): So you are unable to save XWikiPreferences or unable to give it PR?  \ntmortagne - (12:29): it's not about PR  \ntmortagne - (12:29): it's about cache corumption  \nlucaa joined #xwiki at 12:30  \ntmortagne - (12:30): if you call use once the system to drop permission you change the document content author for everyone  \ntmortagne - (12:30): not just for the code your are currently exeuting  \ntmortagne - (12:30): which is very bad  \ntmortagne - (12:30): s/exeuting/executing/  \ncjdelisle - (12:31): Actually dropPermissions() protects against that, the problem is the code in Configurable does the same thing and predated dropPermissions()  \ntmortagne - (12:31): the fact that Configurable force droping persmission whatever the application is another thing an i sent a mail about that to discuss it  \ntmortagne - (12:32): cjdelisle: i don't know what Configurable system is using, all i know is that it's modifying the document in cache and that it was not like that before  \ntmortagne - (12:32): so whatever the real cause it's a blocker bug  \ncjdelisle - (12:33): I'm not sure it would be a very good idea to hand PR to anyone who put a Configurable object in their document but we can discuss that,  \ntmortagne - (12:33): cjdelisle: again it's not the issue  \ntmortagne - (12:34): if you want to discuss that please answer the mailm  \ntmortagne - (12:34): what i'm discussing here is cache corumption  \ncjdelisle - (12:34): I did indeed make a mistake but it was hidden before because the cache was being continuously updated on document save.  \ntmortagne - (12:35): cjdelisle: i don't see why  \ntmortagne - (12:35): the cache would have been modified each time you go on admin UI  \ntmortagne - (12:35): si the fact that cache is fixed when you save does not hidde much  \ntmortagne - (12:35): we don't save XWikiPreferences very often  \ncjdelisle - (12:36): indeed. Perhaps it was hidden by a clone statement which nolonger exists.  \ncjdelisle - (12:36): #if($xcontext.hasProgrammingRights())  \ncjdelisle - (12:36): \u00a0\u00a0\u00a0\u00a0$xcontext.getContext().getDoc().setContentAuthor('XWiki.XWikiGuest')##  \ncjdelisle - (12:36): ^^ I remember testing against your problem and not finding it so something changed.  \ntmortagne - (12:37): i doubt someone change the way XWikiContext is set  \ncjdelisle - (12:37): Replacing with the new api $xcontext.dropPermissions() will make that problem go away since dropPermissions does not modify the document.  \ntmortagne - (12:37): could you takee care of that ?  \ncjdelisle - (12:38): no pb  \ntmortagne - (12:38): then we will discuss about what to do about programming right needs in different applications UI but it's not blocker for 2.5 since it's not very new in case of OO  \ntmortagne - (12:39): hmm except that it's all the time now actually  \ntmortagne - (12:40): since you force it all the time in Configurable now  \ncjdelisle - (12:40): all the time?  \ncjdelisle - (12:41): this change is not compatible with 2.4 so this means I will have to make a branch of the admin app as per the application dev method?  \ntmortagne - (12:42): cjdelisle: yes all the time, how could you have programming right in OO admin \u00a0UI if Configurable system drop it ?  \ntmortagne - (12:42): IMO instead of dropping programming right you should change the context document to the one containing the Configurable object  \nEnygma` - (12:42): Hi... can anyone tell me if I can access an XWiki component from non-componentized code, without depending on xwiki-core (Utils.getComponent) and it's whole (huge) dependency chain?  \nEnygma` - (12:42): The initialization of the non-componentized code is my responsability, and not of the XWiki component manager, so I can`t really use @Requirement either.  \nEnygma` - (12:42): The code will be running from inside XWiki's environment, but it should also run from outside it, using the above XWiki component only if it is available.  \ntmortagne - (12:43): that way it's application choice if you need PR or not  \ncjdelisle - (12:43): That only works once.  \ntmortagne - (12:43): what only works once ?  \ncjdelisle - (12:43): Once you switch to a non pr document, you can't very well reach back up and get PR again.  \ncjdelisle - (12:44): And obviously you can't switch security documents without PR.  \ntmortagne - (12:44): when to switch from admin section to another you reload the page  \ntmortagne - (12:44): so i don't see the issue  \ntmortagne - (12:45): it's not because you drop permission in one section that you loose it it others  \ntmortagne - (12:45): since they have diferent contexts  \ncjdelisle - (12:45): One section may be made up of multiple configurable objs in multiple documents but I see that a hack could be made to make it work in your case.  \ntmortagne - (12:45): lunch time for me, annyway this is to discuss in the mail instead of here  \ntmortagne - (12:46): important thing now is to fix cache corumption  \nvmassol - (12:48): hmm is this a clirr bug:  \nvmassol - (12:48): [INFO] [clirr:check {execution: clirr-check}]  \nvmassol - (12:48): [INFO] Comparing to version: 2.5-rc-1  \nvmassol - (12:48): [ERROR] org.xwiki.component.descriptor.ComponentInstantiationStrategy: Method 'public org.xwiki.component.descriptor.ComponentInstantiationStrategy[] values()' is now final  \ncjdelisle - (12:48): This can be fixed here, cash corruption will return again because we don't have an immutable type of XWikiDocument.  \nvmassol - (12:49): I don't get the clirr error locally  \nvmassol - (12:49): (it's on hudson that I noticed the problem)  \ncjdelisle - (12:51): I have to make a change to the admin app which will make it incompatible with core 2.4. Does this mean I need to create a branch now?  \nrrodriguez\\_ joined #xwiki at 12:52  \ncjdelisle - (12:53): I am going to go ahead without creating any branch because a look at the applications/branches section shows it is obviously not standard practice.  \nvmassol - (13:01): warning: going to change all svn ignores for all directories in which there's a pom.xm in order to harmonize them all  \nvmassol - (13:01): right now I have the following:  \nvmassol - (13:01): target  \nvmassol - (13:01): \\*.iml  \nvmassol - (13:01): \\*.ipr  \nvmassol - (13:01): \\*.iws  \nvmassol - (13:01): .classpath  \nvmassol - (13:01): .project  \nvmassol - (13:01): .settings  \nvmassol - (13:01): \\*.log.\\*  \nvmassol - (13:01): \\*.log  \nvmassol - (13:01): target-eclipse  \nvmassol - (13:01): atlassian-ide-plugin.xml  \nvmassol - (13:01): .sonar-ide.properties  \nvmassol - (13:01): .clover  \nvmassol - (13:02): .checkstyle  \ntmortagne - (13:02): cjdelisle: for admin app see http://svn.xwiki.org/svnroot/xwiki/enterprise/branches/xwiki-enterprise-2.4/pom.xml  \ntmortagne - (13:03): admin app is already incompatible with 2.4 branch  \nvmassol - (13:03): bin?  \ntmortagne - (13:04): and 2.4 will be branch will be closed when 2.5 starts  \nvmassol - (13:04): .hg\\*  \ntmortagne - (13:04): vmassol: \"[ERROR] org.xwiki.component.descriptor.ComponentInstantiationStrategy: Method 'public org.xwiki.component.descriptor.ComponentInstantiationStrategy[] values()' is now final\" is a JVM thing  \ntmortagne - (13:05): we already talked about that  \ntmortagne - (13:05): it's because sdumitriu did the last release with Java 6  \ntmortagne - (13:05): so when you build build 1.5 now clirr see differences  \nvmassol - (13:05): hmm even the RC1?  \nvmassol - (13:05): I thought it was a problem of m2  \ntmortagne - (13:05): only the RC1 AFAIK  \nvmassol - (13:06): ok  \nvmassol - (13:06): so I need to add back the exception right?  \ntmortagne - (13:07): checking  \nvmassol - (13:07): hmm I don't see it in the exclusions I've removed  \nvmassol - (13:07): which is normal  \nvmassol - (13:07): since we were comparing to 2.4 I guess  \nvmassol - (13:07): ok adding it then  \nevalica left at 13:07 (Read error: Connection reset by peer  \ntmortagne - (13:08): hmm actually the issue i'm talking about was in a plugin  \ntmortagne - (13:08): not in core  \ntmortagne - (13:08): tag plugin  \ntmortagne - (13:08): but it's the same  \ncjdelisle - (13:08): Stulle, what version of XWiki are you running?  \ntmortagne - (13:08): it's bacause RC1 has been released \u00a0with Java 6  \ntmortagne - (13:09): anyway the fix is the same: release with 1.5 this time  \ntmortagne - (13:10): ( have to go, back in about 1h )  \ncjdelisle - (13:19): ``archive Oberflaeche.Uebersicht.png of document PDMLink.Oberfl\u00e4che'' \u00a0I wonder if this is repeatable when the document name has no \u00e4 in the name.  \nsburjan - (13:25): vmassol: so should I move interwiki under Syntax 2.1 ?  \nvmassol - (13:25): sburjan: no  \nvmassol - (13:25): but you need to change the text, ok I'll do it  \nsburjan - (13:25): you do it,because you know the syntax too  \nvmassol - (13:25): just committed revision 32000 :)  \nsburjan - (13:26): GG :D  \nsburjan - (13:26): If I want to learn how to do the API breakages, I should read about clirr ?  \nvmassol - (13:26): we have some info in the release process  \nvmassol - (13:27): http://dev.xwiki.org/xwiki/bin/view/Community/ReleaseProcess  \nsburjan - (13:27): thanks, I'll give it a try  \nasrfel left at 13:31 (Quit: Leaving.  \nvmassol - (13:31): mflorea: I see some tomcat dirs in platform/web, do you know why there's there and if it's possible to put them in target?  \nmflorea - (13:32): they are generated by gwt maven plugin, let me see if I can change the path  \nStulle - (13:34): sorry, was afk  \nStulle - (13:34): sburjan: i am using RC1  \nvmassol - (13:35): mflorea: maybe this helps: http://gwt-maven.googlecode.com/svn/docs/maven-googlewebtoolkit2-plugin/tomcatlite.html  \nStulle - (13:35): with Java 1.6 update 21  \nvmassol - (13:35): (although we're not using this plugin AFAIR)  \nStulle - (13:35): although i upgraded to 22 earlier today  \nStulle - (13:35): whoops, actually it was cjdelisle who tried to message me ;)  \nsburjan - (13:35): Stulle: sty the latest snapshot  \nStulle - (13:35): my bad  \nsburjan - (13:35): \\*try  \nsburjan - (13:35): we're about to release 2.5 final soon  \nmflorea - (13:36): vmassol: we're using http://mojo.codehaus.org/gwt-maven-plugin/ but might be related  \ncjdelisle - (13:36): Not sure the latest snapshot will be batter.  \nStulle - (13:36): where can i obtain this snapshot?  \ncjdelisle - (13:36): \\*better  \nsburjan - (13:36): let me give you the link  \nsburjan - (13:36): cjdelisle: I tested on latest snapshot, and I don't have that issue  \nvmassol - (13:36): mflorea: \u00a0it is :)  \nvmassol - (13:36): vmassol@gwt-maven-plugin $ find . -name \"\\*.java\" -exec grep -H tomcat {} \\;  \nvmassol - (13:36): ./src/main/java/org/codehaus/mojo/gwt/shell/RunMojo.java: \u00a0\u00a0\u00a0\u00a0\\* @parameter default-value=\"${project.build.directory}/tomcat\"  \nStulle - (13:36): well, you guys tell me what to test and i'll give it a shot  \nStulle - (13:37): this is still not a fully productive environment, so i don't mind  \nvmassol - (13:37): mflorea: the conf variable is \"tomcat\"  \nvmassol - (13:37): \u00a0\u00a0\u00a0\u00a0/\\*\\*  \nvmassol - (13:37): \u00a0\u00a0\u00a0\u00a0\u00a0\\* Specify the location on the filesystem for the generated embedded Tomcat directory.  \nvmassol - (13:37): \u00a0\u00a0\u00a0\u00a0\u00a0\\*  \nvmassol - (13:37): \u00a0\u00a0\u00a0\u00a0\u00a0\\* @parameter default-value=\"${project.build.directory}/tomcat\"  \nvmassol - (13:37): \u00a0\u00a0\u00a0\u00a0\u00a0\\*/  \nvmassol - (13:37): \u00a0\u00a0\u00a0\u00a0private File tomcat;  \nsburjan - (13:37): Stulle: try this http://maven.xwiki.org/snapshots/com/xpn/xwiki/products/xwiki-enterprise-jetty-hsqldb/2.5-SNAPSHOT/xwiki-enterprise-jetty-hsqldb-2.5-20101020.163354-300.zip .This is the closest thing to 2.5 final  \nvmassol - (13:38): but  \nmflorea - (13:38): vmassol: why \u00a0isn't it listed in the public mojo  \nvmassol - (13:38): projet.build.directory is target \u2026.  \nmflorea - (13:38): for instance http://mojo.codehaus.org/gwt-maven-plugin/compile-mojo.html  \nvmassol - (13:38): mflorea: no idea, I always go to the source ;)  \nStulle - (13:38): alright, just gonna finish something i am editing now and then i'll give it a shot  \nmflorea - (13:39): vmassol: ok, I'll add this config  \nvmassol - (13:39): so the only reason I can see is that the gwt plugin changes the target dir\u2026. that would be strabge  \nvmassol - (13:39): strage  \nvmassol - (13:41): btw mflorea I see this in our config :  \nvmassol - (13:41): \u00a0<!-- HACK: We inject the GWT arguments in the out parameter because we have no other option. -->  \nvmassol - (13:41): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<out>target/www-test${gwt.args}</out>  \nvmassol - (13:41): we hsould never hardcode target normally but instead use ${project.build.directory}  \nmflorea - (13:41): yes, I'll change this, but it's not related  \nvmassol - (13:42): yep  \nvmassol - (13:42): I still don't understand why the target dir is not correct...  \nvmassol - (13:42): hmm let me check the sources for the version we're using  \ncjdelisle - (13:43): Stulle can you run a snippet of code and tell me the output?  \nvmassol - (13:44): mflorea: no luck, it's the same  \nvmassol - (13:44): (in the 1.2 sources)  \nStulle - (13:44): sure  \nStulle - (13:44): just gimme the code  \nvmassol - (13:44): https://svn.codehaus.org/mojo/tags/gwt-maven-plugin-1.2/src/main/java/org/codehaus/mojo/gwt/shell/RunMojo.java  \ncjdelisle - (13:45): {{groovy}}println(xcontext.getContext().getAttachmentVersioningStore());{{/groovy}}  \ncjdelisle - (13:45): 1\u00a2 says that returns 'null'  \nStulle - (13:46): O\\_o Failed to execute the [groovy] macro  \ncjdelisle - (13:47): err oops.  \ncjdelisle - (13:47): {{groovy}}println(xcontext.getContext().getWiki().getAttachmentVersioningStore());{{/groovy}}  \ncjdelisle - (13:47): That's wht I wanted.  \nStulle - (13:47): just a sex  \nStulle - (13:47): \\*sec  \nStulle - (13:47): lol  \nStulle - (13:48): com.xpn.xwiki.store.hibernate.HibernateAttachmentVersioningStore@5bd44e0b  \ncjdelisle - (13:49): hmm. that's strange because it's an null pointer exception.  \nabusenius joined #xwiki at 13:49  \nStulle - (13:49): so? what should i do now?  \ncjdelisle - (13:50): I'll go get a coffee and think it over.  \ncjdelisle - (13:50): It doesn't look like a typical db corruption error.  \nStulle\\_ joined #xwiki at 13:51  \nStulle\\_ - (13:51): sorry, my clumsy self hit the wrong button again  \nStulle\\_ - (13:51): what were you saying?  \ncjdelisle - (13:51): <Stulle> so? what should i do now?  \ncjdelisle - (13:51): <cjdelisle> I'll go get a coffee and think it over.  \ncjdelisle - (13:51): <cjdelisle> It doesn't look like a typical db corruption error.  \nStulle\\_ - (13:51): okay  \nStulle\\_ - (13:51): so should i give the snapshot a try?  \ncjdelisle - (13:52): I don't think anything changed between the RC and the snapshot.  \nStulle\\_ - (13:52): okay, so i'll just continue my editing work  \nStulle\\_ - (13:52): i'll try to keep an eye on the chat in case you need something from me  \ncjdelisle - (13:52): What's worse is it may cause isolation of the issue to be harder.  \nStulle\\_ - (13:53): i don't get the last bit...  \nsburjan - (13:53): vmassol: do we have JIRA category for tests ? I have to create a issue un UI-Tests  \nStulle\\_ - (13:54): oh, being a c++ hobbyist programmer i know how much fun it is to make somebody a slave for testing! ;)  \nStulle left at 13:54 (Ping timeout: 265 seconds  \nStulle\\_ - (13:54): programmer = developer... ;)  \nStulle\\_ is now known as Stulle (8123cca2@gateway/web/freenode/ip.129.35.204.162  \ncjdelisle - (13:54): I have puts'd around with c a little bit.  \nvmassol - (13:56): sburjan: if you're talking about component yes we have one in jira  \ncjdelisle - (13:56): c vs java speed test http://pastebin.com/raw.php?i=JKjkuydk  \nvmassol - (13:56): sburjan: in this case it's the enterprise jira project  \nvmassol - (13:56): since the code is in enterprise/  \nsburjan - (13:56): vmassol: I need a category so I can create issues and attach tests  \nvmassol - (13:56): it's called a component  \nvmassol - (13:57): (not category)  \nsburjan - (13:57): ok  \nvmassol - (13:57): (which is something else)  \nsburjan - (13:57): so I'll create issues on XE .. since the code gets committed there  \nvmassol - (13:57): and agai  \nvmassol - (13:57): there's one  \nvmassol - (13:57): please check it  \nsburjan - (13:58): Build, Infrastructure and Tests  \nsburjan - (13:58): ok  \nmflorea - (14:02): vmassol: using ${project.build.directory}/www-test instead of target/www-test leads to a /home/marius/.. directory in the root of my module.. it seems that ${project.build.directory} is the absolute path not just \"target\" and gets appended to the module directroy..  \nvmassol - (14:03): yes all paths are absolute  \nvmassol - (14:03): but that's not the problem  \nvmassol - (14:03): the problem is that it doesn't point to taregt  \nvmassol - (14:03): target  \nvmassol - (14:04): which is the part I don't understand  \nmflorea - (14:04): I'm not talking about the tomcat dir problem here  \nmflorea - (14:04): I'm referring to the wrong config, where target was hardcoded  \nvmassol - (14:05): it's the same issue apparently  \nmflorea - (14:05): I tried to replace \"target\" with ${project.build.directory} and it creates a /home/mariu/.. in module dir  \nvmassol - (14:05): so at least we know how to fix the tomcat one too  \nvmassol - (14:05): ;)  \nvmassol - (14:05): let me dig a bit in maven to make sure that project.build/directory is supposed to be target  \nvmassol - (14:06): http://docs.codehaus.org/display/MAVENUSER/MavenPropertiesGuide  \nvmassol - (14:06): should be fine\u2026. I don't get it  \nvmassol - (14:07): at least for now you can set <tomcat>target/tomcat</tomcat>  \nvmassol - (14:07): note that the pb with relative paths is when you execute the build in a multi module project  \nvmassol - (14:07): since it means you'll get your output files in the wrong directory  \nvmassol - (14:08): (ie the top level project from where you started the build)  \nmflorea - (14:08): yes, the directory I get in my module is home/marius/work/eclipse/xwiki-web/xwiki-gwt-wysiwyg-client/target/www-test/ so ${project.build.directory} is /home/marius/work/eclipse/xwiki-web/xwiki-gwt-wysiwyg-client/target  \nvmassol - (14:08): ah ok so it's good  \nvmassol - (14:08): then I don't understand what you're saying I guess  \nvmassol - (14:08): (and I don't understand why the default tomcat var is not pointing to the right place)  \nmflorea - (14:09): so, I build from /home/marius/work/eclipse/xwiki-web/xwiki-gwt-wysiwyg-client and I get  \nmflorea - (14:09): /home/marius/work/eclipse/xwiki-web/xwiki-gwt-wysiwyg-client/home/marius/work/eclipse/xwiki-web/xwiki-gwt-wysiwyg-client/target/www-test  \nvmassol - (14:09): good  \nmflorea - (14:10): how can I specify a relative path to ${project.build.directory} in my pom?  \nvmassol - (14:11): you shouldn't do that  \nvmassol - (14:11): as I said it's wrong  \nvmassol - (14:11): it'll lead to problems  \nvmassol - (14:11): (when building from top level modules)  \nvmassol - (14:12): this is why you should never hardcode target actually  \nmflorea - (14:13): then how can I avoid hardcoding \"target\" if using ${project.build.directory} doesn't work as expected  \nvmassol - (14:13): it works as expected  \nvmassol - (14:13): what's wrong with it?  \nmflorea - (14:13): look again at my paths, the second path is duplicated  \nmflorea - (14:14): I guess gwt or maven-gwt-plugin expects a relative path  \nmflorea - (14:14): and resolves the given path relative to the current dir  \nvmassol - (14:14): yes that's possible that the plugin is not correct  \nvmassol - (14:14): but forget this for a moment  \nvmassol - (14:14): I don't understand why the tomcat location is wrong  \nStulle - (14:17): small question for the pro's, i need to increase MaxPermSize in tomcat and i found the apropriate flag, however, i am uncertain how to use the flag on a tomcat install that is installed as a service on windows... any suggestions?  \nvmassol - (14:18): mflorea: out is used by which mojo?  \nmflorea - (14:18): http://mojo.codehaus.org/gwt-maven-plugin-1.2/test-mojo.html  \nvmassol - (14:19): indeed default value is:  \nvmassol - (14:19): \u00a0\u00a0\u00a0\u00a0/\\*\\*  \nvmassol - (14:19): \u00a0\u00a0\u00a0\u00a0\u00a0\\* output directory for code generated by GWT for tests  \nvmassol - (14:19): \u00a0\u00a0\u00a0\u00a0\u00a0\\* @parameter default-value=\"target/www-test\"  \nvmassol - (14:19): \u00a0\u00a0\u00a0\u00a0\u00a0\\*/  \nvmassol - (14:19): \u00a0\u00a0\u00a0\u00a0private String out;  \nvmassol - (14:19): checking code further  \nvmassol - (14:19): why do you need to specify it?  \nvmassol - (14:19): ah you're changing it sorry  \nvmassol - (14:20): mflorea: indeed:  \nvmassol - (14:20): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0new File( getProject().getBasedir(), out ).mkdirs();  \nvmassol - (14:20): that's why you have it twice  \nvmassol - (14:20): a bug IMO  \nmflorea - (14:20): it's a hack, I want to append something to the gwt arguments  \nvmassol - (14:20): anyway that's solved, we should write a comment about it  \nvmassol - (14:20): now remains the tomcat location issue  \nmflorea - (14:20): ok  \nmflorea - (14:21): I tried with <tomcat>target/tomcat</tomcat> and tomcat is still in module dir  \nvmassol - (14:22): mflorea: seems there's a 2.1.0 version of the plugin  \nvmassol - (14:23): hmm not released it seems  \nmflorea - (14:24): on their site 1.2 is the latest stable  \nmflorea - (14:25): btw, tomcat dir is created by the test goal. it isn't created if I skip tests  \ntmortagne - (14:29): cjdelisle: i see you did not assigned yourself on XWIKI-5601  \ntmortagne - (14:30): (you should also move it if it's really not a core thing)  \nSvenDowideit left at 14:31 (Ping timeout: 255 seconds  \nsburjan - (14:31): we should reply to sergiu not to start the release until we fix that  \nSvenDowideit joined #xwiki at 14:32  \nasrfel joined #xwiki at 14:39  \ntmortagne - (14:39): sburjan: i already did  \nsburjan - (14:39): reminder for laszlo removal  \nsburjan - (14:39): okay .. great  \ntmortagne - (14:39): (i did when i created the jira issue)  \nvmassol - (14:40): (and when you replied to the release vote mail)  \ntmortagne - (14:40): vmassol: i meant i replied to the release vote mail when a created the issue ;)  \nvmassol - (14:40): I know, it was for sburjan  \ntmortagne - (14:40): (in case sburjan did not received the mail yet because of mail server issues)  \nsburjan - (14:41): I don't have it.  \nsburjan - (14:41): I'll restart tb  \nsburjan - (14:42): yes.. now I have it  \nsburjan - (14:44): but tb keeps crashing  \nsburjan - (15:01): anybody has any idea why we don't have hungarian language in XE ? I see many translations on the language page, but I don't have hu in my XW  \nflorinciu joined #xwiki at 15:02  \ncjdelisle - (15:11): tmortagne, I plan to test the change now and I will then assign/move/close the issue.  \ntmortagne - (15:11): cjdelisle: ok  \ncjdelisle - (15:12): did you send mail to the dev list? I don't see it. (my email co has been having some trouble lately.)  \nsburjan - (15:20): yeah.. you're not the only one with problems  \ncjdelisle - (15:22): hmm I thought it was me and not the list because jira mail was taking a long time too.  \ncjdelisle - (15:25): heh, my change won't be available unless the 2.0-SNAPSHOT of administration is reconciled with the 1.44-SNAPSHOT of the XE dependency.  \njvelociter - (16:01): lucaa: did you find your way to transforn an array in list in the end ?  \njvelociter - (16:01): (i have the same need right nwo)  \nlucaa - (16:01): jvelociter: manually :(  \njvelociter - (16:01): k  \nlucaa - (16:01): I wrote myself a nice macro  \nlucaa - (16:01): to parse a string actually  \nlucaa - (16:02): to parse the same syntax that you can use for java macros, the one resembling the java array declaration syntax  \nlucaa - (16:02): you want it?  \nrrodriguez\\_ left at 16:02 (Quit: rrodriguez\\_  \nvmassol - (16:06): lucaa: sounds like duplicated code\u2026. :)  \nlucaa - (16:07): vmassol: are you doing that on purpose?  \nvmassol - (16:07): sure  \nlucaa - (16:07): (yes it is duplicate code)  \nlucaa - (16:07): normally we should expose the beanutils parser or something like that, we discussed with tmortagne... but the pb is that it won't work on existing versions  \ntmortagne - (16:09): lucaa: it's not really about beanutils parser but simply adding type support for wiki macro parameters  \nlucaa - (16:09): or yes, that  \nlucaa - (16:09): which would allow more than parsing  \nvmassol - (16:09): I wonder how hard this is vs coding a new method to parse params ;)  \ntmortagne - (16:10): vmassol: technically it's nothing but we have to define how we actually describe types for wiki macros (name of the field, etc...)  \nlucaa - (16:11): and we need to support existing macros without types, etc  \nlucaa - (16:11): but I guess that was just to tease me, isn't it? ;) (how hard it is vs parsing...)  \nvmassol - (16:11): both  \ntmortagne - (16:11): lucaa: that would just mean that the default type is String i guess  \nvmassol - (16:11): (to tease you and seriously)  \nlucaa - (16:11): tmortagne: yes, that should be it  \nlucaa - (16:12): however I cannot grasp all the implications of the parameters atm, so I will not get too deep in this conversatin  \nlucaa - (16:12): conversation  \nlucaa - (16:12): what would be interesting is to have new macros (with typed params) work on old rendering...  \nlucaa - (16:13): but that's only a nice to have  \narkub left at 16:13 (Ping timeout: 276 seconds  \ntmortagne - (16:14): IMO there is nothing special to do to support that  \ntmortagne - (16:14): as i said just mean that when the type is not specified it's String then you support old macros  \nlucaa - (16:14): the other way around I was thinking  \nlucaa - (16:15): like I write the recent changes macro for 2.6 with typed params and I would like it to work as well on a 2.4  \nlucaa - (16:15): nothing should stop it from working except of the types  \ntmortagne - (16:15): you would have to handle it in you macro  \ntmortagne - (16:16): if the macro expect parameters to be typed there is no way to make it work in 2.4  \nlucaa - (16:16): yes, indeed  \nlucaa - (16:16): and supporting would actually mean writing it 2.4 style  \ntmortagne - (16:17): yep you haver to write your macro based on the \u00a0lowest version for which you support the API and hope it's not broken in more recent versions but it's like for anything else  \nlucaa - (16:17): I just managed to reproduce the  \nlucaa - (16:17): \"Unknown macro: spaces\" on a 2.5RC1 :(  \ncjdelisle - (16:25): XAADMINISTRATION-185 is fixed, for version 2.0, remember to upgrade the version in enterprise/pom.xml  \nsburjan - (16:26): great.. tomorrow I'll test it  \nvmassol - (16:27): a sad panda is a dangerous panda, be careful  \nsburjan - (16:28): :))  \ncjdelisle - (16:28): ^^ hehe \u00a0\u00a0\u00a0\u00a0... \u00a0\u00a0enterprise/pom.xml needs to be upgraded to XAADMIN-2.0 or XAADMIN next version needs to be changed in order to see it.  \narkub joined #xwiki at 16:29  \narkub left at 16:30 (Read error: Connection reset by peer  \ntmortagne - (16:30): 2.0 version for admin is still not voted AFAIK  \ntmortagne - (16:31): until it is or not jira should be modified  \ntmortagne - (16:31): vmassol: WDYT ?  \nvmassol - (16:32): tmortagne: for a 2.0 vs a 1.x?  \nvmassol - (16:32): I repllied alreayd on the list I think  \nvmassol - (16:32): basically I'm not fond  \nvmassol - (16:32): (of a 2.0)  \ncjdelisle - (16:32): New changes to XAADMIN are not getting to XE because the versions in the poms are not in sync.  \ntmortagne - (16:32): WDYT about put back 1.x until it's really decided  \nvmassol - (16:32): yes +1 to that  \ntmortagne - (16:32): fixing it then  \nvmassol - (16:33): again I'm not against a 2.x but I'd like a global rule for all apps  \ntmortagne - (16:34): i don't have string opinion on that, i just want it to be a real decision and not some idea someone found nice and decided alone to do it  \nvmassol - (16:35): agreed  \ntmortagne - (16:38): done  \ntmortagne - (16:40): looks like XE 2.5-SNASHOT pom.xml is wrong, sdumitriu did not put back SNASPHOT dependencies after release which means hudson does not test with the last versions of applications/plugins  \nlucaa - (16:42): cjdelisle: did you report the issue with unknown macro?  \nlucaa - (16:43): when installing from war + .xar?  \ncjdelisle - (16:43): I don't think so because nobody else noticed it.  \nlucaa - (16:43): I did, just now  \nlucaa - (16:44): I will report it then  \ncjdelisle - (16:44): It's a short trip ^^  \ncjdelisle - (16:46): Does anyone have opinions about the thought of adding a suite of unit tests which run with the database and wiki available?  \nvmassol - (16:46): cjdelisle: that's exactly the point of the functional tests we have  \nvmassol - (16:46): in enterprise/distribution-tests  \ncjdelisle - (16:47): There are things to test like how store behaves with a corrupt database and I have been abusing ui-tests to do such things  \ncjdelisle - (16:47): aka pasting scripts into the editor to test things which are not apparent to the user.  \nvmassol - (16:47): cjdelisle: well we have various types of tests already in distrinution-tests  \nvmassol - (16:47): so you want to know where to put storage tests?  \nvmassol - (16:48): (functional storage tests)  \nsburjan - (16:48): cjdelisle: yes, I aggee with you. It's not right to paste velocity code in ui-tests  \nsburjan - (16:48): ui test should use ui  \ncjdelisle - (16:49): I'm not sure if storage is the only use case. It seems that sometimes you want to test everything as a whole but need the flexibility of a unit test.  \nvmassol - (16:49): cjdelisle: that's what we have in distribution)tests in several places  \nvmassol - (16:49): ldap, rest, misc, etc  \nvmassol - (16:49): so misc could be a good place if you have only a few  \nvmassol - (16:49): but if you have a lot then a new category might be needed  \nvmassol - (16:50): OTOH I'm not sure if we should test databases  \nvmassol - (16:50): it's the role of the database project to do that  \nvmassol - (16:50): (ie hsqldb, mysql, etc)  \ncjdelisle - (16:50): \"we shouldn't have to\" can be dangerous words.  \nvmassol - (16:50): test database = test the interaction with the DB  \nvmassol - (16:51): testing that we behave correctly if the DB is down must be done  \nlucaa - (16:51): tmortagne: do you want XE-727 ? or should I start digging it?  \nvmassol - (16:51): but that doesn't require a DB  \ntmortagne - (16:51): lucaa: don't have time right now and could not reproduce it in debug mode so if you do better debugging it yourself  \nlucaa - (16:51): ok  \nvmassol - (16:51): are you sure that can't do your tests as unit tests?  \nvmassol - (16:51): (cjdelisle)  \ncjdelisle - (16:52): Well I think the differences between dbs is a fact of life. Hibernate cannot abstract us perfectly from the db's oddities.  \nvmassol - (16:52): sure but you do see the amoint of work that it represents  \nsburjan left at 16:52 (Quit: Ex-Chat  \nvmassol - (16:52): to redo hibernate's work  \nvmassol - (16:52): (in testing)  \ncjdelisle - (16:52): As unit tests, hmm. I would be mocking the database and it still wouldn't prove anything for sure.  \ncjdelisle - (16:53): aka you never really know until you put it together.  \nvmassol - (16:53): I think I could be convinced but only for real bugs that we want fixed and not for potential bugs before they happen  \nvmassol - (16:53): anyway it's a proposal to make  \nvmassol - (16:53): I'm very worried with the trend though  \nvmassol - (16:54): the trend that it could set  \ncjdelisle - (16:54): Real bugs = attachments disappear.  \nvmassol - (16:54): we already have trouble testing our code  \nvmassol - (16:54): :)  \nvmassol - (16:54): yes but that's easy to unit tests  \ncjdelisle - (16:54): What's the trend? We bite off too much work?  \nvmassol - (16:54): simply mock the db so that hibernate doesn't return an attachment that is supposed to be there  \nvmassol - (16:55): it's very different from testing a DB oddity  \ncjdelisle - (16:55): ``simply mock the db'' lol  \nvmassol - (16:55): we have a storage IF  \nvmassol - (16:55): I didn't say to stub it  \nvmassol - (16:55): that would be a lot of work  \nvmassol - (16:56): basically: there's a bug, we analyse the problem, we find that hibernate returns such thing and we want to make sure our code handles it  \nvmassol - (16:56): so we mock the hib storage  \nvmassol - (16:56): to return the same thing and perform the test  \nvmassol - (16:56): would that work?  \ncjdelisle - (16:57): I have to think about it.  \ncjdelisle - (16:57): I'm weary of using unit tests to prove that something is working. IMO unit tests debug but they don't prove.  \nvmassol - (16:58): hmm strange got a build issue with the lucene \u00a0plugin  \nvmassol - (16:58): analyzing  \nvmassol - (16:58): unit tests prove that your code works  \nvmassol - (16:58): it doesn't prove integration  \nsilviar left at 16:58 (Quit: Leaving.  \nvmassol - (16:59): if we had only functional tests  \nvmassol - (16:59): xwiki's build would take about 2 days  \nvmassol - (16:59): and  \ncjdelisle - (16:59): well the executors could run a bit faster but you make a good point.  \nvmassol - (16:59): when something fails you spend days trying to find where the problem is  \ncjdelisle - (16:59): It would seem that any bug which the affects the user and slips by needs a functional test.  \nvmassol - (16:59): since you have to debug a functional test failning  \nvmassol - (17:00): while a unit tests pinpoints the pb exactly  \ncjdelisle - (17:00): Indeed, unit tests debug for you.  \nvmassol - (17:00): both are needed  \nvmassol - (17:00): I agree  \nvmassol - (17:00): it's just a question of balance  \ncjdelisle - (17:00): functional test fails, write unit test to debug problem, now you have both.  \nvmassol - (17:00): and ensuring that something cannot be proved with a reasonable confidence with a unit tes  \nvmassol - (17:00): test  \nvmassol - (17:01): cjdelisle: well unit tests have other advnatages  \nvmassol - (17:01): they are design tools  \nvmassol - (17:01): so you really need to start by writing them  \nvmassol - (17:01): to have good code  \nvmassol - (17:01): they are users of your code  \nvmassol - (17:01): and as such tell you how good your code is to use  \nvmassol - (17:01): so you need them sooner than later  \ncjdelisle - (17:02): Unfortunately xwiki-core is pretty untestable.  \nvmassol - (17:02): yes  \nvmassol - (17:02): hence why we refactor stuff out as separate redesigned modules  \ncjdelisle - (17:02): I blame the dependency graph for it's difficulty in testing.  \ncjdelisle - (17:03): When I did xwiki-crypto, I found writing tests to be a breeze and almost never mocked anything.  \nvmassol - (17:03): tmortagne: just got a lucene build problem I've never seen  \nvmassol - (17:03): Tests run: 3, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 29.621 sec <<< FAILURE!  \nvmassol - (17:03): testIndexUpdater(com.xpn.xwiki.plugin.lucene.IndexUpdaterTest) \u00a0Time elapsed: 7.444 sec \u00a0<<< FAILURE!  \nvmassol - (17:03): junit.framework.AssertionFailedError: expected:<1> but was:<0>  \nvmassol - (17:03): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0at junit.framework.Assert.fail(Assert.java:47)  \nvmassol - (17:03): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0at junit.framework.Assert.failNotEquals(Assert.java:282)  \nvmassol - (17:03): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0at junit.framework.Assert.assertEquals(Assert.java:64)  \nvmassol - (17:03): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0at junit.framework.Assert.assertEquals(Assert.java:201)  \nvmassol - (17:03): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0at junit.framework.Assert.assertEquals(Assert.java:207)  \nvmassol - (17:03): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0at com.xpn.xwiki.plugin.lucene.IndexUpdaterTest.testIndexUpdater(IndexUpdaterTest.java:229)  \nvmassol - (17:03): have you seen this before?  \ntmortagne - (17:04): no  \ncjdelisle - (17:04): well I'll see about mocking hibernate.  \ntmortagne - (17:05): i mean i seen when the test was not working obviously but lucene did not changed recently  \nvmassol - (17:05): yes that's the strange part  \nvmassol - (17:05): ok taking risk in committing my stuff without a full build\u2026. crossing fingers  \ntmortagne - (17:05): maybe there is some environment related thing in this test but i don't thing so  \ntmortagne - (17:06): checking quickly  \nmflorea left at 17:06 (Quit: Leaving.  \nvmassol - (17:06): rebuilding just lucene module to retest  \nvmassol - (17:07): worked this time  \nvmassol - (17:07): the tests are very long  \nvmassol - (17:07): 1mn in total  \ntmortagne - (17:08): this test ?  \nvmassol - (17:08): so something is fishy  \ntmortagne - (17:08): or you mean the whole plugin  \nvmassol - (17:08): yes the whole plugin  \nvmassol - (17:08): Running com.xpn.xwiki.plugin.lucene.IndexUpdaterTest  \nvmassol - (17:08): 2010-10-21 17:07:26,166 [Finalizer] ERROR lucene.LucenePlugin \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0- Lucene plugin will exit !  \nvmassol - (17:08): Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 15.454 sec  \nvmassol - (17:08): Running com.xpn.xwiki.plugin.lucene.AttachmentDataTest  \nvmassol - (17:08): 2010-10-21 17:07:34,210 [Finalizer] ERROR lucene.LucenePlugin \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0- Lucene plugin will exit !  \nvmassol - (17:08): Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 5.384 sec  \nvmassol - (17:08): Results :  \nvmassol - (17:08): Tests run: 9, Failures: 0, Errors: 0, Skipped: 0  \nvmassol - (17:08): still 15 + 5 seconds is a lot  \ntmortagne - (17:09): the plugin has som wait  \nrrodriguez\\_ joined #xwiki at 17:09  \nvmassol - (17:09): rebuilding the whole platform once more \u2026 \\*sigh\\*  \nvmassol - (17:10): (20 minutes wasted! yeah)  \narkub joined #xwiki at 17:10  \ntmortagne - (17:10): but 5 minutes is way too much AFAIK  \nvmassol - (17:10): 5 miutes?  \nvmassol - (17:10): it took 1mn but that's a lot already  \nlucaa - (17:11): tmortagne: is this the issue you said it existed about registering wiki macros ? http://jira.xwiki.org/jira/browse/XWIKI-4861 and which was fixed?  \nlucaa - (17:11): or there is another one?  \ntmortagne - (17:11): so a read the \"5.384\" as minutes  \ntmortagne - (17:11): s/so/sorry/  \ntmortagne - (17:12): lucaa: i'm not sure what you are talking about but XWIKI-4861 has nothing to do with your use case  \nlucaa - (17:12): well, more or less, it's a failure to register wiki macros, indeed not on import but...  \ntmortagne - (17:13): lucaa: if you had failure to register a macor you would see it in the log  \ntmortagne - (17:13): no in your case i think for some reason wiki macro module don't see a document has been added or something like that  \ntmortagne - (17:13): IMO it's more related to events  \nlucaa - (17:13): yes, I am trying to look at that  \nlucaa - (17:14): I just remembered you said that there was a fixed issue about this  \nlucaa - (17:14): and I was wondering  \ntmortagne - (17:14): (which is what i checked last time but import produce the proper event as far as i can see in the log and in the debug mode test i did)  \nlucaa - (17:14): ok  \ntmortagne - (17:14): don't remember talking about an issue on that but maybe  \nlucaa - (17:14): ok  \nStulle - (17:16): hey  \nvmassol - (17:16): tmortagne: any take on where we would put \"standard\" transformations? A new module in rendering? One module per transformation sounds too much though maybe, wdyt?  \nStulle - (17:17): ist there actually the possibility to localize the macro strings?  \nvmassol - (17:17): Stulle: yes but....  \ntmortagne - (17:17): vmassol: one module for each thing is never too much for me, you know that ;)  \nvmassol - (17:17): (I'll let marius finish :))  \nvmassol - (17:18): tmortagne: I was sure you'd say this  \nvmassol - (17:18): tmortagne: but you agree with a new module right?  \nvmassol - (17:18): (at least one)  \ntmortagne - (17:20): if you put all transformation in the same module i'm not sure why you want to separate it from rendering-api but if the reason is to finally make rendering-api a real API only then yes sure  \nvmassol - (17:20): yes that was my idea  \nStulle - (17:20): well, i'm excited for the but because i was actually gonna offer to contribute a german translation  \nvmassol - (17:20): and to be in line with macros being outside  \ntmortagne - (17:21): Stulle: if it's about existing macros you can do to http://l10n.xwiki.org  \ntmortagne - (17:21): s/do/go/  \nStulle - (17:21): sounds good to me  \ntmortagne - (17:21): but most of them are already translated AFAIK  \ntmortagne - (17:22): (but i don't follow german translation)  \nStulle - (17:22): well, i got the feeling the german translation could need some serious polishing here and there  \ntmortagne - (17:23): Stulle: \u00a0sure, it's fully contribution so it's possible there is need for improvements  \ntmortagne - (17:23): BTW it's possible some recent macro don't have the proper translation keys setup  \ntmortagne - (17:24): if you find some (or if you don't actually), don't hesitate to create jira issues  \nStulle - (17:24): yep... oh and i noticed that the box macro documentation seems to be outdated  \ntmortagne - (17:24): we need to find some way to easily sychronise macro translations keys  \nStulle - (17:25): well, i'll have to do some other work first but once i finished this bit i think i'll not get into trouble for improving the localization  \nvmassol - (17:37): still some problems to build enterprise  \nlucaa - (17:38): tmortagne: found it: all events are sent correctly and processed, except that at the moment of the import of Main.Spaces, XWiki.Admin, which is its author and is supposed to have rights to register wiki wide macro, doesn't exist, yet, because it wasn't yet imported  \nvmassol - (17:38): ah that's because I still have 2.0 in applications  \nvmassol - (17:38): for admin ap  \ntmortagne - (17:39): lucaa: that explain why it did work in my existing database when admin was already there  \ntmortagne - (17:39): s/whn/where/  \nlucaa - (17:39): tmortagne: \u00a0ah, yes, the issue is only on the first import  \nlucaa - (17:39): initial import over the war  \nlucaa - (17:40): any ideas about how to fix this? or we just leave it open and ask users nicely to restart the container?  \ntmortagne - (17:40): it's not nice to have to restart but i don't have any quick clean fix idea right now  \ncjdelisle - (17:41): Would it be fixed if the users came first in the .xar file?  \nlucaa - (17:41): and groups,  \ntmortagne - (17:41): cjdelisle: sure but not sure it's easy to do  \ntmortagne - (17:41): it also need rights  \ncjdelisle - (17:41): hehe who saves XWiki.XWikiUsers. He's out of luck.  \ntmortagne - (17:41): etc...  \nlucaa - (17:41): but it's not such a bad idea actually...  \ntmortagne - (17:42): lucaa: i don't know how to order a xar  \nlucaa - (17:42): I mean this kind of stuff is definitely higher level than users and groups  \nlucaa - (17:42): me neither  \nlucaa - (17:42): but it does make sense as a solution  \ncjdelisle - (17:42): I had the privilege of reading Package.java not too long ago.  \nlucaa - (17:42): I think they're alphabetical anyway  \nlucaa - (17:42): or something  \nlucaa - (17:42): at least in the UI  \ncjdelisle - (17:42): It's just the order that they are written into the ZipOutputStream  \ntmortagne - (17:43): lucaa: i don't think they are ordered  \ncjdelisle - (17:43): That is the same order that the zar plugin created them in.  \ntmortagne - (17:43): it's just a import UI thing  \nlucaa - (17:43): yes, it can be just a UI  \ntmortagne - (17:43): yep  \ncjdelisle - (17:43): The ui reads the zos once and then it's read again to do the actual business.  \nlucaa - (17:44): so you need to make sure that:  \nlucaa - (17:44): 1/ they are put in the xar in the right order  \nlucaa - (17:44): 2/ they are read and imported in the right order  \nlucaa - (17:44): importer could use the order in the package.xml  \nlucaa - (17:44): and then we only need to enforce the order in the package.xml  \ncjdelisle - (17:45): No, it's the order in the zip file.  \ntmortagne - (17:45): jvelociter: i did not checked, did you had time to commit what you wanted to commit on 2.4 branch ? it's done on my side so I plan ti release tomorrow morning  \ncjdelisle - (17:45): Hmm. let me check again...  \njvelociter - (17:45): tmortagne: yes.  \nlucaa - (17:45): cjdelisle: \u00a0I'm not talking about what it is now, but if we'd have to pick an order, I would go for enforcing it in package.xml  \nlucaa - (17:46): in any case, ftm users would have to restart :(  \nlucaa - (17:46): but this is so ugly :(  \ncjdelisle - (17:46): pb is that forces all of the documents to sit on the heap which is something that would be nice to get away from.  \ntmortagne - (17:46): lucaa: yes a bit too dangerous for 2.5  \ncjdelisle - (17:46): +1 dangerous  \ncjdelisle - (17:46): Actually...  \nlucaa - (17:47): basically it means that war + xar will fail right away, on the main page :(  \ntmortagne - (17:47): cjdelisle: i agree about streaming thing, we really need to get rid of the current \u00a0way it's done and i plan to not ussing the current importe in extension-manager anyway  \ntmortagne - (17:47): so following package.xml is not an option IMO  \ncjdelisle - (17:47): It wouldn't be very dangerous if all we did was hacked the xar plugin to put XWiki.Admin first.  \ncjdelisle - (17:47): Or even manually edited the xar file.  \ntmortagne - (17:47): cjdelisle: thing is it's not just Admin  \nlucaa - (17:48): manually edit? as in after release?  \ntmortagne - (17:48): you also need Admin groups and XWikiPreference  \nlucaa - (17:48): basically to put the 2 macros at the end :(  \nlucaa - (17:48): :)  \ntmortagne - (17:48): or that yes  \ncjdelisle - (17:48): Maybe it's a horrible idea but it would hide the problem.  \ncjdelisle - (17:49): macros at the end = they would be version 2.1 but it's a smallish price to pay.  \ncjdelisle - (17:49): hehe still have to hack the zip generator...  \nlucaa - (17:49): version 2.1?  \ntmortagne - (17:49): lucaa: actually i think that if theses macros was in an app and not in XE that would work  \ntmortagne - (17:50): since application are added to the xar after XE pages  \nlucaa - (17:50): ok...  \ncjdelisle - (17:50): Oh I see, I thought copy them. Yea that would work.  \nlucaa - (17:50): that would be a solution  \nlucaa - (17:50): but  \nlucaa - (17:50): what's the order of the import  \nlucaa - (17:50): ?  \nlucaa - (17:50): for sure the .zip order?  \ncjdelisle - (17:50): I'll check again.  \ntmortagne - (17:50): the order of the import is the order of the zip i think but need to be checked yes  \ntmortagne - (17:51): checking too  \nlucaa - (17:51): because if so, we can make it work easily, although I'm not so much in love with the idea of having them in a separate app  \nlucaa - (17:51): at all  \ntmortagne - (17:51): AFAIK package.xml is only used to filter  \nlucaa - (17:51): tmortagne: but there is also the option that there is no order  \nlucaa - (17:51): that could be the case  \ntmortagne - (17:51): lucaa: no order does not exists  \ntmortagne - (17:52): you always have an order at some point  \ntmortagne - (17:52): the minimum is zip order  \ntmortagne - (17:54): actually i think it's import UI order  \ntmortagne - (17:55): hmm maybe not  \ncjdelisle - (17:55): AFAICT it is the xip order.  \ncjdelisle - (17:56): xip that would make a good extension...  \ncjdelisle - (17:57): It's the zip stream order, EXCEPT, anything with custom mappings and any classes are loaded first.  \ncjdelisle - (17:57): These things should heva been handles on save but oh well...  \ncjdelisle - (17:58): 1) all custom mappings in zip stream order.  \ncjdelisle - (17:58): 2) all classes in zip stream order  \ntmortagne - (17:58): yep, that's what i see too (i forgot about this classes hack)  \ncjdelisle - (17:59): 3) all other documents in zip stream order unless they contain classes.  \ntmortagne - (17:59): so it's ok at least for our macro use case  \ncjdelisle - (17:59): correction: 1) all custom mappings are loaded into hibernate, the documents are NOT saved.  \ncjdelisle - (18:00): )yet(  \ncjdelisle - (18:01): Hmm. we can create a version2 ov the package file which is fully backward compatable.  \ncjdelisle - (18:01): ^^ future  \ncjdelisle - (18:02): v2 = contents are in order by default, no need to mess with ordering, and package.xml (if it isn't removed) is always first in the zip stream.  \ncjdelisle - (18:02): This way v2 works in v1 package importer.  \ncjdelisle - (18:03): more like v1.1 really.  \ncjdelisle - (18:03): package.xml (if it isn't removed) <-- can't be removed without breaking 1.0 compatibility.  \ntmortagne - (18:04): cjdelisle: 1.0 does not really needs it actually  \ntmortagne - (18:04): we could make sure 1.0 code does not fail when it's not here  \ntmortagne - (18:05): the only use of package.xml is to filter (which is totally useless IMO)  \ncjdelisle - (18:05): Well the idea is that new xars still work perfectly in the old importer. why? dunno :P  \ncjdelisle - (18:05): No real point actually.  \ntmortagne - (18:06): yes and no  \nStulle - (18:06): bye  \ntmortagne - (18:06): some application packaged with the new packagingg could still work in older XWiki  \ntmortagne - (18:06): which has 1.0 packager plufin  \ntmortagne - (18:06): s/plufin/plugin/  \ntmortagne - (18:06): but it's not really critical  \ncjdelisle - (18:06): So we would atill have to ship with a package.xml but 2.0 would not use it at all.  \ncjdelisle - (18:07): If we were to break from 1.0 entirely, I'd be +1 for looking at an entirely different way to represent documents. Maybe a directory tree? Something which is svn friendly.  \ntmortagne - (18:07): i'm not even sure the packager does not already support xar without package.xml  \njvelociter - (18:08): (it does not from what I recall)  \ntmortagne - (18:08): if (description == null) {  \ncjdelisle - (18:08): throw new PackageException(XWikiException.ERROR\\_XWIKI\\_UNKNOWN, \"Could not find the package definition\")  \ntmortagne - (18:08): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0throw new PackageException(XWikiException.ERROR\\_XWIKI\\_UNKNOWN,  \ntmortagne - (18:08): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Could not find the package definition\");  \ntmortagne - (18:08): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0}  \ntmortagne - (18:08): so no it doe snot support it  \ncjdelisle - (18:08): lol yea that  \ntmortagne - (18:09): but IMO it's just a bad design  \ncjdelisle - (18:09): +1  \ncjdelisle - (18:09): But IMO not very hard to set it right.  \ntmortagne - (18:09): we could simply fix the current packager  \ncjdelisle - (18:10): open big transaction, send in the documents, commit.  \nvmassol - (18:10): tmortagne: seems we don't have a way to easily get the next block when you're on a block. Am I missing something?  \ntmortagne - (18:10): vmassol: you can get it from the parent AFAIk  \nvmassol - (18:10): yes but it(s hard  \ntmortagne - (18:10): there is a method to get the block need another  \nvmassol - (18:10): I'll add an api I think  \nvmassol - (18:11): let me check  \nvmassol - (18:11): from the parent  \nStulle left at 18:11 (Ping timeout: 265 seconds  \ntmortagne - (18:11): but in theparent  \nvmassol - (18:11): hmm I don't see  \ntmortagne - (18:11): let me check  \ncjdelisle - (18:11): in javascript it's block.parentNode.nextChild(block) \u00a0or something similar.  \ncjdelisle - (18:12): Nice because the block doesn't need to know it's siblings, only it's parent and children.  \ntmortagne - (18:12): vmassol: hmm it's possible i only implemented the getPreviousBlockByType actually since i only needed this one for toc macro  \nvmassol - (18:13): cjdelisle: why not block.getNextSibling()?  \ntmortagne - (18:13): but there should be the one in the other way  \nvmassol - (18:13): tmortagne: it's not by type  \nvmassol - (18:13): (I need the next one)  \ntmortagne - (18:13): ha yes  \ntmortagne - (18:13): indeed there is nothing AFAIK  \nvmassol - (18:13): ok I'll add somerthing  \ntmortagne - (18:13): at least not from me  \ncjdelisle - (18:13): Because (at least in javascript) you might move a block and it should not need to be aware of it's neighbor.  \nvmassol - (18:14): cjdelisle: the implementation can go to the parent....  \ncjdelisle - (18:15): I suppose, maybe I have just become enamored in the javascript dom model.  \ncjdelisle - (18:15): It \"feels\" wrong and that's very hard to put my finger on.  \ntmortagne - (18:17): i kind of agree with cjdelisle on that but i'm not -1  \ntmortagne - (18:17): all \u00a0the other methods in Block are more of the nextChild(block) style  \ntmortagne - (18:17): like getPreviousBlockByType  \nvmassol - (18:17): not getChildren  \ntmortagne - (18:17): insertChildAfter  \ntmortagne - (18:17): etc.  \ncjdelisle - (18:18): I can't very well say -1 over a feeling which I can't think of a compelling reason for.  \nvmassol - (18:18): the light will come when I finish implementing it I guess....  \ntmortagne - (18:19): WDYM by \"not getChildren\" ?  \ncjdelisle - (18:19): I can say +1 for tree shaped structures ;)  \nvmassol - (18:19): it doesn't take a block param  \ntmortagne - (18:19): and ?  \ntmortagne - (18:19): that would not mean anything  \nvmassol - (18:19): why would getNextSibling take one?  \nvmassol - (18:19): why make things hard?  \ntmortagne - (18:20): because it's not the same level  \ntmortagne - (18:20): what i mean is that currently only the level that know things has the method for it  \ntmortagne - (18:20): a block does not know the block near it  \ntmortagne - (18:20): that's parent thing  \ncjdelisle - (18:20): Suppose we copied javascript exactly, they have a lot of experience in dom trees.  \ntmortagne - (18:20): so insertChildAfter in the parent  \ntmortagne - (18:20): we don't have insertAfter  \nvmassol - (18:21): http://download.oracle.com/javase/1.4.2/docs/api/org/w3c/dom/Node.html#getNextSibling()  \nvmassol - (18:21): :)  \ntmortagne - (18:22): vmassol: what i mean is that currently we don't have any method in Block which directly manipulate thing it does not directly know  \ncjdelisle - (18:22): http://krook.org/jsdom/ indeed, nextSibling is in js.  \ntmortagne - (18:22): so that would be a first  \ntmortagne - (18:22): but if it's part of standard DOM i guess it's ok  \ncjdelisle - (18:23): I think the feeling is that if there are multiple ways to get from here to there, you end up with spaghetti instead of a tree.  \ncjdelisle - (18:24): aka xwiki-core dependency graph  \nlucaa - (18:25): tmortagne: cjdelisle ftm tagcloud registering doesn't work because the registerMacro checks if the \\_current\\_ user has edit rights in order to register the macro, not the author of the document  \nlucaa - (18:26): and at the moment of the tagcloud registering (at the end, because it's in an application), the current user is the guest, because admin was already imported  \ncjdelisle - (18:26): I see, at that moment guest has admin rights but not PR.  \nlucaa - (18:27): I don't need pr  \nlucaa - (18:27): guest doesn't have admin  \nlucaa - (18:27): but it's not even about admin, it  \nlucaa - (18:27): it's only edit  \nlucaa - (18:27): to register a wiki-level macro  \ncjdelisle - (18:28): He has admin until he imports a document which says he doesn't.  \ntmortagne - (18:28): yep  \nlucaa - (18:29): well, XWiki.AdminGroup just does that, I would say  \nlucaa - (18:29): doesn't it?  \ncjdelisle - (18:29): No I think it's XWiki.XWikiPreferences.  \ntmortagne - (18:29): lucaa: no  \nlucaa - (18:29): I mean, I put breakpoints and the import order is this:  \nlucaa - (18:29): Main.Spaces, XWiki.Admin, XWiki.XWikiAdminGroup, XWiki.TagCloud  \ntmortagne - (18:29): AdminGroup could have any other name  \nlucaa - (18:29): yes, but I mean in the default xar  \ntmortagne - (18:30): in the default xar it's XWikiPreference  \ntmortagne - (18:30): as cjdelisle said  \nlucaa - (18:30): right, because it's the one setting rights on groups  \ntmortagne - (18:30): because XWikiPreference give right to AdminGroup nobody else have admin group  \nlucaa - (18:30): yes  \ntmortagne - (18:30): s/have admin group/have admin right/  \nlucaa - (18:31): wait, didn't guest use to have edit right in the default enterprise? we changed that?  \ntmortagne - (18:31): no  \ntmortagne - (18:31): it never had edit right  \ntmortagne - (18:31): only view and comment maybe  \nlucaa - (18:31): ok, then it's just my failing memory  \nlucaa - (18:31): I admit that  \ncjdelisle - (18:32): Hmm. It seems that we are missing the ability to save multiple documents in a single action (so the event broadcasts don't affect eachother.)  \ncjdelisle - (18:33): We really need InputStream<T> so we can call saveDocuments than send a stream of documents and they only commit when we close the stream.  \ncjdelisle - (18:33): ObjectInputStream maybe.  \ncjdelisle - (18:34): nope. not genericized.  \nvmassol - (18:37): tmortagne: hmmm it's quite expensive to know the next sibling in the algo so the Tx is going to cost more than needed  \nvmassol - (18:38): I'll continue but we may need to optimize it in the future  \ntmortagne - (18:38): vmassol: i don't see why you need that  \ntmortagne - (18:38): in the tx  \nvmassol - (18:39): : )  \nvmassol - (18:39): 2 special symbols  \ntmortagne - (18:39): you should not use getChildrenByType with getNext IMO  \ntmortagne - (18:39): just parse the tree  \ntmortagne - (18:40): and from parent when you do a freach on children you see when you have two following synbols  \ntmortagne - (18:40): it's way moore effective anyway than doing getChildrenByType which parse the whole tree and then reparse the result of getChildrenByType  \nvmassol - (18:41): yes I guess I could reparse the whole tree although technically it's less good  \nvmassol - (18:41): sine getChildrenByType could be optimized  \ntmortagne - (18:41): why \"reparse\" ?  \nvmassol - (18:41): s/reparse/parse/  \ntmortagne - (18:41): maybe but fore now getChildrenByType is not and i doubt it will anytime soon  \nvmassol - (18:41): getChildrnenByType could be implement in fixed time with a map for ex  \ntmortagne - (18:42): that mean caaching or something  \ntmortagne - (18:42): s/caaching/caching/  \nvmassol - (18:42): the tree is in memory  \nvmassol - (18:42): it's cached yes  \nvmassol - (18:42): yes it'll cost more memory  \ntmortagne - (18:42): i mean you would need to cahce the result  \nvmassol - (18:42): but it's memory vs speed  \ntmortagne - (18:43): not just about momory  \ntmortagne - (18:43): memory  \nvmassol - (18:43): I don't understand then  \ntmortagne - (18:43): but makes the code more complex  \nvmassol - (18:43): you just add to the map wen you insertChild  \ntmortagne - (18:43): since you ave a caching system  \nvmassol - (18:43): and remove when you removechild  \nvmassol - (18:43): it's not complex  \ntmortagne - (18:43): it's not that simple  \ntmortagne - (18:44): when you add a child in one of the child  \nvmassol - (18:44): got to go, bb in 25mn  \ntmortagne - (18:44): you have to go back to the parent and tel it one of its child get another one  \ntmortagne - (18:44): s/get/got/  \ntmortagne - (18:44): getChildrnenByType is recursive  \nfmancinelli left at 18:58 (Ping timeout: 265 seconds  \nlucaa left at 19:11 (Ping timeout: 240 seconds  \narkub left at 19:12 (Quit: Leaving  \ntmortagne left at 19:29 (Quit: Leaving.  \nfmancinelli joined #xwiki at 20:07  \nvmassol left at 20:15 (Quit: Leaving.  \njvdrean left at 20:23 (Quit: Leaving.  \nmflorea joined #xwiki at 22:01  \nfmancinelli left at 22:25 (Ping timeout: 255 seconds  \nSvenDowideit left at 23:18 (Changing host  \nSvenDowideit joined #xwiki at 23:18  \nmflorea left at 23:19 (Quit: Leaving.  \nvmassol joined #xwiki at 23:29  \nvmassol left at 23:32 (Client Quit  \nsdumitriu joined #xwiki at 23:59  \n\n"}