{"id": "dev:IRC.xwikiArchive20080907", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20080907", "title": "IRC Archive for channel #xwiki on 07 September 2008 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\nxwikibot - (07/09/2008 17:06): XWiki.HelderMassango was modified by XWiki.HelderMassango (Created user) - http://www.xwiki.org/xwiki/bin/view/XWiki/HelderMassango  \njvelociter - (07/09/2008 17:51): vmassol: Hello, are you there ?  \nvmassol - (07/09/2008 17:51): jvelociter: yes...  \njvelociter - (07/09/2008 17:52): If you have some time, I have a question for you  \njvelociter - (07/09/2008 17:53): a question you will not like I'm sure :) : do you know a way or a workaround to \"just wait\" in selenium, not wait for something ?  \njvelociter - (07/09/2008 17:55): I finally understand why my two tests do fail : at some point I open a page and it happens faster that the notification (old fashioned XWikiNotification) upon a document change I did just before, so the result I'm expecting is not available yet  \njvelociter - (07/09/2008 17:58): I could use thread.sleep I guess  \nvmassol - (07/09/2008 18:14): jvelociter: no you should never wait  \nvmassol - (07/09/2008 18:15): never never never :)  \njvelociter - (07/09/2008 18:15): :) I expected that line  \njvelociter - (07/09/2008 18:15): but how can I do then ?  \njvelociter - (07/09/2008 18:15): click here and there to wait the notification to happen ?  \nvmassol - (07/09/2008 18:15): wait for something  \njvelociter - (07/09/2008 18:15): it's just the same  \nvmassol - (07/09/2008 18:15): same as what?  \njvelociter - (07/09/2008 18:15): it's not AJAX  \nvmassol - (07/09/2008 18:16): it doesn't matter  \njvelociter - (07/09/2008 18:16): same as Thread.sleep  \nvmassol - (07/09/2008 18:16): you should always wait for something  \nvmassol - (07/09/2008 18:16): and it's not the same at all  \nvmassol - (07/09/2008 18:16): in one case you have a fragile test  \nvmassol - (07/09/2008 18:16): that'll fail from time to time  \nvmassol - (07/09/2008 18:16): in the other case you have test that is strong and will never fail  \njvelociter - (07/09/2008 18:17): but I don't see anything I can wait for in my case  \nvmassol - (07/09/2008 18:17): there are alwayd things  \nvmassol - (07/09/2008 18:17): you say you open a page  \nvmassol - (07/09/2008 18:17): if you use the open() api then it already waits  \nvmassol - (07/09/2008 18:17): so that is not the problem  \njvelociter - (07/09/2008 18:18): let me rephrase my problem  \nvmassol - (07/09/2008 18:18): it's something else  \njvelociter - (07/09/2008 18:18): I open the page, it opens good and fast, but actually \\_too\\_ fast : the XWikiNotification which result I want to check is not happened already  \njvelociter - (07/09/2008 18:18): I do this :  \njvelociter - (07/09/2008 18:18): 1/ edit and save a page that triggers a XWikiNotification  \njvelociter - (07/09/2008 18:19): 2/ Open a page where I can check the result of this notification  \njvelociter - (07/09/2008 18:19): but there is no way I can be sure the notification has done its job (which is write something in the DB) when I open the page  \njvelociter - (07/09/2008 18:19): do you see what I mean ?  \nvmassol - (07/09/2008 18:19): notifications are asynchronous?  \nvmassol - (07/09/2008 18:19): (yes there are several ways)  \njvelociter - (07/09/2008 18:19): yes, I think so  \nvmassol - (07/09/2008 18:20): I don't think so  \njvelociter - (07/09/2008 18:20): let me check  \nvmassol - (07/09/2008 18:20): that's teh first thing to check  \nvmassol - (07/09/2008 18:20): but if it were  \nvmassol - (07/09/2008 18:20): you could do this:  \nvmassol - (07/09/2008 18:20): open the page and verify if the result is there  \nvmassol - (07/09/2008 18:21): if not, wait for 100ms and refresh the page, repeat till you get the result or there's a timeout  \njvelociter - (07/09/2008 18:21): well : this is wait   \nvmassol - (07/09/2008 18:21): this is basically implementing the waitForCondition  \njvelociter - (07/09/2008 18:21): ok I see  \nvmassol - (07/09/2008 18:21): sure but that's ok since there's the check  \nvmassol - (07/09/2008 18:21): what shouldn't be done is thus wait some amount of time  \nvmassol - (07/09/2008 18:22): and expect that it'll be ready by that time  \njvelociter - (07/09/2008 18:22): ok, got it  \nvmassol - (07/09/2008 18:22): s/thus/just  \njvelociter - (07/09/2008 18:22): indeed, notifications seems synchronous  \njvelociter - (07/09/2008 18:22): so I still don't understand wtf happens in my tests :)  \nvmassol - (07/09/2008 18:23): yep you need to trace that, maybe it's the write to the db  \njvelociter - (07/09/2008 18:23): I downloaded the distrib after hudson's test run, and the data is actually there  \njvelociter - (07/09/2008 18:24): but it's not there by the time I check it in the tests...  \njvelociter - (07/09/2008 18:32): damned I'm blind  \njvelociter - (07/09/2008 18:33): it was just in the front of me from the beginning  \nvmassol - (07/09/2008 18:33): :)  \nvmassol - (07/09/2008 18:46): jvelociter: I think clickEditSaveAndView should always do a waitPage, WDYT?  \njvelociter - (07/09/2008 18:47): yes, that might be safer  \njvelociter - (07/09/2008 18:47): every click on the buttom buttons actually  \nvmassol - (07/09/2008 18:47): no  \nvmassol - (07/09/2008 18:47): yes  \nvmassol - (07/09/2008 18:47): sorry  \nvmassol - (07/09/2008 18:47): :)  \njvelociter - (07/09/2008 18:48): :)  \nvmassol - (07/09/2008 18:51): jvelociter: the wait is already there  \nvmassol - (07/09/2008 18:51): there's no need for waitPage that you added  \njvelociter - (07/09/2008 18:52): oh you are right  \njvelociter - (07/09/2008 18:52): is on clickLinkWithLocator(locator, true);  \nvmassol - (07/09/2008 18:52): yes  \n\n"}