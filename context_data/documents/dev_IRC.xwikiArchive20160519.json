{"id": "dev:IRC.xwikiArchive20160519", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20160519", "title": "IRC Archive for channel #xwiki on 19 May 2016 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<woshilapin>\u00a0has quit  \n01:32\u00a0<abusenius>\u00a0has quit  \n01:55\u00a0<moep>\u00a0has quit  \n03:22\u00a0<Aranjedeath>\u00a0has quit  \n04:38\u00a0<Aranjedeath>\u00a0has joined #xwiki  \n04:38\u00a0<Aranjedeath>\u00a0has quit  \n04:39\u00a0<Aranjedeath>\u00a0xwikibot:) I will do no such thing! :D  \n05:49\u00a0<Chuguniy>\u00a0has quit  \n07:37\u00a0<msmeria>\u00a0has joined #xwiki  \n07:46\u00a0<ekarlso>\u00a0has joined #xwiki  \n07:46\u00a0<ekarlso>\u00a0hey guys, anyone around ? :)  \n08:08\u00a0<cjd>\u00a0has quit  \n08:21\u00a0<vmassol>\u00a0has joined #xwiki  \n08:54\u00a0<KermitTheFragger>\u00a0has joined #xwiki  \n09:01\u00a0<cjd>\u00a0has joined #xwiki  \n09:28\u00a0<tmortagne>\u00a0has joined #xwiki  \n09:29\u00a0<tmortagne>\u00a0has quit  \n09:30\u00a0<woshilapin>\u00a0has joined #xwiki  \n09:39\u00a0<mflorea>\u00a0has joined #xwiki  \n09:48\u00a0<gdelhumeau>\u00a0has joined #xwiki  \n10:01\u00a0<Slashman>\u00a0has joined #xwiki  \n10:07\u00a0<tmortagne>\u00a0has joined #xwiki  \n10:08\u00a0<tmortagne>\u00a0has quit  \n10:27\u00a0<tmortagne>\u00a0has joined #xwiki  \n10:39\u00a0<lkrejci>\u00a0has joined #xwiki  \n10:39\u00a0<lkrejci>\u00a0has quit  \n10:55\u00a0<moep>\u00a0has joined #xwiki  \n11:01\u00a0<vmassol>\u00a0good morning  \n11:04\u00a0<vmassol>\u00a0cool platform build is back to normal :)  \n11:05\u00a0<vmassol>\u00a0hmm one test is still failing  \n11:05\u00a0<vmassol>\u00a0I'll check it  \n11:05\u00a0<vmassol>\u00a0http://ci.xwiki.org/job/xwiki-platform/org.xwiki.platform$xwiki-platform-legacy-oldcore/2873/testReport/com.xpn.xwiki.doc/XWikiDocumentTest/testExtractTitle/  \n11:05\u00a0<evalica>\u00a0has joined #xwiki  \n11:06\u00a0<Enygma`>\u00a0has joined #xwiki  \n11:39\u00a0<vmassol>\u00a0don't forget BFD today! :)  \n11:39\u00a0<vmassol>\u00a0(Enygma` should send a mail normally)  \n12:34\u00a0<Enygma`>\u00a0done :)  \n12:55\u00a0<vmassol>\u00a0thanks Edy  \n13:38\u00a0<vmassol>\u00a0build should be fixed now for platform  \n13:40\u00a0<vmassol>\u00a0starting RN for 8.2M1  \n13:40\u00a0<vmassol>\u00a0hmm we have a bug I think  \n13:41\u00a0<vmassol>\u00a0any idea why I don't see the RN template when I click the wanted link on http://www.xwiki.org/xwiki/bin/view/ReleaseNotes/  \n13:41\u00a0<vmassol>\u00a0but I do see it when I click +  \n13:41\u00a0<vmassol>\u00a0?  \n13:41\u00a0<vmassol>\u00a0strange think is that I see the Dashboard template  \n13:43\u00a0<vmassol>\u00a0testing locally on master\u2026  \n13:46\u00a0<vmassol>\u00a0I can reproduce  \n13:46\u00a0<vmassol>\u00a0can someone confirm that it's a bug?  \n13:46\u00a0<vmassol>\u00a0(in term of use case)  \n13:49\u00a0<cjd>\u00a0has quit  \n13:51\u00a0<cjd>\u00a0has joined #xwiki  \n13:55\u00a0<tmortagne>\u00a0vmassol: that's because the generated link goes to ReleaseNotes.ReleaseNotesXWiki82M1.WebHome and not ReleaseNotes.ReleaseNotesXWiki82M1 and we have a jira issue about template registered for a space not available in subspaces  \n13:55\u00a0<vmassol>\u00a0ok found the bug  \n13:55\u00a0<vmassol>\u00a0(I've debugged it)  \n13:56\u00a0<vmassol>\u00a0I think there's another issue tmortagne  \n13:56\u00a0<vmassol>\u00a0we look for templates in the target link's space  \n13:56\u00a0<vmassol>\u00a0but we should look for templates in the currnet space  \n13:57\u00a0<tmortagne>\u00a0IMO it's ok to look at the target link space but subspaces should inherit parent space templates  \n13:57\u00a0<ClemensR>\u00a0has joined #xwiki  \n13:57\u00a0<vmassol>\u00a0it wouldn't work  \n13:57\u00a0<vmassol>\u00a0imagine the following use case  \n13:58\u00a0<vmassol>\u00a0you are on a page called ReleasesNotes.WebHome  \n13:58\u00a0<vmassol>\u00a0and you have a template provider for ReleaseNotes space  \n13:58\u00a0<vmassol>\u00a0you add a link to [[Blog.SomePage]]  \n13:58\u00a0<vmassol>\u00a0you wouldn't be able to create a release note outside of the current space  \n13:58\u00a0<vmassol>\u00a0hmm  \n13:59\u00a0<vmassol>\u00a0actually both are valid  \n13:59\u00a0<vmassol>\u00a0we need to decide what we want  \n13:59\u00a0<tmortagne>\u00a0I understand your use case but it's not the use case we have here and you asked why it does not work anymore and that's because subspace don't have the parent space templates  \n13:59\u00a0<vmassol>\u00a01) the current location determines what templates are avail  \n13:59\u00a0<vmassol>\u00a02) the target location determines what templates are avail  \n13:59\u00a0<vmassol>\u00a0tmortagne: still, it's strange that the + works; it menas we have an inconsistency  \n14:00\u00a0<vmassol>\u00a0my guess is that the + path uses the current space  \n14:00\u00a0<vmassol>\u00a0yes that makes sense actually  \n14:00\u00a0<vmassol>\u00a0since there's no target in this case when you use +  \n14:01\u00a0<tmortagne>\u00a0the + always been based on the current space and I guess we did not changed it with nested spaces  \n14:01\u00a0<vmassol>\u00a0so I'm wondering if 1) is not more logical in order to have the same behavior between + and wanted links  \n14:02\u00a0<vmassol>\u00a0but maybe not  \n14:02\u00a0<vmassol>\u00a0anyway the bug is known  \n14:02\u00a0<vmassol>\u00a0thanks  \n14:02\u00a0<vmassol>\u00a0stopping my debugging now  \n14:02\u00a0<vmassol>\u00a0this is quite important though  \n14:02\u00a0<tmortagne>\u00a0I'm sure I saw a jira about it but can't find it anymore  \n14:02\u00a0<vmassol>\u00a0and for me raises the severity of this issue  \n14:02\u00a0<vmassol>\u00a0Enygma`: ?  \n14:02\u00a0<vmassol>\u00a0t means that template don't work anymore for wanted links  \n14:02\u00a0<vmassol>\u00a0\\*it  \n14:03\u00a0<vmassol>\u00a0that's an important regression  \n14:05\u00a0<tmortagne>\u00a0http://jira.xwiki.org/browse/XWIKI-13290  \n14:05\u00a0<tmortagne>\u00a0seems to be the one  \n14:05\u00a0<tmortagne>\u00a0yep that's the one I saw  \n14:10\u00a0<Enygma`>\u00a0vmassol: I don`t think anything has changed from the previous behavior, since the javascript template popup for wanted links is evaluated on the target location and not on the current location i.e. getURL(\"targetLocation\", \"create\")  \n14:11\u00a0<Enygma`>\u00a0with the + you get the list of template providers for the current location because that`s what it can do, but even then, once you select a destination that is no OK with the chosen template provider, you will get an error...  \n14:11\u00a0<Enygma`>\u00a0probably the list of template providers should be updated whenever you change the target location  \n14:11\u00a0<vmassol>\u00a0Enygma`: what's changed is that it's now broken :)  \n14:12\u00a0<vmassol>\u00a0(ie regression)  \n14:12\u00a0<Enygma`>\u00a0what usecase exactly?  \n14:12\u00a0<vmassol>\u00a0wante dlinks  \n14:12\u00a0<vmassol>\u00a0\\*wanted links  \n14:13\u00a0<vmassol>\u00a0they don't shwo provideds now because  \n14:13\u00a0<vmassol>\u00a0wanted links are always nested pages since they don't exist  \n14:13\u00a0<vmassol>\u00a0and thus the template provides are not listed since they don't inherit  \n14:13\u00a0<vmassol>\u00a0\\*providers  \n14:13\u00a0<vmassol>\u00a0the code is here:  \n14:13\u00a0<vmassol>\u00a0availableTemplateProviders =  \n14:13\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0loadAvailableTemplateProviders(document.getDocumentReference().getLastSpaceReference(),  \n14:14\u00a0<vmassol>\u00a0document.getDocumentReference() is the ref to the target link  \n14:14\u00a0<vmassol>\u00a0in my case, I had [[test]] as the link  \n14:15\u00a0<tmortagne>\u00a0we should make space look at all parent spaces like they look at wiki level  \n14:15\u00a0<vmassol>\u00a0which leads to the space ref: Space xwiki:ReleaseNotes.test  \n14:15\u00a0<vmassol>\u00a0and my template provider is bound to xwiki:ReleaseNotes  \n14:16\u00a0<vmassol>\u00a0tmortagne: yup  \n14:16\u00a0<Enygma`>\u00a0depends if it`s terminal or not  \n14:16\u00a0<tmortagne>\u00a0(which is what XWIKI-13290 is about)  \n14:16\u00a0<tmortagne>\u00a0Enygma`: I don't think so  \n14:17\u00a0<vmassol>\u00a0Enygma`: the target link cannot be terminal ;)  \n14:17\u00a0<vmassol>\u00a0since it doesn't exist  \n14:17\u00a0<vmassol>\u00a0it's always nested  \n14:17\u00a0<Enygma`>\u00a0what about doc:Test ?  \n14:17\u00a0<tmortagne>\u00a0it inherits wiki level there is no reason to not inherit parent spaces  \n14:17\u00a0<vmassol>\u00a0right  \n14:17\u00a0<vmassol>\u00a0so it's broken not for all use cases only for the main one  \n14:17\u00a0<vmassol>\u00a0;)  \n14:18\u00a0<vmassol>\u00a0(I've confirmed that [[doc:test]] works fine)  \n14:19\u00a0<vmassol>\u00a0it seems pretty simple to fix  \n14:19\u00a0<vmassol>\u00a0apparently we iterate over all template providers in loadAvailableTemplateProviders()  \n14:20\u00a0<vmassol>\u00a0and only keep those mathcing the space ref  \n14:20\u00a0<vmassol>\u00a0this line: if (allowedSpaces.size() == 0 || allowedSpaces.contains(spaceStringReference)) {  \n14:21\u00a0<vmassol>\u00a0we can just replace this line with a loop  \n14:21\u00a0<vmassol>\u00a0to loop over all parent of the passed space ref  \n14:21\u00a0<vmassol>\u00a0(all space ref parents)  \n14:21\u00a0<vmassol>\u00a0wdyt?  \n14:22\u00a0<Enygma`>\u00a0vmassol: did you read http://jira.xwiki.org/browse/XWIKI-13290?focusedCommentId=90926&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-90926 ?  \n14:23\u00a0<vmassol>\u00a0reading  \n14:23\u00a0<vmassol>\u00a0now  \n14:24\u00a0<Enygma`>\u00a0we have the same problem for Annotations as well, in http://jira.xwiki.org/browse/XWIKI-12837  \n14:24\u00a0<vmassol>\u00a0when jira comes up  \n14:24\u00a0<vmassol>\u00a0all I know is that we have an important regression and we've been having for some time and we need to do something about it quickly  \n14:24\u00a0<vmassol>\u00a0still waiting for jira to show up\u2026  \n14:26\u00a0<Enygma`>\u00a0basically we have a tree hierarchy on which we want to set an inherited property at one level. We have some problems:  \n14:26\u00a0<Enygma`>\u00a01) How do we stop inheriting it from a certain level below?  \n14:27\u00a0<vmassol>\u00a0you're adding other use cases in your questions  \n14:27\u00a0<vmassol>\u00a0right now my concern is fixing an important bug  \n14:28\u00a0<Enygma`>\u00a0the current solution is to not inherit and explicitly add the locations where the property applies but the downside is that we don`t cover newly created pages automatically  \n14:28\u00a0<vmassol>\u00a0what thomas and I suggsted seem the best for now  \n14:28\u00a0<vmassol>\u00a0ie that you inherit all providers defined in parent spaces  \n14:28\u00a0<Enygma`>\u00a0ok, then inheriting is not the solution for fixing the bug because it brings in the above mentioned problems  \n14:28\u00a0<vmassol>\u00a0why?  \n14:28\u00a0<Enygma`>\u00a0plus it needs updating the UI  \n14:28\u00a0<vmassol>\u00a0why?  \n14:29\u00a0<vmassol>\u00a0I don't see any change required  \n14:29\u00a0<Enygma`>\u00a0read above?  \n14:29\u00a0<vmassol>\u00a0yep I have  \n14:29\u00a0<vmassol>\u00a0I just don't think those are int'resting use cases  \n14:29\u00a0<vmassol>\u00a0and they certinaly don't need a solution now  \n14:29\u00a0<vmassol>\u00a0and there are plenty of workarounds  \n14:29\u00a0<Enygma`>\u00a0like?  \n14:30\u00a0<vmassol>\u00a0like move your page in a different tree if you don't want to inherit from providers above  \n14:30\u00a0<vmassol>\u00a0like refacotring your providers  \n14:30\u00a0<vmassol>\u00a0so that they affect only a portion of the space hierarchy and not the full one  \n14:31\u00a0<vmassol>\u00a0you start with a provider at a certian level  \n14:31\u00a0<vmassol>\u00a0at some point you intrdocue a new subspace and you don't want thi provider  \n14:31\u00a0<vmassol>\u00a0so you create 2 trees  \n14:31\u00a0<vmassol>\u00a0and move the provider so that it affects only 1 tree  \n14:31\u00a0<Enygma`>\u00a0and if you want the parent too?  \n14:31\u00a0<vmassol>\u00a0in any case these are very specifc user cases  \n14:31\u00a0<Enygma`>\u00a0you move it in the tree as well and replace it with a bogus parent?  \n14:32\u00a0<Denis>\u00a0has quit  \n14:32\u00a0<vmassol>\u00a0leaving a regression on because there are 0.01% of the use cases that are nit filled it way way worse  \n14:32\u00a0<Enygma`>\u00a0yes, could be... then you have the UI issues with the tree  \n14:32\u00a0<vmassol>\u00a0use cases that didn't exist before mind you  \n14:32\u00a0<vmassol>\u00a0why do you want to change the UI?  \n14:32\u00a0<Enygma`>\u00a0http://jira.xwiki.org/secure/attachment/31769/TemplateProviderEditUI-NestedPages.png  \n14:33\u00a0<Enygma`>\u00a0we could leave it as it is actually, and \"know\" that the children are also affected  \n14:33\u00a0<vmassol>\u00a0ideally we would highlit all parents too  \n14:33\u00a0<vmassol>\u00a0or  \n14:33\u00a0<vmassol>\u00a0for now  \n14:33\u00a0<vmassol>\u00a0just mention in the text that all parents are also included by default  \n14:33\u00a0<vmassol>\u00a0and the UI just shows explicitly chosen nodes  \n14:33\u00a0<Enygma`>\u00a0all children, you mean  \n14:33\u00a0<vmassol>\u00a0yes  \n14:33\u00a0<vmassol>\u00a0children sorry  \n14:34\u00a0<Enygma`>\u00a0yes, that would be the only way... and if you check again children as well, it will just be redundant config  \n14:34\u00a0<vmassol>\u00a0yep  \n14:37\u00a0<vmassol>\u00a0would be a nice BFD Enygma` ;)  \n14:37\u00a0<vmassol>\u00a0interested?  \n14:38\u00a0<Enygma`>\u00a0it would, but time is not really in my favor  \n14:38\u00a0<vmassol>\u00a0well at some point we need to make choices  \n14:38\u00a0<vmassol>\u00a0I believe that regressions should always come first  \n14:39\u00a0<Denis>\u00a0has joined #xwiki  \n14:39\u00a0<Enygma`>\u00a0of course you do :)  \n14:39\u00a0<vmassol>\u00a0(especially on bfd days)  \n14:43\u00a0<Enygma`>\u00a0added http://jira.xwiki.org/browse/XWIKI-13290?focusedCommentId=91475&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-91475 and will try to handle it today or in the coming days, as much as possible  \n14:52\u00a0<vmassol>\u00a0thanks Enygma`  \n15:26\u00a0<Denis>\u00a0has quit  \n15:27\u00a0<msmeria>\u00a0has quit  \n15:28\u00a0<Denis>\u00a0has joined #xwiki  \n16:29\u00a0<KermitTheFragger>\u00a0has quit  \n17:00\u00a0<M-mouhb1>\u00a0Hello,  \n17:01\u00a0<M-mouhb1>\u00a0I am trying to generate an external URL from a groovy code (Job Script) using the following code:  \n17:01\u00a0<M-mouhb1>\u00a0def url = xwiki.getXWiki().getExternalURL(\"Space.Page\", \"view\", \"param1=xxx&param2=yyy\", xcontext);  \n17:01\u00a0<M-mouhb1>\u00a0The problem is that sometimes in the generated URL, the domain name of the wiki that executed the code is 'localhost'  \n17:01\u00a0<M-mouhb1>\u00a0As you can see in the example bellow:  \n17:01\u00a0<M-mouhb1>\u00a0The generated url is :  \n17:01\u00a0<M-mouhb1>\u00a0http://localhost:8080/xwiki/bin/view/Space/Page?param1=xxx&param2=yyy  \n17:01\u00a0<M-mouhb1>\u00a0instead of  \n17:01\u00a0<M-mouhb1>\u00a0http://myDomainName/xwiki/bin/view/Space/Page?param1=xxx&param2=yyy  \n17:02\u00a0<M-mouhb1>\u00a0Any idea?  \n17:02\u00a0<vmassol>\u00a0maybe check your main wiki descriptor  \n17:02\u00a0<vmassol>\u00a0see what domain you've put there  \n17:03\u00a0<cjd>\u00a0Is it Apache/AJP/Tomcat or Jetty ?  \n17:04\u00a0<M-mouhb1>\u00a0Jetty  \n17:04\u00a0<cjd>\u00a0I seem to recall there being a place to set the hostname of the server in the xwiki.cfg  \n17:05\u00a0<ClemensR>\u00a0Job script is a background job, it has to get the information from the config, as it has no current request to guess the domain name  \n17:05\u00a0<cjd>\u00a0but also as Vincent said, the wiki descriptor (which I take it to mean XWiki.XWikiServerXwiki) might be involved  \n17:09\u00a0<vmassol>\u00a0it's xwiki.home ClemensR  \n17:09\u00a0<vmassol>\u00a0if defined, it's used to generate the external url  \n17:10\u00a0<vmassol>\u00a0(on the main wiki)  \n17:10\u00a0<vmassol>\u00a0if not defined, then the descriptor is used  \n17:24\u00a0<Enygma`>\u00a0vmassol: the problem M-mouhb1 is having is when sending an email. When the mail sending job generates the external URL, probably the context is not properly initialized and the context URL (the one used by the XWikiServletURLFactory#getHost when initializing the factory)  \n17:24\u00a0<vmassol>\u00a0indeed  \n17:24\u00a0<vmassol>\u00a0we use a stub context  \n17:24\u00a0<vmassol>\u00a0and it's likely it's localhost used then  \n17:25\u00a0<Enygma`>\u00a0now indeed, the xwiki.home parameter from xwiki.cfg is taking precedence to the context URL and to the XWikiServer defined alias  \n17:25\u00a0<Enygma`>\u00a0so that would be a solution  \n17:28\u00a0<Enygma`>\u00a0the order of initializing the server now seems to be: proxy host > xwiki.home > contextURL; Once initialized, on each call if the context wiki is the same as the requested document's wiki, the initialized server is returned. If not, only then the XWikiServer descriptor is checked for the main wiki or for a subwiki to see what is defined there.  \n17:32\u00a0<Enygma`>\u00a0so we either change the lookup order to prioritize the wiki descriptor or we work on the context initialization and say initialize it with the external URL of the main wiki's homepage  \n17:44\u00a0<Enygma`>\u00a0I see that the mail sender uses the current context and it passes it to the mail prepare thread so maybe it`s actually the scheduler's fault that the scheduler context is not setting the correct URL  \n18:09\u00a0<mflorea>\u00a0has quit  \n18:10\u00a0<lkrejci>\u00a0has quit  \n18:23\u00a0<tmortagne>\u00a0has quit  \n18:36\u00a0<vmassol>\u00a0sorry Edy, was in a meeting, and startinf another one now\u2026.  \n18:59\u00a0<ClemensR>\u00a0has quit  \n19:08\u00a0<cjd>\u00a0has quit  \n19:08\u00a0<cjd>\u00a0has joined #xwiki  \n19:34\u00a0<moep>\u00a0has quit  \n20:13\u00a0<cjd>\u00a0has quit  \n20:40\u00a0<evalica>\u00a0has quit  \n20:41\u00a0<evalica>\u00a0has joined #xwiki  \n20:41\u00a0<Slashman>\u00a0has quit  \n20:41\u00a0<evalica>\u00a0has quit  \n20:44\u00a0<Enygma`>\u00a0has quit  \n21:32\u00a0<abusenius>\u00a0has joined #xwiki  \n21:49\u00a0<lkrejci>\u00a0has quit  \n21:53\u00a0<cjd>\u00a0has joined #xwiki  \n22:54\u00a0<gdelhumeau>\u00a0has quit  \n23:11\u00a0<vmassol>\u00a0has quit  \n23:11\u00a0<vmassol>\u00a0has joined #xwiki  \n23:12\u00a0<vmassol>\u00a0has quit  \n23:13\u00a0<lkrejci>\u00a0has quit  \n23:13\u00a0<lkrejci>\u00a0has joined #xwiki\n"}