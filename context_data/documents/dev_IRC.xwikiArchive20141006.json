{"id": "dev:IRC.xwikiArchive20141006", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20141006", "title": "IRC Archive for channel #xwiki on 06 October 2014 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<vmassol>\u00a0has joined #xwiki  \n00:27\u00a0<vmassol>\u00a0has quit  \n00:37\u00a0<Guest64775>\u00a0has quit  \n07:05\u00a0<msmeria>\u00a0has joined #xwiki  \n07:19\u00a0<DarkKnightCZ>\u00a0has joined #xwiki  \n07:25\u00a0<silverdrop>\u00a0has joined #xwiki  \n08:09\u00a0<vmassol>\u00a0has joined #xwiki  \n08:33\u00a0<cjd>\u00a0has joined #xwiki  \n08:35\u00a0<tmortagne>\u00a0has joined #xwiki  \n08:48\u00a0<woshilapin>\u00a0has joined #xwiki  \n08:49\u00a0<evalica>\u00a0has joined #xwiki  \n08:53\u00a0<evalica>\u00a0has quit  \n09:23\u00a0<Emenems>\u00a0has joined #xwiki  \n09:29\u00a0<Lyes>\u00a0has joined #xwiki  \n09:56\u00a0<ClemensR>\u00a0has joined #xwiki  \n10:18\u00a0<mflorea>\u00a0has joined #xwiki  \n10:31\u00a0<AFKGeek>\u00a0has joined #xwiki  \n10:33\u00a0<Pbas>\u00a0has joined #xwiki  \n10:51\u00a0<Lyes>\u00a0has quit  \n10:51\u00a0<Lyes>\u00a0has joined #xwiki  \n10:57\u00a0<Lyes>\u00a0has quit  \n10:57\u00a0<Lyes>\u00a0has joined #xwiki  \n11:07\u00a0<Slashman>\u00a0has joined #xwiki  \n11:30\u00a0<evalica>\u00a0has joined #xwiki  \n11:38\u00a0<Enygma`>\u00a0has joined #xwiki  \n11:47\u00a0<Denis>\u00a0has joined #xwiki  \n11:49\u00a0<Enygma`>\u00a0has quit  \n11:52\u00a0<Enygma`>\u00a0has joined #xwiki  \n12:05\u00a0<Enygma`>\u00a0has quit  \n12:24\u00a0<KermitTheFragger>\u00a0has joined #xwiki  \n12:25\u00a0<DarkKnightCZ1>\u00a0has joined #xwiki  \n12:28\u00a0<DarkKnightCZ>\u00a0has quit  \n12:40\u00a0<DarkKnightCZ>\u00a0has joined #xwiki  \n12:42\u00a0<DarkKnightCZ1>\u00a0has quit  \n12:44\u00a0<Enygma`>\u00a0has joined #xwiki  \n12:45\u00a0<vmassol>\u00a0tmortagne: FTR this looks interesting https://github.com/lukehutch/fast-classpath-scanner  \n12:46\u00a0<Lyes>\u00a0has quit  \n12:47\u00a0<Lyes>\u00a0has joined #xwiki  \n12:48\u00a0<tmortagne>\u00a0vmassol: indeed  \n12:49\u00a0<vmassol>\u00a0seems there's only one class: https://github.com/lukehutch/fast-classpath-scanner/blob/master/src/com/lukehutch/fastclasspathscanner/FastClasspathScanner.java  \n12:49\u00a0<vmassol>\u00a0I wonder if it could work for our AnnotationLoader to load components without having to declare them, need to read the code to see how it does it in practice  \n12:50\u00a0<vmassol>\u00a0seems the code is for java8 too  \n12:55\u00a0<vmassol>\u00a0ok so it all starts with System.getProperty(\"java.class.path\")  \n12:56\u00a0<vmassol>\u00a0then it constructs File objects and read zip files/dirs from the FS  \n12:59\u00a0<tmortagne>\u00a0I think I would prefer generate the component.txt than scanning the components at startup  \n13:01\u00a0<vmassol>\u00a0yes it's less magical, more performant  \n13:01\u00a0<vmassol>\u00a0but it doesn't solve the need for extension loading  \n13:02\u00a0<tmortagne>\u00a0what do you mean ?  \n13:02\u00a0<vmassol>\u00a0forget that  \n13:03\u00a0<vmassol>\u00a0whatever the means the creators of extensions just need to have a components.txt anyway  \n13:03\u00a0<tmortagne>\u00a0it's more the opposite I would say, https://github.com/lukehutch/fast-classpath-scanner probably scan only the root classloader which mean it won't see extensions  \n13:03\u00a0<vmassol>\u00a0(either manually or generated)  \n13:03\u00a0<vmassol>\u00a0oh yes it won't work for us, it would need to be adapated  \n13:03\u00a0<vmassol>\u00a0to use URLs from url classloaders  \n13:04\u00a0<tmortagne>\u00a0so components.txt is safer is better for performances  \n13:04\u00a0<tmortagne>\u00a0but we could check if https://github.com/lukehutch/fast-classpath-scanner is better than reflections  \n13:04\u00a0<cjd>\u00a0how long does it take to scan the classpath ?  \n13:04\u00a0<cjd>\u00a0normally  \n13:04\u00a0<vmassol>\u00a0provided the JARs are saved locally it should work though  \n13:04\u00a0<vmassol>\u00a0it woudln't work for remote jars  \n13:05\u00a0<vmassol>\u00a0but that's an edge use case  \n13:05\u00a0<tmortagne>\u00a0the thing is that in extension case you want to know the component of a specific jar and not get all the class from the classpath  \n13:05\u00a0<Denis>\u00a0has quit  \n13:05\u00a0<tmortagne>\u00a0so I think it would be a pain to adapt this scanner for us  \n13:06\u00a0<vmassol>\u00a0not really  \n13:06\u00a0<vmassol>\u00a0becuase they have methods  \n13:06\u00a0<vmassol>\u00a0to scan a File, a Directory and a Zip  \n13:06\u00a0<vmassol>\u00a0so it's easy to scan just a JAR file  \n13:06\u00a0<tmortagne>\u00a0anyway, I still prefer to work with components.txt, we just it to generate then  \n13:06\u00a0<tmortagne>\u00a0them  \n13:07\u00a0<vmassol>\u00a0yes I agree, I'd still be curious to see how well is works and how performant it is\u2026 ;)  \n13:09\u00a0<tmortagne>\u00a0yes as I said we should compare it to reflections that we are currently using, but reflections added support for various non very standard container along the way that fast-classpath-scanner probably does not yet support  \n13:11\u00a0<Lyes>\u00a0has quit  \n13:13\u00a0<vmassol>\u00a0tmortagne: yes fast-cp-scanner is just one class done by one guy, not even released, it means making the code our own and supporting it  \n13:32\u00a0<Enygma`>\u00a0has quit  \n13:35\u00a0<Denis>\u00a0has joined #xwiki  \n13:45\u00a0<Enygma`>\u00a0has joined #xwiki  \n14:06\u00a0<D-Spair>\u00a0has quit  \n14:21\u00a0<D-Spair>\u00a0has joined #xwiki  \n15:04\u00a0<silverdrop>\u00a0has quit  \n15:23\u00a0<Lyes>\u00a0has joined #xwiki  \n15:30\u00a0<silverdrop>\u00a0has joined #xwiki  \n15:44\u00a0<Denis>\u00a0has quit  \n15:51\u00a0<Lyes>\u00a0has quit  \n16:00\u00a0<tmortagne>\u00a0vmassol: [WARNING] Rule violated for bundle XWiki Platform - URL - Standard Implementation: instructions covered ratio is 0.79, but expected minimum is 0.80  \n16:01\u00a0<vmassol>\u00a0ok thanks  \n16:03\u00a0<vmassol>\u00a0hmm  \n16:03\u00a0<vmassol>\u00a0checking  \n16:03\u00a0<vmassol>\u00a0ah yes I forgot for this module  \n16:04\u00a0<vmassol>\u00a0(forgot to check that is)  \n16:04\u00a0<Enygma`>\u00a0XWiki dev pain point, since I haven`t heard it mentioned before:  \n16:04\u00a0<Enygma`>\u00a0http://ci.xwiki.org/job/xwiki-platform/155/console  \n16:04\u00a0<Enygma`>\u00a0[ERROR] \\* \u00a0basic-import-export/pom.xml  \n16:05\u00a0<Enygma`>\u00a0that keeps happening a lot lately and it is very annoying to have to dig through logs  \n16:05\u00a0<msmeria>\u00a0has quit  \n16:05\u00a0<Enygma`>\u00a0anybody else get this feeling?  \n16:05\u00a0<vmassol>\u00a0what's the problme?  \n16:06\u00a0<Enygma`>\u00a0http://ci.xwiki.org/job/xwiki-platform/ws/xwiki-platform-tools/xwiki-platform-tool-packager-plugin/target/it/package-simple/build.log  \n16:06\u00a0<Enygma`>\u00a0Caused by: org.xwiki.component.manager.ComponentLookupException: Can't find descriptor for the component [role = [interface org.xwiki.configuration.ConfigurationSource] hint = [default]]  \n16:07\u00a0<Enygma`>\u00a0in [INFO] XWiki Platform - Tools - Packager - Test - Simple - Package \u00a0FAILURE [7.583s]  \n16:07\u00a0<Enygma`>\u00a0at least for this particular case  \n16:08\u00a0<Enygma`>\u00a0seems it`s failing the entire day  \n16:09\u00a0<KermitTheFragger>\u00a0has quit  \n16:09\u00a0<Enygma`>\u00a0that looks random to me  \n16:10\u00a0<tmortagne>\u00a0Enygma`: checking, I think it's caused by my last commit  \n16:11\u00a0<Enygma`>\u00a0uh, did jenkins just die? \"Service Temporarily Unavailable\"  \n16:13\u00a0<Enygma`>\u00a0false alarm  \n16:14\u00a0<Enygma`>\u00a0can someone tell me what is the purpose of those tests and why do they so often fail to build?  \n16:14\u00a0<tmortagne>\u00a0Enygma`: in that specific case it should be ok  \n16:15\u00a0<tmortagne>\u00a0now yes they often randomly fail for other reasons  \n16:15\u00a0<tmortagne>\u00a0usually a dependency handling issue, but they seems to fail a lot less often since quite some time  \n16:16\u00a0<vmassol>\u00a0they shouldn't fail randomly  \n16:16\u00a0<vmassol>\u00a0especially since all jobs are now using a single local repo  \n16:17\u00a0<DarkKnightCZ>\u00a0has quit  \n16:17\u00a0<Enygma`>\u00a0I can see stuff like this in the log:  \n16:17\u00a0<Enygma`>\u00a0[INFO] Copying JAR dependencies ...  \n16:17\u00a0<Enygma`>\u00a0[DEBUG] Could not find metadata org.xwiki.commons:xwiki-commons-filter-test:6.3-SNAPSHOT/maven-metadata.xml in local (/home/hudsonagent/jenkins\\_root/workspace/xwiki-platform/xwiki-platform-tools/xwiki-platform-tool-packager-plugin/target/local-repo) [DEBUG] Failure to find org.xwiki.commons:xwiki-commons-filter-test:6.3-SNAPSHOT/maven-metadata.xml in file:///home/hudsonagent/.m2/repository was cached in the local repository, resolution will not be reattempted   \n16:24\u00a0<Lyes>\u00a0has joined #xwiki  \n16:29\u00a0<Denis>\u00a0has joined #xwiki  \n16:32\u00a0<ClemensR>\u00a0it seems running maven in parallel and having it updating the local repo cache is not really a supported use case. however I did not check with the newer version ...  \n16:33\u00a0<silverdrop>\u00a0has quit  \n17:02\u00a0<OSIMasson>\u00a0has joined #xwiki  \n17:04\u00a0<AFKGeek>\u00a0has quit  \n17:05\u00a0<Enygma`>\u00a0tmortagne: leftover https://github.com/xwiki/xwiki-platform/blob/master/xwiki-platform-core/xwiki-platform-repository/xwiki-platform-repository-server-ui/src/main/resources/Scheduler/BatchImporterScheduler.xml#L151 ?  \n17:06\u00a0<tmortagne>\u00a0Enygma`: just forgot to execute mvn xar:format  \n17:06\u00a0<tmortagne>\u00a0ha no  \n17:06\u00a0<tmortagne>\u00a0it's probably like that since forever, did not even noticed  \n17:06\u00a0<tmortagne>\u00a0was exported from extensions.xwiki.org  \n17:07\u00a0<tmortagne>\u00a0fixing it  \n17:07\u00a0<tmortagne>\u00a0a pity we have to put something  \n17:07\u00a0<tmortagne>\u00a0or maybe there is a fallback, I would have to check scheduler code  \n17:07\u00a0<tmortagne>\u00a0ideally it should be scheduler author  \n17:08\u00a0<tmortagne>\u00a0Enygma`: I have to finish something, would be great if you could create a related jira issue so that I don't forget  \n17:14\u00a0<ClemensR>\u00a0has left #xwiki  \n17:14\u00a0<Enygma`>\u00a0tmortagne: will do  \n17:17\u00a0<tmortagne>\u00a0thanks  \n17:21\u00a0<Enygma`>\u00a0tmortagne: XWIKI-11180  \n17:52\u00a0<Enygma`>\u00a0FYI, I`ve just created XWIKI-11182 since it has a great impact on our end users and it should not be that difficult to do.  \n17:58\u00a0<cjd>\u00a0has quit  \n18:02\u00a0<woshilapin>\u00a0has quit  \n18:12\u00a0<Lyes>\u00a0has quit  \n18:20\u00a0<mflorea>\u00a0has quit  \n18:39\u00a0<tmortagne>\u00a0has quit  \n18:57\u00a0<evalica>\u00a0has quit  \n19:00\u00a0<Enygma`>\u00a0has quit  \n19:05\u00a0<Slashman>\u00a0has quit  \n19:14\u00a0<momomomomo>\u00a0has joined #xwiki  \n19:15\u00a0<silverdrop>\u00a0has joined #xwiki  \n19:29\u00a0<Denis>\u00a0has quit  \n19:30\u00a0<abusenius>\u00a0has joined #xwiki  \n19:31\u00a0<Denis>\u00a0has joined #xwiki  \n19:36\u00a0<momomomomo>\u00a0has quit  \n19:56\u00a0<D-Spair>\u00a0has quit  \n19:58\u00a0<momomomomo>\u00a0has joined #xwiki  \n20:01\u00a0<D-Spair>\u00a0has joined #xwiki  \n20:23\u00a0<momomomomo>\u00a0has quit  \n20:23\u00a0<momomomomo>\u00a0has joined #xwiki  \n20:35\u00a0<vmassol>\u00a0has quit  \n20:35\u00a0<Denis>\u00a0has quit  \n20:43\u00a0<sdumitriu>\u00a0has quit  \n20:52\u00a0<sdumitriu>\u00a0has joined #xwiki  \n20:53\u00a0<vmassol>\u00a0has joined #xwiki  \n20:54\u00a0<vmassol>\u00a0has quit  \n21:28\u00a0<andreeapopescu>\u00a0has joined #xwiki  \n21:48\u00a0<andreeapopescu>\u00a0has quit  \n21:54\u00a0<momomomomo>\u00a0has quit  \n21:55\u00a0<momomomomo>\u00a0has joined #xwiki  \n22:46\u00a0<silverdrop>\u00a0has quit  \n23:34\u00a0<momomomomo>\u00a0has quit  \n23:36\u00a0<momomomomo>\u00a0has joined #xwiki\n"}