{"id": "dev:IRC.xwikiArchive20161107", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20161107", "title": "IRC Archive for channel #xwiki on 07 November 2016 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<vmassol>\u00a0has joined #xwiki  \n00:07\u00a0<vmassol>\u00a0has quit  \n01:04\u00a0<vmassol>\u00a0has joined #xwiki  \n01:08\u00a0<vmassol>\u00a0has quit  \n02:06\u00a0<vmassol>\u00a0has joined #xwiki  \n02:11\u00a0<vmassol>\u00a0has quit  \n03:07\u00a0<vmassol>\u00a0has joined #xwiki  \n03:12\u00a0<vmassol>\u00a0has quit  \n03:37\u00a0<sdumitriu>\u00a0has quit  \n04:01\u00a0<sdumitriu>\u00a0has joined #xwiki  \n04:23\u00a0<vmassol>\u00a0has joined #xwiki  \n04:27\u00a0<vmassol>\u00a0has quit  \n06:12\u00a0<vmassol>\u00a0has joined #xwiki  \n06:16\u00a0<vmassol>\u00a0has quit  \n06:27\u00a0<mflorea>\u00a0has joined #xwiki  \n07:37\u00a0<mflorea>\u00a0has quit  \n08:01\u00a0<vmassol>\u00a0has joined #xwiki  \n08:05\u00a0<vmassol>\u00a0has quit  \n08:20\u00a0<msmeria>\u00a0has joined #xwiki  \n08:21\u00a0<vmassol>\u00a0has joined #xwiki  \n08:47\u00a0<Pbas>\u00a0has joined #xwiki  \n09:08\u00a0<tmortagne>\u00a0has joined #xwiki  \n09:13\u00a0<circ-user-B144h>\u00a0has joined #xwiki  \n09:14\u00a0<circ-user-B144h>\u00a0How to test mail notification from xwiki web page? There is any scripts or internal method?  \n09:19\u00a0<vmassol>\u00a0hi, you mean testing sending mail? You can do this using this for example: http://extensions.xwiki.org/xwiki/bin/view/Extension/Mail+Sender+API#HExample1:Sendasimpletextemail  \n09:20\u00a0<vmassol>\u00a0(after updating the email addresses from the example)  \n09:20\u00a0<vmassol>\u00a0(circ-user-B144h)  \n09:35\u00a0<circ-user-B144h>\u00a0has quit  \n09:36\u00a0<mflorea>\u00a0has joined #xwiki  \n09:43\u00a0<gdelhumeau>\u00a0has joined #xwiki  \n09:54\u00a0<vmassol>\u00a0tmortagne: good morning. It seems ExtensionUninstalledEvent always require a version to be specified. It's not possible to ask to be called when an extension has been uninstalled without knowing its version?  \n09:54\u00a0<vmassol>\u00a0I'll use ComponentDescriptorRemovedEvent for now  \n09:55\u00a0<vmassol>\u00a0since I guess uninstalling an extension will also remove the components it contains  \n09:55\u00a0<tmortagne>\u00a0vmassol: null version  \n09:55\u00a0<vmassol>\u00a0ah ok  \n09:55\u00a0<vmassol>\u00a0and for the namespace I can also pass null?  \n09:56\u00a0<vmassol>\u00a0nevermind for the namespace  \n09:56\u00a0<vmassol>\u00a0it's going to always be in the root NS anyway  \n09:56\u00a0<vmassol>\u00a0need to remember how to sepcify root  \n09:56\u00a0<tmortagne>\u00a0null means root namespace  \n09:57\u00a0<vmassol>\u00a0ok cool  \n09:57\u00a0<vmassol>\u00a0re version  \n09:57\u00a0<tmortagne>\u00a0would need a new constructor helper to set the id only  \n09:57\u00a0<vmassol>\u00a0(String) null  \n09:57\u00a0<vmassol>\u00a0or (Version) null  \n09:57\u00a0<vmassol>\u00a0?  \n09:57\u00a0<tmortagne>\u00a0the alternative right now is to simply listen to ExtensionUninstalledEvent() and do a if  \n09:57\u00a0<vmassol>\u00a0checking code  \n09:58\u00a0<tmortagne>\u00a0ExtensionUninstalledEvent() will give you all uninstall and you just need to check if the id is the one you want  \n09:59\u00a0<tmortagne>\u00a0now it depends what you want to do when the extension is uninstalled but if it's the extension itself you can simply implement Disposable in your component which probably make more sense  \n09:59\u00a0<vmassol>\u00a0yes was thinking about this too  \n09:59\u00a0<vmassol>\u00a0that's probaby the simpler  \n10:00\u00a0<tmortagne>\u00a0(need to a component that is always initialized)  \n10:00\u00a0<vmassol>\u00a0since this component is part of the extension  \n10:01\u00a0<vmassol>\u00a0the only issue is that it means it's going to be called more often  \n10:01\u00a0<tmortagne>\u00a0like a listener that register the auth in initialize() and unregister it in dispose(), no need to actually listen to any event  \n10:01\u00a0<vmassol>\u00a0and I need to control the dispose order  \n10:01\u00a0<vmassol>\u00a0in case some other component use the authentication in their dispose  \n10:01\u00a0<vmassol>\u00a0but should be ok  \n10:04\u00a0<vmassol>\u00a0tmortagne: the foillowing should work I think: https://gist.github.com/vmassol/271fbbe11b390180724c6d84f84af75a  \n10:07\u00a0<tmortagne>\u00a0vmassol: you should handle the use case where XWiki does not exist yet  \n10:08\u00a0<tmortagne>\u00a0since your listener is called when tomcat starts  \n10:08\u00a0<vmassol>\u00a0ah yes I changed the event  \n10:08\u00a0<vmassol>\u00a0I need to put back ApplicationReadyEvent  \n10:09\u00a0<vmassol>\u00a0hmm  \n10:09\u00a0<vmassol>\u00a0OTOH \u00a0it might come too late for the first request...  \n10:10\u00a0<vmassol>\u00a0checking code  \n10:10\u00a0<tmortagne>\u00a0you will also need to support the use case where the extension is installed, so probably something like implementing Initializable and register the auth if XWiki already exist (which mean it's an install and not startup)  \n10:11\u00a0<vmassol>\u00a0yes right, I forgot this one  \n10:11\u00a0<tmortagne>\u00a0as for ApplicationReadyEvent being too late I don't think so  \n10:12\u00a0<tmortagne>\u00a0ApplicationReadyEvent is sent at the end of XWiki instance initialization  \n10:12\u00a0<tmortagne>\u00a0nobody will try to authenticate before that I think  \n10:12\u00a0<vmassol>\u00a0ok so before the curren resource is served  \n10:12\u00a0<vmassol>\u00a0cool  \n10:12\u00a0<tmortagne>\u00a0to be tested but most code use XWiki#checkauth so they need initializee XWiki instance  \n10:26\u00a0<vmassol>\u00a0ok second version: https://gist.github.com/vmassol/271fbbe11b390180724c6d84f84af75a  \n10:26\u00a0<vmassol>\u00a0I'll test it  \n10:29\u00a0<tmortagne>\u00a0vmassol: why don't you use the XWikiContext provider ?  \n10:35\u00a0<vmassol>\u00a0thanks for the review tmortagne  \n10:40\u00a0<vmassol>\u00a0third version: https://gist.github.com/vmassol/271fbbe11b390180724c6d84f84af75a  \n10:41\u00a0<vmassol>\u00a0xwiki.org crash....  \n10:41\u00a0<vmassol>\u00a0FTR tmortagne I've talked to Fabio to set up a cluster for xwiki.org  \n10:41\u00a0<vmassol>\u00a0(he has it in his agenda now and will ping us asap)  \n10:42\u00a0<tmortagne>\u00a0ok  \n11:32\u00a0<gdelhumeau>\u00a0tmortagne: build is broken  \n11:32\u00a0<gdelhumeau>\u00a0[ERROR] Unknown packaging: webjar @ org.xwiki.platform:xwiki-platform-job-webjar:[unknown-version], /home/hudsonagent/jenkins\\_root/workspace/xwiki-platform/xwiki-platform-core/xwiki-platform-job/xwiki-platform-job-webjar/pom.xml, line 30, column 14  \n11:33\u00a0<gdelhumeau>\u00a0maybe commons is still building  \n11:33\u00a0<gdelhumeau>\u00a0hmm commons is broken too  \n11:35\u00a0<tmortagne>\u00a0right, forgot about this Maven bug  \n11:35\u00a0<tmortagne>\u00a0cannot build and use an extension in the same build  \n11:36\u00a0<tmortagne>\u00a0will need to move webjar extension declaration to platform for now (it's a pity but we don't have commons webjar yet so it should be ok)  \n12:02\u00a0<vmassol>\u00a0tmortagne: \"[ERROR] /home/hudsonagent/jenkins\\_root/workspace/xwiki-platform\\_Quality/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/internal/script/DebugScriptService.java:42: Script Service implementation [DebugScriptService] in package [com.xpn.xwiki.internal.script] should not be located in the internal package [ScriptService]  \n12:02\u00a0<vmassol>\u00a0\"  \n12:03\u00a0<vmassol>\u00a0at http://ci.xwiki.org/job/xwiki-platform\\_Quality/3534/console  \n12:03\u00a0<vmassol>\u00a0you may want to look into this  \n12:03\u00a0<vmassol>\u00a0it was hidden before  \n12:03\u00a0<vmassol>\u00a0with the checkstyle excludes  \n12:05\u00a0<tmortagne>\u00a0vmassol: it's an internal script service and it's supposed to  \n12:14\u00a0<sdumitriu>\u00a0has quit  \n14:15\u00a0<systemd>\u00a0has joined #xwiki  \n14:21\u00a0<Denis>\u00a0has joined #xwiki  \n14:57\u00a0<gdelhumeau>\u00a0vmassol: Are you working on XWIKI-11564?  \n14:58\u00a0<vmassol>\u00a0gdelhumeau: not ATM  \n14:58\u00a0<gdelhumeau>\u00a0ok, so I change the fixfor  \n14:58\u00a0<vmassol>\u00a0yep thanks  \n14:59\u00a0<gdelhumeau>\u00a0tmortagne: your status on XE-1570?  \n15:00\u00a0<tmortagne>\u00a0gdelhumeau: won't be ready for 8.4  \n15:00\u00a0<gdelhumeau>\u00a0ok  \n15:00\u00a0<gdelhumeau>\u00a0should I postpone to 8.4.1 or 9.x?  \n15:01\u00a0<tmortagne>\u00a0I will take care of that, I introduced various new things that might be too dangerous for 8.4.x so I will more it 9.0RC1 for now  \n15:06\u00a0<gdelhumeau>\u00a0from my side, I just need to remove the fixFor 8.4 :)  \n15:08\u00a0<tmortagne>\u00a0is it onlt me of jira is super slow ?  \n15:12\u00a0<msmeria>\u00a0has quit  \n15:14\u00a0<vmassol>\u00a0tmortagne and all: I have some LDAP auth question. I'm using XWikiLDAPAuthServiceImpl (I'm extending it) but it doesn't seem to fallback properly for some reason: in short, I cannot login with my Admin user. Any idea?  \n15:15\u00a0<vmassol>\u00a0I'm really a newbie on the LDAP auth service/authenticator...  \n15:15\u00a0<tmortagne>\u00a0vmassol: tryLocal  \n15:15\u00a0<vmassol>\u00a0wdym?  \n15:15\u00a0<vmassol>\u00a0it's not the default?  \n15:15\u00a0<tmortagne>\u00a0xwiki.authentication.ldap.trylocal=1  \n15:15\u00a0<tmortagne>\u00a0no it's not the default  \n15:16\u00a0<vmassol>\u00a0weird, I see that XWikiAuthService is called  \n15:16\u00a0<vmassol>\u00a0(in debug)  \n15:16\u00a0<tmortagne>\u00a0not XWikiAuthService#authenticate  \n15:16\u00a0<tmortagne>\u00a0authenticate and checkAuth are 2 very different things  \n15:16\u00a0<vmassol>\u00a0ok I see  \n15:16\u00a0<tmortagne>\u00a0checkAuth is taking care of asking for credentials among other things  \n15:17\u00a0<tmortagne>\u00a0which is the same for LDAP or standard XWiki (unless you are using trusted LDAP)  \n15:41\u00a0<edvorg>\u00a0has quit  \n15:48\u00a0<vmassol>\u00a0tmortagne: I'm trying to use xwiki.extension.namespaces to restrict an extension to be installed on the main wiki  \n15:48\u00a0<vmassol>\u00a0but it doesn't seem possible  \n15:48\u00a0<vmassol>\u00a0all I can do is:  \n15:48\u00a0<vmassol>\u00a0<xwiki.extension.namespaces>wiki:xwiki</\u2026>  \n15:49\u00a0<vmassol>\u00a0but I guess this will fail if the user has modified xwiki.cfg's xwiki.db parameter. For example: xwiki.db=xwiki2  \n15:49\u00a0<vmassol>\u00a0right?  \n15:50\u00a0<tmortagne>\u00a0no  \n15:50\u00a0<tmortagne>\u00a0xwiki.db is not the wiki name  \n15:50\u00a0<tmortagne>\u00a0that's the database name  \n15:50\u00a0<tmortagne>\u00a0the wiki name is always \"xwiki\"  \n15:50\u00a0<vmassol>\u00a0ok, wasn't sure  \n15:50\u00a0<vmassol>\u00a0thx  \n15:50\u00a0<vmassol>\u00a0and good :)  \n15:51\u00a0<tmortagne>\u00a0we have an API to get the main wiki to be clean but in practice there is no official way to change the id of the main wiki right now  \n15:52\u00a0<tmortagne>\u00a0vmassol: what do you want to force on the main wiki ? AD UI ?  \n15:52\u00a0<vmassol>\u00a0yes  \n15:53\u00a0<tmortagne>\u00a0I don't think this is right  \n15:53\u00a0<vmassol>\u00a0ok let's move to the other chat  \n15:53\u00a0<vmassol>\u00a0(I asked there)  \n16:43\u00a0<martinus\\_\\_>\u00a0has quit  \n16:48\u00a0<martinus\\_\\_>\u00a0has joined #xwiki  \n17:07\u00a0<tmortagne>\u00a0has quit  \n17:54\u00a0<mflorea>\u00a0has quit  \n18:35\u00a0<mflorea>\u00a0has joined #xwiki  \n18:44\u00a0<edvorg>\u00a0has joined #xwiki  \n18:44\u00a0<edvorg>\u00a0has quit  \n18:56\u00a0<gdelhumeau>\u00a0Pbas: make me think to look at your PR tomorow  \n18:58\u00a0<Pbas>\u00a0gdelhumeau: ok thxs  \n18:59\u00a0<Pbas>\u00a0I did the mess with git (a nightmare)  \n18:59\u00a0<gdelhumeau>\u00a0yes git is not easy to master  \n18:59\u00a0<gdelhumeau>\u00a0I try to always use the same \"workflow\" to avoid problem with it ^^  \n19:00\u00a0<Pbas>\u00a0yes the same  \n19:00\u00a0<Pbas>\u00a0now I think I manage to use git add -p  \n19:00\u00a0<gdelhumeau>\u00a0your commit looks nicer for sure  \n19:01\u00a0<gdelhumeau>\u00a0has quit  \n19:01\u00a0<Pbas>\u00a0ha ha I hope so! (I take \u00a0... 2 hours for it)  \n21:15\u00a0<Pbas>\u00a0has quit  \n22:27\u00a0<vmassol>\u00a0has quit  \n22:28\u00a0<vmassol>\u00a0has joined #xwiki  \n22:28\u00a0<vmassol>\u00a0has quit  \n22:36\u00a0<Pbas>\u00a0has joined #xwiki  \n23:14\u00a0<mflorea>\u00a0has quit\n"}