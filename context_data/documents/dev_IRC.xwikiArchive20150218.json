{"id": "dev:IRC.xwikiArchive20150218", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20150218", "title": "IRC Archive for channel #xwiki on 18 February 2015 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<lucaa>\u00a0has quit  \n00:05\u00a0<martin-h>\u00a0has quit  \n00:08\u00a0<martin-h>\u00a0has joined #xwiki  \n00:25\u00a0<sburjan``>\u00a0has quit  \n06:02\u00a0<Denis1>\u00a0has joined #xwiki  \n06:04\u00a0<Denis>\u00a0has quit  \n07:06\u00a0<lucaa>\u00a0has joined #xwiki  \n07:12\u00a0<lucaa>\u00a0has quit  \n07:51\u00a0<vmassol>\u00a0has joined #xwiki  \n08:01\u00a0<sburjan>\u00a0has joined #xwiki  \n08:28\u00a0<vmassol>\u00a0has quit  \n08:48\u00a0<gsmeria>\u00a0has joined #xwiki  \n08:53\u00a0<KermitTheFragger>\u00a0has joined #xwiki  \n08:56\u00a0<ClemensR>\u00a0has joined #xwiki  \n09:27\u00a0<cjd>\u00a0has joined #xwiki  \n09:29\u00a0<vmassol>\u00a0has joined #xwiki  \n09:38\u00a0<[d\\_\\_d]>\u00a0has quit  \n09:40\u00a0<[d\\_\\_d]>\u00a0has joined #xwiki  \n09:45\u00a0<gdelhumeau>\u00a0has joined #xwiki  \n09:53\u00a0<mflorea>\u00a0has joined #xwiki  \n09:54\u00a0<mflorea>\u00a0has quit  \n09:54\u00a0<mflorea1>\u00a0has joined #xwiki  \n09:54\u00a0<mflorea1>\u00a0has quit  \n09:54\u00a0<mflorea>\u00a0has joined #xwiki  \n09:56\u00a0<Enygma`>\u00a0has joined #xwiki  \n09:56\u00a0<evalica>\u00a0has joined #xwiki  \n10:02\u00a0<lucaa>\u00a0has joined #xwiki  \n10:57\u00a0<tmortagne>\u00a0has joined #xwiki  \n10:58\u00a0<tmortagne>\u00a0has quit  \n11:06\u00a0<Denis1>\u00a0is now known as <Denis>  \n11:13\u00a0<gsmeria>\u00a0has quit  \n11:37\u00a0<Slashman>\u00a0has joined #xwiki  \n12:18\u00a0<gsmeria>\u00a0has joined #xwiki  \n12:35\u00a0<lucaa>\u00a0has quit  \n12:36\u00a0<lucaa>\u00a0has joined #xwiki  \n12:53\u00a0<ClemensR>\u00a0Has anyone time to review my fix for XWIKI-11476 ? the commit would be here: https://github.com/xwiki/xwiki-platform/commit/69b4c34377145f39a80b5a4b4ae41f8dc0a53af8?w=1  \n12:54\u00a0<ClemensR>\u00a0it is messing with the \u00a0XWikiRightServiceImpl ... I would prefer is someone other than me looks at it  \n14:53\u00a0<KermitTheFragger>\u00a0has quit  \n15:51\u00a0<gsmeria>\u00a0has quit  \n16:08\u00a0<ClemensR>\u00a0hm, I 've got a java.lang.ClassNotFoundException: org.xwiki.environment.internal.StandardEnvironment \u00a0when trying to run xwiki inside eclipse for the dev-tools ... seems a components.txt from some test got into the environment, or what else could it be ?  \n16:09\u00a0<vmassol>\u00a0Hi Clemens  \n16:10\u00a0<vmassol>\u00a0not sure what your problem is, just note that StandardEnvironment has a lower priority and is registered with: 900:org.xwiki.environment.internal.StandardEnvironment  \n16:10\u00a0<vmassol>\u00a0usually we use StandardEnvironment in tests yes  \n16:10\u00a0<vmassol>\u00a0(for integration tests)  \n16:10\u00a0<vmassol>\u00a0(we mock Environment for unit tests)  \n16:14\u00a0<ClemensR>\u00a0ah, yes m, I see I have imported xwiki-platform-security-bridge \u00a0in the xwiki-debug-eclipse, as explained here: \u00a0http://dev.xwiki.org/xwiki/bin/view/Community/DebugXEWithEclipse\\_ImportJarProjects  \n16:14\u00a0<ClemensR>\u00a0and \u00a0that seems mention the StandardEnvironment in its tests components.txt ... maybe it has something to do with that ...  \n16:19\u00a0<ClemensR>\u00a0ah, yes, it included all the test stuff in the xwiki-platform-security-bridge.jar and deployed it ... thats why  \n16:21\u00a0<vmassol>\u00a0ok, sorry i'm not a eclipse user :)  \n16:21\u00a0<cjd>\u00a0you don't look sorry  \n16:21\u00a0<vmassol>\u00a0right\u2026 I'm not :)  \n16:22\u00a0<vmassol>\u00a0intellij ftw :)  \n16:23\u00a0<cjd>\u00a0http://imgs.xkcd.com/comics/real\\_programmers.png  \n16:24\u00a0<vmassol>\u00a0yup  \n16:24\u00a0<vmassol>\u00a0:)  \n16:35\u00a0<Bugen\\_do>\u00a0has joined #xwiki  \n16:47\u00a0<ClemensR>\u00a0just for the record: seems I have been able to work around the issue ; after closing the xwiki-platform-security-bridge project in the IDE and cleaning / removing and reopening lots of stuff, it works now ...  \n17:11\u00a0<vmassol>\u00a0gdelhumeau: I have a problem  \n17:11\u00a0<vmassol>\u00a0and maybe you know about it  \n17:12\u00a0<vmassol>\u00a0on 6.4.1, if I create a subwiki (global users + local users) and I put a \"test\" user as owner, then I set the permissions so that only the local AdminGroup has view access  \n17:12\u00a0<vmassol>\u00a0it results in the \"test\" user not being able to see his wiki in the wiki index  \n17:13\u00a0<vmassol>\u00a0and the \"test\" user has no access to his wiki even though he's the owner  \n17:14\u00a0<vmassol>\u00a0I'm going to create a jira issue, it seems we have some important regression  \n17:14\u00a0<vmassol>\u00a0has someone noticed this too?  \n17:14\u00a0<gdelhumeau>\u00a0What I know is that the owner is not added to the admin group of the subwiki  \n17:14\u00a0<vmassol>\u00a0yes but that's ok  \n17:14\u00a0<vmassol>\u00a0the owner has all the permissions normally  \n17:14\u00a0<vmassol>\u00a0(there's a bypass for the owner in the code)  \n17:14\u00a0<gdelhumeau>\u00a0so maybe the right system does not handle this  \n17:15\u00a0<vmassol>\u00a0it was  \n17:15\u00a0<vmassol>\u00a0for sure  \n17:17\u00a0<momomomomo>\u00a0has joined #xwiki  \n17:29\u00a0<vmassol>\u00a0Denis: ping  \n17:29\u00a0<vmassol>\u00a0Denis: could you quickly check if my assumptions are correct in XWIKI-11811 ?  \n17:31\u00a0<Denis>\u00a0checking  \n17:33\u00a0<Denis>\u00a0looks weird  \n17:39\u00a0<Denis>\u00a0vmassol: it does not make sens to me, actually the owner implicitly receive as a user the admin right on all object holding global rights when those right are requested  \n17:39\u00a0<vmassol>\u00a0Denis: can you point me to the code where this is checked?  \n17:39\u00a0<vmassol>\u00a0so that I can debug it  \n17:40\u00a0<Denis>\u00a0org.xwiki.security.authorization.internal.DefaultSecurityEntryReader#getImpliedRules  \n17:40\u00a0<Denis>\u00a0this is not a check, this is introduced as a implied rules like any other security rules  \n17:41\u00a0<Denis>\u00a0when a global right request is done, that rule is \"virtually\" added in the reply  \n17:44\u00a0<Denis>\u00a0so you could see this like if for all XWikiPrefs, and WebPrefs of the subwiki, there is a rules for the owner user allowing admin right  \n17:45\u00a0<vmassol>\u00a0ok so my assumptions are correct it seems and we have a big bug  \n17:45\u00a0<Denis>\u00a0why ?  \n17:45\u00a0<vmassol>\u00a0Denis: could you quickly check if my assumptions are correct in XWIKI-11811 ?  \n17:46\u00a0<vmassol>\u00a0am I wrong in what I am expecting in this issue?  \n17:46\u00a0<momomomomo>\u00a0has quit  \n17:46\u00a0<momomomomo>\u00a0has joined #xwiki  \n17:47\u00a0<Denis>\u00a0this does not make sens as that user has explicit admin right on that subwiki  \n17:48\u00a0<vmassol>\u00a0Denis: I'm just asking if you can tell me if I'm correct in assuming that with the setup I've defined the owner should always get access to his subwiki  \n17:48\u00a0<Denis>\u00a0yes he should  \n17:48\u00a0<momomomomo>\u00a0has quit  \n17:48\u00a0<vmassol>\u00a0ok then I repeat that we have a big bug because it doesn't work  \n17:49\u00a0<vmassol>\u00a0that's the point of this issue  \n17:49\u00a0<vmassol>\u00a0:)  \n17:49\u00a0<Denis>\u00a0I do not see how it could goes wrong, have you determine if this is a regression ?  \n17:49\u00a0<vmassol>\u00a0FTR it was discovered on myxwiki.org when we created a new wiki for a user yesterday, after thomas upgraded to 6.4.1  \n17:50\u00a0<vmassol>\u00a0Denis: sigh\u2026. this is why I've asked you to verify my assumptions.. anyway feel free to reproduce it if you don't trust the issue  \n17:51\u00a0<Denis>\u00a0I trust you, but unless the implied right is not applied to the user, which means what ever you set, he is not owner, we should have an issue not related to owner, since the rules is a normal rule  \n17:52\u00a0<vmassol>\u00a0I have no clue where the bug is  \n17:52\u00a0<vmassol>\u00a0all I know is that some user had it on myxwiki.org and I can reproduce locally  \n17:52\u00a0<Denis>\u00a0according to admin right tie resolution and hierarchy policy, I do not see anyway to prevent the rules to be effective once introduce  \n17:53\u00a0<vmassol>\u00a0honestly I'd rather you check this because this is not code I know at all\u2026  \n17:59\u00a0<vmassol>\u00a0Denis: for debugging, is there a way to flush the security caches?  \n17:59\u00a0<evalica>\u00a0has quit  \n17:59\u00a0<cjd>\u00a0echo 1 >/proc/sys/vm/drop\\_caches  \n17:59\u00a0<cjd>\u00a0sorry, I'll be quiet  \n17:59\u00a0<vmassol>\u00a0\u00a0/mute cjd  \n18:00\u00a0<cjd>\u00a0good time for it, seeya tomorrow  \n18:00\u00a0<cjd>\u00a0has quit  \n18:00\u00a0<momomomomo>\u00a0has joined #xwiki  \n18:01\u00a0<Denis>\u00a0never done that, there no flush per se, the cache is created here:org.xwiki.security.authorization.cache.internal.DefaultSecurityCache#initialize  \n18:06\u00a0<Denis>\u00a0@vmassol: 6.4.1 you said, I see the wiki in the index actually  \n18:07\u00a0<vmassol>\u00a0yes 6.4.1  \n18:07\u00a0<Denis>\u00a0but I reproduce the issue on view wiki pages  \n18:07\u00a0<ClemensR>\u00a0has quit  \n18:07\u00a0<vmassol>\u00a0are you sure you set up the permissions on the subwiki as I mentined in the issue?  \n18:07\u00a0<vmassol>\u00a0ie tick the permissions only for the local AdminGroup  \n18:08\u00a0<Denis>\u00a0have you set something particular for the membership type ?  \n18:08\u00a0<vmassol>\u00a0yes, as I mentioned in the issue  \n18:08\u00a0<vmassol>\u00a0global+local  \n18:08\u00a0<Denis>\u00a0not that one  \n18:08\u00a0<Denis>\u00a0the one about invitation  \n18:08\u00a0<vmassol>\u00a0only admin  \n18:10\u00a0<Denis>\u00a0you should precise that, since this is why it get hidden in the index  \n18:10\u00a0<vmassol>\u00a0ok, I've added it a few minutes ago :)  \n18:13\u00a0<Denis>\u00a0well, even without this setting the owner does not seems to be admin  \n18:13\u00a0<Denis>\u00a0so it looks like the implied rule does not get applied  \n18:14\u00a0<Denis>\u00a0is there any recent change on the way to retrieve the wiki owner ?  \n18:15\u00a0<Denis>\u00a0currently the code use the legacy function context.getWiki().getWikiOwner(name, context)  \n18:16\u00a0<Denis>\u00a0which return a string, and resolve it  \n18:16\u00a0<Denis>\u00a0I would bet that this is no more working properly  \n18:18\u00a0<gdelhumeau>\u00a0has quit  \n18:20\u00a0<vmassol>\u00a0Denis: I see this http://jira.xwiki.org/browse/XWIKI-8952 but it's a bit old  \n18:23\u00a0<vmassol>\u00a0Denis: maybe it's the right time to use the new api instead?  \n18:28\u00a0<mflorea>\u00a0has quit  \n18:33\u00a0<vmassol>\u00a0bbl  \n18:33\u00a0<vmassol>\u00a0has quit  \n18:39\u00a0<Denis>\u00a0vmassol: get it  \n18:39\u00a0<Denis>\u00a0it is stupid  \n18:39\u00a0<Denis>\u00a0the wiki creation does not set the owner properly, check the descriptor in the subwiki  \n18:42\u00a0<Denis>\u00a0curious  \n18:42\u00a0<Denis>\u00a0it works, but I found that my first wiki does not have the right owner  \n18:44\u00a0<Denis>\u00a0well there is some issue about that setting, I am sure  \n18:47\u00a0<Denis>\u00a0yes  \n18:47\u00a0<Denis>\u00a0commenting the issue  \n18:48\u00a0<Denis>\u00a0even better changing the issue !  \n19:07\u00a0<momomomomo>\u00a0has quit  \n19:07\u00a0<lucaa>\u00a0has quit  \n19:48\u00a0<momomomomo>\u00a0has joined #xwiki  \n19:57\u00a0<Slashman>\u00a0has quit  \n20:26\u00a0<mflorea>\u00a0has joined #xwiki  \n22:03\u00a0<mflorea>\u00a0has quit  \n22:07\u00a0<Bugen\\_do>\u00a0has quit  \n22:11\u00a0<lucaa>\u00a0has joined #xwiki  \n22:16\u00a0<momomomomo>\u00a0has quit  \n22:32\u00a0<momomomomo>\u00a0has joined #xwiki  \n22:36\u00a0<Denis>\u00a0has quit  \n22:49\u00a0<momomomomo>\u00a0has quit  \n23:10\u00a0<Enygma`>\u00a0has quit  \n23:55\u00a0<Trefex>\u00a0has joined #xwiki  \n23:55\u00a0<Trefex>\u00a0hi all\n"}