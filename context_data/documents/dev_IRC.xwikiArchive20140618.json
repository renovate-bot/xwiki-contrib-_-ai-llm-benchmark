{"id": "dev:IRC.xwikiArchive20140618", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20140618", "title": "IRC Archive for channel #xwiki on 18 June 2014 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<OSIMasson>\u00a0has quit  \n00:39\u00a0<OSIMasson>\u00a0has joined #xwiki  \n00:39\u00a0<OSIMasson>\u00a0has quit  \n00:39\u00a0<OSIMasson>\u00a0has joined #xwiki  \n01:12\u00a0<OSIMasson>\u00a0has quit  \n01:41\u00a0<OSIMasson>\u00a0has joined #xwiki  \n02:06\u00a0<Lyes>\u00a0has quit  \n02:16\u00a0<Denis>\u00a0has quit  \n02:38\u00a0<Slashman>\u00a0has quit  \n04:05\u00a0<OSIMasson>\u00a0has quit  \n04:30\u00a0<Denis>\u00a0has joined #xwiki  \n06:01\u00a0<Denis>\u00a0has quit  \n06:36\u00a0<mflorea>\u00a0has joined #xwiki  \n07:11\u00a0<vmassol>\u00a0has joined #xwiki  \n07:36\u00a0<msmeria>\u00a0has joined #xwiki  \n08:14\u00a0<sdumitriu1>\u00a0has quit  \n08:19\u00a0<tekzilla>\u00a0has quit  \n08:23\u00a0<tekzilla>\u00a0has joined #xwiki  \n08:28\u00a0<sdumitriu1>\u00a0has joined #xwiki  \n08:29\u00a0<evalica>\u00a0has joined #xwiki  \n08:59\u00a0<KermitTheFragger>\u00a0has joined #xwiki  \n09:08\u00a0<vfzevaze>\u00a0has joined #xwiki  \n09:08\u00a0<woshilapin>\u00a0has joined #xwiki  \n09:10\u00a0<gdelhumeau>\u00a0has joined #xwiki  \n09:28\u00a0<mflorea>\u00a0has quit  \n09:31\u00a0<Lyes>\u00a0has joined #xwiki  \n10:01\u00a0<msmeria>\u00a0has quit  \n10:01\u00a0<mflorea>\u00a0has joined #xwiki  \n10:02\u00a0<msmeria>\u00a0has joined #xwiki  \n10:11\u00a0<tmortagne>\u00a0has joined #xwiki  \n10:15\u00a0<Denis1>\u00a0has joined #xwiki  \n10:18\u00a0<vmassol>\u00a0tmortagne: good morning  \n10:18\u00a0<vmassol>\u00a0question for you:  \n10:18\u00a0<vmassol>\u00a0in XWikiAttachment, I see:  \n10:18\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0public String getMimeType(XWikiContext context)  \n10:18\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0{  \n10:18\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0// TODO: Try the stream too in case the extension in unknown (might be expensive to load it just for this) ?  \n10:18\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0return new Tika().detect(getFilename());  \n10:19\u00a0<vmassol>\u00a0shouldn't we have only 1 Tika instance? I've checked the code and it seems it's made to be reused  \n10:19\u00a0<vmassol>\u00a0right now it means the config is parsed again every time  \n10:19\u00a0<vmassol>\u00a0which isn't good IMO  \n10:20\u00a0<tmortagne>\u00a0vmassol: no idea  \n10:21\u00a0<vmassol>\u00a0ok I'll change it then  \n10:21\u00a0<tmortagne>\u00a0TikaConfig does not seems to do much  \n10:21\u00a0<vmassol>\u00a0it does  \n10:21\u00a0<vmassol>\u00a0check TikaConfig()  \n10:22\u00a0<tmortagne>\u00a0I did and if you don't put anything special in system property it does not look like very expensive stuff  \n10:22\u00a0<tmortagne>\u00a0anyway I don't know if tika is thread safe  \n10:23\u00a0<vmassol>\u00a0since you pass a cofnig to it I believe it is  \n10:23\u00a0<vmassol>\u00a0I'll check their doc  \n10:24\u00a0<vmassol>\u00a0reading http://stackoverflow.com/questions/10190980/spring-tika-integration-is-my-approach-thread-safe  \n10:25\u00a0<vmassol>\u00a0http://comments.gmane.org/gmane.comp.apache.tika.user/677  \n10:25\u00a0<vmassol>\u00a0ahah: https://issues.liferay.com/browse/LPS-15824  \n10:25\u00a0<vmassol>\u00a0http://web.archiveorange.com/archive/v/99aTkiOCyApHaqASS5CS  \n10:26\u00a0<vmassol>\u00a0checking TIKA-599 now  \n10:27\u00a0<vmassol>\u00a0fixed in 0.10 and we' re using a much more recent version  \n10:27\u00a0<vmassol>\u00a0so it's safe, I'll change it  \n10:29\u00a0<vmassol>\u00a0hmm a middle ground is to create it only when you create the attachment\u2026  \n10:29\u00a0<vmassol>\u00a0not as good as a singleton but simpler to implement  \n10:29\u00a0<vmassol>\u00a0actually this may cost more if you don't call getMimeType() ;)  \n10:34\u00a0<lucaa>\u00a0has joined #xwiki  \n10:40\u00a0<vmassol>\u00a0tmortagne: it's very slow actually to initialize  \n10:41\u00a0<vmassol>\u00a0takes 270ms for each init  \n10:42\u00a0<vmassol>\u00a0actually this is not completely true, it's true for the first init  \n10:42\u00a0<vmassol>\u00a0but it seems it reuses stuff afterwards or the jit really improves it over time  \n10:43\u00a0<vmassol>\u00a0it goes from 270ms to 6ms therafter (which is still high though)  \n10:43\u00a0<vmassol>\u00a0actually no, if I remoeve the first init  \n10:43\u00a0<vmassol>\u00a0it takes 4ms threafter for each new Tika()  \n10:51\u00a0<vmassol>\u00a0tmortagne: I think this getMimeType is not well located, either we should be able to set the mimetype in XWikiAttachment and if not defined then it's auto discovered or it shoudl be some MimeTypeFactory component\u2026 anyway I'm not planing to change this now\u2026  \n10:52\u00a0<tmortagne>\u00a0\"we should be able to set the mimetype in XWikiAttachment\" mimetype is not stored  \n10:53\u00a0<tmortagne>\u00a0I did not introduced this method, just made it not depend on servlet web.xml anymore  \n10:54\u00a0<vmassol>\u00a0actually  \n10:54\u00a0<vmassol>\u00a0just realized that you changed the impl in XWIKI-3249  \n10:54\u00a0<vmassol>\u00a0and before the mime type was retrieved from web.xml or the container's defualt web.xml  \n10:54\u00a0<tmortagne>\u00a0yes that's what I said  \n10:54\u00a0<vmassol>\u00a0so this means that users who put their mime tpyes there will not work anyore  \n10:55\u00a0<vmassol>\u00a0they'll need to configure tika instead  \n10:55\u00a0<tmortagne>\u00a0if tika does not already know the extension  \n10:55\u00a0<vmassol>\u00a0or if it uses a wrong one  \n10:55\u00a0<vmassol>\u00a0I've noticed the following diffrences for example:  \n10:55\u00a0<tmortagne>\u00a0the default web.xml was missing tons of stuff and was never up to date so the current situation is a lot better  \n10:55\u00a0<vmassol>\u00a0https://gist.githubusercontent.com/vmassol/b9c7a6dd29e5310441b2/raw/bc36791a66005011ad29aa04e8fab37ce9adfe64/gistfile1.txt  \n10:56\u00a0<vmassol>\u00a0between the default mime types used in mailsender plugin and the ones returned by Tiak  \n10:56\u00a0<vmassol>\u00a0\\*Tika  \n10:56\u00a0<vmassol>\u00a0I don't believe we documented this though  \n10:56\u00a0<vmassol>\u00a0did you put that in the RN?  \n10:56\u00a0<vmassol>\u00a0(and explain how to configure Tika)  \n10:57\u00a0<vmassol>\u00a0i know for sure several users who had configured their web.xml and they may get different results  \n10:57\u00a0<vmassol>\u00a0web.xml was a standard way, tika is not  \n11:02\u00a0<ClemensR>\u00a0has joined #xwiki  \n11:22\u00a0<tmortagne>\u00a0vmassol: the WAR plugin does not take into account dependencymanagement defined in dependencies (platform in the case of the failing XE build), being forced to put any dependencymanager at the root of commins is not very nice but for now I don't see much possibility, digging more the WAR plugin  \n11:33\u00a0<tmortagne>\u00a0vmassol: commented on XWIKI-3249  \n11:46\u00a0<Slashman>\u00a0has joined #xwiki  \n12:03\u00a0<Slashman>\u00a0has quit  \n12:30\u00a0<Slashman>\u00a0has joined #xwiki  \n13:13\u00a0<cjd>\u00a0has joined #xwiki  \n13:34\u00a0<gdelhumeau>\u00a0has quit  \n13:38\u00a0<lucaa>\u00a0has quit  \n13:41\u00a0<OSIMasson>\u00a0has joined #xwiki  \n13:48\u00a0<gdelhumeau>\u00a0has joined #xwiki  \n14:26\u00a0<ClemensR>\u00a0has left #xwiki  \n14:30\u00a0<lucaa>\u00a0has joined #xwiki  \n14:35\u00a0<OSIMasson>\u00a0has quit  \n15:04\u00a0<msmeria>\u00a0has quit  \n15:14\u00a0<vfzevaze>\u00a0has left #xwiki  \n15:26\u00a0<ClemensR>\u00a0has joined #xwiki  \n15:50\u00a0<vmassol>\u00a0tmortagne: FYI https://github.com/square/okhttp (see also https://github.com/square/okhttp/wiki/Recipes )  \n15:51\u00a0<vmassol>\u00a0http://square.github.io/okhttp/  \n16:39\u00a0<evalica>\u00a0has quit  \n16:55\u00a0<Denis1>\u00a0has quit  \n17:03\u00a0<mflorea>\u00a0has quit  \n17:08\u00a0<gdelhumeau>\u00a0has quit  \n17:17\u00a0<ClemensR>\u00a0has left #xwiki  \n17:18\u00a0<Denis1>\u00a0has joined #xwiki  \n17:49\u00a0<KermitTheFragger>\u00a0has quit  \n18:20\u00a0<Denis1>\u00a0is now known as <Denis>  \n18:30\u00a0<tmortagne>\u00a0has quit  \n18:53\u00a0<cjd>\u00a0has quit  \n19:03\u00a0<abusenius>\u00a0has joined #xwiki  \n19:24\u00a0<Denis>\u00a0Lyes: are you still editing the 6.1RC1 RN ?  \n19:25\u00a0<Lyes>\u00a0Denis: no you can edit it  \n19:25\u00a0<Denis>\u00a0thanks  \n19:29\u00a0<Slashman>\u00a0has quit  \n19:34\u00a0<Lyes>\u00a0Denis: Tell me when can i edit 6.1RC1 RN, Thanks in advance  \n19:35\u00a0<woshilapin>\u00a0has quit  \n19:52\u00a0<Denis>\u00a0Lyes: go on  \n21:23\u00a0<lucaa>\u00a0has quit  \n21:25\u00a0<Lyes1>\u00a0has joined #xwiki  \n21:27\u00a0<Lyes>\u00a0has quit  \n21:46\u00a0<vmassol>\u00a0has quit  \n21:50\u00a0<mflorea>\u00a0has joined #xwiki  \n22:34\u00a0<mflorea>\u00a0has quit  \n22:39\u00a0<abusenius>\u00a0has quit  \n22:44\u00a0<sburjan>\u00a0has quit  \n23:09\u00a0<sburjan>\u00a0has joined #xwiki\n"}