{"id": "dev:IRC.xwikiArchive20121203", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20121203", "title": "IRC Archive for channel #xwiki on 03 December 2012 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<rrodriguez>\u00a0has quit  \n01:23\u00a0<vmassol>\u00a0has quit  \n01:28\u00a0<sdumitriu>\u00a0has quit  \n01:33\u00a0<jvdrean>\u00a0has quit  \n02:02\u00a0<vmassol>\u00a0has joined #xwiki  \n03:29\u00a0<sdumitriu>\u00a0has joined #xwiki  \n04:15\u00a0<tekzilla>\u00a0has quit  \n04:16\u00a0<tekzilla>\u00a0has joined #xwiki  \n04:41\u00a0<polx\\_>\u00a0has joined #xwiki  \n04:43\u00a0<polx>\u00a0has quit  \n04:43\u00a0<polx\\_>\u00a0is now known as <polx>  \n07:58\u00a0<vmassol>\u00a0has quit  \n08:17\u00a0<vmassol>\u00a0has joined #xwiki  \n08:18\u00a0<mflorea>\u00a0has joined #xwiki  \n08:19\u00a0<mflorea>\u00a0has quit  \n08:19\u00a0<mflorea>\u00a0has joined #xwiki  \n08:34\u00a0<mrvanes>\u00a0has joined #xwiki  \n09:06\u00a0<vmassol>\u00a0good morning  \n09:07\u00a0<msmeria>\u00a0has joined #xwiki  \n09:14\u00a0<mrvanes>\u00a0has quit  \n09:14\u00a0<mflorea>\u00a0has quit  \n09:15\u00a0<mflorea>\u00a0has joined #xwiki  \n09:17\u00a0<Slashman>\u00a0has joined #xwiki  \n09:27\u00a0<tmortagne>\u00a0has joined #xwiki  \n09:46\u00a0<tdelafosse>\u00a0has joined #xwiki  \n10:00\u00a0<jvdrean>\u00a0has joined #xwiki  \n10:01\u00a0<vmassol>\u00a0mflorea/tmortagne: let's continue fixing the functional tests till they always pass  \n10:01\u00a0<vmassol>\u00a0http://ci.xwiki.org/view/Functional%20Tests/job/xwiki-enterprise-test-ui/ is in pretty bad shape  \n10:01\u00a0<vmassol>\u00a0:(  \n10:01\u00a0<mflorea>\u00a0vmassol: I'm in, but it's a plain when CI is not stable..  \n10:02\u00a0<mflorea>\u00a0(I'm referring to the CI env)  \n10:02\u00a0<vmassol>\u00a0strange:  \n10:02\u00a0<vmassol>\u00a0testItemsEditor(org.xwiki.test.ui.appwithinminutes.StaticListClassFieldTest) \u00a0Time elapsed: 11932 sec \u00a0<<< FAILURE!  \n10:02\u00a0<vmassol>\u00a0junit.framework.AssertionFailedError: Expected: <null> but was: [[[[[[FirefoxDriver: firefox on LINUX (a6dd4c15-4430-4237-b5ab-c56ba53cae36)] -> id: field-staticList1]] -> xpath: .//dl[@class = 'field-viewer']/dd]] -> xpath: .//\\*[@value = 'value2']]  \n10:03\u00a0<mflorea>\u00a0I'll check  \n10:20\u00a0<vmassol>\u00a0has quit  \n10:28\u00a0<vmassol>\u00a0has joined #xwiki  \n10:31\u00a0<jvelo>\u00a0has joined #xwiki  \n10:31\u00a0<sburjan>\u00a0has joined #xwiki  \n10:52\u00a0<vmassol>\u00a0mflorea: for http://ci.xwiki.org/view/Functional%20Tests/job/xwiki-enterprise-test-ui/org.xwiki.enterprise$xwiki-enterprise-test-ui/1836/testReport/org.xwiki.test.ui/CompareVersionsTest/testAllChanges/ the problem is that the menu is hiding the tag: https://www.evernote.com/shard/s119/sh/52899ba6-b6ab-403a-b7aa-d2e44d90a6a3/1b6a21ec41e405b45cd00a1f10938f32  \n10:52\u00a0<vmassol>\u00a0at line 115 in CompareVersionsTest  \n10:53\u00a0<vmassol>\u00a0i don't understand why the menu is displayed when the previous action was a save  \n10:54\u00a0<mflorea>\u00a0vmassol: simply because the mouse remained at the top of the window where the menu bar is  \n10:54\u00a0<vmassol>\u00a0so it's just the hover?  \n10:54\u00a0<mflorea>\u00a0yes  \n10:55\u00a0<vmassol>\u00a0what a pain\u2026. we need some generic way to solve these problems  \n10:55\u00a0<vmassol>\u00a0we didn't have them before when we didn't have the native events I guess  \n10:56\u00a0<tmortagne>\u00a0has quit  \n10:56\u00a0<tmortagne1>\u00a0has joined #xwiki  \n10:56\u00a0<mflorea>\u00a0one simple solution I did for wysiwyg tests is to \"reset\" the mouse position before each test  \n10:56\u00a0<vmassol>\u00a0we nee something generic  \n10:56\u00a0<vmassol>\u00a0\\*need  \n10:56\u00a0<vmassol>\u00a0so you're suggesting to put this in AbstarctTest?  \n10:56\u00a0<vmassol>\u00a0but it wouldn't work here  \n10:58\u00a0<vmassol>\u00a0mflorea: when we click now, the mouse pointer is moved right?  \n10:59\u00a0<mflorea>\u00a0if it's in the middle of the test they yes, you need to do something else, move the mouse somewhere else.  \n10:59\u00a0<mflorea>\u00a0yes, it moves the mouse first  \n10:59\u00a0<mflorea>\u00a0before the click  \n10:59\u00a0<vmassol>\u00a0addTagsPane.add() will thus move the mouse  \n10:59\u00a0<mflorea>\u00a0exactly like a normal click  \n10:59\u00a0<vmassol>\u00a0so I don't understand why the mouse will be on the edit menu  \n11:00\u00a0<vmassol>\u00a0hmm actually  \n11:00\u00a0<mflorea>\u00a0because the page is scrolled  \n11:00\u00a0<vmassol>\u00a0from the screenshot the edit menu is wrongly located  \n11:00\u00a0<mflorea>\u00a0and the add + is at the \"top\"  \n11:00\u00a0<mflorea>\u00a0nop  \n11:00\u00a0<mflorea>\u00a0it's located \"fine\" because the edit menu floats  \n11:00\u00a0<mflorea>\u00a0when the page is scrolled  \n11:00\u00a0<vmassol>\u00a0but not in the middle of the screen!  \n11:00\u00a0<vmassol>\u00a0:)  \n11:00\u00a0<mflorea>\u00a0it's not in the middle  \n11:01\u00a0<mflorea>\u00a0selenium takes the screenshots of the web page  \n11:01\u00a0<vmassol>\u00a0it is in the screenshot  \n11:01\u00a0<mflorea>\u00a0it's not what you actually seee  \n11:01\u00a0<mflorea>\u00a0the edit menu tells you where the top of the view port is  \n11:02\u00a0<vmassol>\u00a0but how can this page scroll?  \n11:02\u00a0<vmassol>\u00a0it almost doesn't have content  \n11:02\u00a0<mflorea>\u00a0because the resolution is low?  \n11:02\u00a0<vmassol>\u00a0that low?  \n11:02\u00a0<vmassol>\u00a0here it's like 480 pixels  \n11:03\u00a0<Enygma`>\u00a0has joined #xwiki  \n11:03\u00a0<evalica>\u00a0has joined #xwiki  \n11:03\u00a0<vmassol>\u00a0I still don't get it  \n11:03\u00a0<vmassol>\u00a0how could the add work  \n11:03\u00a0<vmassol>\u00a0and not the delete  \n11:03\u00a0<mflorea>\u00a0let me look at the full screenshot  \n11:03\u00a0<vmassol>\u00a0there should be any scroll between them  \n11:04\u00a0<vmassol>\u00a0hold on I can give you a full view  \n11:04\u00a0<vmassol>\u00a0https://www.evernote.com/shard/s119/sh/963b9966-6336-409d-b8d1-ca416415ea4e/3e0c0f4d219fe720f8b71e26f676a566  \n11:05\u00a0<mflorea>\u00a0hmm, was it deleted from the CI?  \n11:05\u00a0<vmassol>\u00a0it's still there I think  \n11:05\u00a0<vmassol>\u00a0actually I've copied it  \n11:05\u00a0<vmassol>\u00a0in maven.xwiki.org:tmp/  \n11:06\u00a0<mflorea>\u00a0should be http://ci.xwiki.org/view/Functional%20Tests/job/xwiki-enterprise-test-ui-4.3/ws/xwiki-enterprise-test/xwiki-enterprise-test-ui/target/screenshots/CompareVersionsTest-testAllChanges.png  \n11:07\u00a0<vmassol>\u00a0this works only for the last workspace AFAIK  \n11:07\u00a0<vmassol>\u00a0unless we've installed the save workspace plugin  \n11:07\u00a0<vmassol>\u00a0which we should maybe  \n11:07\u00a0<vmassol>\u00a0(checking if it's installed)  \n11:08\u00a0<mflorea>\u00a0for me it was working before if the tests was failing in the latest build of that module  \n11:08\u00a0<vmassol>\u00a0yes  \n11:08\u00a0<vmassol>\u00a0http://ci.xwiki.org/view/Functional%20Tests/job/xwiki-enterprise-test-ui/org.xwiki.enterprise$xwiki-enterprise-test-ui/ws/target/screenshots/CompareVersionsTest-testAllChanges.png  \n11:08\u00a0<vmassol>\u00a0(note that we're on jenkins 1.480.1 ATM)  \n11:12\u00a0<mflorea>\u00a0vmassol, the screenshot is 970 x 764, so not even 1024 (the window is maximized so it should take the full width)  \n11:12\u00a0<vmassol>\u00a0do you have an explanation for why addTagsPane.add(); worked (the line before)?  \n11:13\u00a0<vmassol>\u00a0if the menu was there it shouldn't have worked  \n11:13\u00a0<vmassol>\u00a0and I don't see why the add would have caused the menu to appear  \n11:13\u00a0<vmassol>\u00a0it moves the mouse, clicks and the only hover makes the menu appear?  \n11:15\u00a0<vmassol>\u00a0\"if it's in the middle of the test they yes, you need to do something else, move the mouse somewhere else.\" that's just too complex for a test to write, also it makes the test too complex to read. We need to find some generic solution  \n11:15\u00a0<vmassol>\u00a0should we disable the edit menu scroll?  \n11:16\u00a0<vmassol>\u00a0(except for a specific test that tests that it works if we want\u00e0  \n11:16\u00a0<vmassol>\u00a0)  \n11:22\u00a0<tmortagne1>\u00a0has quit  \n11:22\u00a0<tmortagne>\u00a0has joined #xwiki  \n11:27\u00a0<tmortagne>\u00a0has quit  \n11:27\u00a0<tmortagne>\u00a0has joined #xwiki  \n11:35\u00a0<mflorea>\u00a0vmassol: I don't have other explanation besides the page being scrolled. I don't understand why the page is scrolled in this case, the fact that the page is scrolled makes the edit menu float over the tags. The menu is floating in this case too http://ci.xwiki.org/view/Functional%20Tests/job/xwiki-enterprise-test-ui/ws/xwiki-enterprise-test/xwiki-enterprise-test-ui/target/screenshots/ClassEditorTest-testRenameWithSaveAndContinue.png but at least here the hei  \n11:36\u00a0<mflorea>\u00a0trying to fix the test failing on 4.3 branch  \n11:37\u00a0<vmassol>\u00a0mflorea: I'm going to try to reprouce locally  \n11:38\u00a0<vmassol>\u00a0by setting this in WebDriverFactory:  \n11:38\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0driver.manage().window().setSize(new Dimension(640, 480));  \n11:45\u00a0<tmortagne>\u00a0has quit  \n11:45\u00a0<tmortagne1>\u00a0has joined #xwiki  \n11:47\u00a0<vmassol>\u00a0has quit  \n11:55\u00a0<vmassol>\u00a0has joined #xwiki  \n11:57\u00a0<tmortagne1>\u00a0has quit  \n12:11\u00a0<vmassol>\u00a0mflorea: I don't get the problem locally with a small viewport  \n12:13\u00a0<mflorea>\u00a0well, the height of the viewport should be exactly the length from the tags list to the bottom of the page.  \n12:13\u00a0<mflorea>\u00a0or even lower I think  \n12:14\u00a0<vmassol>\u00a0I tried with 480  \n12:14\u00a0<vmassol>\u00a0I'll try with 970 x 764  \n12:15\u00a0<mflorea>\u00a0well, it's not that simple, even with the same window size the layout can be different because of different fonts for instance  \n12:15\u00a0<vmassol>\u00a0764 is really high  \n12:15\u00a0<vmassol>\u00a0the whole page fits in  \n12:16\u00a0<vmassol>\u00a0(almost)  \n12:16\u00a0<vmassol>\u00a0there's no scrolling  \n12:16\u00a0<vmassol>\u00a0of the edit menu  \n12:53\u00a0<mflorea>\u00a0has quit  \n12:55\u00a0<Enygma`>\u00a0has quit  \n12:55\u00a0<Enygma`>\u00a0has joined #xwiki  \n13:54\u00a0<vmassol>\u00a0sdumitriu: any idea how I can configure our tests to not have the floating edit menu?  \n13:55\u00a0<vmassol>\u00a0ah maybe I need to find a way to remove this observer: \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Event.observe(window, 'scroll', handleScroll);  \n13:56\u00a0<vmassol>\u00a0ok going to try http://prototypejs.org/doc/latest/dom/Event/stopObserving/  \n14:42\u00a0<mflorea>\u00a0has joined #xwiki  \n14:44\u00a0<vmassol>\u00a0mflorea: ping on skype :)  \n14:54\u00a0<sdumitriu>\u00a0vmassol: You could add some CSS in a file used during tests  \n14:57\u00a0<sdumitriu>\u00a0Or some JS  \n15:17\u00a0<cjd>\u00a0off topic: this weekend I thought of a way to cut the unit test setup time down to close to 0  \n15:18\u00a0<tmortagne>\u00a0cjd: which one ?  \n15:18\u00a0<cjd>\u00a0all of them  \n15:18\u00a0<cjd>\u00a0the trick wouldn't work on windows and it probably would require modifying the maven test runner.  \n15:19\u00a0<cjd>\u00a0Basicly the idea is to so the setup then fork the jvm using the kernel's clone system call which is effectively instant.  \n15:20\u00a0<cjd>\u00a0but each time it forks, it runs the next test in the suite.  \n15:20\u00a0<tmortagne>\u00a0I see  \n15:20\u00a0<tmortagne>\u00a0indeed that sounds nice  \n15:20\u00a0<tmortagne>\u00a0and junit can do that ?  \n15:21\u00a0<cjd>\u00a0of course not :)  \n15:21\u00a0<cjd>\u00a0that's why we'd have to do lots of hacking  \n15:21\u00a0<jvelo>\u00a0has quit  \n15:22\u00a0<cjd>\u00a0and we could be even more evil by setting pathological GC flags like 30MB of eden space so the GC is basicly guaranteed never to run during the test.  \n15:22\u00a0<tmortagne>\u00a0now it does not mean the setup is close to 0, it just mean there is one setup per test in the class  \n15:22\u00a0<tmortagne>\u00a0for all test I mean  \n15:22\u00a0<tmortagne>\u00a0\\*tests  \n15:23\u00a0<cjd>\u00a0indeed, but since most tests share a common framework, we could improve that further with more hacking.  \n15:23\u00a0<tmortagne>\u00a0but in some cases we do have a lot of tests in the same class  \n15:23\u00a0<tmortagne>\u00a0commons-xunit :)  \n15:24\u00a0<cjd>\u00a0actually running setUp() before the fork is probably less productive than setting up the ECM once for the project.  \n15:43\u00a0<tdelafosse>\u00a0Hello, I'm trying to format some dates in a xwiki doc according to the language chosen in the document, using the $datetool.format() method. So I just need to get the Locale corresponding to the language selected. Do you know how I could do it ?  \n15:55\u00a0<tmortagne1>\u00a0has joined #xwiki  \n15:55\u00a0<tmortagne>\u00a0has quit  \n15:56\u00a0<jvdrean>\u00a0tdelafosse: you can use $xwiki.formatDate($date) for that  \n15:58\u00a0<vmassol>\u00a0yuck  \n15:59\u00a0<jvdrean>\u00a0vmassol: do we have a replacement for that ?  \n15:59\u00a0<vmassol>\u00a0(don't know the alternatives though)  \n15:59\u00a0<jvdrean>\u00a0neither do I  \n15:59\u00a0<vmassol>\u00a0jvdrean: get the language and then use datetool?  \n15:59\u00a0<vmassol>\u00a0not enough  \n16:00\u00a0<vmassol>\u00a0we need the date/time configuration too  \n16:01\u00a0<jvdrean>\u00a0vmassol: I'm using DefaultConfigurationSource and it seems its behavior differs from the one we had with the old APIs. If the composite source encounters an empty string for a given prop (and not null) it will return it, it will not go up in the list of sources  \n16:01\u00a0<jvdrean>\u00a0is it a known limitation ?  \n16:01\u00a0<tmortagne1>\u00a0this remind me I need to add getCurrentLocale in LocalizationScriptService I guess  \n16:01\u00a0<vmassol>\u00a0jvdrean: not sure it's a limitation  \n16:02\u00a0<vmassol>\u00a0empty string means something is configured  \n16:02\u00a0<vmassol>\u00a0the source should return null otherwise  \n16:02\u00a0<jvdrean>\u00a0in our case, not necessarily, since all our props are bundled together you kind of reset them all when you set only one of them  \n16:03\u00a0<vmassol>\u00a0now you shoudl know that the space, user and wiki sources are far from working and they need work  \n16:03\u00a0<vmassol>\u00a0xwikiproperties one should work fine though  \n16:03\u00a0<jvdrean>\u00a0yes, I'm trying to work with space/wiki preferences here  \n16:04\u00a0<vmassol>\u00a0you may need to improve them then....  \n16:04\u00a0<vmassol>\u00a0for example I know that lists are not supported nicely  \n16:07\u00a0<tmortagne1>\u00a0jvdrean already fixed some stuff in those AFAIK  \n16:07\u00a0<jvdrean>\u00a0tmortagne1: I implemented the user source IIRC  \n16:08\u00a0<tmortagne1>\u00a0jvdrean: pretty sure I saw some commit from you fixed bugs in space/wiki too  \n16:08\u00a0<tmortagne1>\u00a0s/fixed/fixing/  \n16:09\u00a0<tmortagne1>\u00a0I also fixed an issue recently  \n16:09\u00a0<tmortagne1>\u00a0XWIKI-8306  \n16:10\u00a0<tmortagne1>\u00a0jvdrean: XWIKI-7686  \n16:10\u00a0<tmortagne1>\u00a0but it's a bit old  \n16:11\u00a0<tmortagne1>\u00a0in any case it's not as bad as vmassol remember it ;)  \n16:12\u00a0<vmassol>\u00a0ok cool  \n16:22\u00a0<vmassol>\u00a0msmeria: since you're doing conversion  \n16:23\u00a0<vmassol>\u00a0make sure you shift all headers by 1  \n16:23\u00a0<vmassol>\u00a0ie move heading level 1 to title and change other headingd  \n16:23\u00a0<vmassol>\u00a0\\*headings  \n16:24\u00a0<msmeria>\u00a0vmassol: Ok. I will  \n16:24\u00a0<vmassol>\u00a0one day we'll remove auto title  \n16:24\u00a0<vmassol>\u00a0(ie title computed from the content)  \n16:24\u00a0<vmassol>\u00a0s/we'll remove/we may/  \n16:26\u00a0<tmortagne1>\u00a0s/we may/we'll remove/ :)  \n16:28\u00a0<vmassol>\u00a0:)  \n16:58\u00a0<msmeria>\u00a0has quit  \n17:34\u00a0<tmortagne1>\u00a0has quit  \n18:36\u00a0<sdumitriu1>\u00a0has joined #xwiki  \n19:10\u00a0<evalica>\u00a0has quit  \n19:17\u00a0<Enygma`>\u00a0has quit  \n19:20\u00a0<mflorea>\u00a0has quit  \n19:26\u00a0<tdelafosse>\u00a0has quit  \n20:40\u00a0<rrodriguez>\u00a0has joined #xwiki  \n20:57\u00a0<rrodriguez>\u00a0has quit  \n20:58\u00a0<rrodriguez>\u00a0has joined #xwiki  \n21:15\u00a0<sburjan>\u00a0has quit  \n21:23\u00a0<Slashman>\u00a0has quit  \n21:32\u00a0<jvdrean>\u00a0has quit  \n21:33\u00a0<abusenius>\u00a0has joined #xwiki  \n22:05\u00a0<jvelo>\u00a0has joined #xwiki  \n22:24\u00a0<mflorea>\u00a0has joined #xwiki  \n22:29\u00a0<mflorea>\u00a0has quit  \n22:32\u00a0<abusenius>\u00a0has quit  \n22:52\u00a0<vmassol>\u00a0has quit  \n22:56\u00a0<cjd>\u00a0http://jsperf.com/js-inheritance-performance  \n22:58\u00a0<polx>\u00a0has quit  \n22:59\u00a0<sdumitriu1>\u00a0Hm, prototype is pretty slow...  \n23:01\u00a0<cjd>\u00a0I think it's fair to say that prototype came from a time when js was more simple.  \n23:01\u00a0<cjd>\u00a0Before people trapped the jit compiler and disassembled the results to optimize their library ;)  \n23:03\u00a0<sdumitriu1>\u00a0Well, the Native syntax clearly sucks  \n23:03\u00a0<sdumitriu1>\u00a0But I like the Fiber syntax  \n23:05\u00a0<cjd>\u00a0I'm playing with fiber now which is why I came up with the list  \n23:06\u00a0<sdumitriu1>\u00a0And the rest of the syntaxes are more or less worse than Prototype  \n23:07\u00a0<cjd>\u00a0Fiber is linkedin which tells me we're not going to get the typical \"surprise, it's actually a toy\" situation which has thus far given (node) js a bad name.  \n23:09\u00a0<sdumitriu1>\u00a0OK, looked at the code, looks clean enough  \n23:14\u00a0<rrodriguez>\u00a0has quit  \n23:17\u00a0<rrodriguez>\u00a0has joined #xwiki  \n23:23\u00a0<vmassol>\u00a0has joined #xwiki  \n23:32\u00a0<vmassol>\u00a0has quit  \n23:44\u00a0<jvdrean>\u00a0has joined #xwiki\n"}