{"id": "dev:IRC.xwikiArchive20141107", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20141107", "title": "IRC Archive for channel #xwiki on 07 November 2014 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<momomomomo>\u00a0has quit  \n00:26\u00a0<DuFFo>\u00a0has joined #xwiki  \n06:00\u00a0<Denis1>\u00a0has joined #xwiki  \n06:03\u00a0<Denis>\u00a0has quit  \n06:58\u00a0<mflorea>\u00a0has joined #xwiki  \n07:04\u00a0<msmeria>\u00a0has joined #xwiki  \n07:16\u00a0<DarkKnightCZ>\u00a0has joined #xwiki  \n08:12\u00a0<tmortagne>\u00a0has joined #xwiki  \n08:15\u00a0<Lyes>\u00a0has joined #xwiki  \n08:27\u00a0<mflorea>\u00a0has quit  \n08:30\u00a0<KermitTheFragger>\u00a0has joined #xwiki  \n08:41\u00a0<DarkKnightCZ>\u00a0has quit  \n08:42\u00a0<DarkKnightCZ>\u00a0has joined #xwiki  \n08:58\u00a0<cjd>\u00a0has joined #xwiki  \n09:08\u00a0<mflorea>\u00a0has joined #xwiki  \n09:14\u00a0<mflorea>\u00a0has quit  \n09:36\u00a0<mflorea>\u00a0has joined #xwiki  \n09:49\u00a0<woshilapin>\u00a0has joined #xwiki  \n10:09\u00a0<vmassol>\u00a0has joined #xwiki  \n10:11\u00a0<Slashman>\u00a0has joined #xwiki  \n10:11\u00a0<lucaa>\u00a0has joined #xwiki  \n10:22\u00a0<tmortagne>\u00a0vmassol: Hi  \n10:22\u00a0<vmassol>\u00a0good morning  \n10:22\u00a0<tmortagne>\u00a05.4 build is failing on jenkins because \"Build step 'Groovy Postbuild' marked build as failure\" but it's not very clear why exactly, any idea ?  \n10:22\u00a0<tmortagne>\u00a0the maven build itself is a SUCCESS  \n10:23\u00a0<vmassol>\u00a0let me check  \n10:23\u00a0<vmassol>\u00a0url?  \n10:23\u00a0<vmassol>\u00a0platform?  \n10:23\u00a0<tmortagne>\u00a0http://ci.xwiki.org/job/xwiki-platform-5.4.x/48/console for example  \n10:23\u00a0<tmortagne>\u00a0(this is when it started failing)  \n10:24\u00a0<Enygma`>\u00a0has joined #xwiki  \n10:24\u00a0<evalica>\u00a0has joined #xwiki  \n10:24\u00a0<tmortagne>\u00a0but others failing builds are similar  \n10:24\u00a0<tmortagne>\u00a0there is a few exceptions in the log, could be what the groovy script catched ?  \n10:25\u00a0<woshilapin>\u00a0has quit  \n10:25\u00a0<vmassol>\u00a0normally  \n10:25\u00a0<vmassol>\u00a0if some logs matches one of the pattern strings  \n10:25\u00a0<vmassol>\u00a0then we execute  \n10:25\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0manager.createSummary(\"warning.gif\").appendText(\"<h1>${message.get(2)}</h1>\", false, false, false, \"red\")  \n10:25\u00a0<vmassol>\u00a0the last line marks the build as unstable  \n10:26\u00a0<woshilapin>\u00a0has joined #xwiki  \n10:26\u00a0<vmassol>\u00a0but we should also see the summary modified  \n10:26\u00a0<tmortagne>\u00a0ok so it's not that then  \n10:26\u00a0<vmassol>\u00a0which isn't the case  \n10:26\u00a0<tmortagne>\u00a0plus it's fail and not unstable  \n10:27\u00a0<vmassol>\u00a0+ it should not send an email  \n10:27\u00a0<vmassol>\u00a0and it does  \n10:28\u00a0<vmassol>\u00a0so I don't understand at all the message:  \n10:28\u00a0<vmassol>\u00a0\"Build step 'Groovy Postbuild' marked build as failure  \n10:28\u00a0<tmortagne>\u00a0master and 5.4.x have the exact same script as far as I can see so I guess it's not an issue in the scipt itself  \n10:28\u00a0<vmassol>\u00a0maybe caused by the jenkins upgrade  \n10:28\u00a0<vmassol>\u00a0some bug somewhere  \n10:28\u00a0<vmassol>\u00a0unlikely but maybe  \n10:29\u00a0<vmassol>\u00a0actually it's possible that the plugin needs upgrading  \n10:29\u00a0<vmassol>\u00a0to match the new jenkins version  \n10:29\u00a0<vmassol>\u00a0maybe they changed some behavior  \n10:29\u00a0<vmassol>\u00a0in the plugin so that it's marked as failure by default or something like that  \n10:30\u00a0<vmassol>\u00a0\"Warning: the new version of this plugin claims to use a different settings format than the installed version. Jobs using this plugin may need to be reconfigured, and/or you may not be able to cleanly revert to the prior version without manually restoring old settings. Consult the plugin release notes for details.\"  \n10:30\u00a0<tmortagne>\u00a0weird that only 5.4 have the issue  \n10:31\u00a0<tmortagne>\u00a0unless the issue is indirectly caused by the exceptions in the log  \n10:31\u00a0<vmassol>\u00a0we're using 1.10  \n10:31\u00a0<vmassol>\u00a0and now it's 2.1  \n10:31\u00a0<vmassol>\u00a0https://wiki.jenkins-ci.org/display/JENKINS/Groovy+Postbuild+Plugin#GroovyPostbuildPlugin-Changelog  \n10:31\u00a0<tmortagne>\u00a0like the script matches the exception and then crash for some reason  \n10:31\u00a0<vmassol>\u00a0possibly lots of changes between the 2 versions  \n10:31\u00a0<tmortagne>\u00a0yep, if they change the main version it's probably to break a few things  \n10:41\u00a0<ClemensR>\u00a0has joined #xwiki  \n11:02\u00a0<vmassol>\u00a0mflorea/all: so what happened to 6.3RC1? was it released? have we redone the release with the assembly plugin version \"rollback\"?  \n11:02\u00a0<vmassol>\u00a0(and good morning!)  \n11:03\u00a0<mflorea>\u00a0vmassol: good morning. there's no rollback, what are you talking about? maven release is done since yesterday morning, I just need to finish the documentation before announcing the release  \n11:03\u00a0<vmassol>\u00a0I'm talking about the problem we have with 6.3RC1  \n11:03\u00a0<vmassol>\u00a0and my comment on the jira issue about it  \n11:04\u00a0<mflorea>\u00a0what problem?  \n11:04\u00a0<vmassol>\u00a0the fact that wiki creation is broken  \n11:04\u00a0<vmassol>\u00a0it's not?  \n11:04\u00a0<mflorea>\u00a0I don't know, no one pinged me about it  \n11:04\u00a0<vmassol>\u00a0we discussed a lot about it here  \n11:04\u00a0<vmassol>\u00a0yesterday  \n11:04\u00a0<vmassol>\u00a0(even though I've been away most of the time)  \n11:04\u00a0<vmassol>\u00a0+ I commented on the issue  \n11:05\u00a0<vmassol>\u00a0what I asked in comment  \n11:05\u00a0<vmassol>\u00a0was whether we should scrap it  \n11:05\u00a0<vmassol>\u00a0because we may not want to have users use it if it doesn't work  \n11:05\u00a0<mflorea>\u00a0sure, but I was busy writing documentation, I can't follow everything is discussed here. Since I'm the RM, I should have been pinged..  \n11:05\u00a0<vmassol>\u00a0but I don't know  \n11:05\u00a0<vmassol>\u00a0was away a lof of times yesterday  \n11:05\u00a0<vmassol>\u00a0mflorea: don't blame me  \n11:05\u00a0<vmassol>\u00a0I'm not even supposed to work at all!!!!  \n11:05\u00a0<mflorea>\u00a0I don't blame you  \n11:06\u00a0<mflorea>\u00a0I just don't know about any issue with 6.3RC1  \n11:06\u00a0<vmassol>\u00a0so you guys should handle that  \n11:07\u00a0<tmortagne>\u00a0mflorea: http://jira.xwiki.org/browse/XCOMMONS-680  \n11:12\u00a0<mflorea>\u00a0tmortagne: ok, so we can keep the RC1 release, putting a warning on the RN  \n11:12\u00a0<tmortagne>\u00a0mflorea: that's what I think too  \n11:41\u00a0<ClemensR>\u00a0has left #xwiki  \n11:42\u00a0<bouquetf>\u00a0has quit  \n11:42\u00a0<bouquetf>\u00a0has joined #xwiki  \n12:00\u00a0<vmassol>\u00a0mflorea: quick question  \n12:01\u00a0<vmassol>\u00a0is {{tree reference=\"Space.MyTreeDefinition\" /}} the same as using {{tree}}{{include reference=\"\u2026\"/}}  \n12:01\u00a0<vmassol>\u00a0?  \n12:01\u00a0<vmassol>\u00a0(it wasn't clear for me in the doc)  \n12:01\u00a0<vmassol>\u00a0ah dynamicity apparently  \n12:02\u00a0<vmassol>\u00a0I guess I would need an example to fully understand it but don't worry I don't need it, was just curious  \n12:02\u00a0<mflorea>\u00a0no, it's not the same, I think it is explained that reference is used for dynamic trees  \n12:02\u00a0<vmassol>\u00a0so the same reference is called every time you open a tree node?  \n12:02\u00a0<vmassol>\u00a0some param are passed to the reference?  \n12:03\u00a0<mflorea>\u00a0yes, http://extensions.xwiki.org/xwiki/bin/view/Extension/Tree+Widget#HTreeData  \n12:03\u00a0<mflorea>\u00a0will link from tree macro  \n12:03\u00a0<vmassol>\u00a0ok thanks  \n12:04\u00a0<vmassol>\u00a0ok I get it  \n12:04\u00a0<vmassol>\u00a0thanks  \n12:04\u00a0<mflorea>\u00a0np  \n12:10\u00a0<mflorea>\u00a0vmassol: btw, you were looking at the tree macro but there is http://extensions.xwiki.org/xwiki/bin/view/Extension/Document+Tree+Macro too, in case you didn't notice  \n12:13\u00a0<vmassol>\u00a0nice mflorea, I'm checking the xwik.org watchlist to discover stuff ;)  \n12:13\u00a0<vmassol>\u00a0rebuilding XE now to try this out :)  \n12:13\u00a0<vmassol>\u00a0(eager)  \n12:14\u00a0<vmassol>\u00a0that's going to be a major feature for our users!  \n12:15\u00a0<mflorea>\u00a0I hope  \n12:17\u00a0<vmassol>\u00a0from Silvia: http://cdn.meme.am/instances/500x/53870777.jpg  \n12:17\u00a0<vmassol>\u00a0:)  \n12:18\u00a0<mflorea>\u00a0:D  \n12:19\u00a0<vmassol>\u00a0a bit old now though, it's 6.3  \n13:05\u00a0<Lyes>\u00a0has quit  \n13:05\u00a0<Lyes>\u00a0has joined #xwiki  \n13:12\u00a0<lucaa>\u00a0has quit  \n13:13\u00a0<evalica>\u00a0has quit  \n13:20\u00a0<evalica>\u00a0has joined #xwiki  \n13:45\u00a0<Lyes>\u00a0has quit  \n13:45\u00a0<Lyes>\u00a0has joined #xwiki  \n13:46\u00a0<woshilapin>\u00a0has quit  \n13:58\u00a0<yaronr>\u00a0has joined #xwiki  \n13:59\u00a0<yaronr>\u00a0tmortagne hi. I have successfully created a wiki Docker image, and also (since our last chat) figured out a way to persist the /var/local/xwiki/ in a way that makes sense for docker.  \n13:59\u00a0<yaronr>\u00a0tmortagne however, that still doesn't make xwiki a '12.5' factor app :)  \n14:00\u00a0<yaronr>\u00a0There's something else I'm missing - it does boot correctly, but still goes through some sort of init  \n14:01\u00a0<yaronr>\u00a0tmortagne it must be one of the folders listed here: https://gist.github.com/yaronr/e64fbb72d5f27947a6bc  \n14:05\u00a0<lucaa>\u00a0has joined #xwiki  \n14:07\u00a0<yaronr>\u00a0sorry, here's the correct gist: https://gist.github.com/yaronr/9dfc7eceadeebf999fb0  \n14:15\u00a0<tmortagne>\u00a0yaronr: you get an error ?  \n14:16\u00a0<tmortagne>\u00a0if /var/local/xwiki is empty after your started XWiki there is clearly something wrong  \n14:17\u00a0<yaronr>\u00a0ah no, but it starts that setup wizard again, deploying xar files. Note, that this time I already have the permanent directory (/var/local/xwiki/) set in the properties file, and pre-populated with data  \n14:17\u00a0<tmortagne>\u00a0you should have a few folder created in there, I see you have some stuff on /opt/tomcat/work/Catalina/localhost/xwiki/xwiki-temp which seems to indicate that XWiki did started  \n14:17\u00a0<tmortagne>\u00a0so \u00a0https://gist.github.com/yaronr/9dfc7eceadeebf999fb0 is not after XWiki started ?  \n14:17\u00a0<yaronr>\u00a0in other words, assume I've done a backup-restore, and am running the instance again. it still goes through the setup wizard thing.  \n14:18\u00a0<tmortagne>\u00a0if you permanent directly is empty then yes no wonder you get the distrbution wizard  \n14:18\u00a0<yaronr>\u00a0Had a working instance. backed up permanent dir. stopped. Started another isntance with same perm dir  \n14:18\u00a0<tmortagne>\u00a0what do you have in your permanent directory before you start ?  \n14:18\u00a0<yaronr>\u00a0My goal is to make xWiki as close as possible to a 12 factor app, which means you can kill and instance and start another one - and it will pick up from the other one left off  \n14:19\u00a0<yaronr>\u00a0extension \u00a0jobs \u00a0lucene \u00a0solr  \n14:19\u00a0<tmortagne>\u00a0ok so nothing to do with https://gist.github.com/yaronr/9dfc7eceadeebf999fb0  \n14:20\u00a0<yaronr>\u00a0let me explain what that gist is.  \n14:20\u00a0<yaronr>\u00a0that gist shows the diff between the vagnilla docker image, and the instance I'm running. except the perm-dir, which I already handled  \n14:21\u00a0<tmortagne>\u00a0if I can see what you have exactly in you permanent dir I can probably tel you why exactly you get the DW  \n14:21\u00a0<yaronr>\u00a0I do see modifications also to files in the perm dir, xar files  \n14:21\u00a0<tmortagne>\u00a0and what is missing  \n14:21\u00a0<tmortagne>\u00a0xar files are the UI extensions  \n14:22\u00a0<tmortagne>\u00a0what is installed by the distribution wizard  \n14:22\u00a0<yaronr>\u00a0what's missing is a smooth transition. In other words - when I restore the permdir to a new node and start xwiki, I want it to just work - without going through the wizard..  \n14:22\u00a0<tmortagne>\u00a0there is xed files next to each xar file  \n14:22\u00a0<yaronr>\u00a0I'm not there at 2am when a host dies  \n14:22\u00a0<yaronr>\u00a0tmortagne do you want me to check?  \n14:23\u00a0<tmortagne>\u00a0if you get the DW then it means you are missing something in your permdir  \n14:23\u00a0<tmortagne>\u00a0and it's probably the installed extension and the distribution status  \n14:23\u00a0<tmortagne>\u00a0\\*extensions  \n14:23\u00a0<yaronr>\u00a0tmortagne I have an idea. How about I tell you how to test this setup on your machine?  \n14:23\u00a0<tmortagne>\u00a0yaronr: you can just zip and send me your permdir too :)  \n14:24\u00a0<yaronr>\u00a0?  \n14:24\u00a0<tmortagne>\u00a0that way I can tell you why you get the DW  \n14:24\u00a0<yaronr>\u00a0the bot doesn't like me  \n14:25\u00a0<tmortagne>\u00a0the bot is not very stable  \n14:25\u00a0<yaronr>\u00a0tmortagne it's just a 1 line command, once you install docker. then you can debug this on your local env  \n14:25\u00a0<yaronr>\u00a0otherwise it's a broken phone  \n14:26\u00a0<yaronr>\u00a0I'll Dockerize you yet ;)  \n14:26\u00a0<tmortagne>\u00a0as you want but I never used Docker so you might have so coaching work :)  \n14:26\u00a0<tmortagne>\u00a0s/so/some/  \n14:26\u00a0<yaronr>\u00a021 people downloaded the Docker image since I published it 6 days ago  \n14:26\u00a0<yaronr>\u00a0Will do  \n14:26\u00a0<tmortagne>\u00a0that's wool  \n14:26\u00a0<tmortagne>\u00a0cool  \n14:26\u00a0<yaronr>\u00a0wool :)  \n14:26\u00a0<yaronr>\u00a0are you using a mac? linux? pc?  \n14:27\u00a0<tmortagne>\u00a0latest ubuntu  \n14:27\u00a0<yaronr>\u00a0great  \n14:27\u00a0<yaronr>\u00a0my guess, apt-get install docker  \n14:27\u00a0<yaronr>\u00a0but let me check  \n14:27\u00a0<tmortagne>\u00a0probably :)  \n14:27\u00a0<tmortagne>\u00a0checking  \n14:27\u00a0<yaronr>\u00a0https://docs.docker.com/installation/ubuntulinux/  \n14:28\u00a0<yaronr>\u00a0apt-get update  \n14:28\u00a0<yaronr>\u00a0apt-get install docker.io  \n14:28\u00a0<tmortagne>\u00a0it gives me docker 1.5  \n14:28\u00a0<tmortagne>\u00a0ha docker.io ok  \n14:28\u00a0<yaronr>\u00a0I didn't know there's docker 1.5, I thought 1.3 was the latest  \n14:28\u00a0<tmortagne>\u00a0installed docker  \n14:28\u00a0<yaronr>\u00a0ok!  \n14:29\u00a0<woshilapin>\u00a0has joined #xwiki  \n14:29\u00a0<tmortagne>\u00a0looks like docker is somehting else  \n14:29\u00a0<tmortagne>\u00a0so I get docker.io 1.2  \n14:29\u00a0<yaronr>\u00a0tell me when you finish the installation according to the url  \n14:29\u00a0<tmortagne>\u00a0done  \n14:29\u00a0<tmortagne>\u00a0ha wait  \n14:30\u00a0<yaronr>\u00a0then, do:  \n14:30\u00a0<yaronr>\u00a0docker pull yaronr/xwiki-tomcat7  \n14:30\u00a0<yaronr>\u00a0and when that finishes, do:  \n14:30\u00a0<tmortagne>\u00a0the doc does not seems to be very up t date, /etc/bash\\_completion.d/docker.io does not exist but not very important  \n14:31\u00a0<tmortagne>\u00a0lets try  \n14:31\u00a0<tmortagne>\u00a0pulling  \n14:31\u00a0<yaronr>\u00a0docker run --name=xwiki -p 8080:8080 -v ${DATA\\_DIR}:/var/local/xwiki/ \u00a0\u00a0-e CATALINA\\_OPTS=\"-Xms128m -Xmx1024m -XX:PermSize=128m -XX:MaxPermSize=256m -Dhibernate.connection.url=jdbc:mysql://....:3306/xwiki -Dhibernate.connection.username=xwiki -Dhibernate.connection.password=...\" yaronr/xwiki-tomcat7  \n14:32\u00a0<yaronr>\u00a0you need a mysql db with a schema named xwiki, btw... sorry  \n14:32\u00a0<yaronr>\u00a0that's the only difficult step in all of this  \n14:32\u00a0<tmortagne>\u00a0I have that, I usually test on MySQL  \n14:32\u00a0<tmortagne>\u00a0let me empty it  \n14:32\u00a0<yaronr>\u00a0or just create a new schema  \n14:34\u00a0<tmortagne>\u00a0lets run that  \n14:34\u00a0<tmortagne>\u00a0I should put something in the password I guess  \n14:34\u00a0<tmortagne>\u00a0you have ... in your example  \n14:34\u00a0<yaronr>\u00a0good guess  \n14:35\u00a0<tmortagne>\u00a0it's java7 you have in this container ?  \n14:35\u00a0<ClemensR>\u00a0has joined #xwiki  \n14:35\u00a0<yaronr>\u00a0of course  \n14:35\u00a0<yaronr>\u00a0:)  \n14:35\u00a0<tmortagne>\u00a0hmm what host should I put ? will localhost go the right place ?  \n14:35\u00a0<tmortagne>\u00a0in the hibernate connection  \n14:35\u00a0<yaronr>\u00a0yes, localhost:8080  \n14:35\u00a0<yaronr>\u00a0ah  \n14:36\u00a0<yaronr>\u00a0I don't know, where's your db's port 3306 ?  \n14:36\u00a0<tmortagne>\u00a0in my local system  \n14:36\u00a0<yaronr>\u00a0and what's the port?  \n14:36\u00a0<tmortagne>\u00a0the default mysql one  \n14:36\u00a0<yaronr>\u00a0put localhost and the port  \n14:36\u00a0<yaronr>\u00a03306  \n14:36\u00a0<tmortagne>\u00a0ok  \n14:37\u00a0<yaronr>\u00a0so: jdbc:mysql//localhost/<SCHEMA\\_NAME>:3306  \n14:37\u00a0<yaronr>\u00a0btw, did you put something instead of ${DATA\\_DIR} ?  \n14:37\u00a0<tmortagne>\u00a0right  \n14:38\u00a0<yaronr>\u00a0ok. that folder is now mapped to the xwiki instance's perm dir  \n14:38\u00a0<tmortagne>\u00a0won't it be /var/local/xwiki/ \u00a0?  \n14:38\u00a0<tmortagne>\u00a0if I don't touch it  \n14:38\u00a0<yaronr>\u00a0both dires are synced all the time  \n14:38\u00a0<yaronr>\u00a0what, on your host? it can be anything you want, it just needs to exist in advance (the directory)  \n14:39\u00a0<tmortagne>\u00a0sure but the way you written your example it will end up in /var/local/xwiki/ locally if I don't touch it, right ?  \n14:40\u00a0<yaronr>\u00a0no, it will end up in /var/local/xwiki INSIDE the container. It will be on your host in whatever you specify on the right side of that param  \n14:40\u00a0<yaronr>\u00a0sorry letft  \n14:40\u00a0<tmortagne>\u00a0ok  \n14:40\u00a0<yaronr>\u00a0so: -v <host dir>:<container dir>  \n14:40\u00a0<yaronr>\u00a0processes running inside containers think they have a whole computer. they don't know they run inside containers  \n14:40\u00a0<tmortagne>\u00a0so somehting like /home/tuska/test/data:/var/local/xwiki/ ?  \n14:41\u00a0<yaronr>\u00a0they have no access to the host, unless you give them access to something explicitly  \n14:41\u00a0<yaronr>\u00a0yes  \n14:41\u00a0<yaronr>\u00a0the right side must be /var/local/xwiki  \n14:41\u00a0<tmortagne>\u00a0so XWiki will start with en empty permanent dir ?  \n14:41\u00a0<tmortagne>\u00a0I mean whatever is in my folder  \n14:42\u00a0<yaronr>\u00a0xactly  \n14:42\u00a0<tmortagne>\u00a0so right now it will start empty  \n14:42\u00a0<yaronr>\u00a0and.. will fill it up with whatever it needs to, as you go through the setup  \n14:42\u00a0<tmortagne>\u00a0which means no extension, nothing  \n14:42\u00a0<yaronr>\u00a0xactly  \n14:42\u00a0<tmortagne>\u00a0so basically right now I have the WAR and tomcat in the container and that's pretty much all right ?  \n14:42\u00a0<yaronr>\u00a0then, when you finish everything, I want you to stop the container, and start another one with the same folder mappings (but a different container name)  \n14:43\u00a0<yaronr>\u00a0you will see that it goes through the setup again, for some reason  \n14:43\u00a0<tmortagne>\u00a0pretty much what you get with the debian package  \n14:43\u00a0<yaronr>\u00a0which is why we're talking :)  \n14:43\u00a0<tmortagne>\u00a0let start it  \n14:43\u00a0<tmortagne>\u00a0looks like I need to be root for all operation on docker  \n14:44\u00a0<yaronr>\u00a0what, docker run?  \n14:44\u00a0<tmortagne>\u00a0hmm Connection refused on mysql  \n14:45\u00a0<yaronr>\u00a0curl localhost:3306  \n14:45\u00a0<msmeria>\u00a0has quit  \n14:45\u00a0<tmortagne>\u00a0hwo do I stop the container ?  \n14:45\u00a0<yaronr>\u00a0docker stop xwiki  \n14:48\u00a0<tmortagne>\u00a0mysql is definitely running and I can access it locally  \n14:49\u00a0<tmortagne>\u00a0looks like it does not see it from the container  \n14:49\u00a0<yaronr>\u00a0just a sec  \n14:49\u00a0<tmortagne>\u00a0testing something  \n14:50\u00a0<yaronr>\u00a0back. just saw a video on slack. apparently they raised $120M..  \n14:51\u00a0<tmortagne>\u00a0here is what I have so far in my command:  \n14:52\u00a0<yaronr>\u00a0tmortagne .. and the error is ?  \n14:52\u00a0<tmortagne>\u00a0it cannot reach mysql server  \n14:52\u00a0<tmortagne>\u00a0connection refused  \n14:52\u00a0<yaronr>\u00a0hmm. try adding --net=host  \n14:52\u00a0<yaronr>\u00a0ah  \n14:52\u00a0<yaronr>\u00a0stupid me  \n14:52\u00a0<yaronr>\u00a0of course it cant...  \n14:53\u00a0<yaronr>\u00a0'localhost' is different inside the container  \n14:53\u00a0<yaronr>\u00a0put your localhost's ip  \n14:53\u00a0<yaronr>\u00a0no need for --net=host  \n14:53\u00a0<yaronr>\u00a0even though that will work as well (but less elegant)  \n14:53\u00a0<DarkKnightCZ>\u00a0has quit  \n14:55\u00a0<tmortagne>\u00a0hmm not sure Mysql is listening external, checking  \n14:55\u00a0<ClemensR>\u00a0side note: anyone minds if I merge pull https://github.com/xwiki-contrib/workflow-publication/pull/13 \u00a0to fix XAWORKFLOW-2 ?  \n14:56\u00a0<yaronr>\u00a0if you have docker 1.3 then you can do 'docker exec xwiki bash' and 'be' inside the container  \n14:59\u00a0<yaronr>\u00a0tmortagne how are you doing my friend ?  \n15:00\u00a0<tmortagne>\u00a0reconfiguring MySQL and it should be ok  \n15:02\u00a0<tmortagne>\u00a0initializing  \n15:02\u00a0<tmortagne>\u00a0installing the UI  \n15:02\u00a0<yaronr>\u00a0what was the problem?  \n15:04\u00a0<tmortagne>\u00a0mysql listening to localhost only  \n15:04\u00a0<tmortagne>\u00a0which is the default)  \n15:04\u00a0<tmortagne>\u00a0DW done  \n15:04\u00a0<tmortagne>\u00a0all seems ok  \n15:05\u00a0<tmortagne>\u00a0so I should stop it, right ?  \n15:05\u00a0<tmortagne>\u00a0stop the container I mean  \n15:06\u00a0<tmortagne>\u00a0does not kill the java process or does tomcat have time to stop properly ?  \n15:06\u00a0<yaronr>\u00a0tmortagne good question, I don't know. it depends on the tomcat script and whether there's a trap for the kill signal  \n15:07\u00a0<yaronr>\u00a0but docker stop xwiki  \n15:07\u00a0<yaronr>\u00a0and then do the exact same startup command (docker run..) just with --name=xwiki2  \n15:07\u00a0<yaronr>\u00a0expected: it will work (..) and not require any setup, since - it's using the data dir  \n15:07\u00a0<tmortagne>\u00a0lets see  \n15:08\u00a0<tmortagne>\u00a0since I don't see any stop log I guess tomcat is just killed  \n15:08\u00a0<yaronr>\u00a0docker log xwiki  \n15:09\u00a0<tmortagne>\u00a0tomcat and xwiki are the same thing, xwiki is just a tomcat \"plugin\"  \n15:09\u00a0<yaronr>\u00a0yes but the docker image name is xwiki  \n15:09\u00a0<yaronr>\u00a0so docker logs xwiki will give you the tomcat logs  \n15:10\u00a0<yaronr>\u00a0since you haven't deleted the container, you just stopped it  \n15:10\u00a0<tmortagne>\u00a0\"Command not found: log\"  \n15:10\u00a0<tmortagne>\u00a0anyway lest start it  \n15:11\u00a0<yaronr>\u00a0sorry, docker logs  \n15:11\u00a0<tmortagne>\u00a0yep just seen it in the log  \n15:11\u00a0<tmortagne>\u00a0but I had the log from the start  \n15:11\u00a0<tmortagne>\u00a0with the run command  \n15:12\u00a0<yaronr>\u00a0tmortagne are you the person behind xwiki ?  \n15:12\u00a0<tmortagne>\u00a0there is more than one perso hopefully :)  \n15:12\u00a0<tmortagne>\u00a0i'm not the founder if that's the question  \n15:13\u00a0<yaronr>\u00a0where are you located?  \n15:13\u00a0<tmortagne>\u00a0france  \n15:13\u00a0<tmortagne>\u00a0all is well after restart  \n15:13\u00a0<yaronr>\u00a0bon apres midi  \n15:13\u00a0<tmortagne>\u00a0extension are there and no DW  \n15:13\u00a0<vmassol>\u00a0yaronr: here: https://maps.google.com/maps/u/0/ms?msid=210331808187331529022.0004f02bd076d94db85c6&msa=0&ie=UTF8&t=h&ll=15.33959,-25.897332&spn=73.477934,106.974356&source=embed&dg=feature  \n15:13\u00a0<yaronr>\u00a0?  \n15:14\u00a0<vmassol>\u00a0(you can add yourself if you want too ;))  \n15:14\u00a0<tmortagne>\u00a0yaronr: it's a map  \n15:14\u00a0<tmortagne>\u00a0of contributors  \n15:14\u00a0<tmortagne>\u00a0(who put themself in the map)  \n15:14\u00a0<yaronr>\u00a0:)  \n15:14\u00a0<vmassol>\u00a0and users  \n15:14\u00a0<tmortagne>\u00a0yes XWiki community  \n15:15\u00a0<vmassol>\u00a0unfortunately not a lot of people register themselves...  \n15:15\u00a0<yaronr>\u00a0how do I add myself?  \n15:15\u00a0<vmassol>\u00a0I think you must be logged in on google  \n15:15\u00a0<tmortagne>\u00a0when I have some time I would like to plain with openstreetmap API and generate a map from users profiles  \n15:16\u00a0<tmortagne>\u00a0most people just don't known this map even exist I think  \n15:16\u00a0<vmassol>\u00a0I've referenced it from http://www.xwiki.org/xwiki/bin/view/References/  \n15:16\u00a0<tmortagne>\u00a0s/plain/play/  \n15:17\u00a0<yaronr>\u00a0cool. now you have \u00a0a pin in Israel  \n15:17\u00a0<vmassol>\u00a0yeah thanks! :)  \n15:17\u00a0<vmassol>\u00a0awesome  \n15:17\u00a0<yaronr>\u00a0tmortagne - how is xwiki2 doing?  \n15:18\u00a0<yaronr>\u00a0did you log on to port 8080?  \n15:18\u00a0<tmortagne>\u00a0xwiki2 ?  \n15:18\u00a0<yaronr>\u00a0ok here's the idea:  \n15:18\u00a0<yaronr>\u00a0stop xwiki  \n15:19\u00a0<yaronr>\u00a0start another container, with the exact same params, just with a differen --name=xwiki2  \n15:19\u00a0<yaronr>\u00a0then logon to the ui  \n15:19\u00a0<tmortagne>\u00a0ok  \n15:19\u00a0<yaronr>\u00a0since we have the same perm dir, you would expect it to 'just work'  \n15:19\u00a0<yaronr>\u00a0but  \n15:19\u00a0<yaronr>\u00a0it will still go through the whole setup thing  \n15:19\u00a0<yaronr>\u00a0unless it hates me  \n15:19\u00a0<tmortagne>\u00a0same perm dir and same database yes  \n15:19\u00a0<tmortagne>\u00a0lets see  \n15:20\u00a0<tmortagne>\u00a0with the distribution status in the permdir there should not be any DW at startup  \n15:20\u00a0<yaronr>\u00a0Hey you have \u00a0a guy in Grenoble. He must ski a lot :)  \n15:20\u00a0<tmortagne>\u00a0the status is basically saying no matter what don't run again  \n15:20\u00a0<yaronr>\u00a0tmortagne lets see  \n15:20\u00a0<tmortagne>\u00a0I'm not very far from the mountains either :)  \n15:22\u00a0<tmortagne>\u00a0yaronr: no DW for me  \n15:22\u00a0<tmortagne>\u00a0all is well  \n15:22\u00a0<yaronr>\u00a0??  \n15:22\u00a0<yaronr>\u00a0tmortagne what, it didn't go through the setup?!  \n15:22\u00a0<tmortagne>\u00a0yep  \n15:22\u00a0<yaronr>\u00a0yep it did, or yep it didn't ?  \n15:23\u00a0<tmortagne>\u00a0and I can see it definitely loaded the same permdir since it's saying in the log that SOLR index is already in sync  \n15:23\u00a0<tmortagne>\u00a0same exact state than \"xwiki\" container  \n15:23\u00a0<tmortagne>\u00a0no DW  \n15:23\u00a0<yaronr>\u00a0damn  \n15:23\u00a0<yaronr>\u00a0then what am I doing wrong?  \n15:23\u00a0<tmortagne>\u00a0I have my installed extensions etc  \n15:23\u00a0<yaronr>\u00a0maybe it's a permissions issue?  \n15:23\u00a0<yaronr>\u00a0let me try to stop and start xwiki, and show you the logs  \n15:23\u00a0<tmortagne>\u00a0you are running with the same user the 2 containers ?  \n15:24\u00a0<yaronr>\u00a0well, at least you learned some Docker! :)  \n15:24\u00a0<tmortagne>\u00a0maybe the second one doe snot have write right on the permdir or something  \n15:24\u00a0<tmortagne>\u00a0yes thanks a lot for that  \n15:24\u00a0<yaronr>\u00a0let me c  \n15:25\u00a0<yaronr>\u00a0ok I killed it, it will start again in a few secs  \n15:25\u00a0<yaronr>\u00a0the only difference in how I run it, is that I run it in CoreOS  \n15:25\u00a0<yaronr>\u00a0why would that make a difference  \n15:26\u00a0<yaronr>\u00a0btw, while at the subject of teaching docker: docker rm <container> will delete the container, docker ps will show all running docker instances  \n15:27\u00a0<tmortagne>\u00a0ok  \n15:27\u00a0<yaronr>\u00a0please take a look at these logs: https://gist.github.com/yaronr/1466385b70bc9c46ea15  \n15:28\u00a0<tmortagne>\u00a0at least from XWiki point of view it's definitely using /var/local/xwiki/  \n15:28\u00a0<tmortagne>\u00a0could you access a page  \n15:29\u00a0<tmortagne>\u00a0you will get more log  \n15:29\u00a0<yaronr>\u00a0it's initializing...  \n15:29\u00a0<yaronr>\u00a0why!?  \n15:29\u00a0<tmortagne>\u00a0including one telling you if SOLR index have stuff to do or not  \n15:29\u00a0<tmortagne>\u00a0DW is after init  \n15:29\u00a0<yaronr>\u00a0DW ?  \n15:29\u00a0<tmortagne>\u00a0distribution wizard  \n15:30\u00a0<tmortagne>\u00a0the distribution install/upgrade setup  \n15:30\u00a0<yaronr>\u00a0no it's re-indexing stuff  \n15:30\u00a0<yaronr>\u00a0https://gist.github.com/yaronr/7f956edacc0f90c17291  \n15:30\u00a0<tmortagne>\u00a015 is not much  \n15:31\u00a0<tmortagne>\u00a0maybe you stopped it before it had time to index them the first time  \n15:31\u00a0<yaronr>\u00a0no, it ran for hours  \n15:31\u00a0<tmortagne>\u00a0you seems to be using an already existing permdir  \n15:31\u00a0<yaronr>\u00a0yes  \n15:31\u00a0<tmortagne>\u00a0weird then  \n15:31\u00a0<tmortagne>\u00a0it ran doing nothing ?  \n15:32\u00a0<yaronr>\u00a0these are the permissions on solr.xml: \u00a0-rw-r--r-- 1  \n15:32\u00a0<yaronr>\u00a0same as yours?  \n15:32\u00a0<tmortagne>\u00a0let me see  \n15:32\u00a0<yaronr>\u00a0just an example file  \n15:32\u00a0<tmortagne>\u00a0rwxr-xr-x  \n15:33\u00a0<yaronr>\u00a0ok, maybe that's it  \n15:33\u00a0<yaronr>\u00a0that's on all your files?  \n15:33\u00a0<tmortagne>\u00a0all the top folders at least  \n15:33\u00a0<tmortagne>\u00a0you got the DW ?  \n15:34\u00a0<yaronr>\u00a0gateway timeout (which is normal as far as I know) soon it will refresh and show me the DW  \n15:34\u00a0<tmortagne>\u00a0I have -rw-r--r-- on distribution startus file (jobs/status/distribution/status.xml)  \n15:34\u00a0<yaronr>\u00a0who are the owners on your files?  \n15:34\u00a0<tmortagne>\u00a0root  \n15:34\u00a0<yaronr>\u00a0smae here  \n15:34\u00a0<tmortagne>\u00a0I started docker with root  \n15:34\u00a0<yaronr>\u00a0hey, it didn't go through the DW.  \n15:34\u00a0<tmortagne>\u00a0it refused to start with anything else anyway  \n15:34\u00a0<yaronr>\u00a0but it did take a long time to init  \n15:35\u00a0<tmortagne>\u00a0took some time for me the second time too  \n15:35\u00a0<tmortagne>\u00a0not sure why  \n15:35\u00a0<tmortagne>\u00a0usually you have 12% right way but on docker it seems to stay some time on 0%  \n15:35\u00a0<tmortagne>\u00a0(connecting and initializing the DB)  \n15:36\u00a0<tmortagne>\u00a0s/way/away/  \n15:36\u00a0<yaronr>\u00a0here are the full logs: https://gist.github.com/yaronr/4d5d08e8700e0ce60238  \n15:36\u00a0<yaronr>\u00a0tmortagne ok, so here's what I think:  \n15:37\u00a0<yaronr>\u00a0docker diff xwiki will show you the changed files (which are not part of the perm dir)  \n15:37\u00a0<tmortagne>\u00a0looks like normal log, \"StepProgressEvent was fired too many times\" warnings are wrong and I do see them from time to time but it's random (not yet sure why)  \n15:37\u00a0<tmortagne>\u00a0but it's not a big deal  \n15:37\u00a0<yaronr>\u00a0So my (our?) goal is to make xWiki load on a second instance immediately, without initializing  \n15:38\u00a0<tmortagne>\u00a0that's not possible  \n15:38\u00a0<yaronr>\u00a0my thinking is that 1) there's more data, other than perm dir, that's involved  \n15:38\u00a0<tmortagne>\u00a0you will always get the init  \n15:38\u00a0<yaronr>\u00a02) if the hostname changes, then you may go through the full DW  \n15:38\u00a0<tmortagne>\u00a0that's XWiki initializing the XWiki class (connecting etc.), unless you can freeze it  \n15:38\u00a0<yaronr>\u00a0tmortagne but why does it take 60 seconds or more?  \n15:39\u00a0<tmortagne>\u00a0XWiki takes time to start  \n15:39\u00a0<tmortagne>\u00a0it's initializing lots of stuff  \n15:39\u00a0<yaronr>\u00a0ok, I C  \n15:39\u00a0<tmortagne>\u00a0but its not supposed to tek 60s  \n15:39\u00a0<tmortagne>\u00a0take  \n15:39\u00a0<tmortagne>\u00a0its slow in this docker image for some reason but it's not missing files  \n15:40\u00a0<yaronr>\u00a0Let's try (2). stop xwiki2, and start xwiki3 but with --hostname=KUKU  \n15:40\u00a0<yaronr>\u00a0see if it goes through the DW this time  \n15:40\u00a0<yaronr>\u00a0I swear I went through the DW every time before today..  \n15:40\u00a0<tmortagne>\u00a0as long as it's using the same permdir there is no reason to get the DW  \n15:41\u00a0<tmortagne>\u00a0the DW status basically just say \"I'm done don't show up again no matter what\"  \n15:42\u00a0<yaronr>\u00a0tmortagne damn it :)  \n15:42\u00a0<yaronr>\u00a0well, then  \n15:43\u00a0<yaronr>\u00a0the only thing that's missing to allow you to officially announce a Docker version of xWiki is how I took care of the perm dir data  \n15:43\u00a0<yaronr>\u00a0I created another container called docker-volume-container  \n15:44\u00a0<yaronr>\u00a0sorry. backup-volume-contaienr: https://registry.hub.docker.com/u/yaronr/backup-volume-container/  \n15:44\u00a0<yaronr>\u00a0It basically listens on the mapped directory and backs it up (incrementally) to S3 or Dropbox or FTP or rsync or...  \n15:44\u00a0<yaronr>\u00a0and the first time you boot, it does a 'restore'  \n15:45\u00a0<yaronr>\u00a0so if you have one instance, it will always work - no matter where you run it, as long as you run the backup volume container  \n15:45\u00a0<yaronr>\u00a0if you have a few, they will be synced every time you re-start them  \n15:45\u00a0<yaronr>\u00a0which is not perfect, but it's not so bad  \n15:46\u00a0<tmortagne>\u00a0yep sounds nice  \n15:46\u00a0<yaronr>\u00a0and if you can think about putting everything in the DB for your next versions - that would make this problem go away and xWiki will be a full 12 factor app  \n15:46\u00a0<yaronr>\u00a0so right now it's 11.5 factor app :)  \n15:46\u00a0<tmortagne>\u00a0putting everything in the DW is not going to happen in the next version for sure  \n15:46\u00a0<tmortagne>\u00a0DB  \n15:47\u00a0<yaronr>\u00a0I guessed so, that's why I developed this solution  \n15:47\u00a0<yaronr>\u00a0also because I wanted to see how to address it for other types of apps, like wordpress, and more  \n15:48\u00a0<yaronr>\u00a0my startup is about providing a technology for companies that use the cloud, to allow them to dramatically reduce costs and at the same time improve QOS and availability metrics, by constantly optimizing the system.  \n15:49\u00a0<yaronr>\u00a0There's a lot more I can optimize if I know I can kill an instance and run it somewhere else without any cost  \n15:49\u00a0<yaronr>\u00a0so taking care of the data is critical  \n15:49\u00a0<yaronr>\u00a0so now with this solution, I add a new node in a 'better' location, and kill the old one when the new one is up  \n15:51\u00a0<tmortagne>\u00a0I see  \n15:54\u00a0<vmassol>\u00a0has quit  \n16:02\u00a0<vmassol>\u00a0has joined #xwiki  \n16:05\u00a0<vmassol1>\u00a0has joined #xwiki  \n16:09\u00a0<vmassol1>\u00a0has quit  \n16:16\u00a0<mflorea>\u00a0tmortagne: do you know what is the \"Performances tests compared to <last super stable version>\" section from RN supposed to contain?  \n16:16\u00a0<mflorea>\u00a0I guess it comes from the RN template  \n16:16\u00a0<mflorea>\u00a0but it's the first time I see it  \n16:16\u00a0<tmortagne>\u00a0mflorea: http://www.xwiki.org/xwiki/bin/view/ReleaseNotes/ReleaseNotesXWiki62#HPerformancestestscomparedto5.4.5  \n16:16\u00a0<tmortagne>\u00a0the first time was actually in 6.2  \n16:17\u00a0<tmortagne>\u00a0this is only for final releases  \n16:17\u00a0<tmortagne>\u00a06.3 here  \n16:18\u00a0<mflorea>\u00a0ok, so I can remove this section  \n16:18\u00a0<tmortagne>\u00a0you can remove it for 6.3RC1 yes  \n16:18\u00a0<mflorea>\u00a0ok, but is it the RM the one that should fill this section?  \n16:20\u00a0<mflorea>\u00a0doesn't seem automated, so someone need to get all that data  \n16:23\u00a0<tmortagne>\u00a0mflorea: right now its me who do test after the release  \n16:24\u00a0<mflorea>\u00a0ok, you may need help, looks like you need to spend some time on this  \n16:24\u00a0<tmortagne>\u00a0yep it takes quite some time  \n16:25\u00a0<tmortagne>\u00a0I discussed it with msmeria but I will probably be doing it for 6.3 once its released  \n16:25\u00a0<tmortagne>\u00a0don't worry about that for now  \n16:27\u00a0<mflorea>\u00a0ok :)  \n16:32\u00a0<yaronr>\u00a0has left #xwiki  \n17:06\u00a0<OSIMasson>\u00a0has joined #xwiki  \n17:22\u00a0<ClemensR>\u00a0has quit  \n17:35\u00a0<evalica>\u00a0has quit  \n18:01\u00a0<cjd>\u00a0has quit  \n18:07\u00a0<woshilapin>\u00a0has quit  \n18:09\u00a0<tmortagne>\u00a0has quit  \n18:20\u00a0<KermitTheFragger>\u00a0has quit  \n18:34\u00a0<mflorea>\u00a0has quit  \n18:58\u00a0<Lyes1>\u00a0has joined #xwiki  \n19:01\u00a0<Lyes>\u00a0has quit  \n19:03\u00a0<Lyes1>\u00a0has quit  \n19:05\u00a0<Lyes>\u00a0has joined #xwiki  \n19:19\u00a0<OSIMasson>\u00a0has quit  \n19:23\u00a0<vmassol>\u00a0has joined #xwiki  \n19:47\u00a0<OSIMasson>\u00a0has joined #xwiki  \n20:05\u00a0<Slashman>\u00a0has quit  \n20:09\u00a0<tmortagne>\u00a0has joined #xwiki  \n20:10\u00a0<tmortagne>\u00a0has quit  \n20:21\u00a0<lucaa>\u00a0has quit  \n21:29\u00a0<Lyes>\u00a0has quit  \n21:48\u00a0<Enygma`>\u00a0has quit  \n22:06\u00a0<vmassol>\u00a0has quit\n"}