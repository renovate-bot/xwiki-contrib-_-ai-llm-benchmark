{"id": "dev:IRC.xwikiArchive20111209", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20111209", "title": "IRC Archive for channel #xwiki on 09 December 2011 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n00:03\u00a0<rrodriguez>\u00a0has quit  \n00:54\u00a0<evalica>\u00a0has quit  \n02:02\u00a0<Enygma`>\u00a0has joined #xwiki  \n02:02\u00a0<Enygma`1>\u00a0has quit  \n03:17\u00a0<tekzilla>\u00a0has quit  \n03:19\u00a0<tekzilla>\u00a0has joined #xwiki  \n05:31\u00a0<DrLou>\u00a0has quit  \n08:06\u00a0<mflorea>\u00a0has joined #xwiki  \n08:28\u00a0<tmortagne>\u00a0has joined #xwiki  \n08:51\u00a0<Denis>\u00a0has joined #xwiki  \n08:58\u00a0<+sburjan`>\u00a0the order ot XWiki downloads isn't changed, you have to scroll to the bottom of the page to get the latest RC1  \n09:04\u00a0<+mflorea>\u00a0sdumitriu; ping  \n09:10\u00a0<+mflorea>\u00a0Hi  \n09:12\u00a0<+mflorea>\u00a0XWikiDocument#setXObjects gets a list of objects, iterates it, and adds each object. The problem is that the given list can be the list returned by getXObjects, in which case a concurrent modification exception is thrown. I'm not sure where to fix this: (1) in the code that call setXObjects or (2) in setXObjects.  \n09:12\u00a0<+mflorea>\u00a0wdyt?  \n09:32\u00a0<rrodriguez>\u00a0has joined #xwiki  \n09:34\u00a0<jvdrean>\u00a0has joined #xwiki  \n09:45\u00a0<vmassol>\u00a0has joined #xwiki  \n10:03\u00a0<vmassol>\u00a0sdumitriu: ?  \n10:18\u00a0<+Denis>\u00a0vma, cjdelisle, sdumitriu, Enygma`, tmortagne, \u2026: I have an urgent question on the ML, could you have a look please ?  \n10:18\u00a0<sburjan>\u00a0has joined #xwiki  \n10:24\u00a0<+tmortagne>\u00a0Denis: sure  \n10:25\u00a0<+tmortagne>\u00a0mflorea: looking  \n10:27\u00a0<vmassol>\u00a0guys the final release date is approaching  \n10:27\u00a0<vmassol>\u00a0we need to decide what we do  \n10:27\u00a0<vmassol>\u00a0for example there are still issues with oracle as reported by sorin  \n10:28\u00a0<vmassol>\u00a0that could be a blocker depending how we want to consider them  \n10:28\u00a0<vmassol>\u00a0do you know any other blockers?  \n10:29\u00a0<+tmortagne>\u00a0mflorea: not sure I understand why someone would do setXObjects(reference, getXObjects()), does not make more sense or I did not understood you use case  \n10:29\u00a0<+tmortagne>\u00a0s/more/much/  \n10:30\u00a0<+tmortagne>\u00a0or you mean setXObjects should protect itself from this use case ?  \n10:31\u00a0<+mflorea>\u00a0tmortagne: XWikiDocument#mergeXObjects does this:  \n10:31\u00a0<+mflorea>\u00a0myObjects = getXObjects().get(classRef);  \n10:31\u00a0<+mflorea>\u00a0myObjects.add(newObject);  \n10:31\u00a0<+mflorea>\u00a0setXObjects(classRef, myObjects)  \n10:31\u00a0<+mflorea>\u00a0ofc, it does more, I just wrote these line to make it clear  \n10:32\u00a0<+tmortagne>\u00a0well just thoses lines took aone are pretty bad :) it should just call addXObject  \n10:32\u00a0<+mflorea>\u00a0so my question is: should i fix mergeXObjects or setXObjects?  \n10:32\u00a0<+tmortagne>\u00a0definitely mergeXObjects here  \n10:32\u00a0<+mflorea>\u00a0ok  \n10:33\u00a0<+tmortagne>\u00a0since what it's doing is very bad anyway  \n10:33\u00a0<+tmortagne>\u00a0now on another subject setXObjects seems wrong to be  \n10:33\u00a0<+mflorea>\u00a0so you suggest to use addXObject instead of setXObjects  \n10:33\u00a0<+tmortagne>\u00a0currently it's adding  \n10:33\u00a0<+tmortagne>\u00a0while it should set  \n10:34\u00a0<+mflorea>\u00a0well, currently that is what mergeXObjects does: only copying objects from one doc to the other, so no merging  \n10:34\u00a0<+tmortagne>\u00a0mflorea: well the code you pasted should be replace d by addXObejct since that's what it's doing  \n10:34\u00a0<+tmortagne>\u00a0modifying the return of \u00a0getXObjects() is veru bad and giving \u00a0getXObjects() to setXObejct is very bad too  \n10:34\u00a0<+mflorea>\u00a0I haven't pasted the code, I just wrote those lines to make it easier to understand the problem  \n10:35\u00a0<+mflorea>\u00a0yes  \n10:35\u00a0<+tmortagne>\u00a0mflorea: yes I know but I can only talk abou the code you pasted here :)  \n10:35\u00a0<+mflorea>\u00a0mergeXObjects does pretty much what I wrote  \n10:36\u00a0<+tmortagne>\u00a0so basically no code should ever do that and I think I will create a jira issue and fix the fact that \u00a0setXObject add instead of setting  \n10:36\u00a0<+mflorea>\u00a0now, I'm not sure what is the expected behavior of this method  \n10:36\u00a0<+tmortagne>\u00a0don't know not sure it's even used  \n10:36\u00a0<+mflorea>\u00a0I mean mergeXObjects  \n10:36\u00a0<+tmortagne>\u00a0never understood what it was about either when I saw what it was doing  \n10:38\u00a0<+Denis>\u00a0vmassol: for me XEM changes is currently not appropriate, see ML  \n10:38\u00a0<+mflorea>\u00a0:) now I see what you mean by adding in setXObject.. it doesn't set, it simply adds all the passed objects. So if you already have objects, those won't be replaced..  \n10:38\u00a0<+mflorea>\u00a0very bad  \n10:39\u00a0<+tmortagne>\u00a0yep  \n10:39\u00a0<+mflorea>\u00a0so there are two issues  \n10:39\u00a0<+tmortagne>\u00a0yep  \n10:39\u00a0<+tmortagne>\u00a0taking care of setXObject, let you deal with the other one ;)  \n10:39\u00a0<+mflorea>\u00a0I mean, I have to fix both mergeXObjects and setXObjects  \n10:39\u00a0<+mflorea>\u00a0ok  \n10:39\u00a0<+mflorea>\u00a0I'll fix mergeXObjects  \n10:40\u00a0<+tmortagne>\u00a0XWIKI-7262  \n10:40\u00a0<+tmortagne>\u00a0you already have an issue for the other one right ?  \n10:41\u00a0<+mflorea>\u00a0well, someone reported an issue for AppWithinMinutes, but the problem is in core XE-1059  \n10:41\u00a0<+mflorea>\u00a0one of the problems is that mergeXObjects can throw ConcurrentModificationException  \n10:42\u00a0<+tmortagne>\u00a0but what is it used for ?  \n10:42\u00a0<+mflorea>\u00a0it is used in XWikiDocument#readFromTemplate  \n10:42\u00a0<+mflorea>\u00a0to \"merge\" (copy in fact) objects from the template to the target doc  \n10:43\u00a0<+mflorea>\u00a0i.e. when you create a new document based on a template (using the template query string param) XWikiDocument#readFromTemplate is called, which in turn call mergeXObjects  \n10:44\u00a0<+tmortagne>\u00a0I see  \n10:44\u00a0<+tmortagne>\u00a0so it really need to add them and not set them  \n10:44\u00a0<+mflorea>\u00a0well, as I said, there are two problems:  \n10:45\u00a0<+tmortagne>\u00a0yes yes I understood that, was just confirming that this method should never have used setXObject anyway ;)  \n10:45\u00a0<+mflorea>\u00a0(1) readFromTemplate shouldn't copy the objects if the target doc is not new  \n10:45\u00a0<+mflorea>\u00a0(2) mergeXObjects (which is a public API) should work when the target doc already have objects  \n10:45\u00a0<+tmortagne>\u00a0ha so 3 problems ok :)  \n10:46\u00a0<+mflorea>\u00a0well, mergeXObjects take the current list of objects and adds the objects from template, so setXObjects makes sense with the current code. Ofc, it would have been better to just call addXObject for each of the objects from the template  \n10:59\u00a0<+tmortagne>\u00a0wow the more I look at set/get/addXObect(s) the more mistake I find...  \n11:00\u00a0<+tmortagne>\u00a0most of them are caused by the fact that the code internally use getXObjects instead of directly accessing the map  \n11:06\u00a0<+mflorea>\u00a0I may have found the reason why mergeXObjects was using setXObjects and not addXObjects. Let's take this use case: You have two wikis (in a XEM). In wiki A you have a class C and a template T with objects of class C. What should happen when you want to create a document in wiki B (another wiki) based on template T? Do we support objects of types defined in other wikis?  \n11:07\u00a0<+tmortagne>\u00a0mflorea: well the database does not AFAIK (even if technically it could)  \n11:07\u00a0<vmassol>\u00a0Enygma`: what's your plan re XEM for the final release. Anything you've planned to work on to make ludovic/denis more happy ?  \n11:07\u00a0<+mflorea>\u00a0the current behavior of mergeXObjects copies the objects from template T but changes their wiki reference so that their type is not from wiki B, instead of wiki A, like the objects from the template.  \n11:08\u00a0<vmassol>\u00a0(Enygma`: the release is planned for Monday so we need to hurry up)  \n11:08\u00a0<+mflorea>\u00a0s/not/now  \n11:08\u00a0<+tmortagne>\u00a0mflorea: it could well change the object  \n11:08\u00a0<+tmortagne>\u00a0no need to use setXObjects for thiqs  \n11:08\u00a0<+mflorea>\u00a0sure  \n11:08\u00a0<+mflorea>\u00a0I'll change the wiki ref on the object and use addXObject  \n11:08\u00a0<+tmortagne>\u00a0especially when setXObject does not does what it's supposed to do :)  \n11:08\u00a0<+mflorea>\u00a0yes :)  \n11:09\u00a0<vmassol>\u00a0tmortagne:/mflorea: I haven't followed the dsicussion but I see you're planning to touch some oldcore stuff. Are you planning this for 3.3 final? If you do maybe we need more time to verify it doesn't break anything?  \n11:09\u00a0<vmassol>\u00a0(from the outside it looks like a dangerous thing to do one day before the release)  \n11:10\u00a0<+Denis>\u00a0vmassol: could you give me your thought on my last message on ML regarding locales ?  \n11:10\u00a0<vmassol>\u00a0Denis: not right now  \n11:10\u00a0<vmassol>\u00a0I'm fully busy on the 3.3 release  \n11:10\u00a0<vmassol>\u00a0we should all focus on 3.3 right now  \n11:11\u00a0<vmassol>\u00a0I'm lagging behing on several proplsa for 3.4 that you've sent  \n11:11\u00a0<vmassol>\u00a0sorry about that  \n11:11\u00a0<vmassol>\u00a0haven't had time to wrap my head around them  \n11:11\u00a0<+Denis>\u00a0just the last one is stucking me  \n11:12\u00a0<+Denis>\u00a0I want these stuff to enter very early the 3.4 cycle for obvious reason  \n11:12\u00a0<+mflorea>\u00a0vmassol: on my side the changes I'd like to make to the mergeXObjects method are pretty safe and shouldn't change the current behavior. Plus, it fixes a bug reported on AppWithinMinutes (I don't want to fix the issue at the AppWitinMinutes level)  \n11:13\u00a0<+tmortagne>\u00a0vmassol: XWIKI-7263 cannot break anything and what mflorea is working on is something that is currently broken, XWIKI-7262 is going to change a behavior but I doubt there is any code using setXObjects and expect it to add instead of setting, that's might instead fix bugs we did not yet found  \n11:13\u00a0<vmassol>\u00a0why do we fix it?  \n11:13\u00a0<vmassol>\u00a0if there's no code using it  \n11:13\u00a0<vmassol>\u00a0:)  \n11:14\u00a0<+tmortagne>\u00a0where did I said no code was using it ?  \n11:14\u00a0<+tmortagne>\u00a0I said no code was using it the wrong way  \n11:14\u00a0<vmassol>\u00a0so the change brings a side effect  \n11:14\u00a0<vmassol>\u00a0and this side effedct is ok because nobody is going to use it  \n11:14\u00a0<vmassol>\u00a0?  \n11:14\u00a0<+tmortagne>\u00a0yes it brong fixing a bug...  \n11:15\u00a0<vmassol>\u00a0so you guys feel comfortable with doing these changes and still releasing on Monday?  \n11:16\u00a0<+tmortagne>\u00a0yes  \n11:16\u00a0<vmassol>\u00a0ok  \n11:18\u00a0<CIA-115>\u00a0Vincent Massol\u000f master\u000f \\* r389c6eb\u000f \u000f/ xwiki-enterprise-test/pom.xml :\u000f XE-1058: Upgrade to Selenium 2.15.0 ...  \n11:24\u00a0<vmassol>\u00a0sburjan: re XWIKI-7254 can I apply your changes as is?  \n11:25\u00a0<+sburjan>\u00a0apply them where ?  \n11:25\u00a0<vmassol>\u00a0for 3.3  \n11:25\u00a0<vmassol>\u00a0\" they only illustrate a possible (but less probable) way to make it work.\"  \n11:25\u00a0<vmassol>\u00a0why \"less probable\"?  \n11:25\u00a0<vmassol>\u00a0what does it mean?  \n11:25\u00a0<evalica>\u00a0has joined #xwiki  \n11:25\u00a0<+sburjan>\u00a0I've written at the bottom that those are not patches, because neither me or ludovic \u00a0aren't sure this is the 100% correct fix  \n11:25\u00a0<+sburjan>\u00a0it's just a workaround, but don't know if it is the most correct one  \n11:25\u00a0<vmassol>\u00a0sure but you're the experts  \n11:26\u00a0<vmassol>\u00a0:)  \n11:26\u00a0<vmassol>\u00a0workaround?  \n11:26\u00a0<vmassol>\u00a0what did you do that is not correct?  \n11:26\u00a0<+sburjan>\u00a0no, I'm not an oracle or hibernate expert here :)  \n11:26\u00a0<vmassol>\u00a0well you're the most expert here  \n11:26\u00a0<vmassol>\u00a0for oracle  \n11:26\u00a0<vmassol>\u00a0anyway  \n11:26\u00a0<+sburjan>\u00a0It is correct, but it might not be the \\_best\\_ way to fix it  \n11:26\u00a0<vmassol>\u00a0it looks better to what we have now, no?  \n11:26\u00a0<+sburjan>\u00a0or the most \"inspired\" data types used  \n11:26\u00a0<+sburjan>\u00a0well it works, that's a first step :)  \n11:27\u00a0<+sburjan>\u00a0so yes, it is better :)  \n11:27\u00a0<vmassol>\u00a0between no doing anything and applying these patches for 3.3 what do you prefer?  \n11:27\u00a0<vmassol>\u00a0(applying them as is that is)  \n11:27\u00a0<+sburjan>\u00a0an experienced dev to validate that the changes are OK  \n11:27\u00a0<+sburjan>\u00a0:)  \n11:27\u00a0<vmassol>\u00a0who?  \n11:28\u00a0<+sburjan>\u00a0you know hibernate, cjdelisle know, someone who has a better understanding of hibernate than me :)  \n11:28\u00a0<vmassol>\u00a0no I don't know hibernate  \n11:28\u00a0<vmassol>\u00a0sergiu doesn't even have time to finish the EM UI so if we want him to look at them we'll need to postpone the release by at least 1 week  \n11:29\u00a0<+sburjan>\u00a0cjdelisle ? he's fan of storage :)  \n11:29\u00a0<vmassol>\u00a0supporting oracle is important though so maybe we should postpone by 1 week  \n11:29\u00a0<vmassol>\u00a0especially since we brought a regression  \n11:29\u00a0<vmassol>\u00a0what would be nice  \n11:30\u00a0<+sburjan>\u00a0I mwan you know better, all I am saying that applying these might work, but I cannot guarantee it. Ludovic also said a dev should look at them, because we were not sure of their correctness  \n11:30\u00a0<vmassol>\u00a0would be to contact the guys who've reported issues on oracle and ask them to test these changes maybe  \n11:30\u00a0<vmassol>\u00a0you know what  \n11:30\u00a0<vmassol>\u00a0?  \n11:30\u00a0<vmassol>\u00a0when we code it's exactly the sae  \n11:30\u00a0<vmassol>\u00a0same  \n11:30\u00a0<vmassol>\u00a0we cannot gurantee anything  \n11:30\u00a0<vmassol>\u00a0:)  \n11:30\u00a0<vmassol>\u00a0but I understand your point, it's just that we have no oracle expert here  \n11:31\u00a0<+sburjan>\u00a0I think that upgrading the hibernate version messed up things.  \n11:31\u00a0<vmassol>\u00a0yep that I'm sure too  \n11:31\u00a0<+sburjan>\u00a0so it's not as much oracle as hibernate upgrade  \n11:31\u00a0<vmassol>\u00a0it's the same  \n11:32\u00a0<vmassol>\u00a0even though hibernate is supposed to hide all differences, in practice it does not  \n11:32\u00a0<+sburjan>\u00a0so if you decide to apply, I will test to validate if it works without any hacks, and also perform a test to validate  \n11:32\u00a0<vmassol>\u00a0what hack?  \n11:32\u00a0<vmassol>\u00a0did you put any hack in the diffs?  \n11:32\u00a0<vmassol>\u00a0(need to know if I apply them ))  \n11:32\u00a0<vmassol>\u00a0:)  \n11:32\u00a0<+sburjan>\u00a0no, I extracted the originals from the oldcore.jar and put them in classes and modified them  \n11:32\u00a0<vmassol>\u00a0that's ok  \n11:33\u00a0<+sburjan>\u00a0and I am saying that if you apply, I will create a wiki from scratch to see if it works. vanilla clean install  \n11:33\u00a0<vmassol>\u00a0ok, if I apply I should also do the same  \n11:33\u00a0<vmassol>\u00a0but I've never setup oracle  \n11:33\u00a0<+sburjan>\u00a0in order to check for sure that this is a possible fix.. valid fix  \n11:33\u00a0<vmassol>\u00a0so it'll take me a few days  \n11:33\u00a0<+sburjan>\u00a0I have setup a Oracle VM on Centaurus  \n11:34\u00a0<+sburjan>\u00a0I can give you access via RDP  \n11:34\u00a0<+sburjan>\u00a0with oracle already installed :)  \n11:34\u00a0<+sburjan>\u00a0we can have a call on this if you want  \n11:34\u00a0<+sburjan>\u00a0it's not so complicated  \n11:35\u00a0<vmassol>\u00a0ok thanks, let's first decide what we do  \n11:35\u00a0<+sburjan>\u00a0ok  \n11:40\u00a0<vmassol>\u00a0sburjan: would have been helpful to put comments for your changes  \n11:40\u00a0<vmassol>\u00a0for example why do you do this:  \n11:40\u00a0<vmassol>\u00a0<typedef name=\"clob\" class=\"org.hibernate.type.StringClobType\" />  \n11:40\u00a0<vmassol>\u00a0?  \n11:48\u00a0<rrodriguez>\u00a0has quit  \n11:50\u00a0<+sburjan>\u00a0Ludovic did it. all we think it does is some cast class... Ludovic found it on some hibernate JIRA issue or somewhere on the internet  \n11:50\u00a0<vmassol>\u00a0any link?  \n11:50\u00a0<vmassol>\u00a0(that's why I say it's missing documenttion)  \n11:50\u00a0<vmassol>\u00a0now I need to guess why you did this  \n11:50\u00a0<vmassol>\u00a0:)  \n11:51\u00a0<vmassol>\u00a0I googled but couldn't find it so far  \n11:57\u00a0<vmassol>\u00a0also you changed the referer from \"text\" to \"string\" whcih I don't understand  \n11:57\u00a0<vmassol>\u00a0I guess I'll need to talk to ludovic  \n11:57\u00a0<+sburjan>\u00a0yes, he did \\_all\\_ of those. and he changed it because we got console errors complaining about those too. Check jetty1,2,3.txt  \n12:05\u00a0<+mflorea>\u00a0vmassol/Denis: I have a doc ref. What is the quickest way to obtain a new doc ref that has only the wiki component changed?  \n12:06\u00a0<+Denis>\u00a0docref.replaceParent(oldwikiref, newwikiref)  \n12:06\u00a0<+Denis>\u00a0de m\u00e9moire  \n12:07\u00a0<+mflorea>\u00a0hmm, you mean:  \n12:07\u00a0<+mflorea>\u00a0docref.getLastSpaceReference().replaceParent(oldWikiRef, newWikiRef)  \n12:08\u00a0<+Denis>\u00a0no  \n12:08\u00a0<+sburjan>\u00a0vmassol: We haven't put any comment because we had a trial-error approach. and I created the diffs for someone with knowledge to easily spot the difference between the files. We didn't investigate if we used the best data types, this is why my doubt about committing it like that  \n12:08\u00a0<+mflorea>\u00a0this changes docref right?  \n12:08\u00a0<+sburjan>\u00a0but I'll give a hand of help by testing either you decide to apply the diffs or not.  \n12:09\u00a0<+Denis>\u00a0I really mean docref.replaceParent(docref.getWikiReference(), new WikiReference(\u2026))  \n12:09\u00a0<+Denis>\u00a0this returns a new ref with what you want  \n12:23\u00a0<vmassol>\u00a0sburjan: ok I spoke with ludovic  \n12:24\u00a0<+sburjan>\u00a0ok, fill me in  \n12:24\u00a0<vmassol>\u00a0no time sorry  \n12:24\u00a0<vmassol>\u00a0also I still need to investigate  \n12:24\u00a0<vmassol>\u00a0and ask some questions to sergiu  \n12:25\u00a0<vmassol>\u00a0since he seems to have done a few strange things that I need to check  \n12:28\u00a0<+sburjan>\u00a0ok. but please keep me in the loop, I am also very interested about this fix.. since I lost 3 days of my live blaiming me of unable to configure oracle properly :)  \n12:28\u00a0<vmassol>\u00a0ok  \n12:28\u00a0<+sburjan>\u00a0\\*life  \n12:28\u00a0<vmassol>\u00a0I'll let you know once I reach conclusions  \n12:29\u00a0<+sburjan>\u00a0okay. thanks  \n12:47\u00a0<vmassol>\u00a0tmortagne: we don't have any installation instructions for components anymore?  \n12:47\u00a0<vmassol>\u00a0ah no  \n12:47\u00a0<vmassol>\u00a0my bad again  \n12:47\u00a0<+tmortagne>\u00a0:)  \n12:48\u00a0<vmassol>\u00a0it's because there's no download  \n12:48\u00a0<vmassol>\u00a0anyway it's bundled by default  \n12:48\u00a0<+mflorea>\u00a0@Denis: thanks, it works.  \n12:57\u00a0<+jvelociter>\u00a0hi vmassol  \n12:57\u00a0<+jvelociter>\u00a0re http://extensions.xwiki.org/xwiki/bin/view/Extension/WikiWord+Transformation  \n12:57\u00a0<vmassol>\u00a0jvdrean: yes?  \n12:57\u00a0<vmassol>\u00a0jvelociter sorry  \n12:57\u00a0<vmassol>\u00a0;)  \n12:57\u00a0<+jvelociter>\u00a0if it's bundled with XE and XEM, shouldn't it be developed by the XWiki dev team ?  \n12:57\u00a0<vmassol>\u00a0yes, checing  \n12:58\u00a0<vmassol>\u00a0indeed  \n12:58\u00a0<vmassol>\u00a0by default it put sthe user name now  \n12:58\u00a0<vmassol>\u00a0didn't notice  \n12:58\u00a0<vmassol>\u00a0thanks  \n12:58\u00a0<vmassol>\u00a0fixing  \n12:58\u00a0<+jvelociter>\u00a0didn't know we had this bundled, it's cool  \n12:59\u00a0<vmassol>\u00a0don't know how performant it is though  \n12:59\u00a0<vmassol>\u00a0since it checks all words it finds  \n12:59\u00a0<vmassol>\u00a0against:  \n12:59\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0private static final Pattern WIKIWORD\\_PATTERN = Pattern.compile(  \n12:59\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"\\\\p{javaUpperCase}+\\\\p{javaLowerCase}+(\\\\p{javaUpperCase}\\\\p{javaLowerCase}\\*)+\");  \n13:00\u00a0<+jvelociter>\u00a0how are words split ?  \n13:11\u00a0<xwikibot>\u00a0has joined #xwiki  \n13:14\u00a0<vmassol>\u00a0(stopped link checker)  \n13:27\u00a0<CIA-115>\u00a0Marius Dumitru Florea\u000f master\u000f \\* r5c468ca\u000f \u000f/ (2 files in 2 dirs):\u000f XWIKI-7268: Duplication entries check bug in an application created by Application Within Minutes ...  \n13:29\u00a0<CIA-115>\u00a0Marius Dumitru Florea\u000f stable-3.3.x\u000f \\* r2dfad3c\u000f \u000f/ (2 files in 2 dirs):\u000f XWIKI-7268: Duplication entries check bug in an application created by Application Within Minutes ...  \n13:42\u00a0<CIA-115>\u00a0tmortagne\u000f master\u000f \\* r990f8f9\u000f \u000f/ xwiki-platform-core/xwiki-platform-extension/xwiki-platform-extension-repositories/xwiki-platform-extension-repository-aether/src/main/java/org/xwiki/extension/repository/aether/internal/AetherExtensionFile.java :\u000f XWIKI-7264: Extension file is not removed from Aether cache anymore - http://git.io/qJo6hg  \n13:42\u00a0<CIA-115>\u00a0tmortagne\u000f master\u000f \\* r7cfbc42\u000f \u000f/ (2 files in 2 dirs):\u000f XWIKI-7263 XWikiDocument#setXObject does not work if there is not ...  \n13:42\u00a0<CIA-115>\u00a0tmortagne\u000f master\u000f \\* r562a42e\u000f \u000f/ (8 files in 6 dirs):\u000f XWIKI-7256: Extension manager imports XAR with wrong user - http://git.io/MKqm9g  \n13:43\u00a0<vmassol>\u00a0hmm http://www.wikimatrix.org/show/XWiki hasn't be updated  \n13:44\u00a0<vmassol>\u00a0seems sergiu has forgotten a few things during the m2 and m3 releases  \n14:08\u00a0<+evalica>\u00a0morning :)  \n14:09\u00a0<vmassol>\u00a0mornign  \n14:48\u00a0<DrLou>\u00a0has joined #xwiki  \n15:23\u00a0<vmassol>\u00a0tmortagne: you're upgrading xwiki.org to 3.3RC1?  \n15:24\u00a0<+tmortagne>\u00a0vmassol: just getting some classes  \n15:24\u00a0<vmassol>\u00a0ok  \n15:24\u00a0<+tmortagne>\u00a0will wait for 3.3 final to upgrade fully xwiki.org  \n15:24\u00a0<vmassol>\u00a0so we'll wait for the final 3.3 before uphrdn  \n15:24\u00a0<vmassol>\u00a0ok  \n15:44\u00a0<CIA-115>\u00a0tmortagne\u000f stable-3.3.x\u000f \\* rfd553a7\u000f \u000f/ (2 files in 2 dirs):\u000f XWIKI-7263 XWikiDocument#setXObject does not work if there is not ...  \n15:45\u00a0<CIA-115>\u00a0tmortagne\u000f stable-3.3.x\u000f \\* r7050517\u000f \u000f/ xwiki-platform-core/xwiki-platform-extension/xwiki-platform-extension-repositories/xwiki-platform-extension-repository-xwiki/xwiki-platform-extension-repository-xwiki-server-api/src/main/java/org/xwiki/extension/repository/xwiki/internal/resources/SearchRESTResource.java :\u000f XWIKI-7252: Add summary in the simple search on XR(cherry picked from commit 18a63a3eea2fe8395aa8920a323263f812f72aa0) - http://git.io/JnfkMA  \n15:45\u00a0<CIA-115>\u00a0tmortagne\u000f stable-3.3.x\u000f \\* r4f34899\u000f \u000f/ (2 files):\u000f XWIKI-7253: Generated default id prefix based on extension creator in XR ...  \n15:45\u00a0<CIA-115>\u00a0tmortagne\u000f stable-3.3.x\u000f \\* rdd36558\u000f \u000f/ xwiki-platform-core/xwiki-platform-extension/xwiki-platform-extension-repositories/xwiki-platform-extension-repository-aether/src/main/java/org/xwiki/extension/repository/aether/internal/AetherExtensionFile.java :\u000f XWIKI-7264: Extension file is not removed from Aether cache anymore(cherry picked from commit 990f8f94fa3a7e5ff65cade5efd630b14f6e048d) - http://git.io/lBEidA  \n15:45\u00a0<CIA-115>\u00a0tmortagne\u000f stable-3.3.x\u000f \\* r1ba4d6e\u000f \u000f/ (8 files in 6 dirs):\u000f XWIKI-7256: Extension manager imports XAR with wrong user(cherry picked from commit 562a42e6d1a6eeca277f84cb53c8c35e1adf2e1c) - http://git.io/-1iOMg  \n15:46\u00a0<@cjdelisle>\u00a0heh  \n15:46\u00a0<+tmortagne>\u00a0late merge (totally forgot the branch was created when committed theses things)  \n16:04\u00a0<CIA-115>\u00a0tmortagne\u000f master\u000f \\* r5a383b5\u000f \u000f/ (4 files in 2 dirs):\u000f XWIKI-7269: Properly use new sheet system in XR UI - http://git.io/WMbfFw  \n16:04\u00a0<CIA-115>\u00a0tmortagne\u000f stable-3.3.x\u000f \\* rab803e3\u000f \u000f/ (4 files in 2 dirs):\u000f XWIKI-7269: Properly use new sheet system in XR UI ...  \n16:10\u00a0<+tmortagne>\u00a0vmassol: if I stop the IRC bot from http://dev.xwiki.org/xwiki/bin/view/IRC/IRCBot it's going to restart in 1 minutes ?  \n16:11\u00a0<+tmortagne>\u00a0i'm about to spam like crazy (modify every extensions documents) so I would like to stop IRC bot basically  \n16:13\u00a0<vmassol>\u00a0tmortagne: yes  \n16:13\u00a0<vmassol>\u00a0except  \n16:13\u00a0<vmassol>\u00a0that there's a problem with it  \n16:13\u00a0<vmassol>\u00a0haven't investigated yet  \n16:14\u00a0<vmassol>\u00a0earlier on today it didn't restart  \n16:14\u00a0<vmassol>\u00a0you can unschedule the job  \n16:14\u00a0<vmassol>\u00a0if you don't want it to restart  \n16:14\u00a0<+tmortagne>\u00a0indeed  \n16:14\u00a0<+tmortagne>\u00a0will do that  \n16:15\u00a0<vmassol>\u00a0me?  \n16:15\u00a0<vmassol>\u00a0:)  \n16:15\u00a0<vmassol>\u00a0another bug  \n16:15\u00a0<vmassol>\u00a0to fix  \n16:16\u00a0<+tmortagne>\u00a0yep, the scheduler probably does not set the context author as author of the modification  \n16:25\u00a0<xwikibot>\u00a0has joined #xwiki  \n16:57\u00a0<vmassol>\u00a0tmortagne: you forgot to turn off the link checker it seem s;)  \n17:53\u00a0<pgmjsd>\u00a0has left #xwiki  \n17:57\u00a0<+tmortagne>\u00a0vmassol: did not know it it was supposed to be turned off  \n17:58\u00a0<+tmortagne>\u00a0ha right you mean for it to not try to check link of modified pages  \n17:59\u00a0<+tmortagne>\u00a0there is a way to disabled it ?  \n17:59\u00a0<tmortagne>\u00a0has quit  \n18:26\u00a0<CIA-115>\u00a0Vincent Massol\u000f master\u000f \\* rb66728e\u000f \u000f/ (2 files):\u000f XWIKI-7254: Invalid mapping with Oracle 11g and Hibernate 3.6 ...  \n18:28\u00a0<CIA-115>\u00a0Vincent Massol\u000f stable-3.3.x\u000f \\* r9c2c430\u000f \u000f/ (2 files):\u000f XWIKI-7254: Invalid mapping with Oracle 11g and Hibernate 3.6 ...  \n18:29\u00a0<CIA-115>\u00a0Vincent Massol\u000f stable-3.2.x\u000f \\* r6db7dad\u000f \u000f/ (2 files):\u000f XWIKI-7254: Invalid mapping with Oracle 11g and Hibernate 3.6 ...  \n18:35\u00a0<vmassol>\u00a0has quit  \n18:36\u00a0<vmassol>\u00a0has joined #xwiki  \n18:37\u00a0<vmassol>\u00a0btw guys I have a nice oracle 10g setup now  \n18:37\u00a0<@sdumitriu>\u00a0vmassol: Paul's machine should also be usable  \n18:37\u00a0<vmassol>\u00a0yep but mine too  \n18:37\u00a0<vmassol>\u00a0easier for me  \n18:37\u00a0<@sdumitriu>\u00a0I didn't have time yet to work on it, though  \n18:37\u00a0<vmassol>\u00a0I'm closing oracle issues  \n18:38\u00a0<vmassol>\u00a0now  \n18:38\u00a0<abusenius>\u00a0has joined #xwiki  \n18:38\u00a0<vmassol>\u00a0there's just one remaining  \n18:38\u00a0<vmassol>\u00a0http://jira.xwiki.org/browse/XWIKI-7271  \n18:38\u00a0<vmassol>\u00a0if you have some ideas sdumitriu...  \n18:38\u00a0<@sdumitriu>\u00a0mflorea: Can you update the roadmap status page? http://enterprise.xwiki.org/xwiki/bin/view/Main/Roadmap  \n18:38\u00a0<vmassol>\u00a0sdumitriu: you should read the new hbm I committed, I've put some comments at the top of thef ile  \n18:38\u00a0<@sdumitriu>\u00a0Yes  \n18:38\u00a0<vmassol>\u00a0removed some of your comments  \n18:38\u00a0<vmassol>\u00a0which were not correct AFAICS  \n18:39\u00a0<vmassol>\u00a0(for the data types)  \n19:06\u00a0<jvdrean>\u00a0has quit  \n19:08\u00a0<sburjan>\u00a0has quit  \n19:51\u00a0<+mflorea>\u00a0sdumitriu  \n19:51\u00a0<vmassol>\u00a0has quit  \n19:51\u00a0<+mflorea>\u00a0I update just one item, the app within minuntes  \n19:53\u00a0<vmassol>\u00a0has joined #xwiki  \n20:14\u00a0<mflorea>\u00a0has quit  \n21:07\u00a0<vmassol>\u00a0I'm still debugging the issue with saving Main.Activity  \n21:07\u00a0<vmassol>\u00a0I got this: http://pastebin.com/YLezK3VF  \n21:08\u00a0<vmassol>\u00a0insert into xwikilargestrings (XWL\\_VALUE, XWL\\_ID, XWL\\_NAME) values (?, ?, ?)  \n21:08\u00a0<vmassol>\u00a0what's strange is that hibernate doesn't bind the first param  \n21:08\u00a0<vmassol>\u00a0maybe because null is passed  \n21:16\u00a0<@sdumitriu>\u00a0The length of the macro code is 37k, which is bigger than 32k  \n21:17\u00a0<@sdumitriu>\u00a0Maybe the schema was created with a 32k limit column  \n21:17\u00a0<vmassol>\u00a0getting closer I think  \n21:17\u00a0<vmassol>\u00a0it seems if the \"content decription\" of the macro content is empty it's causing the issue  \n21:17\u00a0<vmassol>\u00a0I'm verifying if it's that  \n21:18\u00a0<vmassol>\u00a0there's no 32K limit column AFAIK  \n21:18\u00a0<vmassol>\u00a0(in oracle)  \n21:18\u00a0<vmassol>\u00a0it's either 4K or 8TB  \n21:18\u00a0<vmassol>\u00a0yep that's it  \n21:18\u00a0<@sdumitriu>\u00a0Aha  \n21:18\u00a0<vmassol>\u00a0it's because of the macro content descirption field  \n21:18\u00a0<vmassol>\u00a0which is empty  \n21:19\u00a0<@sdumitriu>\u00a0Yes, it needs a not-null=\"false\"  \n21:19\u00a0<vmassol>\u00a0default is not-null?  \n21:19\u00a0<vmassol>\u00a0not-null=true I mean  \n21:20\u00a0<@sdumitriu>\u00a0Not as far as I know  \n21:20\u00a0<@sdumitriu>\u00a0But who knows  \n21:20\u00a0<@sdumitriu>\u00a0Can you get a description of the table?  \n21:20\u00a0<vmassol>\u00a0yep  \n21:21\u00a0<vmassol>\u00a0https://skitch.com/e-vmassol/gxrs4/object-browser  \n21:21\u00a0<vmassol>\u00a0so value can be null  \n21:23\u00a0<vmassol>\u00a0hmm  \n21:23\u00a0<@sdumitriu>\u00a0Weird, the error says:  \n21:23\u00a0<@sdumitriu>\u00a0cannot insert NULL into (\"XWIKI\".\"XWIKILARGESTRINGS\".\"XWL\\_ID\")  \n21:24\u00a0<@sdumitriu>\u00a0Hinting the XWL\\_ID is the one with the problem  \n21:24\u00a0<vmassol>\u00a0yes  \n21:24\u00a0<vmassol>\u00a0I don't understand it  \n21:24\u00a0<@sdumitriu>\u00a0And it is the one with the not-null constraint on it  \n21:24\u00a0<@sdumitriu>\u00a0Does the Oracle driver ignore the specified position of the parameters?  \n21:25\u00a0<vmassol>\u00a0that would be strange  \n21:25\u00a0<@sdumitriu>\u00a0Bind 2 with 613629222 actually ends up as the first column...  \n21:26\u00a0<vmassol>\u00a0hibernate doesn't log the binding for param1  \n21:26\u00a0<vmassol>\u00a0this is before the driver work  \n21:28\u00a0<@sdumitriu>\u00a0Yes, but the driver is the one that sends the values to the server  \n21:28\u00a0<@sdumitriu>\u00a0So Hibernate is doing its job correctly  \n21:28\u00a0<vmassol>\u00a0I've checked BasicBinder source code and it should log a trace even if the value is null  \n21:28\u00a0<vmassol>\u00a0(it actually has a special message if it's null)  \n21:29\u00a0<@sdumitriu>\u00a0vmassol: Can you try to reproduce the problem on another object?  \n21:29\u00a0<@sdumitriu>\u00a0Create a class with a largestring property  \n21:29\u00a0<@sdumitriu>\u00a0Add an object without a value for it  \n21:29\u00a0<@sdumitriu>\u00a0Save  \n21:29\u00a0<vmassol>\u00a0yep  \n21:31\u00a0<vmassol>\u00a0textarea is largestring right?  \n21:31\u00a0<@sdumitriu>\u00a0Yes  \n21:31\u00a0<vmassol>\u00a0deosn't fail  \n21:32\u00a0<@sdumitriu>\u00a0Does it fail only for import?  \n21:32\u00a0<vmassol>\u00a0apparently yes  \n21:32\u00a0<vmassol>\u00a0that's how it looks  \n21:32\u00a0<vmassol>\u00a0I'll create a wiki macro  \n21:33\u00a0<vmassol>\u00a0hmmm  \n21:33\u00a0<vmassol>\u00a0when editing the object again I got this:  \n21:33\u00a0<vmassol>\u00a0http://pastebin.com/8BDysgPk  \n21:34\u00a0<vmassol>\u00a0might be my db  \n21:34\u00a0<@sdumitriu>\u00a0Doesn't look related, it's Lucene  \n21:35\u00a0<vmassol>\u00a0seems my db is not answering any ore  \n21:35\u00a0<vmassol>\u00a0more  \n21:42\u00a0<vmassol>\u00a0I've restarted my oracle vm but I cannot get a page to render properly now, it's just stuck\u2026 strange  \n21:42\u00a0<vmassol>\u00a0ah no was just slow  \n21:42\u00a0<vmassol>\u00a0got a stackt race  \n21:42\u00a0<vmassol>\u00a0apparently I'm having connection problems  \n21:42\u00a0<vmassol>\u00a0which is strange since I'm on the same machine :)  \n21:43\u00a0<@sdumitriu>\u00a0In the XML there's <contentDescription></contentDescription>  \n21:43\u00a0<vmassol>\u00a0yep  \n21:44\u00a0<@sdumitriu>\u00a0So it should have at least an empty string value  \n21:44\u00a0<vmassol>\u00a0what I'm sure is if put something instead of empty string then it works  \n21:44\u00a0<vmassol>\u00a0and I even retried after with an empty string and it failed to import again  \n21:44\u00a0<vmassol>\u00a0ok I'll drop my db user and recreate, it's not working for some reason now  \n21:47\u00a0<@sdumitriu>\u00a0Checked the Java code for XML import  \n21:47\u00a0<@sdumitriu>\u00a0All seems OK  \n21:47\u00a0<@sdumitriu>\u00a0There's supposed to be an empty string there  \n21:48\u00a0<vmassol>\u00a0ok my db is back  \n21:48\u00a0<vmassol>\u00a0(the vm ip had changed for some reason)  \n21:51\u00a0<vmassol>\u00a0so yes I can create a wiki macro fine  \n21:51\u00a0<vmassol>\u00a0with an empty content description  \n21:51\u00a0<vmassol>\u00a0so it seems related to import somehow  \n21:52\u00a0<vmassol>\u00a0btw when I get it to fail when importing, it fails even if I import only Main.Activity so it's not a side effect of prior imported docs  \n22:14\u00a0<vmassol>\u00a0sdumitriu: I thought the problem was in saveXWikiCollection but apparently it's not there  \n22:15\u00a0<vmassol>\u00a0Ive modified the call to saveXWikiCollection in saveXWikiDoc to pass true instead of false for the transaction param  \n22:15\u00a0<vmassol>\u00a0but it doesn't fail in saveXWikiCollection  \n22:16\u00a0<vmassol>\u00a0hmm unless hibernate nests transaction  \n22:16\u00a0<@cjdelisle>\u00a0note that even if you pass true, if a tx is already begun it won't close it and begin another one.  \n22:16\u00a0<vmassol>\u00a0ie if a tx is started  \n22:16\u00a0<vmassol>\u00a0ahah  \n22:16\u00a0<vmassol>\u00a0cjdelisle: yep ex\u00e9ctly what I was getting at  \n22:17\u00a0<@cjdelisle>\u00a0and it won't commit the tx after it's finished  \n22:17\u00a0<@sdumitriu>\u00a0I don't think it's related to transactions, why do you go that way?  \n22:17\u00a0<vmassol>\u00a0so indeed it doesn't prove anything  \n22:17\u00a0<vmassol>\u00a0sdumitriu: I just wanted to verify the exact call we make  \n22:17\u00a0<vmassol>\u00a0with the exact values we pass  \n22:18\u00a0<vmassol>\u00a0anyway I didn't prove anything  \n22:19\u00a0<@cjdelisle>\u00a0I don't like that piece of code very much, it's one of those \"smooth over 90% of all bad situations, fail spectacularly in the other 10%\"  \n22:24\u00a0<vmassol>\u00a0ok I have a breakpoint on \u00a0the baseobject that fails to be saved  \n22:24\u00a0<vmassol>\u00a0but it looks ok  \n22:27\u00a0<vmassol>\u00a0I have the breakpoint on: session.save(\"com.xpn.xwiki.objects.BaseObject\", object);  \n22:39\u00a0<vmassol>\u00a0ok stopping for today\u2026  \n22:39\u00a0<vmassol>\u00a0nn  \n22:39\u00a0<vmassol>\u00a0has quit  \n23:05\u00a0<jvelociter>\u00a0has quit  \n23:32\u00a0<abusenius>\u00a0has quit  \n\n"}