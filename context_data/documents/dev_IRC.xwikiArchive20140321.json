{"id": "dev:IRC.xwikiArchive20140321", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20140321", "title": "IRC Archive for channel #xwiki on 21 March 2014 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<vmassol>\u00a0has quit  \n00:41\u00a0<lucaa>\u00a0has quit  \n00:58\u00a0<vmassol>\u00a0has joined #xwiki  \n01:03\u00a0<vmassol>\u00a0has quit  \n01:13\u00a0<abusenius\\_>\u00a0has quit  \n01:19\u00a0<Denis>\u00a0has quit  \n01:59\u00a0<vmassol>\u00a0has joined #xwiki  \n02:03\u00a0<vmassol>\u00a0has quit  \n03:00\u00a0<vmassol>\u00a0has joined #xwiki  \n03:04\u00a0<vmassol>\u00a0has quit  \n03:21\u00a0<Denis>\u00a0has joined #xwiki  \n03:29\u00a0<fcharton>\u00a0has quit  \n03:32\u00a0<sdumitriu>\u00a0is now known as <sdumitriu\\_[Away]>  \n03:34\u00a0<fcharton>\u00a0has joined #xwiki  \n04:00\u00a0<vmassol>\u00a0has joined #xwiki  \n04:05\u00a0<vmassol>\u00a0has quit  \n04:35\u00a0<polx\\_>\u00a0has joined #xwiki  \n04:38\u00a0<polx>\u00a0has quit  \n04:38\u00a0<polx\\_>\u00a0is now known as <polx>  \n05:01\u00a0<vmassol>\u00a0has joined #xwiki  \n05:05\u00a0<vmassol>\u00a0has quit  \n05:49\u00a0<Chuguniy>\u00a0has quit  \n06:01\u00a0<Denis>\u00a0has quit  \n06:02\u00a0<vmassol>\u00a0has joined #xwiki  \n06:06\u00a0<vmassol>\u00a0has quit  \n06:44\u00a0<mflorea>\u00a0has joined #xwiki  \n06:55\u00a0<polx>\u00a0has quit  \n07:03\u00a0<vmassol>\u00a0has joined #xwiki  \n07:07\u00a0<vmassol>\u00a0has quit  \n07:25\u00a0<andreeapopescu>\u00a0has joined #xwiki  \n07:32\u00a0<evalica>\u00a0has joined #xwiki  \n07:42\u00a0<polx>\u00a0has joined #xwiki  \n07:56\u00a0<polx>\u00a0has quit  \n08:05\u00a0<xwikibot>\u00a0has joined #xwiki  \n08:17\u00a0<tmortagne>\u00a0has joined #xwiki  \n08:30\u00a0<vmassol>\u00a0good morning  \n08:30\u00a0<vmassol>\u00a0tmortagne: seems XE doesn't start becuase of some aether error. All func tests are failing. My guess is that it's caused by the maven upgrade of yesterday  \n08:30\u00a0<vmassol>\u00a0other topic: does anyone also have a problem displaying this page: https://www.evernote.com/shard/s119/sh/cd6dd3e3-5cad-4aa1-b69e-7f00a4e8ec02/9d1ebe94e1d21a51ab84d1a26025432a (link: http://platform.xwiki.org/xwiki/bin/view/DevGuide/UseCacheComponent)  \n08:31\u00a0<vmassol>\u00a0?  \n08:31\u00a0<tmortagne>\u00a0by problem you mean the weird [] here and there ?  \n08:31\u00a0<vmassol>\u00a0yes  \n08:31\u00a0<vmassol>\u00a0the 3 arrows I put  \n08:32\u00a0<vmassol>\u00a0you also this tmortagne?  \n08:32\u00a0<tmortagne>\u00a0I guess we have a regression with xwiki/1.0 syntax  \n08:32\u00a0<tmortagne>\u00a0yes (I was talking about what I see, did not look at your image :))  \n08:33\u00a0<vmassol>\u00a0hmm we need to test this quickly because if it's a regression we need to fix in 5.4.3  \n08:33\u00a0<DarkKnightCZ>\u00a0has joined #xwiki  \n08:33\u00a0<tmortagne>\u00a0yes  \n08:33\u00a0<vmassol>\u00a0checking xwiki 5.4  \n08:35\u00a0<tmortagne>\u00a0I saw the XE error yesterday but I tough it was just jenkins timing issue since those error don't make much sense, org/codehaus/plexus/component/repository/exception/ComponentLookupException class is supposed to be thre  \n08:35\u00a0<tmortagne>\u00a0I will look at that  \n08:36\u00a0<KermitTheFragger>\u00a0has joined #xwiki  \n08:36\u00a0<tmortagne>\u00a0(plus a missing class like that would make platform fail too IMO)  \n08:37\u00a0<tmortagne>\u00a0\u00a0XWiki Platform - Tools - Packager is failing several times a day, it's starting to be quite a pain  \n08:38\u00a0<vmassol>\u00a0I don't have the problem on a standalone 5.4  \n08:39\u00a0<vmassol>\u00a0now I've found another problem  \n08:39\u00a0<vmassol>\u00a0even if I add xwiki/1.0 in the list of sytaxes, it doesn't appear in edit mode in the select box  \n08:40\u00a0<vmassol>\u00a0checking 5.4.2  \n08:41\u00a0<vmassol>\u00a0hmmmmm  \n08:41\u00a0<vmassol>\u00a0just started a 5.4.2 and got:  \n08:41\u00a0<tmortagne>\u00a0vmassol: this is on purpose AFAIK  \n08:41\u00a0<vmassol>\u00a02014-03-21 08:40:54,622 [Active Installs Ping Thread] WARN \u00a0a.i.c.ActiveInstallsPingThread - Failed to send Active Installation ping to [http://extensions.xwiki.org/activeinstalls]. Error = [NullPointerException: ]. Will retry in [86400] seconds...  \n08:41\u00a0<tmortagne>\u00a0the fact that you can't use xwiki/1.0  \n08:41\u00a0<tmortagne>\u00a0(except for page already in xwiki/1.0 syntax)  \n08:41\u00a0<vmassol>\u00a0why?  \n08:42\u00a0<vmassol>\u00a0it's not normal  \n08:42\u00a0<vmassol>\u00a0it should be off by default for sure  \n08:42\u00a0<vmassol>\u00a0but the user adds it it shouldbe visible no?  \n08:42\u00a0<vmassol>\u00a0I don't see why we wouldn't do that  \n08:44\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0#if ($configuredSyntaxes.contains($syntax.toIdString()) &amp;&amp; !$syntax.toIdString().equalsIgnoreCase('xwiki/1.0'))  \n08:44\u00a0<tmortagne>\u00a0http://jira.xwiki.org/browse/XWIKI-8988  \n08:45\u00a0<vmassol>\u00a0and I didn't agree and still don't  \n08:45\u00a0<tmortagne>\u00a0you did not reverted it  \n08:45\u00a0<vmassol>\u00a0yes I was waiting for an explanation from sergiu  \n08:45\u00a0<tmortagne>\u00a0:D  \n08:46\u00a0<vmassol>\u00a0I still believe we should revert this  \n08:46\u00a0<vmassol>\u00a0I don't see the point  \n08:46\u00a0<vmassol>\u00a0the improtant part is that it's off by default  \n08:46\u00a0<vmassol>\u00a0hardcoding it is a bad idea IMO  \n08:47\u00a0<vmassol>\u00a0does anyone here agree with me?  \n08:47\u00a0<vmassol>\u00a0if so, I'll send a mail  \n08:48\u00a0<evalica>\u00a0has quit  \n08:49\u00a0<tmortagne>\u00a0any special case is an issue IMO  \n08:53\u00a0<vmassol>\u00a0mail sent  \n08:53\u00a0<vmassol>\u00a0now checking activeinstalls this is worrying me  \n08:56\u00a0<cjd>\u00a0has joined #xwiki  \n08:58\u00a0<tmortagne>\u00a0vmassol: note that you seemed to finally agreed with it and and even explained it in the configuration in https://github.com/xwiki/xwiki-platform/commit/8153b0e4bb8f6d8c5f7704d96c4ba6dc0589c232#diff-0  \n08:59\u00a0<vmassol>\u00a0no I commented what was missing  \n08:59\u00a0<vmassol>\u00a0so that the doc is aligned with the code  \n08:59\u00a0<tmortagne>\u00a0ou commut is after your comment  \n08:59\u00a0<tmortagne>\u00a0commit  \n08:59\u00a0<vmassol>\u00a0anyway doesn't change the fact that I still don't agree with it  \n08:59\u00a0<vmassol>\u00a0:)  \n08:59\u00a0<vmassol>\u00a0hiding it is ok  \n08:59\u00a0<vmassol>\u00a0but not allowing it is a bit harsh  \n09:00\u00a0<tmortagne>\u00a0how would you hide it ?  \n09:00\u00a0<vmassol>\u00a0the way it's done  \n09:00\u00a0<vmassol>\u00a0well actually  \n09:00\u00a0<vmassol>\u00a0I'd keep it in the doc in xwiki.cfg  \n09:01\u00a0<vmassol>\u00a0but with a text saying it's depredcated and shouldn't be used  \n09:01\u00a0<tmortagne>\u00a0what do you mean by \"the way it's done\" since your sent a mail to revert the way it's currently done  \n09:02\u00a0<vmassol>\u00a0you were talking about xwiki.cfg  \n09:02\u00a0<woshilapin>\u00a0has joined #xwiki  \n09:02\u00a0<vmassol>\u00a0my reply was for xwiki.cfg  \n09:02\u00a0<tmortagne>\u00a0no I was saying that you gave yourself an argument for disabling it totally in xwiki.cfg  \n09:03\u00a0<vmassol>\u00a0I don't understand  \n09:03\u00a0<vmassol>\u00a0what I'd like to do is:  \n09:03\u00a0<vmassol>\u00a01) remove the if in the panel  \n09:03\u00a0<vmassol>\u00a02) update the doc in xwiki.cfg to mention it's deprecated and shouldn't be used  \n09:03\u00a0<tmortagne>\u00a0so it's not hidden, it's just not enabled by default  \n09:03\u00a0<vmassol>\u00a0yes  \n09:04\u00a0<vmassol>\u00a0and if one day we allow setting the syntax from the UI  \n09:04\u00a0<cjd>\u00a0When did syntax2 come out? 2009 or 2008?  \n09:04\u00a0<vmassol>\u00a0we could decide to not show it in the UI  \n09:04\u00a0<vmassol>\u00a0and only allow users to edit xwiki.cfg to set it  \n09:04\u00a0<vmassol>\u00a0(allowed syntaxes I mean)  \n09:05\u00a0<vmassol>\u00a0ie you have to know what you're doing to use it  \n09:05\u00a0<tmortagne>\u00a0cjd: 1.8 or 1.9 I think  \n09:05\u00a0<cjd>\u00a0Yeah, that's the first version of XWiki that I played with so probably 2009  \n09:08\u00a0<sbaloul>\u00a0has joined #xwiki  \n09:08\u00a0<cjd>\u00a0My annoying comment of the day is that if it's been \"kinda deprecated\" for 5 years, in another 5 years it's not going to be any easier to tell a user \"look, we're removing this\" than it is now.  \n09:10\u00a0<vmassol>\u00a0my email doesn't change anything on this regards  \n09:10\u00a0<vmassol>\u00a0the goal has always been and still is  \n09:10\u00a0<vmassol>\u00a0to extract xwiki/1.0 rendering engine from the core and put in legacy  \n09:10\u00a0<vmassol>\u00a0\\* put it  \n09:10\u00a0<vmassol>\u00a0I don't think it's that hard to do  \n09:11\u00a0<vmassol>\u00a0xwiki/1.0 is already removed  \n09:11\u00a0<vmassol>\u00a0and has been removed since xwiki syntax 2.0 was out  \n09:11\u00a0<vmassol>\u00a0(from a user pov)  \n09:29\u00a0<tmortagne>\u00a0vmassol: it's not that easy either, we have tons of if (syntax=xwiki/1.0) because it's a completely dfferent engine than all the other syntaxes  \n09:32\u00a0<sbaloul2>\u00a0has joined #xwiki  \n09:33\u00a0<sbaloul>\u00a0has quit  \n09:45\u00a0<sbaloul2>\u00a0is now known as <sbaloul>  \n09:52\u00a0<vmassol>\u00a0tmortagne: yes\u2026 I guess one real solution would be to implement a RenderingEngine interface and register supported syntaxes against it and 2 impls, one for the xwiki-rendering module and one for the old rendering engine  \n09:52\u00a0<vmassol>\u00a0or maybe not, not sure if we can find common interface  \n09:52\u00a0<vmassol>\u00a0would need to think about it  \n09:52\u00a0<tmortagne>\u00a0there is no real common interface  \n09:53\u00a0<tmortagne>\u00a0or there is one but that's one getting html  \n09:53\u00a0<tmortagne>\u00a0can't go deeper  \n09:53\u00a0<vmassol>\u00a0actually  \n09:54\u00a0<vmassol>\u00a0we just need to gather all the methods where we do an IF  \n09:54\u00a0<vmassol>\u00a0put them in an interface  \n09:54\u00a0<vmassol>\u00a0and then have the 2 implementations ;)  \n09:54\u00a0<vmassol>\u00a0ugly obviously  \n09:54\u00a0<vmassol>\u00a0no it wouldn't :)  \n09:54\u00a0<vmassol>\u00a0other option is just to use aspects  \n09:55\u00a0<vmassol>\u00a0to remove all the xwiki/1.0 \"ifs\"  \n09:55\u00a0<vmassol>\u00a0it would mean a build time dep and you'd need to build XE with syntax 1.0 if you needed it  \n09:55\u00a0<vmassol>\u00a0that could work  \n09:56\u00a0<vmassol>\u00a0(but over time it would break but maybe not a big deal)  \n09:57\u00a0<tmortagne>\u00a0sounds like a nightmare to maintaing, I think I prefer the internal crappy interface  \n09:57\u00a0<tmortagne>\u00a0we can always try and see what we got  \n09:58\u00a0<vmassol>\u00a0yes, that interface would be in the internal package obviously  \n09:58\u00a0<tmortagne>\u00a0the issue is more the placed where we test for xwiki/1.0 because we don't want to do anything  \n09:58\u00a0<tmortagne>\u00a0s/placed/places/  \n09:58\u00a0<vmassol>\u00a0yes there might be a need for several such internal interfaces and not just one  \n10:00\u00a0<vmassol>\u00a0wow not nice:  \n10:00\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0// Save the configured syntaxes  \n10:01\u00a0<vmassol>\u00a0in initXWiki()  \n10:01\u00a0<vmassol>\u00a0should probably be 2.1 if the property is not defined  \n10:01\u00a0<tmortagne>\u00a0actually it should be the default syntax probably  \n10:01\u00a0<vmassol>\u00a0we have that?  \n10:02\u00a0<vmassol>\u00a0I don't remember an api for getting the default syntax  \n10:02\u00a0<vmassol>\u00a0there's some code in XwikiDocument but it's not separate  \n10:02\u00a0<vmassol>\u00a0maybe I just don't remember some place  \n10:03\u00a0<vmassol>\u00a0ah yes we do  \n10:03\u00a0<vmassol>\u00a0CoreConfiguration.getDefaultDocumentSyntax  \n10:05\u00a0<tmortagne>\u00a0yes we have default syntax  \n10:05\u00a0<vmassol>\u00a0we should also supporting xwiki/1.0 here: https://gist.githubusercontent.com/vmassol/9682369/raw/bc45e1111d4b27015d4fe7b2c13075493d9198c4/gistfile1.txt  \n10:06\u00a0<vmassol>\u00a0(that's easy to do)  \n10:09\u00a0<tmortagne>\u00a0actually for this one IMO we should have a user template instead  \n10:10\u00a0<tmortagne>\u00a0plus the include is totally useless with new sheet system  \n10:10\u00a0<tmortagne>\u00a0there is no much value in continue to support creating new user in xwiki/1.0 syntax  \n10:10\u00a0<vmassol>\u00a0yes that was my point  \n10:11\u00a0<tmortagne>\u00a0anyway doing that interface would be a good occasion to review all those codes  \n10:11\u00a0<vmassol>\u00a0yes  \n10:11\u00a0<vmassol>\u00a0I've browsed some code quickly and in lots of places we just don't need to continue checking for xwiki/1.0 syntax  \n10:12\u00a0<vmassol>\u00a0so we don't even need an interface for these places  \n10:12\u00a0<tmortagne>\u00a0ok  \n10:12\u00a0<vmassol>\u00a0so we may not have that many methods to add to the interface  \n10:12\u00a0<tmortagne>\u00a0that could be nice  \n10:12\u00a0<vmassol>\u00a0include, headings, title  \n10:13\u00a0<tmortagne>\u00a0content :)  \n10:13\u00a0<vmassol>\u00a0display  \n10:13\u00a0<tmortagne>\u00a0backlinks  \n10:14\u00a0<tmortagne>\u00a0some legacy sheet system hacks (matching #include and things like this)  \n10:15\u00a0<tmortagne>\u00a0extract old engine as extension would certainly lighten a lot oldcore  \n10:15\u00a0<evalica>\u00a0has joined #xwiki  \n10:33\u00a0<ClemensR>\u00a0has joined #xwiki  \n10:53\u00a0<lucaa>\u00a0has joined #xwiki  \n10:56\u00a0<Denis>\u00a0has joined #xwiki  \n10:58\u00a0<sbaloul>\u00a0Hi  \n10:58\u00a0<sbaloul>\u00a0I want to report an issue on commons (http://jira.xwiki.org/browse/XCOMMONS)  \n10:59\u00a0<sbaloul>\u00a0I don't have enough permission to do it  \n10:59\u00a0<sbaloul>\u00a0my id : sbaloul  \n11:00\u00a0<sbaloul>\u00a0can someone give some permission to me please ?  \n11:15\u00a0<andreeapopescu>\u00a0has quit  \n11:17\u00a0<tmortagne>\u00a0sbaloul: you can't create an issue on commons ? that seems very weird to me  \n11:17\u00a0<tmortagne>\u00a0commons is not listed in \"Project\" when you create a new issue ?  \n11:17\u00a0<tmortagne>\u00a0AFAIK commons has the exact same configuration than platform and rendering  \n11:18\u00a0<tmortagne>\u00a0commons is supposed to be totally open  \n11:20\u00a0<andreeapopescu>\u00a0has joined #xwiki  \n11:20\u00a0<sbaloul>\u00a0Yes, you're right. I can create issue  \n11:21\u00a0<sbaloul>\u00a0I've not been logged yet, why I couldn't create issue :(  \n11:22\u00a0<sbaloul>\u00a0thank you tmortagne ;)  \n11:22\u00a0<tmortagne>\u00a0ok  \n12:22\u00a0<andreeapopescu>\u00a0has quit  \n12:44\u00a0<sbaloul>\u00a0has quit  \n12:46\u00a0<sbaloul>\u00a0has joined #xwiki  \n13:27\u00a0<vmassol>\u00a0ClemensR: we have lots of functional tests in platform already  \n13:28\u00a0<ClemensR>\u00a0ah, yes, I see now  \n13:28\u00a0<vmassol>\u00a0you could check the activeinstalls module, the irc module, etc  \n13:28\u00a0<vmassol>\u00a0adimnistration module  \n13:28\u00a0<ClemensR>\u00a0I misunderstood your idea , and thought I shoyld have written a unit test instead  \n13:28\u00a0<vmassol>\u00a0you can copy the way they do it  \n13:28\u00a0<vmassol>\u00a0this I don't know  \n13:28\u00a0<vmassol>\u00a0:)  \n13:28\u00a0<vmassol>\u00a0I haven't checked the code  \n13:28\u00a0<ClemensR>\u00a0find xwiki-platform-core/ -name \\\\*-test-tests \u00a0\u00a0\u00a0and I see them :)  \n13:28\u00a0<vmassol>\u00a0es  \n13:28\u00a0<vmassol>\u00a0yes  \n13:30\u00a0<ClemensR>\u00a0I do not know how to copy the files from the xwiki-enterprise repo into the xwiki-platform repo without loosing history ... but Iguess it is ok if I just plain copy them ?  \n13:30\u00a0<ClemensR>\u00a0er: s/copy/move/g  \n13:30\u00a0<vmassol>\u00a0yes  \n13:30\u00a0<ClemensR>\u00a0ok, then I know how to proceed, thanks  \n13:31\u00a0<vmassol>\u00a0thanks!  \n13:36\u00a0<vmassol>\u00a0argh....  \n13:37\u00a0<vmassol>\u00a0just finihed debugging the active install ping issue I've found this morning in 5.4.2  \n13:38\u00a0<vmassol>\u00a0the issue I can see is the move to ES 1.0.1  \n13:38\u00a0<vmassol>\u00a0OTOH I can see on http://activeinstalls.xwiki.org/kibana/#dashboard/temp/vRZK3kboQ6Wwv9bFJuG7ow that we have pings from 5.4.2 instances...  \n13:39\u00a0<vmassol>\u00a0but locally the reason is pretty clear  \n13:39\u00a0<vmassol>\u00a0the reason is that ES 1.0 has remove the \"ok\" result  \n13:39\u00a0<vmassol>\u00a0(see http://www.elasticsearch.org/guide/en/elasticsearch/reference/1.x/\\_return\\_values.html )  \n13:39\u00a0<vmassol>\u00a0\"the 'ok' return value has been removed from all response bodies as it added no useful information.\"  \n13:40\u00a0<vmassol>\u00a0and the fwk we use (jest) is using that to check the result  \n13:40\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0return result.get(\"ok\").getAsBoolean();  \n13:40\u00a0<vmassol>\u00a0thus result.get(\"ok\") returns null and this generates a NPE  \n13:41\u00a0<vmassol>\u00a0now I still need to understand why I have some results in ES for 5.4.2 after the upgrade to ES 1.0.1....  \n13:42\u00a0<vmassol>\u00a0msmeria: could you try on your machine to run a xwiki 5.4.x version  \n13:42\u00a0<vmassol>\u00a0and let me know if you have a ping error  \n13:42\u00a0<msmeria>\u00a0vmassol: hello  \n13:43\u00a0<vmassol>\u00a0(you just need to start xwiki, call a page and verify the console)  \n13:43\u00a0<msmeria>\u00a0I do have a ping error related to Active Installs each time I start XWiki  \n13:43\u00a0<vmassol>\u00a0oh I know  \n13:43\u00a0<vmassol>\u00a0no need  \n13:43\u00a0<vmassol>\u00a0the ping is sent  \n13:43\u00a0<vmassol>\u00a0it's just the result that is wrongly analyzed  \n13:43\u00a0<vmassol>\u00a0so it prints the errors  \n13:43\u00a0<vmassol>\u00a0well you can still try but you'll get a NPE I'm sure  \n13:44\u00a0<vmassol>\u00a0pfew\u2026. less bad than I thought  \n13:44\u00a0<vmassol>\u00a0(and fixed in 5.4.3)  \n13:46\u00a0<msmeria>\u00a0vmassol: \"2014-03-21 14:45:27,372 [Active Installs Ping Thread] WARN \u00a0a.i.c.ActiveInstallsPingThread - Failed to send Active Installation ping to [http://extensions.xwiki.org/activeinstalls]. Error = [NullPointerException: ]. Will retry in  \n13:46\u00a0<vmassol>\u00a0yep  \n13:46\u00a0<vmassol>\u00a0ok I understand fully everything now  \n13:46\u00a0<vmassol>\u00a0thanks  \n13:46\u00a0<msmeria>\u00a0yw  \n13:46\u00a0<vmassol>\u00a0so all our XWiki instances > 5.2 and < 5.4.3 will have this in their console....  \n13:47\u00a0<vmassol>\u00a0>= 5.2M2 to be precise  \n13:48\u00a0<vmassol>\u00a0the only way to remove it is to downgrade to the previous version of ES and change the code for 5.4.3 and 6.0M1 to support both ES < 1.0.0 and ES > 1.0.0  \n13:48\u00a0<vmassol>\u00a0we need to take a call  \n13:48\u00a0<vmassol>\u00a0Denis, tmortagne, mflorea, ClemensR, all: WDYT?  \n13:49\u00a0<vmassol>\u00a0note that rolling back ES means keeping an old pre 1.0 version for a long time (ie at least \u00a01 year)  \n13:50\u00a0<vmassol>\u00a0hmm another option would be to modify the response sent by ES  \n13:50\u00a0<ClemensR>\u00a0I have to admit that I have seen then the NPE in my 6.0-snapshot but did not worry too much about it ....  \n13:51\u00a0<ClemensR>\u00a0how about only rolling back on 5.4.x branch ?  \n13:51\u00a0<vmassol>\u00a0errr?  \n13:51\u00a0<vmassol>\u00a0ES is on xwiki.org  \n13:51\u00a0<vmassol>\u00a0:)  \n13:51\u00a0<Denis>\u00a0is it possible to modify ES response to match the caller ?  \n13:52\u00a0<vmassol>\u00a0Denis: that's the idea I was mentioning above by \"hmm another option would be to modify the response sent by ES\"  \n13:52\u00a0<vmassol>\u00a0it probably requires some apache level stuff  \n13:52\u00a0<vmassol>\u00a0basically it means changing the returned JSON  \n13:52\u00a0<vmassol>\u00a0to add the \"ok\" field  \n13:53\u00a0<Denis>\u00a0could mod\\_substitute be a solution for that ?  \n13:53\u00a0<vmassol>\u00a0according to http://www.elasticsearch.org/guide/en/elasticsearch/reference/1.x/\\_return\\_values.html the field has been removed altogether  \n13:53\u00a0<vmassol>\u00a0so we need to add the field  \n13:55\u00a0<vmassol>\u00a0there might be some way in ES to add result filters or something like this  \n13:55\u00a0<vmassol>\u00a0I'm googling  \n13:57\u00a0<DarkKnightCZ>\u00a0tmortagne: hi, i've noticed several issues regarding extension updater, subwiki creation and basically everything that works in asynchronous way... all json requests should have refresh=1 get param... if whole xwiki is cached (rendering cache), all requests returns invalid data (since they're cached)... currently it's not a problem, since rendering cache is broken, but it can occur... also extension updater seems to fail if server returns invalid http co  \n13:58\u00a0<DarkKnightCZ>\u00a0i'm gonna write down everything i've noticed with possible workarounds / fixes  \n14:01\u00a0<GuillaumeF>\u00a0has joined #xwiki  \n14:02\u00a0<evalica>\u00a0has quit  \n14:26\u00a0<DarkKnightCZ>\u00a0has left #xwiki  \n14:44\u00a0<OSIMasson>\u00a0has joined #xwiki  \n14:53\u00a0<ClemensR>\u00a0vmassol: \u00a0it seems I coult use a bit of help with that watchlist tests  \n14:53\u00a0<ClemensR>\u00a0s/coult/could/  \n14:54\u00a0<ClemensR>\u00a0not sure if you have time for that any time soon  \n14:59\u00a0<cjd>\u00a0mflorea: is there any known issue with setSelectionRange() ? I'm getting a weird behavior where \u00a0\u00a0\u00a0\u00a0x = getSelectionRange(); \u00a0setSelectionRange(x); then getSelectionRange returns null  \n15:01\u00a0<mflorea>\u00a0cjd: I'm not aware of such an issue. Which browser?  \n15:01\u00a0<cjd>\u00a0chromium  \n15:01\u00a0<cjd>\u00a0Do you know if setSelectionRange() is used in tests?  \n15:01\u00a0<cjd>\u00a0if it is, I'll just keep debugging my code  \n15:02\u00a0<cjd>\u00a0I'm probably doing something silly like setting it to an element which has been removed from the dom...  \n15:03\u00a0<mflorea>\u00a0you're talking about setSelectionRange from the WYSIWYG editor JS API right? then no, I don't think it is used in tests, here's what is tested from the JS API https://github.com/xwiki/xwiki-enterprise/blob/master/xwiki-enterprise-test/xwiki-enterprise-test-wysiwyg/src/test/it/org/xwiki/test/wysiwyg/NativeJavaScriptApiTest.java  \n15:03\u00a0<mflorea>\u00a0did you try on Firefox?  \n15:04\u00a0<cjd>\u00a0yes, wysiwyg.setSelectionRange()  \n15:05\u00a0<mflorea>\u00a0I don't reproduce on FF  \n15:05\u00a0<mflorea>\u00a0is the selection empty (caret) or not?  \n15:06\u00a0<cjd>\u00a0it's the >body>  \n15:06\u00a0<cjd>\u00a0\\*<body>  \n15:06\u00a0<cjd>\u00a0it's what I get and naturally what I set as well  \n15:06\u00a0<mflorea>\u00a0I don't understand  \n15:07\u00a0<mflorea>\u00a0you mean the document is empty?  \n15:07\u00a0<vmassol>\u00a0ClemensR: otp ATM, I can help after or you could get help from others (mflorea, tmortagne just to cite 2 ;))  \n15:08\u00a0<ClemensR>\u00a0well, maybe someone can tell me where the functional tests in platform know which wiki pages it install  \n15:09\u00a0<tmortagne>\u00a0ClemensR: it install all you have in dependencies of your project AFAIK  \n15:09\u00a0<ClemensR>\u00a0I am posting the watchlists tests to platform, and the integration tests work if running against an existing instance, \u00a0but if it construct its own then the wiki is empty  \n15:09\u00a0<ClemensR>\u00a0ok, seems I have been missing the dependencies, checking ....  \n15:10\u00a0<tmortagne>\u00a0well it's almost empty yes, you don't get the whole XE in thoses tests  \n15:10\u00a0<tmortagne>\u00a0only what your extension needs  \n15:10\u00a0<tmortagne>\u00a0(plus a few stuff included all the time)  \n15:11\u00a0<cjd>\u00a0mflorea: doesn't seem to repeat on ff but firebug is spoiling the test by injecting html which is being grabbed so it's hard to be sure  \n15:11\u00a0<mflorea>\u00a0you the native dev tools  \n15:11\u00a0<mflorea>\u00a0s/you/use  \n15:12\u00a0<cjd>\u00a0mm seems to be working  \n15:13\u00a0<mflorea>\u00a0I'm using this script http://pastebin.com/FCacHGak and it works, i.e. the range is not null after setting it  \n15:13\u00a0<mflorea>\u00a0on Firefox  \n15:13\u00a0<ClemensR>\u00a0tmortagne: \u00a0well, \u00a0it does not have the watchlist page, for sure ... but that is a dependency of the ttest. I guess the problem is that the xwiki-platform-tool-packager-plugin does not run in my case  \n15:15\u00a0<tmortagne>\u00a0well if it was not running would would not get an empty instance, you would get nothing  \n15:15\u00a0<tmortagne>\u00a0did you copy/pasted another integration test from platform ?  \n15:15\u00a0<tmortagne>\u00a0I actually never wrote any  \n15:16\u00a0<tmortagne>\u00a0only worked on XE tests but we are starting to have a lot of UI test in platform  \n15:17\u00a0<ClemensR>\u00a0yes, I but I copies frost from activeinstalls, then figured out this needs a custom test runner, and then switched to user-profile  \n15:17\u00a0<ClemensR>\u00a0but ah, I see the pages are imported, it is just that the macro does not work  \n15:18\u00a0<ClemensR>\u00a0I have a vague idea why, but need more debugging  \n15:19\u00a0<tmortagne>\u00a0ok  \n15:19\u00a0<ClemensR>\u00a0anyone knows how I can start the xwiki instance the test uses ? so I do not have to suspend the test orr somethign liek that to look into \u00a0the instance ?  \n15:19\u00a0<cjd>\u00a0mflorea: thanks, script works same for me on chromium so this is just something I screwed up tinkering with body.outerHTML  \n15:19\u00a0<Denis>\u00a0has quit  \n15:20\u00a0<ClemensR>\u00a0ah, sorry, should have put my thinking cap on, of course the instance is somewhere in target/....  \n15:20\u00a0<tmortagne>\u00a0ClemensR: yep  \n15:20\u00a0<cjd>\u00a0mflorea: yeah, that was my thought  \n15:21\u00a0<cjd>\u00a0maybe outerHTML causes a node to \"replace itself\"  \n15:21\u00a0<mflorea>\u00a0it probably does  \n15:21\u00a0<mflorea>\u00a0in fact I'm pretty sure it does  \n15:23\u00a0<mflorea>\u00a0restoring the selection after changing the DOM tree is not simple because you need to reference the new DOM nodes  \n15:27\u00a0<cjd>\u00a0yeah, I had that much figured out, I just didn't expect a node to \"vanish\" when I set it's outerHTML  \n15:37\u00a0<ClemensR>\u00a0argh, now the newly created user in the test has not set its profile to \"autowatch all changes\". Where does this happen? if testing in XE it seems users are set u like this by defult  \n15:40\u00a0<tmortagne>\u00a0ClemensR: it's not enable by default  \n15:40\u00a0<tmortagne>\u00a0hmm wait  \n15:40\u00a0<tmortagne>\u00a0mixing with something else  \n15:41\u00a0<tmortagne>\u00a0a user property is supposed to be whatever is in the xwiki.cfg  \n15:41\u00a0<tmortagne>\u00a0which is enabled by default  \n15:41\u00a0<tmortagne>\u00a0how did you created the user ?  \n15:41\u00a0<ClemensR>\u00a0ah, then it is propably not in the xwiki.cfg, or ... the corresponding \u00a0stuff is mising in the user profile  \n15:41\u00a0<ClemensR>\u00a0checnking ...  \n15:41\u00a0<tmortagne>\u00a0maybe you reused something that explicitely disable it  \n15:42\u00a0<tmortagne>\u00a0by default there is nothing in the profile which makes it fallback on xwiki.cfg  \n15:42\u00a0<ClemensR>\u00a0user is created programatically via: \u00a0getUtil().createUserAndLogin(userName, \"password\");  \n15:43\u00a0<tmortagne>\u00a0createUser() does not seems to disable auto watch  \n15:43\u00a0<ClemensR>\u00a0but I see the user has no profile settings for the watchlist  \n15:44\u00a0<ClemensR>\u00a0so my install is still incomplete ... thats why, sorry, need to get used to \"minimal\" \u00a0installations ...  \n15:44\u00a0<tmortagne>\u00a0do you have watchlist at all ?  \n15:44\u00a0<tmortagne>\u00a0it should probably be a dependency of your macro  \n15:45\u00a0<ClemensR>\u00a0yes, it should be, especially inside the xwiki-platform-watchlist-ui  \n15:46\u00a0<ClemensR>\u00a0there is no \"drop down\" menu in the \"Wiki\" > space > page navigation at all, that makes it hard to say if watchlist is enabled ...  \n15:47\u00a0<ClemensR>\u00a0ah, the `default` settigns for the minimal \u00a0\"xwiki.plugins=....\" \u00a0does not contain the WatchListPlugin  \n15:47\u00a0<ClemensR>\u00a0that might explain it, UI pages there but plugin deactivated :)  \n15:52\u00a0<tmortagne>\u00a0ClemensR: look at ui test for admin app, there is a few plugins required here too as far as I can see in the pom.xml  \n15:52\u00a0<Denis>\u00a0has joined #xwiki  \n15:52\u00a0<ClemensR>\u00a0oh, yes, and I thought I can get away with less ;)  \n15:54\u00a0<msmeria>\u00a0has quit  \n15:54\u00a0<tmortagne>\u00a0ClemensR: that or you convert watchilst plugin in a service ;)  \n15:55\u00a0<ClemensR>\u00a0I thought I could finish this before the end of the weekend ;)  \n15:59\u00a0<vmassol>\u00a0errr someone is staging xwiki stuff on sonatype  \n15:59\u00a0<vmassol>\u00a05.4.2 apparently  \n15:59\u00a0<vmassol>\u00a0is that normal?  \n16:00\u00a0<vmassol>\u00a0(they were missing maybe)  \n16:00\u00a0<vmassol>\u00a0ah yes tmortagne it's you actually, didn't read till the end of the email  \n16:00\u00a0<vmassol>\u00a0thanks!  \n16:01\u00a0<tmortagne>\u00a0I saw it was still not done  \n16:02\u00a0<tmortagne>\u00a0done  \n16:02\u00a0<vmassol>\u00a0cool  \n16:15\u00a0<GuillaumeF1>\u00a0has joined #xwiki  \n16:18\u00a0<GuillaumeF>\u00a0has quit  \n16:40\u00a0<tmortagne>\u00a0has quit  \n16:47\u00a0<OSIMasson>\u00a0has quit  \n17:01\u00a0<Denis>\u00a0has quit  \n17:03\u00a0<ClemensR>\u00a0oh no, the watchlist needs the ActivityEventImpl in the database schema, which is not in the database in my test setup ... but the xwiki-platform-activitystream-api-6.0-SNAPSHOT.jar \u00a0is in the WEB-IN/lib \u00a0\u00a0there must be somethign else that I am missing  \n17:04\u00a0<ClemensR>\u00a0I remember some tests have a custom hibernate configuration, but I cannot find them now :/  \n17:04\u00a0<D-Spair>\u00a0has quit  \n17:06\u00a0<vmassol>\u00a0ClemensR: hmm not sure what the problem is since you have the jar in web-inf/lib indeed...  \n17:06\u00a0<vmassol>\u00a0does your hibernate configuration have the mapping defined?  \n17:07\u00a0<ClemensR>\u00a0it is complaining with a: \u00a0org.hibernate.MappingException: Unknown entity: com.xpn.xwiki.plugin.activitystream.impl.ActivityEventImpl \u00a0... maybe the annotations do not get picked up  \n17:07\u00a0<ClemensR>\u00a0ah, checking ....  \n17:07\u00a0<vmassol>\u00a0btw when in doubt the code to check is PackageMojo  \n17:07\u00a0<vmassol>\u00a0this is the code that creates the xwiki distribution for the test  \n17:09\u00a0<vmassol>\u00a0(in this case generateConfigurationFiles())  \n17:09\u00a0<ClemensR>\u00a0ah, hibernate.cfg.xml has no \u00a0activitystream.hbm.xml \u00a0....  \n17:09\u00a0<ClemensR>\u00a0ok, reading PackageMojo .... I remember one can configure something, just not sure where, \u00a0but it should be in that class, ok  \n17:09\u00a0<vmassol>\u00a0createVelocityContext() is the key here  \n17:09\u00a0<D-Spair>\u00a0has joined #xwiki  \n17:10\u00a0<vmassol>\u00a0and inside:  \n17:10\u00a0<vmassol>\u00a0so you just need to define the velocity properties you need  \n17:10\u00a0<vmassol>\u00a0in your pom.xml inside <properties>  \n17:10\u00a0<vmassol>\u00a0:)  \n17:10\u00a0<vmassol>\u00a0and in hibernate.cfg.vm it needs:  \n17:11\u00a0<vmassol>\u00a0xwikiDbHbmMySQLExtraMappings  \n17:11\u00a0<ClemensR>\u00a0ah, \u00a0that one !  \n17:11\u00a0<vmassol>\u00a0this one or xwikiDbHbmCommonExtraMappings not sure which one  \n17:12\u00a0<vmassol>\u00a0yep  \n17:12\u00a0<vmassol>\u00a0that one  \n17:12\u00a0<vmassol>\u00a0so <xwikiDbHbmCommonExtraMappings>activitystream.hbm.xml</...>  \n17:13\u00a0<vmassol>\u00a0btw  \n17:13\u00a0<vmassol>\u00a0you can see an example in the func tests for activeinstalls :)  \n17:13\u00a0<vmassol>\u00a0it uses: \u00a0\u00a0\u00a0\u00a0<xwikiDbHbmCommonExtraMappings>instance.hbm.xml</xwikiDbHbmCommonExtraMappings>  \n17:23\u00a0<ClemensR>\u00a0yes, I found it here :) ... now looking why the packager tool fails locally but not for the activeinstall tests  \n17:27\u00a0<ClemensR>\u00a0ok, server starts and scheduler / watchlist etc seem to work, now only a failing assertion left ... I hope this is manageable :)  \n17:27\u00a0<vmassol>\u00a0getting better :)  \n17:28\u00a0<vmassol>\u00a0my guess is that the -ui's pom.xml is missing some dependency  \n17:28\u00a0<vmassol>\u00a0just run it in debug mode  \n17:28\u00a0<vmassol>\u00a0you start xwiki from target/xwiki in debug mode  \n17:28\u00a0<vmassol>\u00a0then connect to it from your IDE  \n17:28\u00a0<vmassol>\u00a0and put a breakpoint in the func test  \n17:29\u00a0<vmassol>\u00a0then progress step by step  \n17:29\u00a0<vmassol>\u00a0(ClemensR)  \n17:30\u00a0<ClemensR>\u00a0ah, ok I will try ... actually I now see the watchlist message contains exceptions ....  \n17:35\u00a0<ClemensR>\u00a0phew, missing diff plugin, now it looks like the tests are running  \n17:36\u00a0<vmassol>\u00a0for missing deps, add them either to the api or ui module, not in the test's pom  \n17:36\u00a0<ClemensR>\u00a0I try a second time, just to be sure, but I hope no more questions from my side for today  \n17:36\u00a0<vmassol>\u00a0that's the beauty of these functional tests in platform, they allow us to fix missing or incorrect dependnecies :)  \n17:37\u00a0<ClemensR>\u00a0ah, yes, I had to add a few of them already (I hope correctly), but as the DiffPlugin is an \"old style\" thing, it needs to be added to \"<xwikiCfgPlugins>\" in test, too, to be activated  \n17:38\u00a0<vmassol>\u00a0yup  \n17:38\u00a0<OSIMasson>\u00a0has joined #xwiki  \n17:38\u00a0<ClemensR>\u00a0the WatchlistMacro test takes ages to run because my XPath performs quite poor, but I hope that is ok for today ....  \n17:39\u00a0<vmassol>\u00a0yeah, xpath should be avoided as much as possible in favor of id or classes but sometimes it's not possible  \n18:02\u00a0<KermitTheFragger>\u00a0has quit  \n18:13\u00a0<sdumitriu\\_[Away]>\u00a0is now known as <sdumitriu>  \n18:15\u00a0<ClemensR>\u00a0phew, watchlists tests pass on jenkins \u00a0now, too ... \u00a0I better call it a week now. Thanks for all the advice!  \n18:18\u00a0<woshilapin>\u00a0has quit  \n18:27\u00a0<ClemensR>\u00a0there are a bit odd inline styles on http://extensions.xwiki.org/xwiki/bin/edit/Extension/Watchlist+Application \u00a0with fixed font size.  \n18:33\u00a0<sbaloul>\u00a0has quit  \n18:34\u00a0<mflorea>\u00a0has quit  \n18:51\u00a0<ClemensR>\u00a0I removed the font-sizes and rephrased the email-setup section. feel free to roll back, of course  \n18:52\u00a0<cjd>\u00a0has quit  \n19:15\u00a0<ClemensR>\u00a0has quit  \n19:33\u00a0<abusenius\\_>\u00a0has joined #xwiki  \n19:52\u00a0<GuillaumeF1>\u00a0has quit  \n20:22\u00a0<D-Spair>\u00a0has quit  \n21:31\u00a0<OSIMasson>\u00a0has quit  \n21:45\u00a0<lucaa>\u00a0has quit  \n21:56\u00a0<polx>\u00a0has joined #xwiki  \n22:54\u00a0<UCC>\u00a0has joined #xwiki  \n22:54\u00a0<unknown\\_>\u00a0has joined #xwiki  \n23:35\u00a0<polx>\u00a0has quit  \n23:39\u00a0<vmassol>\u00a0has quit  \n23:41\u00a0<polx>\u00a0has joined #xwiki\n"}