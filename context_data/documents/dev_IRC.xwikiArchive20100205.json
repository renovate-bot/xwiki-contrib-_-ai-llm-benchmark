{"id": "dev:IRC.xwikiArchive20100205", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20100205", "title": "IRC Archive for channel #xwiki on 5 Feb 2010 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n{{{  \nxwikibot joined #xwiki at 08:51  \nbblfish left at 08:57 (Remote host closed the connection  \nxenon75 joined #xwiki at 09:09  \nxenon75 left at 09:11 (Client Quit  \nvmassol - (09:14): CalebJamesDeLisl: is this patch valid/up to date: http://jira.xwiki.org/jira/browse/XWIKI-4410 ?  \nCalebJamesDeLisl - (09:14): I don't think so as of jv's change.  \nCalebJamesDeLisl - (09:16): Oh, that one might still be good.  \nvmassol - (09:16): the methods added in Api.java look a bit strange  \nCalebJamesDeLisl - (09:16): I was thinking of the change to the attachments LiveTable.  \nCalebJamesDeLisl - (09:18): There is a convert method for Document so I followed along.  \nvmassol - (09:18): ok  \nmflorea - (09:18): guys, DocumentAccessBridge#pushDocumentInContext is still using string reference. I'd like to deprecate it and add a new method which gets a DocumentReference, wdyt?  \nvmassol - (09:18): +1  \nvmassol - (09:19): everything using string must be deprecated and use DR  \nvmassol - (09:19): we've already voted that actually  \nvmassol - (09:19): so go ahead! :)  \nmflorea - (09:19): ok, doing it  \nvmassol - (09:19): and hi marius!  \nmflorea - (09:19): :) hi vincent!  \ntmortagne joined #xwiki at 09:39  \nbblfish joined #xwiki at 09:49  \nKermitTheFragger joined #xwiki at 09:58  \nKermitTheFragger left at 09:59 (Client Quit  \nKermitTheFragger joined #xwiki at 09:59  \nsilviar joined #xwiki at 10:13  \njvdrean joined #xwiki at 10:16  \nlucaa joined #xwiki at 10:29  \nbblfish left at 10:43 (Ping timeout: 245 seconds  \nbblfish joined #xwiki at 10:44  \nlucaa left at 10:51 (Quit: Leaving.  \nbblfish left at 10:52 (Ping timeout: 265 seconds  \nbblfish joined #xwiki at 10:54  \nlucaa joined #xwiki at 10:54  \nvmassol - (10:59): lucaa: should http://jira.xwiki.org/jira/browse/XWIKI-3784 be closed?  \nvmassol - (10:59): it has a fix for of 2.2 but your last comment  \nvmassol - (10:59): says it's been done  \nvmassol - (10:59): it even says it was committed in 1.9!  \nlucaa - (10:59): hi Vincent, lemme check  \nlucaa - (11:00): it doesn't say it was fixed, it was fixed part of the damage it's doing  \nlucaa - (11:01): it's a bit of a special english there, but if you try really hard it's understandable :)  \nvmassol - (11:01): in any case it's planned for 2.2 is that right?  \nvmassol - (11:01): smae for http://jira.xwiki.org/jira/browse/XWIKI-3741  \nlucaa - (11:01): well, it's the issues we've been postponing  \nlucaa - (11:02): for 3784 it's kind of difficult to fix, I should move it to Marius since he was looking at a fix last time  \nlucaa - (11:02): (it's a command execution issue)  \nvmassol - (11:02): if nobody has been working on it then maybe it should be moved to 2.2.1 ?  \nlucaa - (11:02): as for 3741, we talked about it on the last release, and we agreed that I should de-assign myself since I'm not working on them  \nvmassol - (11:03): mflorea/lucaa: could you agree about when they should be fixed and put the correct assignee?  \nvmassol - (11:03): (and set the fix for)  \nvmassol - (11:03): (to what we want it to be)  \nbblfish left at 11:03 (Ping timeout: 252 seconds  \nvmassol - (11:04): final is still planned for Monday FTM  \nmflorea - (11:07): vmassol/lucaa: anca, unassign issues you don't plan to work on in the near future and set the fix for to future. I'll look at the unassigned issues and see what I can handle.  \nlucaa - (11:08): ok  \nbblfish joined #xwiki at 11:12  \nvmassol - (11:13): if someone has the time today it would be great to install the 2.2 RC on myxwiki.org  \nvmassol - (11:14): so that we have 3 days of tests with it before the monday release  \nvmassol - (11:14): who could do this?  \nlucaa - (11:16): mflorea: done  \nmflorea - (11:16): lucaa: ok, thanks  \nsdumitriu - (11:17): vmassol: I could, a bit later  \nvmassol - (11:19): ok thanks, the sooner the better. HAve you done it before? Otherwise there's doc on http://myxwiki.org/xwiki/bin/view/XWiki/Upgrading  \nsdumitriu - (11:21): Yes, done several times  \nvmassol - (11:21): ok  \nvmassol - (11:21): lucaa/mflorea: this http://jira.xwiki.org/jira/browse/XWIKI-3741 sounds pretty important, isn't it? Shouldn't be plan it for 2.2.1?  \nvmassol - (11:22): same for http://jira.xwiki.org/jira/browse/XWIKI-3784  \nlucaa - (11:22): 3784 is tricky last time I heard about it  \nlucaa - (11:23): 3741 is just work & refactor, somebody needs to set himself to do it  \nmflorea - (11:23): vmassol: no votes, no comments, no complains on the list, no complains from the client projects. I don't this they are critical. I can plan them for 2.3  \nvmassol - (11:23): I mean anything that modifies content you have in wiki mode is critivcal to me  \nlucaa - (11:23): and yes, as I mentioned last time we talked about those issues, I 100% agree with mflorea  \nvmassol - (11:23): since that was the main reason for thenew wysiwyg editor  \nvmassol - (11:24): (why we decided to rewrite it vs tinymce)  \nlucaa - (11:24): vmassol: I don't understand, wdym modify the content you have in wiki mode?  \nmflorea - (11:24): yes, but since users didn't complained about it, it means they rarely use custom parameters on images and links  \nlucaa - (11:24): as in 'will mess it up'?  \nvmassol - (11:25): mflorea: I guess it depends if you have more critical ones for 2.2.1  \nmflorea - (11:25): ok, I read 2.1.2, you said 2.2.1. In this case it might be possible. When is 2.2.1 planed?  \nvmassol - (11:26): I'd say 1 or 2 weeks after 2.2 final is released  \nvmassol - (11:26): 1 if something blocking is found  \nvmassol - (11:26): and 2 weeks if it's just maintaiancne without a real blocker  \nmflorea - (11:26): ok, I'll try to handle them  \nvmassol - (11:26): ok cool  \nvmassol - (11:26): there might be more important issue sthough  \nvmassol - (11:26): haven't checked the other open ones  \nvmassol - (11:27): there are about 40 or so open bugs I believe  \nkibahop left #xwiki at 11:29  \nkibahop joined #xwiki at 11:36  \nCalebJamesDeLisl - (11:38): Time for bed.  \nvmassol - (11:39): good night CalebJamesDeLisl  \ntmortagne - (11:39): CalebJamesDeLisl: good night :)  \nCalebJamesDeLisl - (11:39): Good night all.  \nCalebJamesDeLisl left at 11:39 (Quit: The user has gone to sleep.  \nvmassol - (11:45): hourrah :)  \ntmortagne - (11:49): sdumitriu: i can do myxwiki upgrade now unless you really want to do it  \nsdumitriu - (11:51): tmortagne: Ok, go ahead  \ntmortagne - (11:52): sdumitriu: ok  \nbblfish - (11:57): it says \"Go in platform/web/standard and type mvn install -Pjettyrun\"  \nvmassol - (11:58): bblfish: this part is oldish, dunno if it still works  \nvmassol - (11:58): the best is to build enterprise/  \nvmassol - (11:58): http://svn.xwiki.org/svnroot/xwiki/enterprise/trunk/  \nvmassol - (11:58): this is XWiki Enterprise (the wiki product)  \nbblfish - (11:58): ah ok. I had not checked that out I think  \nvmassol - (11:58): it uses the platform  \nvmassol - (11:59): then once it's built you go in distribution/jetty/hsqldb/target  \nvmassol - (11:59): you'll find the distribution zip  \nvmassol - (11:59): you can unzip it  \nvmassol - (11:59): and then call start\\_xwiki.sh  \nbblfish - (12:01): ah I get it, I was in the https://svn.xwiki.org/svnroot/xwiki/platform/trunk directory  \nvmassol - (12:02): bblfish: yep  \nbblfish - (12:02): so probably that should have read \"Go in platform/trunk/web/standard and type  \nbblfish - (12:03): I just ran that to see if it works. It seems to be downloading a lot of stuff  \nvmassol - (12:03): ok I haven't tried it for ages  \nvmassol - (12:03): bblfish: it says: \"Go in platform/web/standard and type mvn install -Pjettyrun.\"  \nbblfish - (12:04): yes. I was looking with find for platform which of course I was not going to find...  \nvmassol - (12:04): ok  \nmflorea left at 12:08 (Quit: Leaving.  \nbblfish - (12:09): yes, I could load http://localhost:8080/xwiki which redirects http://localhost:8080/xwiki/bin/view/Main/ and says the page is not found. I suppose that's it then  \nbblfish - (12:09): I get stuff like [[  \nbblfish - (12:09): $xwiki.jsfx.use('js/scriptaculous/scriptaculous.js') $xwiki.jsfx.use('js/xwiki/actionbuttons/actionButtons.js', true) \u00a0\u00a0$xwiki.jsfx.use('js/scriptaculous/effects.js', true) $xwiki.jsfx.use('js/xwiki/widgets/modalPopup.js', true) $xwiki.ssfx.use('js/xwiki/widgets/modalPopup.css', true) $xwiki.jsfx.use('js/xwiki/widgets/jumpToPage.js', true) $xwiki.ssfx.use('js/xwiki/widgets/jumpToPage.css',...  \nbblfish - (12:09): ...true) $xwiki.jsfx.use('uicomponents/widgets/confirmationBox.js', true) $xwiki.ssfx.use('uicomponents/widgets/confirmationBox.css', true) $xwiki.jsfx.use('uicomponents/widgets/confirmedAjaxRequest.js', true) $xwiki.jsfx.use('uicomponents/widgets/notification.js', true) $xwiki.ssfx.use('uicomponents/widgets/notification.css', true)  \nbblfish - (12:09): ]]  \nbblfish - (12:10): at the top of the page  \nvmassol - (12:10): bblfish: yes it's not working  \nvmassol - (12:10): missing stuff  \nvmassol - (12:10): we have kept this solution up to date  \nvmassol - (12:10): so for now the best is that you build enterprise/ to get a full XE running  \nvmassol - (12:11): I don't think it would be complex to update the build to make this work again but someone just need to do it  \nbblfish - (12:11): ok  \nbblfish - (12:11): hope it does not take as long to compile again  \nvmassol - (12:16): no, just about 3 mn  \ntmortagne - (12:22): [upgrade] i'm stoping myxwiki.org  \ntmortagne - (12:25): note: http://myxwiki.org/xwiki/bin/view/XWiki/Upgrading is really not up to date (there was no link \"xwiki\" to point to the correct war, there is no backup folder...)  \ntmortagne - (12:26): i fixed the xwiki link part  \nvmassol - (12:29): sdumitriu: ok I think I know what the pb is regarding the pre in comment editing  \nvmassol - (12:29): and I wonder how it could have ever worked  \nvmassol - (12:29): the pb is when a template calls $doc.display in syntax 1.0  \nvmassol - (12:29): and in edit mode  \nvmassol - (12:29): (or hidden mode or search mode)  \nsdumitriu - (12:29): Ah, right  \nvmassol - (12:30): in this case pre are added  \nsdumitriu - (12:30): The {pre} and <pre>  \nvmassol - (12:30): but there's no check for isInRenderingEngine  \nvmassol - (12:30): which we have for syntax 2.0  \nvmassol - (12:30): (hence why it works in 2.0 syntax)  \nvmassol - (12:30): fixing it  \nvmassol - (12:31): sdumitriu: do you agree we should use pre only if isInRenderingEngine is trueN  \nvmassol - (12:31): s/trueN/true?/  \nvmassol - (12:31): since in template only velocity is evaluated  \nsdumitriu - (12:31): Yes  \nsdumitriu - (12:32): And also <pre> should never be there anyway  \nsdumitriu - (12:32): We've discussed this already, but don't remember who won  \nvmassol - (12:33): yes I don't recall exactly for <pre> so I won't touch that right now  \nbbc581 joined #xwiki at 12:35  \nbbc581 left at 12:40 (Ping timeout: 264 seconds  \nplunden joined #xwiki at 13:15  \nmflorea joined #xwiki at 13:18  \nbblfish - (13:20): hi: just in case this rings any bells  \nbblfish - (13:20): ---[[  \nbblfish - (13:20): Error unpacking file[/Users/hjs/.m2/repository/com/xpn/xwiki/platform/xwiki-web-standard/2.3-SNAPSHOT/xwiki-web-standard-2.3-SNAPSHOT.war]to[/Users/hjs/Programming/EclipseWorkspace/xwiki-enterprise-parent/web/target/war/work/com.xpn.xwiki.platform/xwiki-web-standard]  \nbblfish - (13:20): Embedded error: Error while expanding /Users/hjs/.m2/repository/com/xpn/xwiki/platform/xwiki-web-standard/2.3-SNAPSHOT/xwiki-web-standard-2.3-SNAPSHOT.war  \nbblfish - (13:20): Negative seek offset  \nbblfish - (13:20): ]]  \nbblfish - (13:20): that was why the enterprise build failed  \nbblfish - (13:23): going to try rebuilding that component  \nbblfish - (13:32): building enterprise: \"java.lang.Exception: Unable to locate [XWiki.WikiMacroClass] & [XWiki.WikiMacroParameterClass] classes required for defining wiki macros.\"  \nbblfish - (13:33): but it's continuing  \nbblfish - (13:44): bon \"[INFO] BUILD SUCCESSFUL\"  \nsdumitriu - (13:46): tmortagne: incubator myxwiki dead  \ntmortagne - (13:46): sdumitriu: yes i know, the whole myxwiki.org is dead  \ntmortagne - (13:46): i can't make tomcat work with 2.2RC1 war yet  \ntmortagne - (13:47): it works well with 2.1 wnad when i just switch the folder i get a 503 and nothing in the log  \nbblfish - (13:49): ok. startex xwiki in ~/Programming/EclipseWorkspace/xwiki-enterprise-parent/distribution/jetty/hsqldb/target/xwiki-enterprise-jetty-hsqldb-2.3-SNAPSHOT  \nbblfish - (13:50): but I just git a list of files when I go to http://localhost:8080/xwiki/  \nplunden left #xwiki at 13:55  \ntmortagne - (13:55): putting back 2.1 for now  \ntmortagne - (13:56): if someone has an idea of what could be the issue...  \nbblfish - (14:01): if I go to http://localhost:8080/xwiki/bin/view/Main/WebHome I get a 404  \nkibahop left #xwiki at 14:03  \nsdumitriu - (14:03): bblfish: Did you install the default xar?  \nsdumitriu - (14:03): The wiki is empty  \nmflorea - (14:03): guys, I have some code that is component oriented but still depends on the old xwiki core (i.e. accessed the xwiki context from the execution context). Can this code have org.xwiki.\\* package prefix?  \nbblfish - (14:03): I downloaded from svn  \nsdumitriu - (14:04): mflorea: What do you need from the context? Can't it be accessed if you use the map interface?  \nsdumitriu - (14:04): Or is it a class field not stored in the map?  \nbblfish - (14:04): then I did a mvn install I think  \nvmassol - (14:05): sdumitriu: bblfish doesn't need to install the default XAR since he's built the default xe  \nsdumitriu - (14:05): bblfish: Normally I unzip the .zip that's in /distribution/jetty/hsqldb/target/ and run from there  \nsdumitriu - (14:05): vmassol: Yes, I just looked up and saw where he built from  \nmflorea - (14:06): sdumitriu: I need more than the xwiki context. I'm referring to the DefaultWikiService used by wysiwyg. It needs to access the code, like search documents, and other things that are not accessible through the bridge  \nsdumitriu - (14:06): mflorea: OK  \nbblfish - (14:06): sdumitriu: that's what I did. I unzipped that jar  \nbblfish - (14:06): sorry that zip  \nplunden joined #xwiki at 14:06  \nbblfish - (14:07): I unzipped this one xwiki-enterprise-jetty-hsqldb-2.3-SNAPSHOT.zip  \nsdumitriu - (14:07): mflorea: I'd go for org.xwiki, but vmassol should know better  \nmflorea - (14:07): my question war regarding the org.xwiki.\\* pacakge prefix policy. Is it for component oriented code or for code that doesn't depend on the old core  \nbblfish - (14:07): that I had built after checking it out  \nsdumitriu - (14:08): bblfish: Is it an XWiki page with a \"document does not exist\" message, or a tomcat error?  \nbblfish - (14:08): \u00a0svn info ~/Programming/EclipseWorkspace/xwiki-enterprise-parent/pom.xml  \nbblfish - (14:08): Path: /Users/hjs/Programming/EclipseWorkspace/xwiki-enterprise-parent/pom.xml  \nbblfish - (14:08): Name: pom.xml  \nbblfish - (14:08): URL: http://svn.xwiki.org/svnroot/xwiki/enterprise/trunk/pom.xml  \nbblfish - (14:08): Repository Root: http://svn.xwiki.org/svnroot/xwiki  \nbblfish - (14:08): Repository UUID: f329d543-caf0-0310-9063-dda96c69346f  \nbblfish - (14:08): Revision: 26763  \nbblfish - (14:08): Node Kind: file  \nbblfish - (14:08): Schedule: normal  \nbblfish - (14:08): Last Changed Author: tmortagne  \nbblfish - (14:08): Last Changed Rev: 26715  \nvmassol - (14:08): mflorea: org.xwiki sounds good  \nbblfish - (14:08): Last Changed Date: 2010-02-03 18:32:15 +0100 (Wed, 03 Feb 2010)  \nbblfish - (14:08): Text Last Updated: 2010-02-05 12:15:01 +0100 (Fri, 05 Feb 2010)  \nbblfish - (14:08): Checksum: c9250c4a4c807713c1e576f7d9ede4cc  \nbblfish - (14:08): if I go to http://localhost:8080/xwiki  \nmflorea - (14:08): vmassol: ok, thanks!  \nbblfish - (14:08): then I get just some list of files on the directory path  \nvmassol - (14:09): we need to move everything to org.xwiki anyway  \nmflorea - (14:09): ok  \nvmassol - (14:09): the sooner the better  \nvmassol - (14:09): I think we should updtae the policy  \nvmassol - (14:09): let me find it again  \nsdumitriu - (14:09): mflorea: Did you test the editor on FF3.6?  \nmflorea - (14:09): not yet, why?  \nsdumitriu - (14:10): FCK had some problems  \nsdumitriu - (14:10): http://hacks.mozilla.org/2010/02/firefox-3-6-feedback/  \nvmassol - (14:10): mflorea: we have this on dev.xwiki.rg: \"All code that is not moved to the new XWiki Architecture based on components should use com.xpn.xwiki. New architecture code should use org.xwiki.\"  \nmflorea - (14:10): ok, thanks  \nvmassol - (14:10): http://dev.xwiki.org/xwiki/bin/view/Community/JavaCodeStyle  \nvmassol - (14:12): bblfish: I don't see how this can happen at all. How do you start XE?  \nmflorea - (14:12): sdumitriu: it's easy to test if we upgrade Hudson to FF3.6  \nbblfish - (14:12): sh start\\_xwiki.sh  \nvmassol - (14:12): actually we also need to support FF 3.5  \nvmassol - (14:13): so we need more agents  \nbblfish - (14:13): let me try with debug  \nvmassol - (14:13): bblfish: it's not going to change anything normally  \nvmassol - (14:14): bblfish: anything strange in the console?  \nvmassol - (14:14): this is really weird  \nbblfish - (14:14): 2010-02-05 14:13:11.792::INFO: \u00a0Deploy /Users/hjs/Programming/EclipseWorkspace/xwiki-enterprise-parent/distribution/jetty/hsqldb/target/xwiki-enterprise-jetty-hsqldb-2.3-SNAPSHOT/jetty/contexts/root.xml -> org.mortbay.jetty.webapp.WebAppContext@3caa4b{/,/Users/hjs/Programming/EclipseWorkspace/xwiki-enterprise-parent/distribution/jetty/hsqldb/target/xwiki-enterprise-jetty-hsqldb-2.3-SNAPSHOT/jetty/  \nbblfish - (14:14): ../webapps/root}  \nbblfish - (14:14): 2010-02-05 14:13:11.799::INFO: \u00a0Deploy /Users/hjs/Programming/EclipseWorkspace/xwiki-enterprise-parent/distribution/jetty/hsqldb/target/xwiki-enterprise-jetty-hsqldb-2.3-SNAPSHOT/jetty/contexts/xwiki.xml -> org.mortbay.jetty.webapp.WebAppContext@ed0220c{/xwiki,/Users/hjs/Programming/EclipseWorkspace/xwiki-enterprise-parent/distribution/jetty/hsqldb/target/xwiki-enterprise-jetty-hsqldb-2.3-SNAPSHOT  \nbblfish - (14:14): /jetty/../webapps/xwiki}  \nbblfish - (14:14): 2010-02-05 14:13:14.360::INFO: \u00a0Opened /Users/hjs/Programming/EclipseWorkspace/xwiki-enterprise-parent/distribution/jetty/hsqldb/target/xwiki-enterprise-jetty-hsqldb-2.3-SNAPSHOT/jetty/logs/2010\\_02\\_05.request.log  \nbblfish - (14:14): 2010-02-05 14:13:14.414::INFO: \u00a0Started [[email\u00a0protected]](https://dev.xwiki.org/cdn-cgi/l/email-protection):8080  \nvmassol - (14:14): what does http://localhost:8080/ do?  \nbblfish - (14:15): it redirects to http://localhost:8080/xwiki/  \nbblfish - (14:15): and that shows a list of directories such as META-INF  \nbblfish - (14:15): WEB-INF  \nbblfish - (14:16): redirect/  \nbblfish - (14:16): resources/  \nbblfish - (14:16): skins/  \nbblfish - (14:16): templates  \nvmassol - (14:16): yes but that shouldn't happens ince we have a redirect servlet defined in web.xml  \nvmassol - (14:17): can you try http://localhost:8080/xwiki/bin/view/Main/WebHome  \nbblfish - (14:17): that gave the 404  \nbblfish - (14:18): yep, NOT\\_FOUND  \nvmassol - (14:19): let me rebuild myself here  \nbblfish - (14:19): perhaps this error in the build: 2010-02-05 12:39:26,587 [main] ERROR xwiki.XWiki \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0- Error while registering wiki macros.  \nbblfish - (14:19): java.lang.Exception: Unable to locate [XWiki.WikiMacroClass] & [XWiki.WikiMacroParameterClass] classes required for defining wiki macros  \nvmassol - (14:19): maybe the build was broken by a recent commit  \nvmassol - (14:19): bblfish: no this is ok  \nvmassol - (14:19): (we should fix it from the build but it's ok)  \nvmassol - (14:20): I'm rebuilding a clean all  \nvmassol - (14:20): I'll let you know in 20 minutes....  \nbblfish - (14:20): in enterprise?  \nvmassol - (14:20): first platform and then enterprise  \nvmassol - (14:20): hmm maybe when you built enterprise it downloaded latest version maven remote repo  \nvmassol - (14:21): since hudson may have built a newer version in between your build for platforml  \nvmassol - (14:21): and the time you started building enterprise  \nvmassol - (14:21): and maybe the latest version on hudson isn't working for some reason  \nvmassol - (14:21): anyway I should find out  \nbblfish - (14:21): that's kind of why I was wondering if it was a good idea to work from trunk  \nbblfish - (14:23): there was this error  \nbblfish - (14:23): \"org.hibernate.NonUniqueObjectException: a different object with the same identifier value was already associated with the session: [com.xpn.xwiki.doc.XWikiDocument#104408758]\"  \nvmassol - (14:23): bblfish: trunk works most of the time  \nvmassol - (14:23): I'm still not sure this is the pb  \nvmassol - (14:23): FTM I just can't find an explanatio  \nvmassol - (14:24): btw to speed up building platform you can run: mvn install -Pdev  \nbblfish - (14:25): ok, thanks  \nvmassol - (14:25): (more info here: http://dev.xwiki.org/xwiki/bin/view/Community/Building#HBuildingtheWYSIWYGeditor)  \nbblfish - (14:25): checking the platform externals  \nbblfish - (14:25): ah there are a few updates  \nbblfish - (14:26): oh quite a few it seems  \nvmassol - (14:29): bblfish: what's the end goal? if what you want is to get a recent build of XE then you could simply download it  \nvmassol - (14:29): then you can do your dev and copy your JAR in WEB-INF/lib  \nvmassol - (14:30): (to run it)  \nbblfish - (14:30): well I am mostly done now. :-)  \nbblfish - (14:30): I hope  \nvmassol - (14:30): ok  \nvmassol - (14:30): in case you need it: http://maven.xwiki.org/snapshots/com/xpn/xwiki/products/xwiki-enterprise-jetty-hsqldb/2.3-SNAPSHOT/  \nbblfish - (14:30): ok, thanks.  \nbblfish - (14:31): It helps to see how xwiki is built anyway...  \nvmassol - (14:31): yes  \nvmassol - (14:32): I'm just sorry it's not been a pleasant experience so far as it should have been  \nvmassol - (14:32): we're quite happy with our build that normally just works?  \nbblfish - (14:32): well working from the trunk, is usually a bit dangerous :-)  \nvmassol - (14:32): it's a bit long though when you build it all  \nvmassol - (14:32): but there isn't much we can do about that, except not building it all (which is not needed)  \nbblfish - (14:33): yes, partly because I think maven sometimes has to make multiple requests, no?  \nvmassol - (14:34): what's long is compilation + tests + checkstyle checks + aspectj weaving + gwt compilation...  \nbblfish - (14:34): But I am reading a good book on surveillance, so that's not a problem, I have something to do while my cpu is pegged  \nvmassol - (14:34): (+ backward compat checks to prevent breaking apis for some module)  \nvmassol - (14:34): :)  \nbblfish - (14:34): is this serious: org.hibernate.HibernateException: Can't find [/WEB-INF/hibernate.cfg.xml] for hibernate configuration  \nvmassol - (14:34): no  \nvmassol - (14:35): it's jsut some unit tests  \nvmassol - (14:35): that need to be improved  \nvmassol - (14:35): we want to fix those but since they affect some old code that we want to get rid of  \nvmassol - (14:35): we've not spent much time looking at how to imrpove the console logs for them  \nvmassol - (14:36): anything serious will make the build fail  \nvmassol - (14:36): so you're safe  \nbblfish - (14:37): ok, well I think what I want to do is going to be initially quite simple to add. RDFa templates should be super simple. A bit of intelligent public key management, a bit more work.  \nbblfish - (14:37): (and require an entry in the DB)  \nbblfish - (14:38): but I can see why most end user apps are php based. I think php developers just need to put their files somwhere on the file system and they work  \nvmassol - (14:38): yes you just saw why PHP based wiki don't scale :)  \nbblfish - (14:39): oh?  \nbblfish - (14:39): where?  \nvmassol - (14:39): you can make them scale but with lots of machines and caches and indexing process to parse the file system  \nvmassol - (14:40): that's why we use a db  \nvmassol - (14:40): when we do a request we get live results  \nbblfish - (14:40): ah, in any case one can write php and compile to java...  \nvmassol - (14:40): also it's impossible to do complex queries IMO on files  \nvmassol - (14:40): you can script in php in xwiki actually  \nvmassol - (14:41): not sure why you'd want to do this though ;)  \nbblfish - (14:41): yes. that's cool. There are a lot of people who do php out there, who seem to do good UIs  \nbblfish - (14:41): :-/ Build Failure  \nvmassol - (14:41): buidl sucess here  \nbblfish - (14:42): [INFO] Building XWiki Platform - Plugins - Application Manager  \nbblfish - (14:42): [INFO] \u00a0\u00a0\u00a0task-segment: [install]  \nvmassol - (14:42): now building enterprise  \nbblfish - (14:42): [..]  \nbblfish - (14:42): Surefire report directory: /Users/hjs/Programming/EclipseWorkspace/xwiki-platform-externals/plugins/application-manager/target/surefire-reports  \nbblfish - (14:42): org.apache.maven.surefire.booter.SurefireExecutionException: TestCase; nested exception is java.lang.NoClassDefFoundError: TestCase  \nbblfish - (14:42): java.lang.NoClassDefFoundError: TestCase  \nbblfish - (14:42): which svn number are you at?  \nvmassol - (14:42): you really have a pb in your environment I think  \nvmassol - (14:42): 26765  \nbblfish - (14:43): I was at 26763  \nvmassol - (14:43): the app manager hasn't been touched for months  \nbblfish - (14:43): or that was the revision of pom.xml  \nvmassol - (14:43): AFAIK  \nbblfish - (14:44): ok, so perhaps I should clean and start from scratch  \nbblfish - (14:44): is that  \nbblfish - (14:44): mvn clean ?  \nvmassol - (14:44): mvn clean install  \nvmassol - (14:44): btw which version of maven are u using?  \nbblfish - (14:44): $ mvn --version  \nbblfish - (14:44): Apache Maven 2.2.0 (r788681; 2009-06-26 15:04:01+0200)  \nbblfish - (14:44): Java version: 1.6.0\\_17  \nbblfish - (14:44): Java home: /System/Library/Frameworks/JavaVM.framework/Versions/1.6.0/Home  \nbblfish - (14:44): Default locale: en\\_US, platform encoding: MacRoman  \nbblfish - (14:44): OS name: \"mac os x\" version: \"10.6.2\" arch: \"x86\\_64\" Family: \"mac\"  \nvmassol - (14:45): ok, slightly oldish  \nvmassol - (14:45): but it's ok  \nvmassol - (14:45): it should work just fine  \nbblfish - (14:45): should I do  \nbblfish - (14:45): mvn clean install -Pdev ?  \nvmassol - (14:45): yes  \nvmassol - (14:46): ok all built  \nvmassol - (14:46): now starting XE  \nvmassol - (14:47): works fine  \nbblfish - (14:49): ok, rebuilding  \nbblfish - (14:49): now we are in sync, so we'll know...  \nvmassol - (15:24): grrr there's still the {/pre} displayed in the user profile when logged in with a user having a page in 1.0 syntax  \nvmassol - (15:24): I'm on it  \nbblfish - (15:25): no, after clean and rebuilding both I still get the directory listing  \nplunden left #xwiki at 15:25  \nvmassol - (15:25): ah must be some deps issue  \nvmassol - (15:25): (talking to myself)  \nvmassol - (15:26): not responding to you bblfish  \nvmassol - (15:27): vmassol: no you're wrong, it's not a dep issue!  \nvmassol - (15:33): jvdrean: why cannot I see a user's watchlist if I'm admin?  \nvmassol - (15:34): (the watchlist tab isn't displayed)  \nbblfish - (15:35): vmassol: which (sub)version of enterprise are you using?  \nvmassol - (15:35): svn?  \nbblfish - (15:35): yes  \nbblfish - (15:35): version  \nbblfish - (15:35): of the code  \nvmassol - (15:35): vmassol@standard $ svn --version  \nvmassol - (15:35): svn, version 1.6.3 (r38063)  \nvmassol - (15:35): \u00a0\u00a0\u00a0compiled Jun 23 2009, 16:38:16  \nvmassol - (15:35): Copyright (C) 2000-2009 CollabNet.  \nbblfish - (15:35): of the xwiki \u00a0code  \nvmassol - (15:36): as I said rev 26765  \nvmassol - (15:36): (this is what I built)  \nbblfish - (15:38): yes that is my version of xwiki-platforms-externals  \nbblfish - (15:39): I am at 26770 for http://svn.xwiki.org/svnroot/xwiki/enterprise/trunk/pom.xml  \nvmassol - (15:39): bblfish: can I ssh into your system? (I need to finish something first but I could try to help you a bit later)  \nbblfish - (15:40): ssh is a bit complex I think. I am not sure how the firewall is set up here.  \njvdrean - (15:41): vmassol: about the watchlist, APIs are currently missing, from the code:  \njvdrean - (15:41): ## TODO: add APIs to be able to display users watchlists to admins  \nvmassol - (15:41): ok  \njvdrean - (15:41): badly designed API :)  \nvmassol - (15:42): :)  \nvmassol - (15:42): self-bashing?  \njvdrean - (15:42): yes I'm the one to blame  \nbblfish - (15:44): I am going to download one of the snapshots. I suppose most of the code is up to date. I'll be in Paris next week at some point, in case I can't get it to compile by then...  \nsdumitriu - (15:44): vmassol: bblfish: You could do a reverse tunnel first, then connect through it.  \nvmassol - (15:44): bblfish: ok fine  \nvmassol - (15:44): you can always come to the xwiki sas office in paris whenever you want  \nbblfish - (15:45): cool :-) I'll try to put something together so I have something to show...  \nvmassol - (15:45): ok great  \nvmassol - (15:46): I'm in Paris next tuesday  \nvmassol - (15:46): otherwise there'll be others at the office  \nbblfish - (15:52): cool the snapshot seems to work  \nbblfish - (15:53): what does not happen when I run from my build is all the deployment stuff  \nvmassol - (16:03): tmortagne: big pb on upgrading myxwiki.org?  \ntmortagne - (16:04): vmassol: yes  \nbblfish left at 16:07 (Read error: Connection reset by peer  \njvdrean left at 16:09 (Quit: Leaving.  \ntmortagne - (16:12): i'm doing remote debugging to try to find what is the issue but even XWikiAction#execute, does someone have an issue of something before that that could break the request ? note: break the request but without producing any error log  \ntmortagne - (16:12): \\*even XWikiAction#execute is not called  \nvmassol - (16:13): you could try to put breakpoints in the filters  \nvmassol - (16:13): servlet filters  \ntmortagne - (16:14): sure but none of the filters changed AFAIK  \nvmassol - (16:14): well you need to find the place where it calls the xwiki code  \nvmassol - (16:15): you could also put a breakpoint in the servlet context listener  \nvmassol - (16:16): ok I know my pb?. grrr?. so simple...  \ntmortagne - (16:16): the action is called by struts not xwiki, i'm currently trying to debug the servlect context but that should not have any impact on the faollowing requests  \ntmortagne - (16:22): XWikiServletContextListener is called and behave like it should AFAICS  \ntmortagne - (16:27): SetThreadNameServletRequestListener is called too without any issue, what filters are supposed to be called for each view request ?  \nvmassol - (16:27): let me check web.xml  \ntmortagne - (16:27): i'm currently looking  \nvmassol - (16:28): com.xpn.xwiki.web.SetCharacterEncodingFilter  \nvmassol - (16:28): RequestRestorer  \nsdumitriu left at 16:28 (Quit: Leaving.  \nvmassol - (16:28): DavFilter  \nvmassol - (16:29): ActionDispatcher  \ntmortagne - (16:29): SetCharacterEncodingFilter is not called here  \nvmassol - (16:29): why not?  \nvmassol - (16:29): the pattern is: \u00a0<url-pattern>/\\*</url-pattern>  \ntmortagne - (16:29): i don't say it should not be called  \ntmortagne - (16:29): i'm saing it's not  \nvmassol - (16:29): ok  \nvmassol - (16:30): so that's one pb  \nvmassol - (16:30): is your web.xml the original one or is it modified on myxwiki.org?  \ntmortagne - (16:31): that's the original one with watch in it = myxwiki.org  \nvmassol - (16:31): could it be some permission issue that is not obvious?  \ntmortagne - (16:32): no i'm reproducing on my machine, (i downloaded instance of tomcat and xwiki from myxwiki.org)  \njvdrean joined #xwiki at 16:32  \ntmortagne - (16:33): i'm running with my user in my home with all files unziped by the users  \ntmortagne - (16:33): \\*the user  \ntmortagne - (16:34): ActionDispatcher is never called either  \ntmortagne - (16:35): same for SavedRequestRestorerFilter  \ntmortagne - (16:37): my web.xml: http://pastebin.com/m4ccf2ec4  \nbblfish joined #xwiki at 16:40  \ntmortagne - (16:40): still have only SetThreadNameServletRequestListener called and nothing else (tested ActionFilter, SavedRequestRestorerFilter, SetCharacterEncodingFilter, XWikiAction, XWikiDavFilter)  \ntmortagne - (16:42): trying without any Watch related filter  \nvmassol - (16:44): have you tried replacing this web.xml with the default one, just to see if there's any diff?  \ntmortagne - (16:45): i already did a diff and the only differences was watch  \ntmortagne - (16:46): not better...  \ntmortagne - (16:46): i don't understand  \ntmortagne - (16:47): if only there was some error in the log... even a warning, something  \nvmassol - (16:47): have you tried using jetty with the same exact config/war?  \ntmortagne - (16:48): that's supposed to be what you have in a jetty/hsqldb distribution, the only difference is some plugin added  \nvmassol - (16:48): so you're saying the pb is defienitely the fact that it runs in tomcat?  \ntmortagne - (16:49): i'm saying i don't understand what is the problem but there is nothing special, it's standard war with standard web.xml  \nvmassol - (16:49): we need to eliminate possible pb one by one  \nvmassol - (16:50): if it runs fine jetty but not tomcat  \nvmassol - (16:50): then the pb is with tomcat  \ntmortagne - (16:50): no  \ntmortagne - (16:50): well yes with tomcat  \nvmassol - (16:50): with tomcat = with xwiki running on tomcat  \ntmortagne - (16:50): but nt tomcat itself  \ntmortagne - (16:50): since tomcat wors well with older  \ntmortagne - (16:51): problem is that tomcat doe snot even call XWiki...  \ntmortagne - (16:51): and the war did not changed  \ntmortagne - (16:51): well it calls SetThreadNameServletRequestListener but this filter is doing almost nothing so it's not this one that make the request bahave like this  \nvmassol - (16:52): trying to set up xwiki and tomcat  \ntmortagne - (16:52): (and it did not changed aither AFAIK)  \ntmortagne - (16:53): note: i'ts tomcat 6.0.20 on myxwiki.org  \ntmortagne - (16:53): (and the one i'm using to test here since it's a copy of myxwiki.org)  \nvmassol - (16:53): does it work fine with tomcat 6.0.24?  \nvmassol - (16:53): (latest)  \nbblfish - (16:53): so how do I edit the html produced by http://localhost:8080/xwiki/bin/view/XWiki/bblfish  \ntmortagne - (16:53): no idea  \nbblfish - (16:54): I don't mean filling in the fields, but changing the template  \ntmortagne - (16:54): was talking to vmassol :)  \nvmassol - (16:54): bblfish: you edit the page in wiki mode  \nbblfish - (16:54): (yes, I guessed that :)  \nbblfish - (16:54): ah ok  \nvmassol - (16:54): that will lead to you a userprofile sheet page  \nvmassol - (16:54): you'll find a mix of velocity scripting and html  \nvmassol - (16:54): basically the page you want is:  \nvmassol - (16:55): XWiki.XWikiUserProfileSheet  \nbblfish - (16:55): ok. looking...  \ntmortagne - (17:01): vmassol: not better with a fresh tomcat 6.0.24, so it's not tomcat version of configuration it seems  \ntmortagne - (17:01): of=or  \nvmassol - (17:01): still trying to start tomcat....  \ntmortagne - (17:02): i can give you my tomcat script if you want  \nvmassol - (17:02): I'm trying to use the default startup.sh  \nvmassol - (17:06): ok the pb was simply that there's no x flag for execution in the tomcat zip....  \nvmassol - (17:07): tmortagne: works fine  \nvmassol - (17:07): tomcat 6.0.24 + XE 2.3 from trunk  \ntmortagne - (17:07): did you tryed 2.2RC1 ?  \nvmassol - (17:07): nope  \nvmassol - (17:08): downloading  \ntmortagne - (17:19): just tryed with a fresh 2.2RC1 it's it seems to work  \ntmortagne - (17:19): but it's the same web.xml...  \nvmassol - (17:19): ok you beat me, still downloading  \ntmortagne - (17:20): there only some plugins added in the other  \nvmassol - (17:20): well something is different  \nvmassol - (17:20): :)  \nvmassol - (17:20): try removing them one by one maybe?  \ntmortagne - (17:20): the same plugins used in the currently running myxwiki.org  \njvelo joined #xwiki at 17:28  \ntmortagne - (17:30): i think i found the issue but well it's not really supposed to be an issue... testing again  \ntmortagne - (17:32): not that's not it it seems  \nvmassol - (17:32): have you done a full unix diff on all files?  \ntmortagne - (17:33): i just remove the plugin and put them back and it's working...  \nvmassol - (17:34): so some special invisible characters?  \ntmortagne - (17:34): no characters, i moved files in a backup folder, started, it worked, them i moved them back and it still work  \ntmortagne - (17:34): absolutely nothing changed...  \nvmassol - (17:35): might be cache  \nvmassol - (17:35): cached  \nvmassol - (17:35): ?  \ntmortagne - (17:35): cached what ? jars in tomcat ?  \nvmassol - (17:35): maybe you could remove the tomcat work dir to check  \ntmortagne - (17:36): hmm wait  \nsilviar left #xwiki at 17:36  \ntmortagne - (17:37): i just checked ad one moved back did not worked it seems  \ntmortagne - (17:38): or so my first \"(17:31:01) <moi>: i think i found the issue but well it's not really supposed to be an issue... testing again\" was the correct one it seems  \ntmortagne - (17:38): but that's the weirdest from my POV:  \ntmortagne - (17:39): it's not working with the myxwiki.org struts-config file  \ntmortagne - (17:39): but that should not make any difference between 2.1 and 2.2  \ntmortagne - (17:39): especially since it's pretty basic things  \ntmortagne - (17:40): ha not that basic  \ntmortagne - (17:40): i think it's because of captcha  \ntmortagne - (17:40): but that would mean that struts does not log any error when there is issue in the struts-config file  \ntmortagne - (17:43): did we changed something to captcha in struts-config file ?  \ntmortagne - (17:43): looking at the svn log  \nvmassol - (17:43): what does the diff says?  \ntmortagne - (17:44): the diff will not help, i have a merged struts-config file not the one used in 2.1  \nvmassol - (17:45): + \u00a0 \u00a0 \u00a0 \u00a0<action path=\"/imagecaptcha/\"  \nvmassol - (17:45): + \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0type=\"org.xwiki.captcha.internal.DefaultImageCaptchaAction\">  \nvmassol - (17:45): + \u00a0 \u00a0 \u00a0 \u00a0</action>  \nvmassol - (17:45): +  \nvmassol - (17:45): +  \nvmassol - (17:46): and removed old captch actions  \nvmassol - (17:46): - \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0<forward name=\"captcha\" path=\"/templates/captcha.vm\"/>  \nvmassol - (17:46): - \u00a0 \u00a0 \u00a0 \u00a0<action path=\"/jcaptcha/\"  \nvmassol - (17:46): - \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0type=\"com.octo.captcha.module.struts.image.RenderImageCaptchaAction\">  \nvmassol - (17:46): - \u00a0 \u00a0 \u00a0 \u00a0</action>  \nvmassol - (17:46): so these don't exist anymore  \nvmassol - (17:46): so if you keep them it'll fail probably  \nvmassol - (17:46): this too:  \nvmassol - (17:46): - \u00a0 \u00a0<!-- ============================ Plugins =============================== -->  \nvmassol - (17:46): - \u00a0 \u00a0<plug-in className=\"com.octo.captcha.module.struts.CaptchaServicePlugin\"/>  \nvmassol - (17:46): -  \njvelo left at 17:47 (Remote host closed the connection  \nvmassol - (17:47): we could add it in the release notes so that users pay extra attention  \nvmassol - (17:47): even though we're coverd since we tell them to diff config files they modify  \nvmassol - (17:47): s/coverd/covered/  \ntmortagne - (17:47): yes i seen that in svn, it's a pain that struts fail silently...  \ntmortagne - (17:48): maybe we have a crappy filter in log4j configuration for that  \ntmortagne - (17:48): that would not be the first  \ntmortagne - (17:48): ### Deactive Struts warnings  \ntmortagne - (17:48): log4j.logger.org.apache.struts.util.RequestUtils=error  \ntmortagne - (17:49): very useful...  \nvmassol - (17:49): we don't want warnings  \ntmortagne - (17:49): but i guess that's a warning for struts  \ntmortagne - (17:49): warning is not info  \ntmortagne - (17:49): i dont see why we would not want warning  \nvmassol - (17:49): we can try  \nvmassol - (17:49): depends what it spits  \nbblfish - (17:50): quelqu'un s'y connais un peu avec la logique de XWikiUserProfileSheet ?  \nbblfish - (17:50): sorry, I meant does someone know the logic of XWikiUserProfileSheet ?  \nvmassol - (17:50): bblfish: yep you have jvdrean who's is the creator if it :)  \nvmassol - (17:50): and I know it a little bit too  \nbblfish - (17:50): ah cool. is jvdrean here?  \njvdrean - (17:50): bblfish: yep  \nbblfish - (17:50): ah cool  \nbblfish - (17:51): sorry, I am just trying to add rdfa to that page  \nbblfish - (17:51): it says: #if($context.action == ?view?)  \nbblfish - (17:51): why is the vcard encolsed in that  \njvdrean - (17:52): $context.action is the request action, we have 2 main actions called on the profile  \njvdrean - (17:53): 'view' which is obviously the view action, 'inline' which allow to edit the profile  \nbblfish - (17:53): ah ok, so no need to add the vcard info to the profile I suppose  \njvdrean - (17:53): we don't add vcard info when the form is displayed  \nbblfish - (17:53): yes, you are packing a lot into one page there...  \nvmassol - (17:54): yes, not very clean I agree?..  \nlucaa left #xwiki at 17:54  \nbblfish - (17:54): ok, not me to complain here :-) I'll add the rdfa in there.. I can see the pattern.  \ntmortagne - (17:55): vmassol: struts does not print anything even with log4j.logger.org.apache.struts.util.RequestUtils=warn  \nbblfish - (18:00): RDF's SIOC and AWE -SIOC:Semantically Interlinked Online Communities-AWE: ACL,WebOfTrust,Ego(FOAF) -RDF: reality distortion field :-)  \ntmortagne - (18:02): [upgrade (raised from the dead)] stopping myxwiki.org  \ntmortagne - (18:09): note: i get http://pastebin.com/m53c9f159 in teh log at startup, Nullpointer in scheduler plugin initialization  \nvmassol - (18:09): java.lang.ClassCastException: [Ljava.lang.Object; cannot be cast to [Ljava.lang.String;  \nvmassol - (18:09): \u00a0 \u00a0 \u00a0 \u00a0 at com.xpn.xwiki.internal.DefaultWikiMacroInitializer.registerExistingWikiMacros(DefaultWikiMacroInitializer.java:117)  \ntmortagne - (18:10): thre is several different errors in my pastebin actually  \nvmassol - (18:11): I remember I modified from Object to String  \nvmassol - (18:11): for the wiki macro init stuff I think  \nvmassol - (18:11): but I don't yet understand how it can be a pb  \ntmortagne - (18:12): the nullpointer seems pretty critical if it prevent scheduler job to work, since it happen at init it's possible  \nvmassol - (18:12): it might only be a pb with existing serialized job  \ntmortagne - (18:12): sure but it still make the whole init fail  \nvmassol - (18:12): ah  \nvmassol - (18:13): in any case it needs to be fixed  \ntmortagne - (18:13): which mean if it's the first thing done, it prevend the scheduler to create its main thread  \nvmassol - (18:13): same for wiki macros  \ntmortagne - (18:13): yes  \nvmassol - (18:13): I don't get it  \ntmortagne - (18:14): i'm checking when this is done in the scheduler init  \nvmassol - (18:14): oh  \ntmortagne - (18:14): because if it totally break the scheduler i will have to revert to 2.1  \nvmassol - (18:14): it may simply means we have a bug in wiki macro  \nvmassol - (18:14): :)  \nvmassol - (18:14): I'll fix this one  \nvmassol - (18:14): trying to reproduce locally (should be easy)  \njvdrean left at 18:17 (Quit: Leaving.  \nvmassol - (18:18): ok I can reproduce, fixing  \nvmassol - (18:18): glad we caught it  \nvmassol - (18:19): (we need some wiki macros in XE by default ;))  \ntmortagne - (18:19): does it makes wiki macro unusable ?  \nvmassol - (18:19): no  \nvmassol - (18:19): but it makes them not restart on xwiki restart  \nvmassol - (18:20): any it's a blocker for the 2.2 release  \nvmassol - (18:20): fixing now  \ntmortagne - (18:20): ok so none of the existing macro before the migration are registered now ?  \nvmassol - (18:20): correct  \nvmassol - (18:21): you'll need to save their page to get them registered  \ntmortagne - (18:22): (the scheduler bug is not too critical for myxwiki.org, it's the last thing done in the plugin init and it's about old version of scheduler job)  \nvmassol - (18:22): it's possible the wiki macro prevents xwiki from starting  \ntmortagne - (18:24): i could resave macros but myxwiki.org restart very often so we will not do it at each restart  \ntmortagne - (18:24): seems blocker for myxwiki.org  \nvmassol - (18:24): you should wait for a new snapshot IMO  \nvmassol - (18:24): I need 10 minutes for fixing the bug I think  \nvmassol - (18:24): I can also provide you with a patched core jar  \ntmortagne - (18:27): patched core would be fine  \nvmassol - (18:27): found the pb  \nvmassol - (18:27): 2 mn more  \nvmassol - (18:27): fixed, testing  \nbblfish - (18:29): is this going to work? <dd #if($context.action == ?view?) rel=\"foaf:phone\" href=\"tel:$doc.display('phone')\" class=\"tel\"#end>$doc.display(?phone?)</dd>  \nbblfish - (18:30): the idea is to use the tel: URL there.  \nvmassol - (18:30): it'll probably won't validate against XHTML though, will it?  \nbblfish - (18:31): why?  \nvmassol - (18:31): is href a valid attribute for dd in XHTML?  \nvmassol - (18:31): (haven't checked)  \nbblfish - (18:31): is it possible to make xhtml less strict?  \nbblfish - (18:32): or I mean your interpreter less strict?  \nbblfish - (18:32): that is part of what is required by rdfa  \nvmassol - (18:32): XHTML supports this by adding a namespace and a DTD/schema  \nbblfish - (18:32): no, you are quite right  \nbblfish - (18:32): I should put an <a href=\"\"  \nbblfish - (18:34): but there is an interesting issue about xhtml conformance of rdfa I suppose that will pop up  \nvmassol - (18:34): tmortagne: ok works, committing  \nbblfish - (18:35): perhaps it is xhtml2 specific http://www.w3.org/TR/xhtml-rdfa-primer/  \nbblfish - (18:35): do you expect this to create problems for your parser?  \nbblfish - (18:39): ok, well I suppose we'll find out real soon. I'll stick to really simple relations for the moment.  \nvmassol - (18:39): tmortagne: fixed, do you want the jar or do you want to build it?  \ntmortagne - (18:39): vmassol: i will build it  \nvmassol - (18:40): ok  \ntmortagne - (18:41): i still don't understand how http://jira.xwiki.org/jira/browse/XASCH-49 can happen, the query search for documents with obj.className='XWiki.SchedulerJobClass' and when it ask for jobDoc.getObject(\"XWiki.SchedulerJobClass\"); it gets null  \nmflorea left at 18:41 (Quit: Leaving.  \nbblfish - (18:41): so I suppose I need to be adminstrator to change that file  \nvmassol - (18:42): bblfish: what file?  \nvmassol - (18:43): do you mean page?  \nvmassol - (18:43): if you can edit it then you can save it  \nvmassol - (18:43): to edit it you need to be admin indeed  \nvmassol - (18:43): user: Admin, pwd: admin  \nsdumitriu joined #xwiki at 18:48  \nsdumitriu left at 18:52 (Ping timeout: 240 seconds  \ntmortagne - (18:52): vmassol: i get many logs like http://pastebin.com/m4a67461e  \nKermitTheFragger left at 18:53 (Quit: Leaving  \nvmassol - (18:54): checking code  \ntmortagne - (18:54): looks like registerWikiMacros and buildMacro don agree on what is a wiki macro  \ntmortagne - (18:56): vmassol: actually i'm afrais there is a big in XwikiDocument  \ntmortagne - (18:56): it's exactly the same issue that the scheduler  \ntmortagne - (18:56): doc.getObject(WIKI\\_MACRO\\_CLASS) return null  \ntmortagne - (18:56): even if the document has been requested using some object.classNAme=\"wikimacroclass\"  \ntmortagne - (18:58): pretty critical...  \nvmassol - (18:59): so the object is not added to the map for some reason, is that it?  \nvmassol - (18:59): private Map<DocumentReference, List<BaseObject>> xObjects = new TreeMap<DocumentReference, List<BaseObject>>();  \ntmortagne - (19:00): either the object is not in the map of it doe snot have the right reference  \ntmortagne - (19:00): of the reference generated from getObejct(String) is wrong  \nvmassol - (19:01): ah it might be a case of  \nvmassol - (19:01): some code using getxWikiObjects().put(?.)  \nvmassol - (19:01): checking if I can find that  \ntmortagne - (19:02): its a XWikiDocument coming directly from the storage both times  \nvmassol - (19:03): right now I don't see how the objects get put in the cache  \nvmassol - (19:03): checking  \ntmortagne - (19:04): it's using doc.setXObject(classReference, object.getNumber(), object);  \ntmortagne - (19:04): it seems  \ntmortagne - (19:05): in XwikiHibernateStore#loadXWikiDoc  \nvmassol - (19:05): yes  \nvmassol - (19:05): it looks fine  \nbblfish - (19:06): it does not seem to like the following  \nvmassol - (19:06): if I could reproduce locally I could debug  \nbblfish - (19:06): #if($context.action == 'view')  \nbblfish - (19:06): \u00a0\u00a0<div xmlns:foaf=\"http://xmlns.com/foaf/0.1/\"  \nbblfish - (19:06): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0xmlns:dct=\"http://purl.org/dc/terms/\"  \nbblfish - (19:06): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0xmlns:contact=\"http://www.w3.org/2000/10/swap/pim/contact#\"  \nbblfish - (19:06): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0xmlns:cert=\"http://www.w3.org/ns/auth/cert#\"  \nbblfish - (19:06): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0xmlns:rsa=\"http://www.w3.org/ns/auth/rsa#\"  \nbblfish - (19:06): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0about=\"#me\" typeof=\"foaf:Person\"  \nbblfish - (19:06): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0class=\"vcard\">  \nbblfish - (19:06): \u00a0\u00a0<span typeof=\"foaf:OnlineAccount\" property=\"foaf:accountName\" class=\"fn hidden\">$username</span>  \nbblfish - (19:07): somehow that turns into <div xmlns:foaf=\"<span class=\"wikiexternallink\"><a cl  \nvmassol - (19:07): try using clean=false in the wrapping html macro  \nvmassol - (19:07): you might have found a bug in our cleaning algo  \nvmassol - (19:08): ah no  \nvmassol - (19:08): wait  \nvmassol - (19:08): it's because there's wiki=true in the wrapping html macro  \nvmassol - (19:08): and http:// is wiki syntax for a link  \nvmassol - (19:08): so you need to escape it if you don't want it considered a link  \nvmassol - (19:08): with:  \nvmassol - (19:08): http:~/~/;;;;  \nvmassol - (19:08): oop  \nvmassol - (19:08): oops  \nvmassol - (19:09): http:~/~/......  \nvmassol - (19:09): <div xmlns:foaf=\"http://xmlns.com/foaf/0.1/~/~/http://xmlns.com/foaf/0.1/\" etc  \ntmortagne - (19:09): is wiki macro really needed here ?  \nvmassol - (19:09): no idea, haven't looked  \nbblfish - (19:10): you mean: <div xmlns:foaf=\"http:~/~/xmlns.com/foaf/0.1\"  \nvmassol - (19:10): yes  \nbblfish - (19:10): ok, will try that  \ntmortagne - (19:10): bblfish: do you really need wiki=true ?  \nvmassol - (19:10): tmortagne: how can I reproduce the pb locally?  \njvdrean joined #xwiki at 19:10  \nvmassol - (19:10): maybe it's a pb only in XEM?  \njvdrean left #xwiki at 19:11  \njvdrean joined #xwiki at 19:11  \ntmortagne - (19:11): vmassol: not sure, i did not tryed locally, what happen here is that it load a document that is supposed to have some object and it can't find it, IMO there is an issue in the way the reference is resolved  \nvmassol - (19:12): tmortagne: yes but I've not seen it  \nvmassol - (19:12): and I guess we'd have seen it before  \nvmassol - (19:12): it's not like we don't load docs with objects  \nvmassol - (19:12): might be the ref although we have tests for that  \ntmortagne - (19:13): vmassol: sure but there is a bug for sure the hql request selected document with object of a specifc class and getObject can't fin dit  \ntmortagne - (19:13): mayeb there is a bug in multiwiki  \nvmassol - (19:13): indeed the multiwiki part has not been tested  \nvmassol - (19:13): for wiki macros  \nvmassol - (19:14): reading again code for multiwki  \nvmassol - (19:14): hmm it's pretty much the same code but maybe the ref gets the wiki added which we don't normally  \ntmortagne - (19:15): it's not about wiki macros  \nvmassol - (19:16): ok I have some idea  \nvmassol - (19:16): hmmm no  \nvmassol - (19:19): tmortagne: I need a way to reproduce it  \ntmortagne - (19:20): did you tried in a sub wiki ?  \nvmassol - (19:20): testing something  \nvmassol - (19:20): I don't have a subwiki  \nCalebJamesDeLisl joined #xwiki at 19:21  \njvdrean left at 19:21 (Quit: Leaving.  \nvmassol - (19:23): ok found the pb I think  \nvmassol - (19:24): It's in resolveReferenceWithSpecificSpace  \nvmassol - (19:24): this doesn't pass:  \nvmassol - (19:24): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0DocumentReference expected3 = new DocumentReference(\"wiki\", \"space\", \"page\");  \nvmassol - (19:24): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0assertEquals(expected2, doc.resolveReferenceWithSpecificSpace(\"wiki:space.page\", \"XWiki\"));  \nvmassol - (19:24): now fixing code  \nvmassol - (19:24): oops  \nvmassol - (19:24): expected2  \nvmassol - (19:24): grrr  \nvmassol - (19:25): false aler, it passes  \nvmassol - (19:25): \\*alert  \nvmassol - (19:26): tmortagne: I have to go now, but I'll try to fix it later. If you can reproduce it locally please let me know  \nvmassol left at 19:27 (Quit: Leaving.  \nbblfish - (19:36): well I think I have generated some rdfa now  \nbblfish - (19:36): the trick will be to test it. As it is on localhost, I can't use any of the online rdfa parsers  \nbblfish - (19:37): there are a few tools one can use to do this...  \nbblfish - (19:37): will look into them  \nxenon75 joined #xwiki at 19:47  \ntmortagne left at 19:50 (Quit: Leaving.  \nxenon75 left at 19:55 (Quit: Leaving.  \ntmortagne joined #xwiki at 20:49  \ntmortagne left at 20:49 (Client Quit  \nflaviusolaru joined #xwiki at 21:11  \nflaviusolaru left at 21:22 (Quit: Leaving.  \nbblfish left at 21:32 (Read error: Connection reset by peer  \nbblfish joined #xwiki at 21:43  \nvmassol joined #xwiki at 22:30  \nflorinciu left at 23:20 (Read error: Connection reset by peer  \n}}}\n"}