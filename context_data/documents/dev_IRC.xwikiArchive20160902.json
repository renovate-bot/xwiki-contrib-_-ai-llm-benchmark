{"id": "dev:IRC.xwikiArchive20160902", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20160902", "title": "IRC Archive for channel #xwiki on 02 September 2016 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<Aranjedeath>\u00a0has quit  \n07:07\u00a0<DarkKnightCZ>\u00a0has joined #xwiki  \n07:54\u00a0<vmassol>\u00a0has joined #xwiki  \n08:11\u00a0<woshilapin>\u00a0has quit  \n08:18\u00a0<vmassol1>\u00a0has joined #xwiki  \n08:18\u00a0<vmassol>\u00a0has quit  \n08:23\u00a0<vmassol1>\u00a0good morning  \n08:43\u00a0<vmassol1>\u00a0has quit  \n09:08\u00a0<vmassol>\u00a0has joined #xwiki  \n09:11\u00a0<acotiuga>\u00a0has joined #xwiki  \n09:13\u00a0<vmassol1>\u00a0has joined #xwiki  \n09:13\u00a0<vmassol>\u00a0has quit  \n09:13\u00a0<vmassol1>\u00a0thanks Alex (for the BFD)  \n09:14\u00a0<vmassol1>\u00a0is now known as <vmassol>  \n09:16\u00a0<tmortagne>\u00a0has joined #xwiki  \n09:16\u00a0<acotiuga>\u00a0Good morning  \n09:21\u00a0<vmassol>\u00a0@acotiuga: I've added explanations to http://dev.xwiki.org/xwiki/bin/view/Community/Testing#HXARTesting if you're interested  \n09:21\u00a0<vmassol>\u00a0(fyi)  \n09:21\u00a0<vmassol>\u00a0now I'm checking if I can speed up a bit the test  \n09:21\u00a0<vmassol>\u00a0it takes too long for my taste  \n09:21\u00a0<vmassol>\u00a0basically 3s for the first test  \n09:22\u00a0<vmassol>\u00a0already found that one problem is the TIKA init which takes 800ms to intiialize even though we don't need it for the majority of tests  \n09:29\u00a0<acotiuga>\u00a0useful information :) thanks  \n09:33\u00a0<woshilapin>\u00a0has joined #xwiki  \n09:34\u00a0<Denis1>\u00a0has quit  \n09:36\u00a0<msmeria>\u00a0has joined #xwiki  \n09:38\u00a0<msmeria>\u00a0has quit  \n09:40\u00a0<msmeria>\u00a0has joined #xwiki  \n09:41\u00a0<mflorea>\u00a0has joined #xwiki  \n10:10\u00a0<Pbas>\u00a0Hello, I upgrade my xwiki 7.0.1 to 8.2.1 but I have 2 problem: ldapsauthentication doesn't work anymore and postgresql connexion with jndi doesn't work anymore.  \n10:11\u00a0<Pbas>\u00a0With ldap debug mode show me this error  \n10:11\u00a0<Pbas>\u00a02016-09-02 09:56:57,896 [https://xwiki-dev.dom.cp2i.i2/bin/loginsubmit/XWiki/XWikiLogin] DEBUG u.i.L.XWikiLDAPAuthServiceImpl - Local LDAP authentication failed.  \n10:11\u00a0<Pbas>\u00a0java.lang.ClassCastException: null  \n10:16\u00a0<Pbas>\u00a0(I will activate all ldap logging may be to have a more explicit log)  \n10:17\u00a0<vmassol>\u00a0Pbas: hi, sorry can't help you much on this  \n10:17\u00a0<vmassol>\u00a0(on my side)  \n10:17\u00a0<Enygma`>\u00a0has joined #xwiki  \n10:18\u00a0<Pbas>\u00a0ok thxs anyway  \n10:18\u00a0<evalica>\u00a0has joined #xwiki  \n10:21\u00a0<Pbas>\u00a0nope: when I increase ldap level, same log: \u00a0Local LDAP authentication failed. java.lang.ClassCastException: null :-/  \n10:23\u00a0<vmassol>\u00a0maybe you've used a wrong class name in the config?  \n10:23\u00a0<vmassol>\u00a0(or maybe there's a bug)  \n10:23\u00a0<Pbas>\u00a0strange, authentification working well I think becasue if i typing a wrong password, my log display: Local LDAP authentication failed. com.novell.ldap.LDAPException: Invalid Credentials  \n10:25\u00a0<Pbas>\u00a0About class name in my conf, do you talking about ldap mapping attribute?  \n10:27\u00a0<vmassol>\u00a0don't know :)  \n10:27\u00a0<vmassol>\u00a0I was talking in general  \n10:30\u00a0<Pbas>\u00a0k i will test my ldap authentication with xwiki 7.0.1 and java8 may be (before I use java7)  \n10:46\u00a0<tmortagne>\u00a0Pbas: it's very weird to get a java.lang.ClassCastException without the actual class  \n10:48\u00a0<Pbas>\u00a0I'm weird ... Anyway I activate this line in xwiki.cfg xwiki.authentication.authclass=com.xpn.xwiki.user.impl.LDAP.XWikiLDAPAuthServiceImpl and I have this in log java.lang.ClassCastException: java.lang.String cannot be cast to java.lang.Number now  \n10:48\u00a0<tmortagne>\u00a0could you pasted the complete stack trace  \n10:48\u00a0<tmortagne>\u00a0to understand where exactly is this classcast  \n10:49\u00a0<Pbas>\u00a0yes (I must found a webserver to paste my log)  \n10:50\u00a0<Pbas>\u00a0ha pastebin!  \n10:52\u00a0<sagarhani>\u00a0has quit  \n10:53\u00a0<sagarhani>\u00a0has joined #xwiki  \n10:58\u00a0<tmortagne>\u00a0without more details I would bet on a field which is a Number on LDAP side and a String on XWiki user profile side, StringClass#fromValue does not seems to take much care of the type of the passed value  \n10:59\u00a0<Pbas>\u00a0Here: http://pastebin.com/HeEjBZ0R  \n11:00\u00a0<tmortagne>\u00a0yep that seems to be it  \n11:00\u00a0<Pbas>\u00a0then I will deactivate temporaly ldap attribute mapping to test  \n11:00\u00a0<tmortagne>\u00a0will need to bulletproof on LDAP authenticator side, new version coming quickly  \n11:01\u00a0<tmortagne>\u00a0(I think it's the first time I see a LDAP server send actual Integer and not number as a String in my tests)  \n11:03\u00a0<Pbas>\u00a0Anyway I must activate this line in xwiki.cfg ? # xwiki.authentication.authclass=com.xpn.xwiki.user.impl.LDAP.XWikiLDAPAuthServiceImpl (on 7.0.1 I disabled it)  \n11:05\u00a0<tmortagne>\u00a0well this line indicate to use the LDAP authenticator so you probably have it somewhere in your configuration file or you would not have LDAP  \n11:07\u00a0<Pbas>\u00a0ok it's mapping fault  \n11:08\u00a0<Pbas>\u00a0with short mapping like this one: xwiki.authentication.ldap.fields\\_mapping=last\\_name=sn,first\\_name=givenName,email=mineqMelmailEmission  \n11:08\u00a0<Pbas>\u00a0ldap authentication working (with xwiki.authentication.authclass=com.xpn.xwiki.user.impl.LDAP.XWikiLDAPAuthServiceImpl disabled :-/ )  \n11:11\u00a0<tmortagne>\u00a0Pbas: you must have it set somewhere  \n11:11\u00a0<tmortagne>\u00a0it cannot work without it  \n11:11\u00a0<tmortagne>\u00a0or you did not restarted XWiki after disabling it  \n11:14\u00a0<Pbas>\u00a0yes I restart tomcat and in xwiki.cfg I haven't this line. I didn't have ldap extension installed (but I installed ldap extension once and removed)  \n11:14\u00a0<Pbas>\u00a0it doesn't matter I will enabled this line :-)  \n11:15\u00a0<tmortagne>\u00a0what ldap extension are you talking about ?  \n11:16\u00a0<Pbas>\u00a0LDAP Authenticator par : Thomas Mortagne, xwiki dev  \n11:17\u00a0<Pbas>\u00a0To fix my problem I suppose I must edit xwiki user class (integer or sstring field)  \n11:18\u00a0<tmortagne>\u00a0wait you are using the new LDAP authenticator I release this week and not the one embedded in XWiki 8.2.1 ?  \n11:19\u00a0<tmortagne>\u00a0hmm no it does not seems so according to you stack trace so I don't understand  \n11:19\u00a0<Pbas>\u00a0No I use the one embedded in XWiki 8.2.1 but I rember with 7.0.1 there was a ldap extension to configure ldap authentication  \n11:20\u00a0<tmortagne>\u00a0just a UI  \n11:20\u00a0<tmortagne>\u00a0should not have any impact on xwiki.authentication.authclass property which can only be set in xwiki.cfg  \n11:21\u00a0<Pbas>\u00a0then I check my xwiki.cfg and I have not enabled \"xwiki.authentication.authclass=com.xpn.xwiki.user.impl.LDAP.XWikiLDAPAuthServiceImpl\" line  \n11:21\u00a0<Pbas>\u00a0may be you enabled with xwiki.authentication.ldap=1  \n11:22\u00a0<tmortagne>\u00a0crap, looks like we still have this old hack in XWiki class  \n11:23\u00a0<tmortagne>\u00a0so indeed xwiki.authentication.ldap=1 seems to be enough in 8.2.1 but it's not a good idea  \n11:23\u00a0<tmortagne>\u00a0going to remove that ASAP  \n11:23\u00a0<Pbas>\u00a0wow ... sorry ;-)  \n11:34\u00a0<Pbas>\u00a0You though on a field which is a Number on LDAP side and a String on XWiki user profile side, but I just saw I use a number field in my user profil, probably it is the problem (it's working well on 7.0.1 anyway)  \n11:39\u00a0<edvorg>\u00a0has joined #xwiki  \n11:39\u00a0<tmortagne>\u00a0Pbas: yes actually it's the opposite, a number on XWiki side  \n11:41\u00a0<Pbas>\u00a0YES! that's it! I just fix my postalcode field in my XWiki/XWikiUsers class  \n11:42\u00a0<Pbas>\u00a0thxs a lot for your help :)  \n11:43\u00a0<lucaa>\u00a0has joined #xwiki  \n11:43\u00a0<Pbas>\u00a0(my postalcode field was a number type)  \n11:46\u00a0<lucaa>\u00a0has quit  \n11:47\u00a0<lucaa>\u00a0has joined #xwiki  \n11:51\u00a0<tmortagne>\u00a0Pbas: currently releasing a new version of the LDAP auth with a fix  \n11:53\u00a0<Pbas>\u00a0ok a fix about com.xpn.xwiki.user.impl.LDAP.XWikiLDAPAuthServiceImpl parameter ?  \n11:54\u00a0<tmortagne>\u00a0a fix about your classcast, better support of conversion  \n11:54\u00a0<Pbas>\u00a0ok thxs  \n11:55\u00a0<tmortagne>\u00a0the good news is that you'll be able to use it right now, the trick is that it's a new Contrib LDAP authenticator extension you will need to install with a different name (the xwiki.authentication.authclass property)  \n11:56\u00a0<tmortagne>\u00a0since 8.3 LDAP has it's own life and I made it compatible with 7.4+ so that older version can benefit from new features and fixes (like in you case)  \n11:58\u00a0<Pbas>\u00a0k :)  \n11:59\u00a0<tmortagne>\u00a0Pbas: so if you want this new fix you will need to:  \n11:59\u00a0<tmortagne>\u00a0\\* install \"LDAP Authenticator\" on root in Extension Manager  \n11:59\u00a0<tmortagne>\u00a0\\* go to xwiki.cfg and change the xwiki.authentication.authclass according to http://extensions.xwiki.org/xwiki/bin/view/Extension/LDAP/Authenticator/#HGenericLDAPconfiguration  \n12:02\u00a0<tmortagne>\u00a0you will have the new authenticator that will be used and the old one that won't do anything anymore  \n12:02\u00a0<lucaa>\u00a0has quit  \n12:06\u00a0<Pbas>\u00a0ok ty, I must go home to go on the beach with my daughter (she want to learn windsurfing :-/ ) have a nice WE  \n12:09\u00a0<tmortagne>\u00a0Pbas: you too :)  \n12:42\u00a0<edvorg>\u00a0has quit  \n13:07\u00a0<DarkKnightCZ>\u00a0has quit  \n13:07\u00a0<[d\\_\\_d]>\u00a0has quit  \n13:11\u00a0<[d\\_\\_d]>\u00a0has joined #xwiki  \n13:12\u00a0<DarkKnightCZ>\u00a0has joined #xwiki  \n13:54\u00a0<vmassol>\u00a0Pbas: nice\u2026 enjoy windsurf, lucky you!  \n14:07\u00a0<ekarlso\\_>\u00a0has joined #xwiki  \n14:11\u00a0<ekarlso\\_>\u00a0has quit  \n14:27\u00a0<edvorg>\u00a0has joined #xwiki  \n14:40\u00a0<DarkKnightCZ>\u00a0has quit  \n14:54\u00a0<edvorg>\u00a0has quit  \n14:55\u00a0<edvorg>\u00a0has joined #xwiki  \n15:02\u00a0<DarkKnightCZ>\u00a0has joined #xwiki  \n15:10\u00a0<edvorg>\u00a0has quit  \n15:16\u00a0<DarkKnightCZ>\u00a0has quit  \n15:40\u00a0<DarkKnightCZ>\u00a0has joined #xwiki  \n15:56\u00a0<DarkKnightCZ>\u00a0has quit  \n16:57\u00a0<msmeria>\u00a0has quit  \n17:01\u00a0<acotiuga>\u00a0has quit  \n17:02\u00a0<evalica>\u00a0has quit  \n17:12\u00a0<Aranjedeath>\u00a0has joined #xwiki  \n17:35\u00a0<tmortagne>\u00a0vmassol: [ERROR] src/main/java/org/xwiki/test/page/PageTest.java:[80,1] (metrics) ClassFanOutComplexity: Class Fan-Out Complexity is 21 (max allowed is 20).  \n17:35\u00a0<vmassol>\u00a0argh :)  \n17:35\u00a0<vmassol>\u00a0the dreaded one!  \n17:35\u00a0<tmortagne>\u00a0the fun one  \n17:35\u00a0<vmassol>\u00a0thanks, handling it  \n17:37\u00a0<vmassol>\u00a0it's strange actually since I've removed stuff in my commit  \n17:37\u00a0<vmassol>\u00a0anyway, checking  \n17:43\u00a0<vmassol>\u00a0rok I know why  \n17:43\u00a0<vmassol>\u00a0s/rok/ok  \n17:47\u00a0<mflorea>\u00a0has quit  \n18:02\u00a0<vmassol>\u00a0tmortagne: I wonder how much of what's in https://github.com/xwiki/xwiki-platform/blob/32543ee278f65740f609f79b56eb85fdf03e0c4e/xwiki-platform-core/xwiki-platform-test/xwiki-platform-test-page/src/main/java/org/xwiki/test/page/PageTest.java#L199-L199 could be moved to mockitooldcorerule  \n18:02\u00a0<vmassol>\u00a0depends if we're ok to have default values in there or not  \n18:03\u00a0<vmassol>\u00a0may be too specific for mockitooldcorerule  \n18:03\u00a0<tmortagne>\u00a0we have a few default value already, mostly in the context  \n18:04\u00a0<tmortagne>\u00a0but not much  \n18:04\u00a0<vmassol>\u00a0for example:  \n18:04\u00a0<vmassol>\u00a0ExecutionContextManager ecm = mocker.getInstance(ExecutionContextManager.class);  \n18:04\u00a0<vmassol>\u00a0ecm.initialize(oldcore.getExecutionContext());  \n18:04\u00a0<tmortagne>\u00a0things like wiki and locale  \n18:04\u00a0<tmortagne>\u00a0there is a default ExecutionContextManager already  \n18:05\u00a0<tmortagne>\u00a0hmm not this one actually  \n18:05\u00a0<tmortagne>\u00a0there is a default Execution  \n18:05\u00a0<tmortagne>\u00a0there is a lot of default components  \n18:09\u00a0<tmortagne>\u00a0has quit  \n18:23\u00a0<vmassol>\u00a0build should be better now, sorry about that  \n18:28\u00a0<vmassol>\u00a0not particularly proud of my solution though\u2026 :)  \n18:32\u00a0<sagarhani>\u00a0has quit  \n18:32\u00a0<sagarhani>\u00a0has joined #xwiki  \n19:17\u00a0<OSIMasson>\u00a0has joined #xwiki  \n19:22\u00a0<OSIMasson>\u00a0Looking to change access rights to public wiki: non-reg users can view, but not edit. Reviewing this page: http://platform.xwiki.org/xwiki/bin/view/AdminGuide/Access+Rights I am told to add a new user \"XWiki.XWikiGuest\" where do I add that?  \n19:25\u00a0<Enygma`>\u00a0has quit  \n19:29\u00a0<vmassol>\u00a0Hi OSIMasson  \n19:29\u00a0<vmassol>\u00a0the doc is wrong, fixing  \n19:30\u00a0<vmassol>\u00a0not sure how this slipped through  \n19:33\u00a0<OSIMasson>\u00a0vmassol: thanks  \n19:35\u00a0<OSIMasson>\u00a0vmassol: This is also included in other documentation, https://network.xwiki.com/xwiki/bin/view/DocXCS2En/WikiAccessConfiguration  \n19:37\u00a0<OSIMasson>\u00a0vmassol: That 2nd page was more clear, and enabled me to fix the issue, thanks  \n19:38\u00a0<vmassol>\u00a0OSIMasson: see http://platform.xwiki.org/xwiki/bin/view/AdminGuide/Access+Rights#HOpenWiki  \n19:38\u00a0<OSIMasson>\u00a0vmassol: Thx - all good!  \n19:39\u00a0<vmassol>\u00a0np  \n19:42\u00a0<vmassol>\u00a0haha if you ask on multiple channels you'll get multiple answers\u2026.  \n19:42\u00a0<vmassol>\u00a0;)  \n19:56\u00a0<OSIMasson>\u00a0vmassol: I need multiple explanations--\"I not good at being smrat\" The XWiki community is AWESOME!  \n19:57\u00a0<vmassol>\u00a0has quit  \n20:03\u00a0<vmassol>\u00a0has joined #xwiki  \n20:15\u00a0<DarkKnightCZ>\u00a0has joined #xwiki  \n21:57\u00a0<sdumitriu1>\u00a0has quit  \n22:58\u00a0<DarkKnightCZ>\u00a0has quit  \n23:11\u00a0<DarkKnightCZ>\u00a0has joined #xwiki  \n23:29\u00a0<DarkKnightCZ>\u00a0has quit\n"}