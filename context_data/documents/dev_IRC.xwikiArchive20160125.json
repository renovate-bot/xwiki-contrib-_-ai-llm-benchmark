{"id": "dev:IRC.xwikiArchive20160125", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20160125", "title": "IRC Archive for channel #xwiki on 25 January 2016 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<mflorea>\u00a0has joined #xwiki  \n07:12\u00a0<zzeroo>\u00a0has joined #xwiki  \n07:15\u00a0<msmeria>\u00a0has joined #xwiki  \n07:37\u00a0<mflorea>\u00a0has quit  \n07:55\u00a0<Pbas>\u00a0has joined #xwiki  \n08:13\u00a0<zzeroo>\u00a0has quit  \n08:47\u00a0<vmassol>\u00a0has joined #xwiki  \n08:51\u00a0<vmassol>\u00a0has quit  \n08:51\u00a0<vmassol1>\u00a0has joined #xwiki  \n08:54\u00a0<vmassol>\u00a0has joined #xwiki  \n08:55\u00a0<vmassol1>\u00a0has quit  \n08:55\u00a0<KermitTheFragger>\u00a0has joined #xwiki  \n09:03\u00a0<Enygma`>\u00a0has joined #xwiki  \n09:12\u00a0<Pbas>\u00a0has quit  \n09:15\u00a0<mflorea>\u00a0has joined #xwiki  \n09:37\u00a0<tmortagne>\u00a0has joined #xwiki  \n09:38\u00a0<gdelhumeau>\u00a0has joined #xwiki  \n09:40\u00a0<evalica>\u00a0has joined #xwiki  \n10:21\u00a0<Slashman>\u00a0has joined #xwiki  \n10:26\u00a0<evalica1>\u00a0has joined #xwiki  \n10:27\u00a0<woshilapin>\u00a0has joined #xwiki  \n10:29\u00a0<evalica>\u00a0has quit  \n10:38\u00a0<gdelhumeau>\u00a0has quit  \n11:32\u00a0<gdelhumeau>\u00a0has joined #xwiki  \n12:00\u00a0<woshilapin>\u00a0has quit  \n12:24\u00a0<woshilapin>\u00a0has joined #xwiki  \n12:49\u00a0<ClemensR>\u00a0has joined #xwiki  \n14:16\u00a0<tmortagne>\u00a0mflorea: maybe you have an idea about XWIKI-13031  \n14:17\u00a0<tmortagne>\u00a0only tested it on 7.4  \n14:20\u00a0<tmortagne>\u00a0what is weird is that the error does no seems to have any thing to do with the locales but the only way I found to reproduce it is to put several locales in the configuration, just modifying XWikiPreference is not enough  \n14:21\u00a0<mflorea>\u00a0it points to  \n14:21\u00a0<mflorea>\u00a0String wikiName = (String) solrDocument.get(FieldUtils.WIKI);  \n14:21\u00a0<tmortagne>\u00a0yep  \n14:21\u00a0<tmortagne>\u00a0that's why I say I don't see how it's related to locales setup  \n14:21\u00a0<tmortagne>\u00a0but it happen only when I put several locale i the available locales (no error when there is only one)  \n14:21\u00a0<mflorea>\u00a0so it suggests that get() returns org.apache.lucene.document.Field instead of String  \n14:22\u00a0<tmortagne>\u00a0yes that I understood  \n14:22\u00a0<tmortagne>\u00a0but it's getting the valie of WIKI field  \n14:22\u00a0<mflorea>\u00a0maybe the document is indexed in a different way when there are multiple locates  \n14:22\u00a0<mflorea>\u00a0let me try locally  \n14:23\u00a0<tmortagne>\u00a0it's a new thing for sure since I often do changes like this  \n14:23\u00a0<mflorea>\u00a0are you sure the instance is clean? it doesn't share the permanent directory with an old XWiki instance right?  \n14:23\u00a0<tmortagne>\u00a0I just unzipped the jetty/hsqldb distribution  \n14:23\u00a0<mflorea>\u00a0ok  \n14:25\u00a0<mflorea>\u00a0I have a snapshot from one week ago (or so) and I don't reproduce.  \n14:25\u00a0<tmortagne>\u00a0could you try with 7.4 just to make sure I'm not the only one reproducing it  \n14:25\u00a0<tmortagne>\u00a0will download last snapshot  \n14:26\u00a0<tmortagne>\u00a0by snapshot you mean 8.0-SNAPSHOT or 7.4.1-SNAPSHOT ?  \n14:26\u00a0<mflorea>\u00a08.0-SNAPSHOT  \n14:26\u00a0<mflorea>\u00a0let me check with 7.4  \n14:26\u00a0<mflorea>\u00a0you have only one wiki?  \n14:26\u00a0<tmortagne>\u00a0yes, the steps I indicated in the issue are just after uzipping the distribution  \n14:27\u00a0<mflorea>\u00a0ok  \n14:27\u00a0<tmortagne>\u00a0there is nothing else  \n14:29\u00a0<tmortagne>\u00a0did you set multilanguage to true ?  \n14:29\u00a0<tmortagne>\u00a0\u00a0forgot to indicate that in the issue  \n14:30\u00a0<ClemensR>\u00a0oh, I can reporduce with a 7.4 jetty/hsql distro (but content was updated from 7.2)  \n14:30\u00a0<tmortagne>\u00a0I can reproduce on 7.4.1-SNASHOT  \n14:30\u00a0<tmortagne>\u00a0trying 8.0  \n14:31\u00a0<ClemensR>\u00a0does not seem to cause user-visible problems however  \n14:31\u00a0<tmortagne>\u00a0not right now but it's not a good sign for the search  \n14:31\u00a0<tmortagne>\u00a0s/right now/right away/  \n14:32\u00a0<tmortagne>\u00a0mflorea: same issue on 8.0-SNAPSHOT for me, you probably did not enabled multi language  \n14:32\u00a0<mflorea>\u00a0I did  \n14:32\u00a0<mflorea>\u00a0because I needed to edit doc translations with CKEditor  \n14:33\u00a0<tmortagne>\u00a0then maybe it's the Java version but that's weird, it's 1.8.0\\_66 in my case  \n14:33\u00a0<tmortagne>\u00a0maybe you have some changes locally that hide the problem  \n14:34\u00a0<tmortagne>\u00a0better test with a fresh distribution  \n14:34\u00a0<mflorea>\u00a0yes, I'm downloading a fresh 7.4 now  \n14:34\u00a0<mflorea>\u00a0checking also with the latest 8.0-SNAPSHOT  \n14:35\u00a0<mflorea>\u00a0what languages did you put?  \n14:36\u00a0<tmortagne>\u00a0\"en, fr\"  \n14:36\u00a0<tmortagne>\u00a0but I had the issue firs with another one  \n14:36\u00a0<tmortagne>\u00a0I doubt it matter  \n14:37\u00a0<tmortagne>\u00a0important thing is having several IMO  \n14:37\u00a0<tmortagne>\u00a0(so that the field move to a list of values)  \n14:37\u00a0<mflorea>\u00a0I put \"en,ro,fr,de\", and I tested by going to Main.Welcome and selecting a different language from the drawer on the right  \n14:38\u00a0<mflorea>\u00a0I cannot reproduce on the latest 8.0-SNAPSHOT  \n14:38\u00a0<mflorea>\u00a0checking 7.4  \n14:38\u00a0<tmortagne>\u00a0you don't need to do anything else that setting the property  \n14:38\u00a0<tmortagne>\u00a0it's not when you switch  \n14:38\u00a0<ClemensR>\u00a0after changing to single language and then again back to multi-language, it is no longer reproducible here  \n14:38\u00a0<tmortagne>\u00a0it's when you save the configuration  \n14:38\u00a0<tmortagne>\u00a0are you sure you enabled multi language ?  \n14:38\u00a0<mflorea>\u00a0yes  \n14:38\u00a0<mflorea>\u00a0otherwise I wouldn't get the Languages entry in the drawer  \n14:39\u00a0<tmortagne>\u00a0try the exact thing I put in the issue (\"en, fr\" with the white space)  \n14:39\u00a0<tmortagne>\u00a0maybe it's related to the white space someway  \n14:39\u00a0<tmortagne>\u00a0but you'll probably need to reset the whole thing first  \n14:39\u00a0<mflorea>\u00a0yep  \n14:39\u00a0<mflorea>\u00a0I can reproduce now  \n14:40\u00a0<mflorea>\u00a0so it must be the white space  \n14:40\u00a0<mflorea>\u00a0no problem if I remove it  \n14:40\u00a0<tmortagne>\u00a0ok changing issue title  \n14:40\u00a0<ClemensR>\u00a0not reproducible with java7, freshly unzipped jetty-hsql  \n14:42\u00a0<ClemensR>\u00a0on the other hand the indexer has still been running when I switched to multi language  \n14:42\u00a0<tmortagne>\u00a0AFAIK I always put a white space in this list and I use Java 8 since a long time with jetty/hsqldb  \n14:43\u00a0<mflorea>\u00a0I usually don't add the whitespace so that's why I didn't noticed this before  \n14:44\u00a0<mflorea>\u00a0but it's strange how this can affect the type returned by solrDocument.get(FieldUtils.WIKI)  \n14:44\u00a0<tmortagne>\u00a0yes  \n14:44\u00a0<tmortagne>\u00a0unless the value ends up in that field fr some weird reason  \n14:44\u00a0<ClemensR>\u00a0ah, I \\*can\\* reproduce it with java7, but only after the \"initial\" reindexing finished  \n14:45\u00a0<tmortagne>\u00a0ClemensR: the initial index is probably just quicker on Java 8  \n14:45\u00a0\\*\u00a0ClemensR retries from scratch ... waiting for the indexer to finish  \n14:45\u00a0<tmortagne>\u00a0or XWikiPreference is not saved in the same order in Java 8 and Java 7 maybe  \n14:46\u00a0<ClemensR>\u00a0yes, that might even explain it ... I can even get the exception when changing the multi-lang from \"yes\" to \"No\" - but only once  \n14:48\u00a0<tmortagne>\u00a0I can reproduce it as many time as I want by switching between \"en\" and \"en, \u00a0fr\"  \n14:49\u00a0<tmortagne>\u00a0if you change something else it won't have much impact because solr indexer only take into account what changed, as little as an object property  \n14:50\u00a0<tmortagne>\u00a0(it listen to all entity related events, not just documents)  \n14:51\u00a0<tmortagne>\u00a0now supported language is a bit special and at least used to have some more impact that itself  \n14:51\u00a0<ClemensR>\u00a0indeed, but I only get it when changing to \"en, fr\"  \n14:52\u00a0<tmortagne>\u00a0you mean you don't reproduce with another existing locale ?  \n14:52\u00a0<ClemensR>\u00a0not if changeng to \"en fr\"  \n14:52\u00a0<tmortagne>\u00a0white space is not a separator I think  \n14:52\u00a0<tmortagne>\u00a0not really  \n14:52\u00a0<ClemensR>\u00a0\"en, it\" reproduces, so it seems it is the comma  \n14:53\u00a0<ClemensR>\u00a0I always only used whitespace to separate the locales ... even in production ;)  \n14:53\u00a0<tmortagne>\u00a0ok  \n14:53\u00a0<tmortagne>\u00a0so maybe the issue come from having an empty locale then  \n14:53\u00a0<ClemensR>\u00a0ah, \"en,it\" \u00a0(no ws) does not produce any error  \n14:54\u00a0<tmortagne>\u00a0(note that empty string is a valid locale)  \n14:54\u00a0<tmortagne>\u00a0(it's the root of all locales)  \n14:55\u00a0<tmortagne>\u00a0I get the same error with \" fr\" (start with a white space)  \n14:56\u00a0<tmortagne>\u00a0so indeed I think it have more to do with having an empty white space in the list  \n14:58\u00a0<tmortagne>\u00a0(Ok so at least I learned that putting \", \" is a nonsense in there)  \n15:00\u00a0<msmeria>\u00a0has quit  \n15:02\u00a0<ClemensR>\u00a0cannot reproduce with 7.2, btw  \n15:27\u00a0<ClemensR>\u00a0reproducible with 7.3, however  \n16:07\u00a0<tmortagne>\u00a0ClemensR: ok, updated the affects  \n17:05\u00a0<tmortagne>\u00a0gdelhumeau: should I just ignore failing test in http://ci.xwiki.org/job/xwiki-enterprise-test-webstandards-7.4.x/ ?  \n17:06\u00a0<tmortagne>\u00a0(looking at stuff for 7.4.1 release)  \n17:07\u00a0<gdelhumeau>\u00a0tmortagne: normally yes (it's not fully fixed right now)  \n17:07\u00a0<tmortagne>\u00a0ok  \n17:07\u00a0<gdelhumeau>\u00a0But I'm a bit surprise that there is more failures than in master  \n17:08\u00a0<gdelhumeau>\u00a0because I've backported commits  \n17:08\u00a0<gdelhumeau>\u00a0this is weird for example: http://ci.xwiki.org/job/xwiki-enterprise-test-webstandards-7.4.x/lastBuild/org.xwiki.enterprise$xwiki-enterprise-test-webstandards/testReport/org.xwiki.test.webstandards.framework/DefaultValidationTest/Validating\\_XWiki\\_validity\\_for\\_\\_space\\_Code\\_\\_page\\_NotificationsMenuUIX\\_executed\\_with\\_credentials\\_Admin\\_admin/  \n17:10\u00a0<gdelhumeau>\u00a0damn I've not backported XWIKI-12971 nor closed it  \n17:10\u00a0<gdelhumeau>\u00a0is it to late to backport it?  \n17:10\u00a0<tmortagne>\u00a0Enygma`: I guess this one is for you (Rule violated for bundle XWiki Platform - Rendering - XWiki-specific implementation: instructions covered ratio is 0.70, but expected minimum is 0.72) (nothing to do with 7.4.1 but I saw platform master was failing)  \n17:10\u00a0<tmortagne>\u00a0gdelhumeau: no you can backport  \n17:10\u00a0<gdelhumeau>\u00a0thx  \n17:11\u00a0<tmortagne>\u00a0won't release before tomorrow and anyway we still have 11 issue open for 7.4.1 with one blocker  \n17:16\u00a0<tmortagne>\u00a0vmassol: looks like you forgot to backport on 7.4 whatever was causing testVfsMacro to fail  \n17:16\u00a0<tmortagne>\u00a0or then there is an new issue  \n17:16\u00a0<tmortagne>\u00a0see http://ci.xwiki.org/job/xwiki-platform-7.4.x/lastBuild/org.xwiki.platform$xwiki-platform-vfs-test-tests/testReport/org.xwiki.vfs.test.ui/VfsTest/testVfsMacro/  \n17:17\u00a0<tmortagne>\u00a0http://ci.xwiki.org/job/xwiki-platform-7.4.x/org.xwiki.platform$xwiki-platform-vfs-test-tests/52/testReport/junit/org.xwiki.vfs.test.ui/VfsTest/testVfsMacro/  \n17:17\u00a0<tmortagne>\u00a0more stable link)  \n17:25\u00a0<KermitTheFragger>\u00a0has quit  \n17:30\u00a0<vmassol>\u00a0(sorry was otp catching up)  \n17:35\u00a0<vmassol>\u00a0tmortagne: strange, I had backported the fix: http://jira.xwiki.org/browse/XWIKI-12967  \n17:35\u00a0<mflorea>\u00a0has quit  \n17:36\u00a0<vmassol>\u00a0so I guess I'll have to debug the new problem on the 7.4.x branch...  \n17:39\u00a0<tmortagne>\u00a0has quit  \n18:05\u00a0<tmortagne>\u00a0has joined #xwiki  \n18:12\u00a0<woshilapin>\u00a0has quit  \n18:15\u00a0<vmassol>\u00a0success :)  \n18:55\u00a0<tmortagne>\u00a0has quit  \n18:59\u00a0<evalica1>\u00a0has quit  \n18:59\u00a0<evalica>\u00a0has joined #xwiki  \n19:00\u00a0<evalica>\u00a0has quit  \n19:24\u00a0<ClemensR>\u00a0has quit  \n20:27\u00a0<abusenius>\u00a0has joined #xwiki  \n20:57\u00a0<Slashman>\u00a0has quit  \n21:05\u00a0<vmassol>\u00a0has quit  \n21:05\u00a0<woshilapin>\u00a0has joined #xwiki  \n21:07\u00a0<gdelhumeau>\u00a0has quit  \n22:18\u00a0<woshilapin>\u00a0has quit  \n22:26\u00a0<woshilapin>\u00a0has joined #xwiki  \n22:38\u00a0<Enygma`>\u00a0has quit\n"}