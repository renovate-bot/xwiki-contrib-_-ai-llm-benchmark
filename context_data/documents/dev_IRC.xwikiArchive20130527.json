{"id": "dev:IRC.xwikiArchive20130527", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20130527", "title": "IRC Archive for channel #xwiki on 27 May 2013 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<abusenius\\_>\u00a0has quit  \n03:45\u00a0<qwebirc9565>\u00a0has joined #xwiki  \n03:45\u00a0<qwebirc9565>\u00a0hi  \n03:46\u00a0<qwebirc9565>\u00a0hey  \n03:46\u00a0<qwebirc9565>\u00a0a  \n03:48\u00a0<sdumitriu>\u00a0Hey  \n04:30\u00a0<Denis1>\u00a0has joined #xwiki  \n05:51\u00a0<Denis1>\u00a0has quit  \n06:50\u00a0<sdumitriu>\u00a0has quit  \n06:51\u00a0<sdumitriu>\u00a0has joined #xwiki  \n07:23\u00a0<qwebirc9565>\u00a0has quit  \n07:27\u00a0<mflorea>\u00a0has joined #xwiki  \n07:35\u00a0<vmassol>\u00a0has joined #xwiki  \n07:43\u00a0<vmassol>\u00a0has quit  \n07:48\u00a0<vmassol>\u00a0has joined #xwiki  \n08:30\u00a0<Denis1>\u00a0has joined #xwiki  \n08:31\u00a0<Denis1>\u00a0is now known as <Denis>  \n08:39\u00a0<tmortagne>\u00a0has joined #xwiki  \n09:03\u00a0<msmeria>\u00a0has joined #xwiki  \n09:34\u00a0<evalica>\u00a0has joined #xwiki  \n09:53\u00a0<vmassol>\u00a0good morning everyone  \n09:53\u00a0<vmassol>\u00a0ah today is supposedly release day for 5.1M1 :)  \n09:53\u00a0<vmassol>\u00a0do we have a RM btw?  \n09:54\u00a0<vmassol>\u00a0sburjan`/msmeria: good morning, do we have documentation on xwiki.org for the user directory feature already?  \n10:09\u00a0<vmassol>\u00a0sburjan`/msmeria: ok, added a quick version to http://extensions.xwiki.org/xwiki/bin/view/Extension/User+Directory+Application  \n10:11\u00a0<sburjan>\u00a0has joined #xwiki  \n10:16\u00a0<gdelhumeau>\u00a0has joined #xwiki  \n10:59\u00a0<Slashman>\u00a0has joined #xwiki  \n11:01\u00a0<Denis>\u00a0has quit  \n11:01\u00a0<Denis>\u00a0has joined #xwiki  \n11:07\u00a0<polx>\u00a0has joined #xwiki  \n11:07\u00a0<vmassol>\u00a0guys  \n11:08\u00a0<vmassol>\u00a0we need to focus on having a stable build ASAP  \n11:08\u00a0<vmassol>\u00a0http://ci.xwiki.org/  \n11:09\u00a0<vmassol>\u00a0would be great if max # of people could help on this  \n11:14\u00a0<vmassol>\u00a0checking ApplicationTest.testParametersInColibri:108->testParameterEscaping:129->AbstractEscapingTest.getUnderEscapingErrors:377->AbstractEscapingTest.getUrlContent:291 \u00bb Runtime  \n11:15\u00a0<vmassol>\u00a0ah  \n11:15\u00a0<vmassol>\u00a0I need to apply thomasD's pull request to fix it  \n11:15\u00a0<vmassol>\u00a0doing this now  \n11:27\u00a0<vmassol>\u00a0there are some problems with his PR unfortunately  \n11:27\u00a0<vmassol>\u00a0I'm working with him to fix it  \n11:49\u00a0<rauds>\u00a0has joined #xwiki  \n11:49\u00a0<tdelafosse>\u00a0has joined #xwiki  \n11:57\u00a0<vmassol>\u00a0has quit  \n11:59\u00a0<vmassol>\u00a0has joined #xwiki  \n12:05\u00a0<vmassol>\u00a0Who wants to be the RM for 5.1M1?  \n12:06\u00a0<vmassol>\u00a0( http://dev.xwiki.org/xwiki/bin/view/Community/ReleaseManagerRoster )  \n12:14\u00a0<vmassol>\u00a0mflorea and others: shoudl't web-standards fail if we have <script> in body?  \n12:14\u00a0<vmassol>\u00a0answering to myself: the problem is that the vm is excluded....  \n12:14\u00a0<mflorea>\u00a0no, I don't think we have such a rule, inline scripts are valid  \n12:15\u00a0<mflorea>\u00a0not recommended, but valid  \n12:15\u00a0<vmassol>\u00a0ok, thomasD has added some inline script in passwd.vm  \n12:15\u00a0<vmassol>\u00a0right it's excluded:  \n12:15\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0templates/passwd\\.vm <!-- must be tested on a user document, otherwise returns status 400 -->  \n12:15\u00a0<vmassol>\u00a0\\*right now  \n12:15\u00a0<vmassol>\u00a0is it ok or should I ask thomasD to do something?  \n12:16\u00a0<vmassol>\u00a0(tdelafosse)  \n12:16\u00a0<vmassol>\u00a0mflorea: it's here: https://github.com/xwiki/xwiki-platform/pull/108/files  \n12:17\u00a0<vmassol>\u00a0going to apply now and can refined if we think it's not the best thing to do  \n12:20\u00a0<mflorea>\u00a0createinline.vm https://github.com/xwiki/xwiki-platform/blob/master/xwiki-platform-core/xwiki-platform-web/src/main/webapp/templates/createinline.vm has inline scripts, and other templates too. Ofc, best is to have the js outside in a file, but sometimes the js is small and very specific to the place where it is used. For a wiki page you can just write a jsx, but for a template it's not as nice to create a js file with a few lines to be used in that template  \n12:59\u00a0<rauds>\u00a0Hi. I don't know how to activate the acitvety stream. The stream is blank since the update from 5.0 to 5.01. and 5.02. After the upgrade i added a new blog and changed spaces- the stream doesn't recognise the news.I don't know how to restart the modul because it's a core modul. I can't find a tip in the administration guide. Can you give me a tip to get a status to the stream modul or how to get the activity stream running again?  \n13:06\u00a0<rauds>\u00a0With the last upgrade to 5.0.2 i skiped these config files in the xar upgrade: xwikipreferences, xwikiallgroup, admin, xwikiadmingroup, registrationconfig. From 5.0 to 5.01 i skiped more configs which i didn't worte down.  \n13:07\u00a0<vmassol>\u00a0rauds: need to check, sburjan/msmeria, do you think you'd have the time to check this out?  \n13:07\u00a0<vmassol>\u00a0rauds: btw you should start using the Distribution Wizard for upgrades ;)  \n13:09\u00a0<sburjan>\u00a0rauds: can you tell me \u00a0from what version are you migrating ?  \n13:11\u00a0<rauds>\u00a0@ vmassol. You mean i only need to update the war file and the rest is updated by the wizzard? I'll keep it in mind. thx  \n13:11\u00a0<vmassol>\u00a0rauds: yes  \n13:11\u00a0<vmassol>\u00a0and it does the necessary merges  \n13:16\u00a0<rauds>\u00a0my first blog in the wiki is from 12.march. I think it was 5.0M1. The update to 5.0 worked fine. With 5.0 to 5.01 the activety stream is just blank with no errors.  \n13:17\u00a0<sburjan>\u00a0and if you add something new it doesn;t appear in the AS ?  \n13:17\u00a0<vmassol>\u00a0hmm note that I reported http://jira.xwiki.org/browse/XWIKI-9117# too, don't know if it's related  \n13:18\u00a0<rauds>\u00a0yes i addeded after the update a new blog and changed spaces.  \n13:19\u00a0<rauds>\u00a0Can it relate to the new user rights modul?  \n13:27\u00a0<rauds>\u00a0I just added a new user to the admin group and added a new blog entry. The activity stream is blank. How importatnt is this: With the last upgrade to 5.0.2 i skiped these config files in the xar upgrade: xwikipreferences, xwikiallgroup, admin, xwikiadmingroup, registrationconfig. From 5.0 to 5.01 i skiped more configs which i didn't worte down.  \n13:35\u00a0<vmassol>\u00a0has quit  \n13:36\u00a0<vmassol>\u00a0has joined #xwiki  \n13:54\u00a0<Enygma`>\u00a0has joined #xwiki  \n13:59\u00a0<rauds>\u00a0@Sburjan can i fix the activity stream manually?  \n14:02\u00a0<sburjan>\u00a0@rauds: I don't know a way to fix it, I have to reproduce it first, but I think it's the same issue vmassol \u00a0pointed out on JIRA  \n14:03\u00a0<vmassol>\u00a0sburjan: not sure  \n14:03\u00a0<vmassol>\u00a0I think it worked for me for new stuff but not sure, could you try it?  \n14:08\u00a0<sburjan>\u00a0vmassol, I will try it, yes. I will try from 5.0 to 5.0.2 and see. With and w/o DW.  \n14:09\u00a0<rauds>\u00a0@sburjan: I will test it. i hope i have old maschines saved with software 5.0m1 or 5.0 versions. Thanks and i will report. What info is necessary for you? Do you need log files?@vmassol: me too.  \n14:15\u00a0<tmortagne>\u00a0rauds: most important usually is a detailed way to reproduce the issue  \n14:40\u00a0<vmassol>\u00a0guys, who's working on fixing build failures ATM?  \n14:42\u00a0<tmortagne>\u00a0fixed broken 5.0.x builds, looking at recently failing builds but the most recent seems to have git issues  \n14:44\u00a0<tmortagne>\u00a0vmassol: I asked several time already but nobody answered me: what is xwiki-platform-pullrequests ?  \n14:44\u00a0<vmassol>\u00a0tmortagne: it's an experiment from sdumitriu  \n14:44\u00a0<vmassol>\u00a0to automatically build PR  \n14:44\u00a0<vmassol>\u00a0see https://wiki.jenkins-ci.org/display/JENKINS/Github+pull+request+builder+plugin  \n14:45\u00a0<tmortagne>\u00a0well this job never worked AFAIK so if nobody is working on it we might disable it  \n14:45\u00a0<vmassol>\u00a0sdumitriu: can you give us an update?  \n14:46\u00a0<sdumitriu>\u00a0I'll look at it again  \n14:46\u00a0<sdumitriu>\u00a0It \"should\" work  \n14:46\u00a0<tmortagne>\u00a0well I never seen it work  \n14:47\u00a0<sdumitriu>\u00a0Except that it doesn't build downstream projects  \n14:47\u00a0<vmassol>\u00a0sdumitriu: at least discable email notifications till it works  \n14:47\u00a0<sdumitriu>\u00a0vmassol: K  \n14:47\u00a0<vmassol>\u00a0\\*disable  \n15:01\u00a0<vmassol>\u00a0rebuilding full XE to run the build locally  \n15:04\u00a0<vmassol>\u00a0mflorea: maybe you could have a look at http://ci.xwiki.org/view/Functional%20Tests/job/xwiki-enterprise-test-wysiwyg/ ?  \n15:15\u00a0<jvelo>\u00a0has joined #xwiki  \n15:15\u00a0<jvelo>\u00a0hello friends  \n15:16\u00a0<jvelo>\u00a0just a FYI, the title of the home page of xwiki.org has been lost  \n15:16\u00a0<jvelo>\u00a0it's indexed as \"Wiki Home (Main.WebHome)\" while it used to be a marketing pitch  \n15:17\u00a0<vmassol>\u00a0checking http://www.xwiki.org/xwiki/bin/view/Main/WebHome?viewer=history  \n15:17\u00a0<vmassol>\u00a0you know in which rev jvelo?  \n15:18\u00a0<jvelo>\u00a0no idea. It looks it was present in 100.3  \n15:18\u00a0<vmassol>\u00a0http://www.xwiki.org/xwiki/bin/view/Main/WebHome?viewer=changes&rev1=101.1&rev2=102.1 ?  \n15:18\u00a0<jvelo>\u00a0it's between 101.1 and 102.1  \n15:18\u00a0<vmassol>\u00a0evalica: any idea why you removed it?  \n15:18\u00a0<vmassol>\u00a0:)  \n15:20\u00a0<mflorea>\u00a0vmassol: I will, I'm finishing updating the solr search doc and release notes first  \n15:21\u00a0<jvelo>\u00a0has quit  \n15:24\u00a0<evalica>\u00a0vmassol: I didn't removed it intentionally - maybe I've imported the page  \n15:24\u00a0<vmassol>\u00a0evalica: can I let you fix it?  \n15:24\u00a0<evalica>\u00a0k  \n15:35\u00a0<rauds>\u00a0has quit  \n15:42\u00a0<vmassol>\u00a0sdumitriu: when you upgraded the jenkins version and when you realized there were problems, did you you modify any jenkins config/files?  \n15:42\u00a0<sdumitriu>\u00a0vmassol: No  \n15:43\u00a0<vmassol>\u00a0I'm still trying to solve https://issues.jenkins-ci.org/browse/JENKINS-18096  \n15:43\u00a0<sdumitriu>\u00a0But Jenkins itself did report some unreadable settings which were discarded  \n15:44\u00a0<vmassol>\u00a0ah, do you have a copy of that?  \n15:44\u00a0<sdumitriu>\u00a0They were just build start dates  \n15:44\u00a0<vmassol>\u00a0in the issue I pointed to  \n15:44\u00a0<vmassol>\u00a0we have:  \n15:44\u00a0<vmassol>\u00a0<hudson.plugins.emailext.ExtendedEmailPublisherDescriptor plugin=\"[[email\u00a0protected]](https://dev.xwiki.org/cdn-cgi/l/email-protection)\">  \n15:44\u00a0<vmassol>\u00a0I don't know if this is normal  \n15:44\u00a0<vmassol>\u00a0the 2.29 part  \n15:44\u00a0<sdumitriu>\u00a0Plus smtphost which is now correctly set  \n15:44\u00a0<vmassol>\u00a0we're at 2.30.2  \n15:45\u00a0<vmassol>\u00a0maybe it's the previous version  \n15:50\u00a0<vmassol>\u00a0please don't commit anything that can make any part of the build fail now  \n15:50\u00a0<vmassol>\u00a0since we're supposed to have released 5.1M1 already  \n15:50\u00a0<vmassol>\u00a0we all need to be fixing the build at this stage  \n15:51\u00a0<vmassol>\u00a0finished rebiulding everything locally now, testing escaping tests locally (master)  \n15:55\u00a0<vmassol>\u00a0mflorea: fails  \n15:56\u00a0<vmassol>\u00a0on SolrSearch.xml  \n15:58\u00a0<mflorea>\u00a0I'll check  \n16:03\u00a0<vmassol>\u00a09 errors in webstandards  \n16:04\u00a0<vmassol>\u00a0https://gist.github.com/vmassol/5657241  \n16:04\u00a0<vmassol>\u00a0mflorea: there's Solrearch in there too  \n16:04\u00a0<vmassol>\u00a0seems to be the same problem for all of them  \n16:04\u00a0<mflorea>\u00a0yes  \n16:05\u00a0<vmassol>\u00a0maybe some change in a vm  \n16:05\u00a0<mflorea>\u00a0I was expecting it, I'll take care  \n16:05\u00a0<vmassol>\u00a0ok thanks  \n16:11\u00a0<vmassol>\u00a0hmm I don't get any build error on the xmlrpc tests  \n16:11\u00a0<vmassol>\u00a0however I don't have the same result when executing  \n16:11\u00a0<vmassol>\u00a0the error on agent is: http://ci.xwiki.org/view/Functional%20Tests/job/xwiki-enterprise-test-xmlrpc/org.xwiki.enterprise$xwiki-enterprise-test-xmlrpc/2480/testReport/junit/org.xwiki.test.xmlrpc/PagesTest/testStoreNewPageTranslation/  \n16:12\u00a0<vmassol>\u00a0and it's about \"Adding the 'za' translation...\"  \n16:13\u00a0<vmassol>\u00a0when I run locally I see only  \n16:13\u00a0<vmassol>\u00a0Adding the 'tt' translation...  \n16:13\u00a0<vmassol>\u00a0and  \n16:13\u00a0<vmassol>\u00a0Adding the 'ie' translation...  \n16:13\u00a0<vmassol>\u00a0hmm strange translation names....  \n16:16\u00a0<vmassol>\u00a0hmm I see in the test: \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0String[] languages = Locale.getISOLanguages();  \n16:16\u00a0<vmassol>\u00a0I guess this depends on the environment  \n16:16\u00a0<vmassol>\u00a0ah also  \n16:16\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0String fakeLanguage = languages[random.nextInt(languages.length)];  \n16:16\u00a0<vmassol>\u00a0bad  \n16:16\u00a0<vmassol>\u00a0this means the test is not repetitive  \n16:17\u00a0<sburjan>\u00a0Hello. is it normal that $xwiki.getDocument(\"\") will return the space.webHome from which is it called ?  \n16:17\u00a0<diamond>\u00a0has joined #xwiki  \n16:18\u00a0<sdumitriu>\u00a0has quit  \n16:18\u00a0<diamond>\u00a0hi are the gso accepted list announced?  \n16:18\u00a0<diamond>\u00a0gsoc\\*  \n16:18\u00a0<sdumitriu>\u00a0has joined #xwiki  \n16:20\u00a0<vmassol>\u00a0mflorea: I see you've modifeid this part of the code (PagesTest.java)  \n16:20\u00a0<vmassol>\u00a0was quite some ago though  \n16:20\u00a0<vmassol>\u00a0but maybe you understand better this code than I do  \n16:22\u00a0<diamond>\u00a0@ sdumitriu.... could u tell when the result will be announced for GSoC?  \n16:22\u00a0<mflorea>\u00a0I edited it to fix some issue, but I didn't wrote it. The random part was there before my change.  \n16:22\u00a0<vmassol>\u00a0so it seems the test fails because  \n16:22\u00a0<vmassol>\u00a0the \"bfore\" part doesn\"'t have a key named \"za\"  \n16:23\u00a0<vmassol>\u00a0not sure why it should have that though  \n16:24\u00a0<sdumitriu>\u00a0has quit  \n16:25\u00a0<sdumitriu>\u00a0has joined #xwiki  \n16:26\u00a0<diamond>\u00a0has left #xwiki  \n16:29\u00a0<vmassol>\u00a0this tests really looks very strange  \n16:29\u00a0<mflorea>\u00a0hmm, ci.xwiki.org looks different..  \n16:30\u00a0<mflorea>\u00a0how do you see the failed builds?  \n16:30\u00a0<vmassol>\u00a0http://ci.xwiki.org/view/Functional%20Tests/job/xwiki-enterprise-test-xmlrpc/org.xwiki.enterprise$xwiki-enterprise-test-xmlrpc/2480/testReport/junit/org.xwiki.test.xmlrpc/PagesTest/testStoreNewPageTranslation/ .  \n16:30\u00a0<vmassol>\u00a0?  \n16:30\u00a0<mflorea>\u00a0no, I mean the failed jobs  \n16:30\u00a0<vmassol>\u00a0oh you mean generally  \n16:30\u00a0<mflorea>\u00a0yes  \n16:30\u00a0<vmassol>\u00a0wow you haven't looked there for a while :)  \n16:31\u00a0<mflorea>\u00a0yes, I've been busy :)  \n16:31\u00a0<mflorea>\u00a0solr search ui  \n16:31\u00a0<vmassol>\u00a0the short answer is that they're displayed in red or yellow  \n16:31\u00a0<mflorea>\u00a0yes, but the list of jobs is huge  \n16:32\u00a0<vmassol>\u00a0if the question is: why don't we see the dashboard view by default, the reason is that it has performance issues  \n16:33\u00a0<Denis>\u00a0has quit  \n16:33\u00a0<mflorea>\u00a0ok  \n16:33\u00a0<vmassol>\u00a0thhey're fixing it  \n16:33\u00a0<vmassol>\u00a0and if the question is  \n16:33\u00a0<vmassol>\u00a0why have we upgraded?  \n16:33\u00a0<vmassol>\u00a0it's because sergiu wanted to upgrade to the latest LTS  \n16:34\u00a0<vmassol>\u00a0and it broke everyhing  \n16:34\u00a0<vmassol>\u00a0and I tried to salvage it as quickly as I could  \n16:34\u00a0<vmassol>\u00a0so right now we're back on latest  \n16:34\u00a0<mflorea>\u00a0ok  \n16:34\u00a0<mflorea>\u00a0the full list will do fine for now  \n16:36\u00a0<mflorea>\u00a0I can sort by status  \n16:36\u00a0<vmassol>\u00a0indeed, good idea :)  \n16:36\u00a0<vmassol>\u00a0didn't notice it  \n16:40\u00a0<vmassol>\u00a0ok will rebuild the xmlrpc job  \n16:40\u00a0<vmassol>\u00a0there's some stuff related to deprecated code  \n16:40\u00a0<vmassol>\u00a0and maybe that's the issue  \n16:49\u00a0<mflorea>\u00a0I'm looking at the failing UI test btw  \n16:49\u00a0<vmassol>\u00a0thanks mflorea  \n16:57\u00a0<sburjan>\u00a0vmassol, I hadn't the time to test the AS issue today, but I will do it tomorrow  \n17:00\u00a0<msmeria>\u00a0has quit  \n17:00\u00a0<sburjan>\u00a0has quit  \n17:06\u00a0<sdumitriu1>\u00a0has joined #xwiki  \n17:27\u00a0<vmassol>\u00a0ok fixed emails :)  \n17:28\u00a0<vmassol>\u00a0(jenkins emails)  \n17:28\u00a0<vmassol>\u00a0(sdumitriu)  \n17:29\u00a0<vmassol>\u00a0see https://issues.jenkins-ci.org/browse/JENKINS-18096  \n17:29\u00a0<sdumitriu1>\u00a0Cool  \n17:42\u00a0<vmassol>\u00a0mflorea: so xmlrpc test worked again, the test is really too complex and not decisive IMO, seems like \"za\" has some older code too or somrhing like that  \n17:42\u00a0<mflorea>\u00a0yes, I think there are some codes that have canged  \n18:00\u00a0<mflorea>\u00a0vmassol: we have an issue. New line characters are not preserved anymore in attribute values. It seems to be related to the HTMLCleaner upgrade because new lines are preserved with clean=\"false\". This causes http://ci.xwiki.org/job/xwiki-enterprise-test-ui/org.xwiki.enterprise$xwiki-enterprise-test-ui/2292/testReport/  \n18:01\u00a0<evalica>\u00a0has quit  \n18:01\u00a0<mflorea>\u00a0the issue is basically this: I have a multiline string, I put it in the value of a hidden input and then I submit the form. I expect the value received on the server side to have multiple lines.  \n18:02\u00a0<mflorea>\u00a0{{html}}...<input type=\"hidden\" \u00a0name=\"foo\" value=\"$escapetool.xml($multiLineValue)\" />...{{/html}}  \n18:08\u00a0<vmassol>\u00a0can you create a simple test for me that I can debug in the xml module?  \n18:09\u00a0<vmassol>\u00a0(mflorea)  \n18:09\u00a0<vmassol>\u00a0some input and expected output  \n18:13\u00a0<vmassol>\u00a0mflorea: we have severla tests for NL in html cleaner  \n18:13\u00a0<vmassol>\u00a0and they pass  \n18:14\u00a0<vmassol>\u00a0I've also tested and new lines seem preserved  \n18:14\u00a0<vmassol>\u00a0so I'd need some specific example  \n18:16\u00a0<mflorea>\u00a0just put new lines in attribute value <input value=\"one\\ntwo\\nthree\" />  \n18:17\u00a0<mflorea>\u00a0note that I'm not saying the behavior of HTMLCleaner is not right, I'm just saying that it breaks existing code.  \n18:18\u00a0<vmassol>\u00a0we don't have any unit tests related to new lines in attributes  \n18:19\u00a0<mflorea>\u00a0normally if you want new lines to be preserved you need to escape using &#10;. Otherwise parsers will normalize the \\n into space when parsing.  \n18:19\u00a0<vmassol>\u00a0ok I could reproduce  \n18:19\u00a0<vmassol>\u00a0it's indeed normalized into spaces  \n18:19\u00a0<mflorea>\u00a0it looks like HTMLCleaner is not standard compliant, but that breaks unfortunately some of our code.  \n18:20\u00a0<vmassol>\u00a0we need to decide what is the correct behavior  \n18:21\u00a0<mflorea>\u00a0http://stackoverflow.com/questions/1823979/how-to-have-line-breaks-in-xml-attributes  \n18:22\u00a0<mflorea>\u00a0http://stackoverflow.com/questions/2004386/how-to-save-newlines-in-xml-attribute  \n18:22\u00a0<mflorea>\u00a0the first answer gives more details  \n18:23\u00a0<vmassol>\u00a0debugging to understand htmlcleaner's algorithm  \n18:23\u00a0<mflorea>\u00a0I think best is to extend $escapetool.xml to encode the new line characters with &#10;  \n18:24\u00a0<mflorea>\u00a0I tested and it fixes the problem  \n18:25\u00a0<vmassol>\u00a0yes, at least till htmlcleaner supports it  \n18:25\u00a0<vmassol>\u00a0I'm debugging hmtlcleaner in the meantime to try to understand and report the issue  \n18:28\u00a0<evalica>\u00a0has joined #xwiki  \n18:33\u00a0<evalica>\u00a0has quit  \n18:45\u00a0<vmassol>\u00a0mflorea: trying to find the spec for new lines in attribute values  \n18:45\u00a0<vmassol>\u00a0so far just got this: http://www.w3.org/TR/xhtml1/#C\\_5  \n18:45\u00a0<vmassol>\u00a0which doesn't say much :)  \n18:46\u00a0<vmassol>\u00a0ah foud begter  \n18:46\u00a0<vmassol>\u00a0better  \n18:46\u00a0<vmassol>\u00a0http://www.w3.org/TR/xhtml1/#h-4.7  \n18:46\u00a0<vmassol>\u00a0so it seems htmlcleaner is correct  \n18:46\u00a0<vmassol>\u00a0\"Map sequences of one or more white space characters (including line breaks) to a single inter-word space.\"  \n18:46\u00a0<sdumitriu1>\u00a0http://www.w3.org/TR/xml/#AVNormalize  \n18:49\u00a0<vmassol>\u00a0so based on this, if we really want new lines, our input needs to use HTML entities but I'm not sure we want to do that in our escape.xml() since it's not a valid normalization  \n18:49\u00a0<mflorea>\u00a0yes, we need to encode the white space if we want it to be preserved  \n18:49\u00a0<vmassol>\u00a0(at least not always)  \n18:49\u00a0<vmassol>\u00a0yep but where we use it, not generically I think  \n18:50\u00a0<vmassol>\u00a0at least maybe not all the time  \n18:50\u00a0<mflorea>\u00a0I don't think it breaks anything to encode whitespace using XML entities. It's valid XML/HTML  \n18:50\u00a0<vmassol>\u00a0it will in some cases  \n18:50\u00a0<mflorea>\u00a0I mean in $escapetool.xml/html  \n18:51\u00a0<vmassol>\u00a0since instead of whitespaces you'll get new lines  \n18:51\u00a0<vmassol>\u00a0it's only correct if you expect new lines which isn't the norm  \n18:51\u00a0<vmassol>\u00a0the norm is to get whitespaces  \n18:51\u00a0<vmassol>\u00a0(when you pass new lines)  \n18:51\u00a0<sdumitriu1>\u00a0XMLUtils.escapeAttributeValue could indeed escape all whitespace  \n18:52\u00a0<mflorea>\u00a0you get only one space, not more, all spaces are normalized  \n18:52\u00a0<vmassol>\u00a0yes  \n18:52\u00a0<vmassol>\u00a0that's what is expected whatever the input  \n18:52\u00a0<mflorea>\u00a0but I can't think of a use case where you would rely on that, since you call escapetool.xml to use the result in HTML, and thus it doesn't matter  \n18:52\u00a0<vmassol>\u00a0only the person who knows the input  \n18:52\u00a0<vmassol>\u00a0can decide  \n18:53\u00a0<vmassol>\u00a0if it should be normalized or escaped  \n18:53\u00a0<vmassol>\u00a0s/person/code/  \n18:53\u00a0<vmassol>\u00a0yeah maybe I'm talking generically, it depends on the code htat uses the result  \n18:53\u00a0<vmassol>\u00a0we don't control that  \n18:54\u00a0<vmassol>\u00a0we control it for what we use it for  \n18:54\u00a0<vmassol>\u00a0but since it's a lib that users can use  \n18:54\u00a0<vmassol>\u00a0it can be used for anything  \n18:54\u00a0<mflorea>\u00a0I understand your point. I'm just thinking that changing escapetool.xml will address the regression  \n18:54\u00a0<vmassol>\u00a0yes  \n18:54\u00a0<vmassol>\u00a0surely  \n18:54\u00a0<mflorea>\u00a0while if we add a new escapetool method, we might miss some places  \n18:55\u00a0<vmassol>\u00a0we can also see this a bug that is now fixed  \n18:55\u00a0<vmassol>\u00a0and not as a regression  \n18:55\u00a0<vmassol>\u00a0:)  \n18:55\u00a0<mflorea>\u00a0I agree that a new method is cleaner  \n18:55\u00a0<mflorea>\u00a0indeed :)  \n18:56\u00a0<evalica>\u00a0has joined #xwiki  \n18:57\u00a0<evalica>\u00a0has quit  \n19:01\u00a0<Enygma`>\u00a0has quit  \n19:04\u00a0<tmortagne>\u00a0has quit  \n19:06\u00a0<evalica>\u00a0has joined #xwiki  \n19:06\u00a0<evalica>\u00a0has quit  \n19:20\u00a0<Slashman>\u00a0has quit  \n19:30\u00a0<abusenius\\_>\u00a0has joined #xwiki  \n19:34\u00a0<gdelhumeau>\u00a0has quit  \n19:39\u00a0<tdelafosse>\u00a0has quit  \n20:28\u00a0<polx>\u00a0has quit  \n20:37\u00a0<polx>\u00a0has joined #xwiki  \n20:39\u00a0<Denis1>\u00a0has joined #xwiki  \n20:42\u00a0<mflorea>\u00a0has quit  \n21:10\u00a0<vmassol>\u00a0has quit  \n21:21\u00a0<vmassol>\u00a0has joined #xwiki  \n21:33\u00a0<vmassol>\u00a0has quit  \n22:12\u00a0<Denis1>\u00a0has quit  \n22:16\u00a0<sdumitriu1>\u00a0has quit  \n22:30\u00a0<Denis1>\u00a0has joined #xwiki  \n22:31\u00a0<Denis1>\u00a0is now known as <Denis>  \n23:14\u00a0<rauds>\u00a0has joined #xwiki\n"}