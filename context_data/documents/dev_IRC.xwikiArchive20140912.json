{"id": "dev:IRC.xwikiArchive20140912", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20140912", "title": "IRC Archive for channel #xwiki on 12 September 2014 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<momomomomo>\u00a0has quit  \n00:48\u00a0<vmassol>\u00a0has quit  \n01:02\u00a0<Slashman>\u00a0has quit  \n01:11\u00a0<xwikiorg\\_guest\\_8>\u00a0has left #xwiki  \n01:16\u00a0<jeremiah>\u00a0has joined #xwiki  \n01:16\u00a0<jeremiah>\u00a0Anybody have a moment for a quick auth question?  \n01:17\u00a0<jeremiah>\u00a0I am trying to set up my xwiki so that if a request comes in with basic auth user credentials and the user doesn't exist, that it will automatically create the user.  \n01:18\u00a0<jeremiah>\u00a0Where can I find the source code for authentication?  \n01:53\u00a0<jeremiah>\u00a0So I found and cloned the platform-core repo, then created a class that extends XWikiAuthServiceImpl.  \n01:53\u00a0<jeremiah>\u00a0How do I add this class to my xwiki?  \n02:16\u00a0<sburjan>\u00a0has quit  \n03:01\u00a0<jeremiah>\u00a0has quit  \n07:09\u00a0<msmeria>\u00a0has joined #xwiki  \n07:54\u00a0<DarkKnightCZ>\u00a0has joined #xwiki  \n08:04\u00a0<mflorea>\u00a0has joined #xwiki  \n08:05\u00a0<ClemensR>\u00a0has joined #xwiki  \n08:08\u00a0<Denis>\u00a0has joined #xwiki  \n08:10\u00a0<vmassol>\u00a0has joined #xwiki  \n08:12\u00a0<Denis>\u00a0has quit  \n08:27\u00a0<Denis>\u00a0has joined #xwiki  \n08:31\u00a0<msmeria>\u00a0has quit  \n08:32\u00a0<msmeria>\u00a0has joined #xwiki  \n08:33\u00a0<DarkKnightCZ>\u00a0has quit  \n08:40\u00a0<cjd>\u00a0has joined #xwiki  \n08:43\u00a0<evalica>\u00a0has joined #xwiki  \n08:44\u00a0<Enygma`>\u00a0has joined #xwiki  \n08:50\u00a0<tmortagne>\u00a0has joined #xwiki  \n08:50\u00a0<DarkKnightCZ>\u00a0has joined #xwiki  \n08:51\u00a0<cjd>\u00a0tmortagne: for (; i < awesome; ++i) ; \u00a0\u00a0\u00a0highfive();  \n08:55\u00a0<woshilapin>\u00a0has joined #xwiki  \n09:06\u00a0<tmortagne>\u00a0cjd: :)  \n09:08\u00a0<Enygma`>\u00a0has quit  \n09:09\u00a0<Enygma`>\u00a0has joined #xwiki  \n09:30\u00a0<DarkKnightCZ1>\u00a0has joined #xwiki  \n09:32\u00a0<DarkKnightCZ>\u00a0has quit  \n09:35\u00a0<KermitTheFragger>\u00a0has joined #xwiki  \n10:19\u00a0<mflorea>\u00a0has quit  \n10:36\u00a0<Slashman>\u00a0has joined #xwiki  \n10:46\u00a0<KermitTheFragger>\u00a0has quit  \n11:11\u00a0<cjd>\u00a0Does anyone know if it's possible in velocity to create a reference to a document with a specific langyage?  \n11:12\u00a0<vmassol>\u00a0I dno't think it is  \n11:13\u00a0<tmortagne>\u00a0cjd: you mean in wiki syntax ?  \n11:13\u00a0<vmassol>\u00a0actually it is  \n11:13\u00a0<cjd>\u00a0$services.model.createReferenceTo....  \n11:13\u00a0<vmassol>\u00a0public DocumentReference createDocumentReference(DocumentReference reference, Locale locale)  \n11:13\u00a0<vmassol>\u00a0didn't notice it got added :)  \n11:13\u00a0<vmassol>\u00a0\\* @since 5.4RC1  \n11:14\u00a0<cjd>\u00a0hmm  \n11:14\u00a0<tmortagne>\u00a0ho you mean a DocumentReference  \n11:14\u00a0<tmortagne>\u00a0I tough you wanted a link  \n11:14\u00a0<cjd>\u00a0we should make all of these script services into extensions so I can depend on them rather than waiting for xwiki to be updated...  \n11:14\u00a0<cjd>\u00a0extensions are really kind of awesome that way  \n11:14\u00a0<vmassol>\u00a0not really  \n11:15\u00a0<vmassol>\u00a0that would be pretty bad  \n11:15\u00a0<cjd>\u00a0why?  \n11:15\u00a0<tmortagne>\u00a0cjd: you can provide your own script service in your extension if you like  \n11:15\u00a0<vmassol>\u00a0because when you have tons of core extensions you're into version hell  \n11:15\u00a0<vmassol>\u00a0and you don't control your stabitlity anymore  \n11:15\u00a0<cjd>\u00a0that's how debian works  \n11:15\u00a0<vmassol>\u00a0so it looks appealing but it's almost impossible to do it well  \n11:15\u00a0<tmortagne>\u00a0it's nice to have such base API by default  \n11:16\u00a0<vmassol>\u00a0actually it's so hard that you've had companies offering business models based on that!  \n11:16\u00a0<vmassol>\u00a0curating the repos and finding what versions work with what  \n11:16\u00a0<vmassol>\u00a0and making distribs  \n11:17\u00a0<tmortagne>\u00a0technically that API is an en extension, but that extension is sychronized with platform right now like many very standard APIs  \n11:17\u00a0<cjd>\u00a0mm good base api is nice, it's annoying when the base api is too hard to use and/or doesn't do what people want so you end up with IOUtils and FileUtils and StringUtils etc etc  \n11:17\u00a0<tmortagne>\u00a0s/an en/in an/  \n11:17\u00a0<tmortagne>\u00a0having a locale in DocumentReference does not exist since DocumentReference exist  \n11:18\u00a0<cjd>\u00a0mm true  \n11:18\u00a0<tmortagne>\u00a0your main issue is that we add things in script service when we need then in XE  \n11:18\u00a0<cjd>\u00a0it's actually the php model vs. the nodejs model  \n11:18\u00a0<cjd>\u00a0also the windows model vs the linux model  \n11:18\u00a0<tmortagne>\u00a0s/then/them/  \n11:18\u00a0<cjd>\u00a0linux and nodejs are dependency hell, windows and php are unified api  \n11:19\u00a0<tmortagne>\u00a0you have many extensions in php  \n11:20\u00a0<cjd>\u00a0it's a bit even the cathedral and the bazaar, the bazaar is the market of extensions all competing to provide the best API  \n11:20\u00a0<cjd>\u00a0but indeed bazaars are messy  \n11:21\u00a0<vmassol>\u00a0you need a large community to handle a bazaar too  \n11:22\u00a0<vmassol>\u00a0(or maybe the community forms because it's a bazaar and it needs sorting out\u2026 ;))  \n11:22\u00a0<vmassol>\u00a0anyway back to my shell scripts now!  \n11:22\u00a0<cjd>\u00a0I have a hard time imagining a community forming around a cathedral  \n11:22\u00a0<cjd>\u00a0have fun  \n11:22\u00a0<vmassol>\u00a0did you see my trick cjd?  \n11:22\u00a0<vmassol>\u00a0pretty happy about myself  \n11:23\u00a0<cjd>\u00a0yeah, it's probably going to have problems  \n11:23\u00a0<vmassol>\u00a0this:  \n11:23\u00a0<vmassol>\u00a0trap \"kill ${XWIKI\\_PID}; exit 1\" INT  \n11:23\u00a0<vmassol>\u00a0?  \n11:23\u00a0<cjd>\u00a0most robust solution is to write the pid from inside of java  \n11:23\u00a0<cjd>\u00a0/nod  \n11:23\u00a0<vmassol>\u00a0I don't fully understand it TBH  \n11:23\u00a0<vmassol>\u00a0but it seems to be working  \n11:23\u00a0<cjd>\u00a0there is the fact that java has no decent way to get a pid (a mildly disturbing fact btw)  \n11:24\u00a0<cjd>\u00a0but there's a hacky one which Should Always Work  \n11:24\u00a0<vmassol>\u00a0so I'll leave it like this for now  \n11:25\u00a0<cjd>\u00a0user@toshitba:~/wrk/cjdns$ node -e 'require(\"fs\").writeFile(\"my.pid\", process.pid);' && cat ./my.pid  \n11:25\u00a0<cjd>\u00a015725  \n11:27\u00a0<vmassol>\u00a0guys are you ok that I change the way params are passed to start\\_xwiki.sh? It's breaking backward compat so I want to know if it's ok  \n11:27\u00a0<cjd>\u00a0ok for me  \n11:27\u00a0<vmassol>\u00a0it's only for the standalone version though  \n11:27\u00a0<vmassol>\u00a0so no big risk for produciton....  \n11:28\u00a0<cjd>\u00a0oh, you can actually do it without that trick  \n11:30\u00a0<cjd>\u00a0PID=$$ ; echo $PID > $PID\\_FILE ; ( wait $PID ; rm $PID\\_FILE ) & \u00a0\u00a0exec java .....  \n11:30\u00a0<cjd>\u00a0then ctrl+c will go to java directly  \n11:30\u00a0<vmassol>\u00a0errr  \n11:30\u00a0<tmortagne>\u00a0vmassol: it's OK IMO  \n11:30\u00a0<vmassol>\u00a0wait is going to wait on the JVM  \n11:31\u00a0<vmassol>\u00a0so that JVM won't receive the ctrl+c  \n11:31\u00a0<vmassol>\u00a0tmortagne: ok thanks  \n11:31\u00a0<cjd>\u00a0my line switches the processes  \n11:31\u00a0<cjd>\u00a0it forks the wait/rm pidfile into the background  \n11:31\u00a0<tmortagne>\u00a0we might need to review some scripts here and there but it's probably not a big deal  \n11:31\u00a0<tmortagne>\u00a0would be nice to have a clear error when using the old way  \n11:31\u00a0<cjd>\u00a0then \\*execs\\* java rather than spawning it so it reuses the pid number from the shell process  \n11:32\u00a0<cjd>\u00a0so you already know the pid #  \n11:32\u00a0<vmassol>\u00a0I don't understand anything! :)  \n11:32\u00a0<vmassol>\u00a0sounds way more complex  \n11:32\u00a0<cjd>\u00a0oh a downside of this approach is when you stop java, you probably lose your terminal :)  \n11:32\u00a0<cjd>\u00a0also fixable  \n11:32\u00a0<cjd>\u00a0but complex bash is bad  \n11:32\u00a0<cjd>\u00a0b/c it's different on every machine :D  \n11:35\u00a0<Denis>\u00a0has quit  \n11:37\u00a0<vmassol>\u00a0one option would have been to reuse http://dev.eclipse.org/svnroot/rt/org.eclipse.jetty/jetty/trunk/jetty-distribution/src/main/resources/bin/jetty.sh but I find it too complex and I don't want to maintain that!  \n11:38\u00a0<cjd>\u00a0+1  \n11:38\u00a0<cjd>\u00a0I fight to keep bash out of the cjdns build because I've been bitten by it before  \n11:38\u00a0<cjd>\u00a0'./do' just downloads nodejs (if necessary) and then runs make.js :)  \n11:39\u00a0<vmassol>\u00a0I already don't like the complexity I'm bringing but I don't see any other way to make our CI more robust...  \n11:39\u00a0<cjd>\u00a0/nod  \n11:40\u00a0<cjd>\u00a0some lines of code are less complex than others..  \n11:41\u00a0<cjd>\u00a0hm  \n11:41\u00a0<Denis>\u00a0has joined #xwiki  \n11:43\u00a0<tmortagne>\u00a0vmassol: if it's really only for the CI we could do that at CI level in a pre build step  \n11:43\u00a0<vmassol>\u00a0nope  \n11:43\u00a0<vmassol>\u00a0I thought about it  \n11:43\u00a0<vmassol>\u00a0;)  \n11:43\u00a0<vmassol>\u00a0because a job can start xwiki several times  \n11:44\u00a0<tmortagne>\u00a0for platform yes  \n11:44\u00a0<vmassol>\u00a0and in any case \u00a0it can be useful for the iuser anyway  \n11:44\u00a0<vmassol>\u00a0\\*user  \n11:44\u00a0<vmassol>\u00a0so if we have it we might as well expose it  \n11:48\u00a0<cjd>\u00a0https://ezcrypt.it/539n#8bQTwqZwlcnogPo83DTMgMsq  \n11:48\u00a0<cjd>\u00a0that is a nice solution IMO  \n11:48\u00a0<vmassol>\u00a0I really prefer mine  \n11:48\u00a0<vmassol>\u00a0I now understand it  \n11:48\u00a0<cjd>\u00a0/nod  \n11:48\u00a0<cjd>\u00a0you're trappinga sig and relaying it to the other process  \n11:48\u00a0<cjd>\u00a0but if it's not a SIGINT then it won't work  \n11:48\u00a0<vmassol>\u00a0I could add more signals  \n11:49\u00a0<cjd>\u00a0maybe not a big deal \\*shrug\\*  \n11:49\u00a0<vmassol>\u00a0I just trapped INT  \n11:49\u00a0<vmassol>\u00a0ie ctrl-c  \n11:49\u00a0<vmassol>\u00a0for now  \n11:49\u00a0<vmassol>\u00a0we probably need to add the signals sent by jstack too  \n11:49\u00a0<vmassol>\u00a0(need to check which one it is)  \n11:49\u00a0<vmassol>\u00a0for heap dump and memory dump  \n11:50\u00a0<cjd>\u00a0it will send it to the java process directly  \n11:50\u00a0<cjd>\u00a0my solution is to put the \"remove pid\" job in another process and then reuse the pid number from the shell for java  \n11:50\u00a0<vmassol>\u00a0indeed, so even better  \n11:51\u00a0<cjd>\u00a0but.. they're both equally good until one of them fails on a weird machine :)  \n11:51\u00a0<cjd>\u00a0and we can't know which one  \n12:03\u00a0<Denis>\u00a0has quit  \n12:15\u00a0<evalica>\u00a0has quit  \n12:17\u00a0<evalica>\u00a0has joined #xwiki  \n12:21\u00a0<Denis>\u00a0has joined #xwiki  \n12:41\u00a0<Denis>\u00a0has quit  \n13:18\u00a0<DarkKnightCZ1>\u00a0hi, what could cause Caused by: org.artofsolving.jodconverter.office.OfficeException: could not store document: img0.html; errorCode: 2074  \n13:19\u00a0<vmassol>\u00a0https://code.google.com/p/jodconverter/issues/detail?id=102  \n13:20\u00a0<vmassol>\u00a0converting to PDF?  \n13:20\u00a0<vmassol>\u00a0ah it's not just pdf apparently  \n13:20\u00a0<DarkKnightCZ1>\u00a0nope, just office viewer, but i guess that could be permissions issue (i might be running office server under different user, checking)  \n13:21\u00a0<DarkKnightCZ1>\u00a0hmm, openoffice server is not storing any files, is it?  \n13:27\u00a0<DarkKnightCZ1>\u00a0nope, so it's not caused by permissions  \n13:29\u00a0<vmassol>\u00a0no idea, there could be temporary files  \n13:30\u00a0<vmassol>\u00a0(that would make sense)  \n13:35\u00a0<DarkKnightCZ1>\u00a0hmm, cannot find it in filesystem, there might be bug in used version of OO  \n13:39\u00a0<ClemensR>\u00a0maybe indeed the office-server version: https://code.google.com/p/jodconverter/issues/detail?id=102 \u00a0\"The upgrade to LibreOffice 3.5 solved the problem for us.\"  \n13:40\u00a0<DarkKnightCZ1>\u00a0ha, openoffice 4.1.0 is broken, libreoffice 4.3.0 is working  \n13:41\u00a0<DarkKnightCZ1>\u00a0ok, so not actually working, just not throwing that error (resulting in no slides), going to try 3.x  \n13:41\u00a0<vmassol>\u00a0what os are you on?  \n13:42\u00a0<DarkKnightCZ1>\u00a0RHEL  \n13:42\u00a0<ClemensR>\u00a0happy version hunting :-/ \u00a0... seems error code 2074 is a \"something went wrong\" code from oo  \n13:42\u00a0<DarkKnightCZ1>\u00a0yeah, they have pretty good error codes :)  \n13:44\u00a0<ClemensR>\u00a0did the office view work at all before? sometimes this error means modules for spreadsheet etc is missing  \n13:45\u00a0<DarkKnightCZ1>\u00a0i don't know actually  \n13:50\u00a0<DarkKnightCZ1>\u00a0hmm, WARN \u00a0o.x.c.ExecutionContext \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0- Tried to remove non-existing property [officeView.caughtException] from execution context.  \n13:51\u00a0<DarkKnightCZ1>\u00a0thats when there is no exception (but presentations have 0 slides)  \n13:51\u00a0<Denis>\u00a0has joined #xwiki  \n14:05\u00a0<Slashman>\u00a0has quit  \n14:06\u00a0<Slashman>\u00a0has joined #xwiki  \n14:12\u00a0<msmeria>\u00a0vmassol: hello  \n14:14\u00a0<msmeria>\u00a0I've just released File Manager v1.1.7 here: https://github.com/xwiki-contrib/application-filemanager/releases/tag/application-filemanager-1.1.7  \n14:14\u00a0<msmeria>\u00a0can you promote the release to Nexus ?  \n14:14\u00a0<vmassol>\u00a0hey why me? :)  \n14:15\u00a0<vmassol>\u00a0finishgin sth  \n14:15\u00a0<vmassol>\u00a0you should ask committers in general  \n14:16\u00a0<Denis>\u00a0has quit  \n14:19\u00a0<msmeria>\u00a0tmortagne, Enygma`, evalica: can one of you guys do it ?  \n14:19\u00a0<cjd>\u00a0has quit  \n14:24\u00a0<ClemensR>\u00a0msmeria: I can give it a try  \n14:24\u00a0<msmeria>\u00a0ClemensR: sweet! :D  \n14:25\u00a0<cjd>\u00a0has joined #xwiki  \n14:26\u00a0<msmeria>\u00a0ClemensR: you have instructions here: http://contrib.xwiki.org/xwiki/bin/view/Main/WebHome#HReleasetheproject  \n14:26\u00a0<msmeria>\u00a0just before the \"Publishing on extensions.xwiki.org\" section  \n14:27\u00a0<ClemensR>\u00a0ah, cool  \n14:28\u00a0<ClemensR>\u00a0msmeria: ok, its \"closed\" now. does this need some testing or should I try to publish it right away?  \n14:29\u00a0<vmassol>\u00a0I'm going to break some jobs but they'll succeed once platform has finished biulding....  \n14:29\u00a0<vmassol>\u00a0I've had to modify both plarform and enterprise  \n14:29\u00a0<vmassol>\u00a0and they both need each other to work fine....  \n14:30\u00a0<tmortagne>\u00a0ClemensR: release it right away  \n14:30\u00a0<msmeria>\u00a0ClemensR: you could try just installing it and adding an entry just for kicks...maybe I missed something  \n14:30\u00a0<vmassol>\u00a0well enterprise needs platform  \n14:30\u00a0<msmeria>\u00a0or not :)  \n14:31\u00a0<tmortagne>\u00a0msmeria: a test master would miss something ? :)  \n14:31\u00a0<ClemensR>\u00a0ok, I \u00a0guess I just publish it, and if it really fails, there can be 1.1.8 ;)  \n14:32\u00a0<msmeria>\u00a0tmortagne: it's my second release and I just hope I didn't brake anything :D  \n14:33\u00a0<vmassol>\u00a0msmeria: indeed normally staging is there so that you can try it out before releasing to the final repo :)  \n14:34\u00a0<msmeria>\u00a0vmassol: yeah, that's what I read in the doc too: \"Make sure to test your extension from the closed staging repo first since a released repo cannot be removed!\"  \n14:34\u00a0<ClemensR>\u00a0when testing my problem is that I always point to the wrong repo :p ... anyway, it should be published now  \n14:34\u00a0<vmassol>\u00a0ah I documented it cool :)  \n14:34\u00a0<msmeria>\u00a0ClemensR: checking...  \n14:39\u00a0<andreeapopescu>\u00a0has joined #xwiki  \n14:45\u00a0<Denis>\u00a0has joined #xwiki  \n14:51\u00a0<msmeria>\u00a0ClemensR: thanks! I was able to install it and test it  \n14:51\u00a0<ClemensR>\u00a0ah, ok, cool :)  \n14:57\u00a0<andreeapopescu>\u00a0has left #xwiki  \n14:57\u00a0<vmassol>\u00a0hmm my updated scripts don't work on agents apparently  \n14:57\u00a0<vmassol>\u00a014:36:32.471 [Thread-1] INFO \u00a0o.x.t.i.XWikiLogOutputStream - Starting Jetty on port 8080, please wait...  \n14:57\u00a0<vmassol>\u00a014:36:32.477 [Thread-2] ERROR o.x.t.i.XWikiLogOutputStream - start\\_xwiki.sh: 161: wait: Illegal number: $  \n14:57\u00a0<vmassol>\u00a0some wrong shell used apparently  \n14:58\u00a0<msmeria>\u00a0has quit  \n14:58\u00a0<cjd>\u00a0start\\_xwiki.sh: 79: start\\_xwiki.sh: [[: not found \u00a0<-- sh vs. bash  \n14:59\u00a0<vmassol>\u00a0shouldn't the first line ensure that bash is used?  \n14:59\u00a0<cjd>\u00a0hmm yeah  \n14:59\u00a0<cjd>\u00a0and bash should have [[  \n14:59\u00a0<cjd>\u00a0\\*usually :D  \n14:59\u00a0<tmortagne>\u00a0only if you execute the script I think  \n15:00\u00a0<cjd>\u00a0oh yeah, if you run \u00a0sh ./script  \n15:00\u00a0<tmortagne>\u00a0if you do \"sh start\\_xwiki.sh\" it probably does not care  \n15:00\u00a0<cjd>\u00a0then it will still be interpreted in sh  \n15:00\u00a0<vmassol>\u00a0locally I run sh start\\_xwiki.sh and it workds  \n15:00\u00a0<vmassol>\u00a0works  \n15:00\u00a0<vmassol>\u00a0maybe it's specific to mac  \n15:00\u00a0<tmortagne>\u00a0I guess jenkins is not doing that  \n15:00\u00a0<vmassol>\u00a0jenkins is not doing anything  \n15:00\u00a0<vmassol>\u00a0it's our code  \n15:00\u00a0<vmassol>\u00a0I'll change it to bash then  \n15:01\u00a0<tmortagne>\u00a0what is our code doing ?  \n15:01\u00a0<vmassol>\u00a0sh  \n15:01\u00a0<vmassol>\u00a0sh start\\_xwiki.sh -p %s -sp %  \n15:01\u00a0<tmortagne>\u00a0maybe sh is an alias for bash or a special adavanced sh on mac  \n15:01\u00a0<vmassol>\u00a0I thought it was ok since it works locally  \n15:01\u00a0<vmassol>\u00a0ah yes good point  \n15:01\u00a0<vmassol>\u00a0cehcking  \n15:01\u00a0<tmortagne>\u00a0s/adavanced/advanced/  \n15:01\u00a0<cjd>\u00a0sh is different on every machine  \n15:01\u00a0<cjd>\u00a0really  \n15:02\u00a0<cjd>\u00a0even versions of the same OS  \n15:02\u00a0<tmortagne>\u00a0anyway batter be explicit in our code since we require bash  \n15:02\u00a0<tmortagne>\u00a0s/batter/better/  \n15:03\u00a0<Denis>\u00a0has quit  \n15:05\u00a0<vmassol>\u00a0let's see how it goes....  \n15:05\u00a0<vmassol>\u00a045 minutes more....  \n15:05\u00a0<vmassol>\u00a0actually not that long  \n15:05\u00a0<vmassol>\u00a0just 3-4  \n15:10\u00a0<vmassol>\u00a0grr still failing  \n15:10\u00a0<vmassol>\u00a0but different eerror  \n15:10\u00a0<vmassol>\u00a05:10:06.060 [Thread-3] ERROR o.x.t.i.XWikiLogOutputStream - start\\_xwiki.sh: line 161: wait: `$': not a pid or valid job spec  \n15:16\u00a0<Denis>\u00a0has joined #xwiki  \n15:16\u00a0<vmassol>\u00a0oh  \n15:16\u00a0<vmassol>\u00a0I know  \n15:16\u00a0<vmassol>\u00a0:)  \n15:16\u00a0<vmassol>\u00a0(I think\u00e0)  \n15:17\u00a0<vmassol>\u00a0ok so  \n15:17\u00a0<vmassol>\u00a0I believe that the following line:  \n15:17\u00a0<vmassol>\u00a0XWIKI\\_PID=$!  \n15:18\u00a0<vmassol>\u00a0is transformed by velocity to:  \n15:18\u00a0<vmassol>\u00a0XWIKI\\_PID=$  \n15:18\u00a0<vmassol>\u00a0:)  \n15:18\u00a0<ClemensR>\u00a0ah, if velocity is filtering the resources  \n15:18\u00a0<vmassol>\u00a0we're using velocity for this line:  \n15:18\u00a0<vmassol>\u00a0XWIKI\\_DATA\\_DIR=${xwikiDataDir}  \n15:19\u00a0<cjd>\u00a0mm template preprocessors are good until they aren't  \n15:19\u00a0<vmassol>\u00a0yes it's dangerous to run velocity on a shell script  \n15:19\u00a0<vmassol>\u00a0very dangerous  \n15:19\u00a0<cjd>\u00a0yeah, we should use CPP instead :)  \n15:20\u00a0<vmassol>\u00a0the code is in PackageMojo.expandJettyDistribution() FYI  \n15:20\u00a0<cjd>\u00a0mhm  \n15:21\u00a0<Denis>\u00a0has quit  \n15:21\u00a0<cjd>\u00a0I wrote an excellent little piece of CPP/js which tests if a CPP macro is defined  \n15:21\u00a0<Denis>\u00a0has joined #xwiki  \n15:22\u00a0<vmassol>\u00a0it's easy enough to search/replace here  \n15:22\u00a0<Denis>\u00a0has quit  \n15:22\u00a0<cjd>\u00a0what do you use velocity for ?  \n15:23\u00a0<cjd>\u00a0oh right  \n15:23\u00a0<cjd>\u00a0so do this:  \n15:23\u00a0<cjd>\u00a0XWIKI\\_VELOCITY\\_INJECTED\\_CONFIGURATION  \n15:23\u00a0<cjd>\u00a0## check abcdx.vm for information about that this is here for  \n15:33\u00a0<vmassol>\u00a0more complex than that, it needs to work for the distribution pom too, I'll try using some escapes  \n15:35\u00a0<cjd>\u00a0http://imgs.xkcd.com/comics/success.png  \n15:36\u00a0<DarkKnightCZ>\u00a0has joined #xwiki  \n15:36\u00a0<DarkKnightCZ>\u00a0has left #xwiki  \n15:38\u00a0<DarkKnightCZ1>\u00a0has quit  \n15:50\u00a0<cjd>\u00a0tmortagne: do you know what happens if you install an extension and there is already existing a document which the extension is to override?  \n15:50\u00a0<tmortagne>\u00a0cjd: conflict  \n15:50\u00a0<vmassol>\u00a0grrr seems escapes don't work for some reason\u2026. I'd have expected this to work: XWIKI\\_PID=$\\!  \n15:51\u00a0<tmortagne>\u00a0i.e. \"no idea what to do, let the user choose\"  \n15:51\u00a0<vmassol>\u00a0(according to http://velocity.apache.org/engine/devel/user-guide.html#Advanced\\_Issues:\\_Escaping\\_and\\_ )  \n15:51\u00a0<cjd>\u00a0ok, Charles did it on the intranet and it seems to have hung  \n15:52\u00a0<tmortagne>\u00a0what do you mean ?  \n15:52\u00a0<vmassol>\u00a0ok I'll do it like this:  \n15:52\u00a0<vmassol>\u00a0#set ($exclamationMark = '!')  \n15:52\u00a0<vmassol>\u00a0XWIKI\\_PID=$$exclamationMark  \n15:52\u00a0<vmassol>\u00a0;)  \n15:52\u00a0<cjd>\u00a0he said it refused to proceed  \n15:53\u00a0<cjd>\u00a0just \"trying forever\" to continue  \n15:53\u00a0<tmortagne>\u00a0always the exact same conflict ?  \n15:54\u00a0<tmortagne>\u00a0never seen something like this  \n15:54\u00a0<tmortagne>\u00a0maybe he have some old EM css/js in his browser cache  \n15:55\u00a0<cjd>\u00a0--> Installation manager does not seems to be sur that this extention is installed.  \n15:55\u00a0<cjd>\u00a0To be continued  \n15:58\u00a0<ClemensR>\u00a0vmassol: maybe \u00a0XWIKI\\_PID=\\$! \u00a0would have worked, but via #set everybody notices velocity has a word to say here first  \n15:58\u00a0<vmassol>\u00a0no it doesn't work  \n15:58\u00a0<vmassol>\u00a0right now I'm trying to figure out why it doesn't work with my local variable too  \n15:58\u00a0<vmassol>\u00a0and yes I agree it's better for clarity  \n15:59\u00a0<vmassol>\u00a0I'l doing this  \n15:59\u00a0<vmassol>\u00a0## Since this file is parsed with Velocity and since Velocity would render '$!' as '$' we need to be tricky...  \n15:59\u00a0<vmassol>\u00a0XWIKI\\_PID=$$exclamationMark  \n15:59\u00a0<vmassol>\u00a0but nothings gets replaced strangely  \n15:59\u00a0<vmassol>\u00a0in a wiki page it works though  \n15:59\u00a0<vmassol>\u00a0for ex: http://playground.xwiki.org/xwiki/bin/view/Main/VMA  \n16:00\u00a0<vmassol>\u00a0but through the assembly plugin with filtering on it doesn't....  \n16:00\u00a0<ClemensR>\u00a0maybe \u00a0\u00a0#set ($exclamationMark = '$!') \u00a0and \u00a0\u00a0XWIKI\\_PID=$exclamationMark \u00a0\u00a0\u00a0to do less substitution  \n16:01\u00a0<vmassol>\u00a0I'll try this since it's also nicer  \n16:02\u00a0<ClemensR>\u00a0if I try this locally, it builds a xwiki-platform-tool-jetty-resources-6.3-SNAPSHOT.zip \u00a0\u00a0without any substitutions :/  \n16:03\u00a0<vmassol>\u00a0same  \n16:03\u00a0<vmassol>\u00a0yep  \n16:04\u00a0<vmassol>\u00a0actually it does substitute for ${xwikiDataDir}  \n16:04\u00a0<vmassol>\u00a0so it's like local variable have no effect  \n16:05\u00a0<vmassol>\u00a0and using a property variable in the pom.xml would be ugly ;)  \n16:05\u00a0<ClemensR>\u00a0for me it does not even this ... must have made a mistake somewhere :(  \n16:06\u00a0<vmassol>\u00a0I rebuild tools/jetty  \n16:06\u00a0<vmassol>\u00a0and then distribution/jetty/hsqldb  \n16:06\u00a0<vmassol>\u00a0then in target, I unzip the zip  \n16:06\u00a0<vmassol>\u00a0and check start\\_xwiki.sh  \n16:07\u00a0<ClemensR>\u00a0seems I need to do the second step, too  \n16:09\u00a0<vmassol>\u00a0maybe there's an option when you run velocity to not define local variables  \n16:09\u00a0<vmassol>\u00a0oh  \n16:09\u00a0<vmassol>\u00a0stupid me  \n16:09\u00a0<vmassol>\u00a0forget all that  \n16:09\u00a0<vmassol>\u00a0the assembly plugin must not be using Velocity at all  \n16:09\u00a0<vmassol>\u00a0it just happens to use a similar syntax  \n16:09\u00a0<vmassol>\u00a0${var}  \n16:09\u00a0<vmassol>\u00a0checking that  \n16:10\u00a0<vmassol>\u00a0yup  \n16:10\u00a0<vmassol>\u00a0http://maven.apache.org/plugins/maven-assembly-plugin/examples/single/filtering-some-distribution-files.html  \n16:11\u00a0<vmassol>\u00a0so the isseu with $! is only with the PackageMojo actually  \n16:11\u00a0<vmassol>\u00a0and I can apply a similar strategy than the assembyl plugin instead  \n16:11\u00a0<ClemensR>\u00a0ah, great, that might explain something :)  \n16:13\u00a0<ClemensR>\u00a0actually there is still a XWIKI\\_PID=$! \u00a0in the generated \u00a0xwiki-enterprise-jetty-hsqldb-6.3-SNAPSHOT/start\\_xwiki.sh \u00a0anyway, at least I see something  \n16:14\u00a0<Denis>\u00a0has joined #xwiki  \n16:15\u00a0<ClemensR>\u00a0ah, PackageMojo is different ...  \n16:17\u00a0<Denis>\u00a0has quit  \n16:34\u00a0<Pbas>\u00a0has quit  \n16:35\u00a0<vmassol>\u00a0let's see how this goes\u2026  \n16:36\u00a0<ClemensR>\u00a0not sure about, but \u00a0\u00a0XWIKI\\_PID=${!} \u00a0seems to have worked for the PackageMojo at least ... as different solution in PackageMojo instead  \n16:36\u00a0<ClemensR>\u00a0ok, maybe nicer to keep it in sync there  \n16:40\u00a0<vmassol>\u00a0cool it's working  \n16:40\u00a0<vmassol>\u00a0see http://ci.xwiki.org/job/xwiki-platform/18/console  \n16:41\u00a0<vmassol>\u00a0actually  \n16:41\u00a0<vmassol>\u00a0speaking too fat  \n16:41\u00a0<vmassol>\u00a0fast  \n16:41\u00a0<vmassol>\u00a0some other problem now....  \n16:43\u00a0<evalica>\u00a0has quit  \n16:52\u00a0<Denis>\u00a0has joined #xwiki  \n17:02\u00a0<Denis>\u00a0has quit  \n17:09\u00a0<vmassol>\u00a0oh stupid me  \n17:14\u00a0<benoitc>\u00a0has quit  \n17:14\u00a0<benoitc>\u00a0has joined #xwiki  \n17:14\u00a0<vmassol>\u00a0should work this time\u2026.  \n17:14\u00a0<vmassol>\u00a0can't believe how long it all took....  \n17:15\u00a0<cjd>\u00a0#bash  \n17:16\u00a0<tmortagne>\u00a0vmassol: you Java developer :)  \n17:16\u00a0<cjd>\u00a0naw, bash is always like that  \n17:16\u00a0<vmassol>\u00a0actually I've worked during a few years coding only in shell in my past life :)  \n17:16\u00a0<tmortagne>\u00a0cjd: was refering to the ;  \n17:16\u00a0<cjd>\u00a0that's why I avoid it like the plague  \n17:17\u00a0<tmortagne>\u00a0in https://github.com/xwiki/xwiki-platform/commit/77261c854551d9d3e0690b5583581ff157786d7d  \n17:17\u00a0<cjd>\u00a0haha no, the ; are all my lines  \n17:17\u00a0<vmassol>\u00a0I've developed pretty scary long code (full apps) in shell....  \n17:18\u00a0<vmassol>\u00a0working! :)  \n17:18\u00a0<momomomomo>\u00a0has joined #xwiki  \n17:18\u00a0<vmassol>\u00a0(so far)  \n17:19\u00a0<cjd>\u00a0friday fun: determining whether a given preprocessor macro is defined w/o using an #ifdef https://github.com/cjdelisle/cjdns/blob/master/util/Defined.h#L18  \n17:37\u00a0<momomomomo>\u00a0has quit  \n17:38\u00a0<ClemensR>\u00a0has left #xwiki  \n17:40\u00a0<momomomomo>\u00a0has joined #xwiki  \n17:52\u00a0<vmassol>\u00a0someone introduced a checkztyle error in rendering  \n17:52\u00a0<vmassol>\u00a0home/hudsonagent/jenkins\\_root/workspace/xwiki-rendering/xwiki-rendering-api/src/main/java/org/xwiki/rendering/block/DefinitionDescriptionBlock.java:0: File does not end with a newline.  \n17:52\u00a0<vmassol>\u00a0sdumitriu: is that you?  \n17:52\u00a0<vmassol>\u00a0see http://ci.xwiki.org/job/xwiki-rendering/10/console  \n17:53\u00a0<cjd>\u00a0yeah, I'm pretty sure he enabled that  \n17:53\u00a0<vmassol>\u00a0actually no  \n17:53\u00a0<vmassol>\u00a0more likely to be tmortagne  \n17:53\u00a0<vmassol>\u00a0https://github.com/xwiki/xwiki-rendering/commit/9ebe8bc850538f01c8f04c58dcea4d874cb877d1  \n17:54\u00a0<vmassol>\u00a0he's the last one to have committed in rendering  \n17:54\u00a0<vmassol>\u00a0http://ci.xwiki.org/job/xwiki-rendering/8/  \n17:54\u00a0<tmortagne>\u00a0vmassol: I don't see how this is related  \n17:54\u00a0<vmassol>\u00a0before the error ahppened :)  \n17:54\u00a0<tmortagne>\u00a0there was no change in DefinitionDescriptionBlock  \n17:54\u00a0<vmassol>\u00a0or it's caused by some changes in commons indirectly  \n17:54\u00a0<tmortagne>\u00a0pretty sure it's a change in checkstyle setup  \n17:54\u00a0<tmortagne>\u00a0I don't remember ever having this kind of checktyle error  \n17:55\u00a0<vmassol>\u00a0sdumitriu: could you check that please?  \n17:55\u00a0<tmortagne>\u00a0and I really don't see how this is important enough to fail the build...  \n17:55\u00a0<Enygma`>\u00a0has quit  \n17:55\u00a0<cjd>\u00a0btw I'd like to hear your comments on my most recent checkstyle related mail  \n17:55\u00a0<tmortagne>\u00a0\"File does not end with a newline.\" seriously  \n17:55\u00a0<vmassol>\u00a0cjd: no time at all  \n17:56\u00a0<cjd>\u00a0will you have time over the weekend?  \n17:56\u00a0<vmassol>\u00a0no  \n17:56\u00a0<vmassol>\u00a0right now the priority is the biuld  \n17:56\u00a0<vmassol>\u00a0and the release  \n17:56\u00a0<vmassol>\u00a0but if you're interested in checkstyle please review my mail about it  \n17:56\u00a0<cjd>\u00a0from when?  \n17:56\u00a0<vmassol>\u00a0(the one I sent 2 weeks before yours)  \n17:57\u00a0<vmassol>\u00a0pointing to that page: http://design.xwiki.org/xwiki/bin/view/Proposal/DefineSonarRules  \n17:59\u00a0<mflorea>\u00a0has joined #xwiki  \n18:01\u00a0<cjd>\u00a0I don't see anything that looks related in the past month  \n18:02\u00a0<vmassol>\u00a0http://xwiki.markmail.org/search/?q=DefineSonarRules  \n18:03\u00a0<cjd>\u00a0ahh [xwiki-devs] Playing with Sonar Rules -- aug 17  \n18:03\u00a0<vmassol>\u00a0the next step is replying to this email by listing the checks that in your opinion should be removed  \n18:03\u00a0<vmassol>\u00a0all violations can be seen on sonar.xwiki.org  \n18:03\u00a0<cjd>\u00a0a next step  \n18:04\u00a0<vmassol>\u00a0it's much larger than juste checkstyle  \n18:05\u00a0<cjd>\u00a0well we would need to think about what it means in terms of possibly weighting the project down with (what I understand is) a proprietary SaaS service  \n18:10\u00a0<vmassol>\u00a0cjd: it's as proprietary as xwiki is  \n18:10\u00a0<vmassol>\u00a0actually less  \n18:11\u00a0<vmassol>\u00a0not less same since it's also LGPL  \n18:11\u00a0<cjd>\u00a0ahh ok  \n18:12\u00a0<cjd>\u00a0well see you on monday  \n18:12\u00a0<cjd>\u00a0has quit  \n18:14\u00a0<vmassol>\u00a0bye  \n18:14\u00a0<vmassol>\u00a0sdumitriu: ping  \n18:33\u00a0<sdumitriu1>\u00a0vmassol: Pong  \n18:33\u00a0<vmassol>\u00a0sdumitriu: I missed that it was on a branch  \n18:33\u00a0<vmassol>\u00a0sorry about that  \n18:33\u00a0<vmassol>\u00a0I still fixed a violation on rendering though  \n18:33\u00a0<vmassol>\u00a0(master)  \n18:34\u00a0<vmassol>\u00a0regarding checkstyle, this is a dead tool  \n18:34\u00a0<vmassol>\u00a0let me reply quickly  \n18:37\u00a0<tmortagne>\u00a0has quit  \n18:39\u00a0<vmassol>\u00a0done  \n18:40\u00a0<woshilapin>\u00a0has quit  \n18:42\u00a0<vmassol>\u00a0oh I forgot to merge my changes to the 6.x branch  \n18:42\u00a0<vmassol>\u00a0doing it  \n18:47\u00a0<mflorea>\u00a0has quit  \n19:10\u00a0<momomomomo>\u00a0has quit  \n19:15\u00a0<vmassol>\u00a0sdumitriu: could you please fix all violations caused by your addition of the New line check?  \n19:16\u00a0<vmassol>\u00a0I fixed all rendering but now all platform is failing  \n19:16\u00a0<vmassol>\u00a0(see for example http://ci.xwiki.org/job/xwiki-platform/21/console )  \n19:17\u00a0<sdumitriu1>\u00a0vmassol: Working on that  \n19:17\u00a0<vmassol>\u00a0k  \n19:23\u00a0<Slashman>\u00a0has quit  \n19:25\u00a0<sdumitriu1>\u00a0From yesterday:  \n19:25\u00a0<sdumitriu1>\u00a0(12:01:18 PM) sdumitriu1: I wonder if anybody would complain if I break the build...  \n19:25\u00a0<sdumitriu1>\u00a0(12:06:44 PM) tmortagne: sdumitriu1: these days you could get lucky and have jenkins blamed for it before you fix it  \n19:59\u00a0<cjd>\u00a0has joined #xwiki  \n20:00\u00a0<cjd>\u00a0is now known as <Guest12167>  \n20:04\u00a0<momomomomo>\u00a0has joined #xwiki  \n20:15\u00a0<vmassol>\u00a0sdumitriu: I didn't see it, I would have said no because we're trying to do the opposite  \n20:15\u00a0<vmassol>\u00a0been at it for more than \u00a0week already  \n20:15\u00a0<vmassol>\u00a0opposite = try to stabillize the buikd  \n20:15\u00a0<vmassol>\u00a0and it's hard  \n20:15\u00a0<vmassol>\u00a0and painful  \n20:16\u00a0<vmassol>\u00a0and we're all supposed to be doing other stuff ....  \n20:16\u00a0<vmassol>\u00a0I'm actually depressed by the state of our build/ci  \n20:48\u00a0<abusenius\\_>\u00a0has joined #xwiki  \n22:39\u00a0<vmassol>\u00a0has quit  \n23:08\u00a0<OSIMasson>\u00a0has joined #xwiki  \n23:12\u00a0<OSIMasson>\u00a0has quit  \n23:25\u00a0<OSIMasson>\u00a0has joined #xwiki  \n23:33\u00a0<sburjan>\u00a0has joined #xwiki  \n23:40\u00a0<nickless>\u00a0has joined #xwiki  \n23:43\u00a0<abusenius\\_>\u00a0has quit\n"}