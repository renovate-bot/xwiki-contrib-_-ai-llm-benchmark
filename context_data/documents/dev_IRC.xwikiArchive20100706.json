{"id": "dev:IRC.xwikiArchive20100706", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20100706", "title": "IRC Archive for channel #xwiki - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\nsdumitriu left at 01:34 (Quit: Leaving.  \nEnygma` left at 01:40 (Ping timeout: 276 seconds  \nabusenius left at 01:53 (Ping timeout: 240 seconds  \nmflorea joined #xwiki at 07:43  \nmariusbutuc joined #xwiki at 07:52  \nsburjan joined #xwiki at 08:24  \nflorinciu joined #xwiki at 08:27  \nvmassol joined #xwiki at 08:39  \nEnygma` joined #xwiki at 09:19  \nevalica joined #xwiki at 09:20  \nsburjan - (09:29): http://code.xwiki.org/xwiki/bin/view/Applications/AnnotationsApplication  \nsburjan - (09:29): please check the download link for this app  \nsburjan - (09:29): is it correct ?  \nsburjan - (09:29): shouldnt point to a xar file ?  \nflorinciu left at 09:31 (Read error: Connection reset by peer  \nlucaa left at 09:38 (Ping timeout: 240 seconds  \nvmassol - (09:46): not anymore, thomas should have sent a mail on the dev list to explain it....  \nvmassol - (09:46): I'll do it  \narkub joined #xwiki at 09:49  \nvmassol - (09:50): sburjan: mail sent  \njvdrean joined #xwiki at 09:51  \nvmassol left at 09:52 (Quit: Leaving.  \nKermitTheFragger joined #xwiki at 09:53  \nvmassol joined #xwiki at 09:54  \nvmassol1 joined #xwiki at 09:56  \nvmassol left at 09:56 (Read error: Connection reset by peer  \nlucaa joined #xwiki at 10:09  \nsburjan - (10:12): wait.. what are you talking about .. about the Annotations ?  \nsburjan - (10:13): oh  \nsburjan - (10:13): i read the mail  \nabusenius joined #xwiki at 10:13  \nsburjan - (10:13): but isn't this a bit hard for the end-user ?  \nmariusbutuc - (10:19): sburjan: sounds good to me, and a lot easier from the dev pov  \nmflorea left at 10:19 (Quit: Leaving.  \nsburjan - (10:20): for devs yes, but for normal users that want to try it out,etc  \nsburjan - (10:20): it should be specified that the \"installer\" is actually the xar file  \nsburjan - (10:20): so that end users know too what to do  \nlucaa - (10:22): actually I think it's a very good idea to link to a place with all versions for download  \nlucaa - (10:22): users will know they need to pick the latest version  \nlucaa - (10:22): and it's a lot easier for development, to make sure that latest version is always available  \nlucaa - (10:23): however, this will not be possible for all artifacts, since not all are released and can be linked to a folder in maven  \ntmortagne joined #xwiki at 10:26  \nlucaa - (10:26): the only thing would be indeed kind of making it easy for the users to know that it's the .xar / .jar etc. that they want from the list (and not something else). Most of the users on code.xwiki.org will know it, I think, because that's why they are there but we can never be sure  \nflorinciu joined #xwiki at 10:36  \nflorinciu left at 10:36 (Client Quit  \nsburjan - (10:39): what server is at myxwiki.org .. it always have problems and gets restarted  \nflorinciu joined #xwiki at 10:53  \nsdumitriu joined #xwiki at 11:07  \nmflorea joined #xwiki at 11:10  \nvmassol joined #xwiki at 11:13  \nnuvolari left at 11:14 (Quit: No Ping reply in 180 seconds.  \nnuvolari joined #xwiki at 11:14  \nvmassol1 left at 11:15 (Ping timeout: 245 seconds  \nflorinciu left at 11:22 (Quit: Leaving.  \nnuvolari left at 11:27 (Quit: http://quassel-irc.org - Chat comfortably. Anywhere.  \nevalica - (11:28): hi sburjan I'm testing 2.4 M2 - and annotations are working only if in Admin- Presentation, the Skin is set with value XWiki.DefaultSkin; otherwise (custom, colibri, toucan) annotations are not working - can you test this? do you know something about this?  \nsburjan - (11:28): let me check  \nsburjan - (11:30): 2.4 M2 or latest snapshot ?  \nevalica - (11:30): 2.4 M2  \nsdumitriu - (11:31): lucaa: This is for you, read above  \nsdumitriu - (11:31): If anybody else wants to study the memory dump on myxwiki, http://incubator.myxwiki.org/xwiki/snaps/Bootstrap-2010-07-06-periodic-7.snapshot (800M file)  \nsburjan - (11:32): mine annotations work in toucan too  \nsburjan - (11:32): let me check albatros  \nevalica - (11:33): what value have you put to set the skin to toucan?  \nsburjan - (11:33): toucan  \nsburjan - (11:33): in the Skin input field  \nevalica - (11:34): I tested twice - first I set a custom skin, ex. Skin.NewSkin ... and after toucan, colibri, etc are not working for me anymore  \nsburjan - (11:34): albatross works too  \nsburjan - (11:34): well.. I tested for default, then changed to toucan, then to albatross  \nsburjan - (11:34): let me check on other pages, i only tested on Main  \nevalica - (11:34): sburjan: I'll test again after the meeting - thanks  \nevalica - (11:34): The presentation is for Wiki level  \nsdumitriu - (11:34): Size increase over time:  \nsdumitriu - (11:34): 23:30 - 440M  \nsdumitriu - (11:34): 00:30 - 555M  \nsdumitriu - (11:34): 01:30 - 660M  \nsdumitriu - (11:34): 02:30 - 820M  \nsdumitriu - (11:34): 03:10 - crash  \nsdumitriu - (11:34): 04:10 - 325M  \nsdumitriu - (11:34): 05:10 - 475M  \nsdumitriu - (11:34): 06:10 - 610M  \nsdumitriu - (11:34): 07:10 - 700M  \nsdumitriu - (11:34): 08:10 - 800M  \nlucaa - (11:34): evalica: the annotations don't work on other skin but collibri  \nsdumitriu - (11:34): 08:20 - crash  \nlucaa - (11:34): I mean the UI  \nevalica - (11:35): so If I want to extend them I should rewrite the annotations - k  \nsburjan - (11:35): that's odd.. mine works  \nevalica - (11:35): lucaa: thanks - but this should be fixed  \nlucaa - (11:35): evalica: extend?  \nevalica - (11:35): I wanted to extend Colibri with a custom skin .. and is not working  \nevalica - (11:36): custom skin that has as base colibri  \nsburjan - (11:36): I don;t have other skins .. i only have the 3 bundled ones  \nlucaa - (11:36): evalica: well, as long as you don't modify much, it should work  \nevalica - (11:36): lucaa: I've overriden commentsinline.vm stopped working  \nevalica - (11:36): what means don't modify much?  \nlucaa - (11:37): commentsinline should not make it fail  \nlucaa - (11:37): wdym it does not work? no UI or partial UI or UI but crashing?  \nevalica - (11:37): so .. they work ... add / visualizing ... the tab from docextra is not working  \nlucaa - (11:37): ok  \nlucaa - (11:37): ok, I was about to tell you about this  \nlucaa - (11:38): the tab from docextra is rendered using a template attached to XWiki.DefaultSkin  \nlucaa - (11:38): if you want to extend, you should also get it the template from there and attach it to your skin  \nlucaa - (11:38): and it will work  \nlucaa - (11:38): agreeded that it should be less complex than that  \nevalica - (11:38): as a hack - but this shouldn't be the normal behavior  \nlucaa - (11:38): s/agreeded/agreed  \nevalica - (11:39): k thanks lucaa - this would solve my problem  \nsburjan - (11:40): I'm still wondering how annotations work even when I use toucan  \nevalica - (11:40): sburjan sorry I wasn't more specific .. I meant the #annotation tab from docextra  \nlucaa - (11:40): evalica: yes, but that's a little more complicated. I avoided bundling the annos in the war, as in add jss in there, add templates, etc, I prefered to keep it in .xar form, and I still prefer.  \nsburjan - (11:40): oh, I see  \nvmassol1 joined #xwiki at 11:43  \nvmassol left at 11:43 (Read error: Connection reset by peer  \nlpereira joined #xwiki at 11:44  \nvmassol joined #xwiki at 11:46  \nvmassol1 left at 11:46 (Read error: Connection reset by peer  \nevalica - (11:47): lucaa: also why didn't you add itemCount of existing annotations for Annotation tab, like Annotations (3) ? same reason?  \nlucaa - (11:48): no, because that would require an extra ajax call, which would be time costly, but it's possible to do it without annoying the user  \nlucaa - (11:48): there should be an issue reported for it in the XAANNOTATIONS project, vmassol should have done it iirc  \nevalica - (11:48): from consistency reason - that should be added - also in the shortcut area up  \nsdumitriu - (11:49): vmassol: VelocimacroManager takes up 400M out of 800M  \nevalica - (11:53): lucaa: yes found it thanks  \nvmassol - (11:54): otp (meeting)  \nevalica - (11:56): sdumitriu: about Class editor - when you import a skin from somewhere else (where you had a different Skins Class declaration) , the file shows only the fields from the current Skins Class (even thou those fields are in the description and active) - is there a way to show them somehow?  \nevalica - (11:58): something like \"The following properties where deleted from the class \u00a0XWiki.XWikiSkins and are now deprecated:\" but more like \"This object also contains other properties, that are not default in the Class\" ... or something  \nabusenius - (12:03): sdumitriu, which JRE is used on myxwiki?  \nabusenius - (12:04): I have problems runnign xwiki on sun 1.6.0.20 x86\\_64, it leaks memory (sun 1.5.0.22 works fine)  \nnuvolari joined #xwiki at 12:05  \nnuvolari left at 12:05 (Changing host  \nnuvolari joined #xwiki at 12:05  \ntmortagne - (12:16): myxwiki.org is using Java 1.6 AFAIK but i don't know which exact version  \nflorinciu joined #xwiki at 12:25  \nlucaa left at 12:29 (Ping timeout: 265 seconds  \nmariusbutuc left at 12:48 (Ping timeout: 252 seconds  \narkub left at 12:55 (Quit: Leaving  \nsdumitriu - (13:15): abusenius:  \nsdumitriu - (13:15): java version \"1.6.0\\_12\"  \nsdumitriu - (13:15): Java(TM) SE Runtime Environment (build 1.6.0\\_12-b04)  \nsdumitriu - (13:15): Java HotSpot(TM) 64-Bit Server VM (build 11.2-b01, mixed mode)  \nlucaa joined #xwiki at 13:18  \nSvenDowideit left at 13:56 (Read error: Operation timed out  \nvmassol - (14:08): sdumitriu: sorry was in meeting the whole morning. Any disocvery re the memory issue?  \nsdumitriu - (14:09): Yep  \nsdumitriu - (14:09): Since macros don't override each other, now each wiki has its own set of macros  \nsdumitriu - (14:09): Macro overload  \nsdumitriu - (14:09): The only solution I can think of is to use a LRU to store macros  \nvmassol - (14:10): yes but once the page has finished rendernig it's cleared  \nsdumitriu - (14:10): No it's not  \nsdumitriu - (14:10): That's the problem  \nsdumitriu - (14:10): Macros are kept in a cache forever  \nvmassol - (14:10): the macros for the page namespace that is  \nvmassol - (14:10): I'm clearing them  \nsdumitriu - (14:10): For a page, maybe  \nvmassol - (14:10): that was the purpose of my fix  \nvmassol - (14:10): I only changed velcotiy macros for pages  \nsdumitriu - (14:10): Hm..  \nvmassol - (14:11): not velocity macros in templates  \nvmassol - (14:11): these are still registered with a common namespace  \nsdumitriu - (14:11): Are you sure?  \nsdumitriu - (14:11): Well, something's not working  \nvmassol - (14:12): here's what I call:  \nvmassol - (14:12): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Utils.getComponent(VelocityManager.class).getVelocityEngine().clearMacroNamespace(documentName);  \nvmassol - (14:12): which internally calls:  \nvmassol - (14:12): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0this.rsvc.dumpVMNamespace(templateName);  \nvmassol - (14:13): which calls:  \nvmassol - (14:13): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0return vmManager.dumpNamespace(namespace);  \nsdumitriu - (14:13): Hm...  \nvmassol - (14:13): (in VelocimacroManager)  \nsdumitriu - (14:13): I don't think macros are namespaced in that cache  \nsdumitriu - (14:13): I'll investigate more the structure of that cache  \nvmassol - (14:13): they are  \nvmassol - (14:14): look at VelocimacroManager sources  \nvmassol - (14:14): (I have it under my eyes)  \nvmassol - (14:14): \u00a0\u00a0\u00a0\u00a0/\\*\\* Hash of namespace hashes. \\*/  \nvmassol - (14:14): \u00a0\u00a0\u00a0\u00a0private final Map namespaceHash = MapFactory.create(17, 0.5f, 20, false);  \nvmassol - (14:15): let me put a breakpoint just to test locally  \nSvenDowideit joined #xwiki at 14:15  \nsdumitriu - (14:15): OK, they are namespaced  \nsdumitriu - (14:15): But they are not cleared  \nsdumitriu - (14:16): Look in o.a.v.runtime.VelocimacroManager  \nvmassol - (14:16): I'm there  \nvmassol - (14:16): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Map h = (Map) namespaceHash.remove(namespace);  \nsdumitriu - (14:16): btw, why are there 2 instances of org.xwiki.velocity.internal.DefaultVelocityEngine?  \nvmassol - (14:17): there's only one when you run locally but there are as many as you have skins  \nvmassol - (14:17): jconsole will give you info on that btw  \nsdumitriu - (14:17): Huh  \nsdumitriu - (14:18): K, something strange  \nsdumitriu - (14:18): There are 2 VelocimacroManagers  \nvmassol - (14:18): I can see the remove called in debug mode  \nsdumitriu - (14:18): One is linked from DefaultVelocityEngine, one is root  \nsdumitriu - (14:19): The one linked from our code is almost empty  \nsdumitriu - (14:19): The other one is the one that's full  \narkub joined #xwiki at 14:26  \nsburjan - (14:27): does anyone know where could I find some JUnit tests on the SVN so I can take a look at them ?  \nsburjan - (14:27): something more larger that 2-3 tests  \nvmassol - (14:28): sburjan: look for all classes implementing AbstracMockingComponentTestCase for ex  \nvmassol - (14:28): this is the new method (cf mail I sent over the weekend about it)  \nsburjan - (14:28): platform or enterprise ?  \nvmassol - (14:28): platform  \nsburjan - (14:28): ok  \nfmancinelli joined #xwiki at 14:29  \nvmassol - (14:32): fmancinelli: the build is failing on hudson in core  \nvmassol - (14:32): http://hudson.xwiki.org/job/xwiki-platform-core/6229/org.xwiki.platform$xwiki-rest-model/console  \nvmassol - (14:34): sdumitriu: let me know if you need my help to debug the velocitymacromanager thing. I'm working on something else right now but I can help if need be.  \nfmancinelli - (14:34): vmassol: Yes, fixing it  \narkub left at 14:37 (Ping timeout: 260 seconds  \nsburjan - (14:39): vmassol, \u00a0: I can't find the shared tests  \ntmortagne - (14:41): sburjan: http://svn.xwiki.org/svnroot/xwiki/platform/core/trunk/xwiki-shared-tests/  \ntmortagne - (14:41): that's the tools  \ntmortagne - (14:41): you can find example in most of the core project  \ntmortagne - (14:41): xwiki-core have a lot of them  \ntmortagne - (14:42): but it also have a lot of bad examples :)  \nDSpair joined #xwiki at 14:42  \nDSpair - (14:42): Good morning all..  \ntmortagne - (14:42): sburjan: see http://dev.xwiki.org/xwiki/bin/view/Community/Testing  \nvmassol - (14:43): english guys would you use \"\"Looking for professional services? Go on XWiki.com\" or \"\"Looking for professional services? Go to XWiki.com\" ?  \nDSpair - (14:43): Brit english, or US?  \ntmortagne - (14:44): US probably  \nDSpair - (14:44): \"Go to\" would be the common way in US English.  \ntmortagne - (14:45): vmassol: GG the advertisement on IRC chat ;)  \nDSpair - (14:45): vmassol: You could avoid US/UK distinction with the phrase \"Navigate to XWiki.com\".  \nDSpair - (14:46): Or perhaps \"Link to XWiki.com\"  \njvdrean left at 14:46 (Quit: Leaving.  \njvdrean joined #xwiki at 14:47  \nvmassol - (14:49): tmortagne: that wasn't my purpose!  \nvmassol - (14:50): I also think Go to is better  \nvmassol - (14:50): FYI guys I'm going to add an image advertisement on the download page  \nvmassol - (14:50): according to our governance rule  \nvmassol - (14:51): http://dev.xwiki.org/xwiki/bin/view/Community/Governance  \nDSpair - (14:53): Question on XAR files.  \nsburjan - (14:53): thanks vmassol , tmortagne  \nDSpair - (14:54): The exported XML file for a class has a UUID... How broken would it be to have a duplicate UUID?  \nDSpair - (14:54): The reason I ask is that I would like to programmatically (from a script) generate a bunch of new object instances and use a default template.  \nvmassol - (14:57): evalica: could you help me on styling http://www.xwiki.org/xwiki/bin/view/Main/Support correctly?  \nvmassol - (14:57): (so that there's no scroll and so that the text wraps correctly :))  \ntmortagne - (14:58): DSpair: there UUIS only for object, i doubt you have a UUID in the XML when exporting just a class  \ntmortagne - (14:58): s/UUIS/UUID/  \ntmortagne - (14:59): DSpair: if the question is \"how do i generate UUID\" the answer is use the proper API and it will be automatically generated for you ;)  \nfmancinelli - (15:09): vmassol: Should be fixed now. I was compiling with JDK1.6 which happens to have some previously required dependencies (JAXB) in the standard libraries.  \nmariusbutuc joined #xwiki at 15:10  \narkub joined #xwiki at 15:20  \nDSpair - (15:23): tmortagne, You are correct, I meant to say object instance/page.  \nDSpair - (15:24): tmortagne, As for using the proper APIs, that's not really a very good option as I want to convert the information from an incompatible data source.  \ntmortagne - (15:24): DSpair: you are working in pure XML you mean ?  \ntmortagne - (15:24): no in the wiki ?  \nDSpair - (15:25): tmortagne, I have an existing external database which I will write a script to generate XML files from that database.  \ntmortagne - (15:25): the best is probably to simply not put any UUID in the XML  \ntmortagne - (15:25): a unique one will be automatically generated  \nDSpair - (15:25): tmortagne, That's exactly what I was hoping!  \nDSpair - (15:25): Thanks so much!  \ntmortagne - (15:25): in fact IMO we should probably not have UUID in the exported XML  \nDSpair - (15:26): Because it could conflict in another XWiki instance...  \ntmortagne - (15:26): yep  \ntmortagne - (15:26): or at least not take then into account if we don't import as backup pack  \nDSpair - (15:26): Would you like me to put in an RFE?  \ntmortagne - (15:26): i will check that  \ntmortagne - (15:26): (it's possible we already do that i don't know)  \ntmortagne - (15:27): but i doubt that  \ntmortagne - (15:27): DSpair: RFE ?  \nDSpair - (15:28): RFE = Request For Enhancement  \ntmortagne - (15:28): DSpair: ho ok sorry :) Yep sure do it  \nsburjan - (15:47): vmassol, \u00a0: so AbstractMockingComponentTestCase should be used as a ProtoFramework for testing with JUnit and JMock ?  \nvmassol - (15:48): sburjan: there are some info here too: http://dev.xwiki.org/xwiki/bin/view/Community/Testing  \nvmassol - (15:48): sburjan: yes  \nsburjan - (15:48): read them :P  \nsburjan - (15:49): so every JUnit test will have to be \"converted\" to use this class ?  \narkub left at 15:50 (Ping timeout: 260 seconds  \nmariusbutuc left at 16:23 (Ping timeout: 245 seconds  \nvmassol - (16:33): sburjan: new tests should be written this way yes  \nvmassol - (16:33): and indeed old tests should be converted slowly to it  \nsdumitriu - (16:34): vmassol: Found two possible leaks  \nvmassol - (16:34): ahah  \nsdumitriu - (16:34): 1: exceptions  \nsdumitriu - (16:34): 2: parsed SX  \nvmassol - (16:35): tmortagne: we're supposed to stabilize XE\u2026. :)  \nvmassol - (16:35): (upgrading versions is a risk)  \nsdumitriu - (16:36): Ah, no  \nsdumitriu - (16:36): Forget 1  \nsdumitriu - (16:36): That's minor  \nsdumitriu - (16:36): There are two getRenderedContent methods in XWikiDocument  \nsdumitriu - (16:36): One has the clear, the other doesn't  \ntmortagne - (16:36): vmassol: upgrading to bugfixing releases  \nsdumitriu - (16:36): And the other one is called for rendering panels  \nsdumitriu - (16:37): So each page with panels leaks macros  \nsdumitriu - (16:37): Which means all pages  \nsdumitriu - (16:37): vmassol: Do you want to fix it, or can I go on?  \nvmassol - (16:38): sdumitriu: hmmm  \nvmassol - (16:38): I discussed with tmortagne about this  \nvmassol - (16:38): maybe we missed something  \nvmassol - (16:38): we had voluntarily done the clear only in one method  \ntmortagne - (16:38): vmassol: the cleanup was not supposed to be done in getRenderedContent  \ntmortagne - (16:39): but at the end of the whole page rendering process  \ntmortagne - (16:39): when we talked about it  \nvmassol - (16:39): tmortagne: you're changing the history :)  \ntmortagne - (16:39): no  \ntmortagne - (16:39): i don't  \nvmassol - (16:39): since we did it together  \nvmassol - (16:39): but that's ok  \nsdumitriu - (16:39): That might still leak, not all documents are rendered in the current document  \ntmortagne - (16:39): i'm sure of what i'm saying  \ntmortagne - (16:40): it's useless to cleanup only for the rendered content part  \nsdumitriu - (16:40): You can do $someOtherDoc.getRenderedContent  \nvmassol - (16:40): tmortagne: you don't remember that we agreed that checking isInRenderingEngine was the way to check inside getRendereContent that the rendering was over?  \ntmortagne - (16:41): yep we talked about that but we also talked about panels if i remember well  \nvmassol - (16:42): anyway the question is: how do we fix it?  \ntmortagne - (16:44): vmassol: didn't you changed something in the way panels was rendered to make then use the same entry point ?  \nvmassol - (16:44): no  \nvmassol - (16:44): I haven't changed anythin  \narkub joined #xwiki at 16:44  \ntmortagne - (16:44): i think we talked about that before saying that we had a single entry point to be able to cleanup  \nvmassol - (16:45): maybe I didn't really understand that part  \nvmassol - (16:45): and thus didn't change anythng  \nvmassol - (16:45): what's strange though is that in my tests using jconsole I didn't see the cache growing  \nvmassol - (16:45): (velocity macro cache)  \ntmortagne - (16:45): (that's what even lead use to talk about future design)  \ntmortagne - (16:45): s/use/us/  \nvmassol left at 16:52 (Ping timeout: 245 seconds  \nvmassol joined #xwiki at 16:58  \nDSpair - (17:01): OK, clean install of XWiki, new database (postgres 8.3), and imported the XWiki default xar.  \nDSpair - (17:01): But I still cannot use attached JAR files with my Groovy applications.  \nlpereira left at 17:02 (Quit: Leaving.  \nvmassol - (17:02): tmortagne: ?  \nvmassol - (17:02): sdumitriu: I think it should be ok to add the same check  \ntmortagne - (17:02): vmassol: and don't forget to put the cleanup in a finally like sdumitriu suggested  \nvmassol - (17:03): sdumitriu: can you make the change or would you prefer thomas or me do it?  \nsburjan left at 17:06 (Quit: Ex-Chat  \nvmassol - (17:07): seems like all core is broken on hudson  \ntmortagne - (17:13): vmassol: i'm on it  \ntmortagne - (17:13): small mistake i did  \nvmassol - (17:13): it = hudson or the memory leak?  \nvmassol - (17:13): ok hudson  \ntmortagne - (17:13): hudson  \nsdumitriu - (17:20): I'll take the leak  \nvmassol - (17:23): ok thanks  \nsdumitriu - (17:29): vmassol, tmortagne: In the future we should refactor the way we use velocity macros  \nsdumitriu - (17:29): Since the current way is very inefficient  \nsdumitriu - (17:29): We shouldn't use {{include}} to import macros, but have a special {{useMacroLibrary}} or something like that  \nvmassol - (17:29): oh definitely  \nvmassol - (17:29): we need  \nsdumitriu - (17:29): Which only parses once the document and reuses the same instance each time  \nvmassol - (17:29): the same mechanism as for wiki macros  \nvmassol - (17:29): but for velocity macros  \nvmassol - (17:29): ie objects  \nvmassol - (17:30): and a manager that listens  \nsdumitriu - (17:30): Yep  \nsdumitriu - (17:30): Maybe for 2.5  \nvmassol - (17:30): maybe  \nsdumitriu - (17:30): I'd like 2.5 to be targeted on security and performance  \ntmortagne - (17:30): sdumitriu: sure, but not sure for 2.5  \nvmassol - (17:31): I'll send a mail for polling what people would like to see in 2.5 in brainstorming mode  \ntmortagne - (17:31): (but i would love to make 2.5 target on security/performance/bugfixes too)  \nsdumitriu - (17:33): 2.5 should be around the start of november  \nsdumitriu - (17:34): Going back to the leak  \nsdumitriu - (17:34): I'll just clean the cache in the other getRenderedContent method for the moment  \nsdumitriu - (17:35): If !isInRenderingEngine  \nsdumitriu - (17:35): Is that OK?  \ntmortagne - (17:35): sdumitriu: yep and also put all that in the finally (same for the one that already have the clean)  \nvmassol - (17:35): sdumitriu: sounds ok to me, please also fix the finally  \nsdumitriu - (17:36): Sure  \ntmortagne left at 17:38 (Quit: Leaving.  \nlpereira joined #xwiki at 18:13  \nevalica - (18:34): q: if I have a macro how can I found out in which file it is defined?  \nflorinciu left at 18:35 (Quit: Leaving.  \nfmancinelli left at 18:39 (Ping timeout: 260 seconds  \nmflorea left at 18:45 (Quit: Leaving.  \nabusenius left at 18:52 (Ping timeout: 240 seconds  \nsdumitriu - (19:06): evalica: Search  \narkub left at 19:09 (Quit: Leaving  \nlucaa - (19:12): evalica: since some recent version there are some properties of the macro descriptors to get this info. Basically you need to write a bit of code to get this descriptor to get the page name. I can search for the specific way to do it, if it would suit your purpose  \nlucaa left at 19:16 (Quit: Leaving.  \nevalica - (19:16): thanks  \nevalica left #xwiki at 19:18  \nabusenius joined #xwiki at 19:19  \nKermitTheFragger left at 19:23 (Quit: Leaving  \nCalebJamesDeLisl - (19:25): abusenius: I got crypto.signText to work. What I had to do was create a CA cert on the server and sign the client cert, then the client has to install the ca cert (which is surprisingly easy).  \nabusenius - (19:26): cool  \nsdumitriu - (19:26): Cool  \nsdumitriu - (19:27): abusenius: What's the status on CSRF prevention?  \nabusenius - (19:27): sdumitriu: the component that does it is small and working  \nabusenius - (19:28): most of the important applications, all templates and all actions are patched (up to possible bugs)  \nabusenius - (19:29): most problematic are the tests (especially selenium1)  \nflorinciu joined #xwiki at 19:29  \nabusenius - (19:29): they use url to delete/create/etc pages all over the place  \nabusenius - (19:30): it would be cool if a couple of people would test it  \nabusenius - (19:32): btw, CalebJamesDeLisl, I'm writing a prototype of the signed macro and a crypto component  \nsdumitriu - (19:32): I think it should be applied early on 2.5  \nabusenius - (19:33): +1 :)  \nCalebJamesDeLisl - (19:33): I'm the worst for doing that (save with url). You can't post and it takes forever to navigate around to the page you want.  \nsdumitriu - (19:33): abusenius: Do you think the code (except tests) is ready?  \nsdumitriu - (19:33): CalebJamesDeLisl: +1, me too  \nabusenius - (19:33): I think yes  \nsdumitriu - (19:34): Initially I was against fixing CSRF because of this (I know, I'm lazy)  \nabusenius - (19:34): im principle it is ok to save with url, as long as the token is there  \nabusenius - (19:34): we just need to read it out of a page and use everywhere  \nsdumitriu - (19:35): Ah, what about REST?  \nDSpair - (19:35): CalebJamesDeLisl, I'm back to debugging the attached jars again. Has anyone had a chance to investigate?  \nabusenius - (19:35): it is not protected  \nsdumitriu - (19:35): Is it still open to CSRF?  \nabusenius - (19:35): yes  \nCalebJamesDeLisl - (19:35): We can turn it off for tests for the beginning. I'm +1 to having some protection rather than waiting until everything is perfect before installing.  \nsdumitriu - (19:35): K  \nabusenius - (19:35): it is easy to fix though, I was talking to Fabio about it  \nsdumitriu - (19:36): Sure it's easy, it just has to be done in a convenient way  \nabusenius - (19:36): and we need to fix applications that use it  \nCalebJamesDeLisl - (19:36): DSpair: I haven't had any chance, I noticed you sent mail, Thomas who responded knows a lot more about components and rendering than me.  \nabusenius - (19:37): if somebody wants to test CSRF protection, ping me, I'll update the patches  \nDSpair - (19:37): CalebJamesDeLisl, OK, thanks. I'll wait for him to respond further.  \nCalebJamesDeLisl - (19:53): abusenius: signText uses pkcs7 so if you're working on a validator, that's probably the best choice for a standard. I can send you my (still hackish) work to date so you can play with it.  \nflorinciu left at 19:56 (Quit: Leaving.  \nCalebJamesDeLisl - (20:04): DSpair: I'll try duplicating your problem in 2.3.0, I'm afraid the answer is wither going to be \"there was a bug, upgrade\" or it's something about your jvm/operating system/etc.  \nDSpair - (20:16): CalebJamesDeLisl, I've tried on Linux and Windows, Java 5 and 6, new and old installation of 2.3.1...  \nCalebJamesDeLisl - (20:17): Have you tried it on installations other than 2.3.1?  \nCalebJamesDeLisl - (20:17): \\*versions  \nDSpair - (20:17): CalebJamesDeLisl, No.  \nCalebJamesDeLisl - (20:22): I have 2.3.0 sitting on my computer, I can give that a try.  \nDSpair - (20:26): CalebJamesDeLisl, Thanks. I would appreciate that.  \nsdumitriu - (20:37): I'll put non-leaky versions of the core and of the skinx on myxwiki to see how it behaves  \nsdumitriu - (20:38): If it's OK, we can release RC1 tomorrow  \nDSpair left at 20:56 (Quit: Leaving  \nsdumitriu - (21:10): K, again \"inexisting\" documents hidden behind the cache  \nsdumitriu - (21:10): Something else is wrong on myxwiki  \nsdumitriu - (21:15): vmassol: Ping  \nDSpair joined #xwiki at 21:33  \nCalebJamesDeLisl - (21:41): DSpair: Can't repeat in 2.3.0. Are you using jetty?  \nDSpair - (21:41): No, using PostgreSQL  \nCalebJamesDeLisl - (21:41): jetty vs. tomcat.  \nDSpair - (21:41): Tomcat  \nDSpair - (21:42): Sorry, I was thinking hsqldb  \nCalebJamesDeLisl - (21:42): Maybe that has something to do with it. I'm running jetty as the back end.  \nDSpair - (21:42): Let me try 2.3.0 in tomcat \u00a0and see  \nDSpair - (21:54): CalebJamesDeLisl: \u00a02.3.0 fails inside of Tomcat as well.  \nDSpair - (21:54): I guess it could be something to do with the container properties, but I am running with the security manager turned off.  \nCalebJamesDeLisl - (21:57): I think there must be something going on with the Tomcat loader. I'm out of my league with tomcat. Maybe try asking the tomcat people about the error message you get? I seem to recall there were some google hits for that message. Good luck.  \nsdumitriu - (21:58): But it works on xwiki.org  \nsdumitriu - (21:58): Which is using Tomcat  \nDSpair - (21:58): CalebJamesDeLisl: \u00a0On the attached jars, I don't get ANY message. That thread just stops.  \nsdumitriu - (21:59): Are you sure it's not something wrong with the jar itself?  \nDSpair - (21:59): CalebJamesDeLisl: \u00a0Even when I bump logging up to debug, I get nothing.  \nDSpair - (21:59): sdumitriu: \u00a0It doesn't matter what Jar I use.  \nDSpair - (22:00): I could create a blank JAR file using \"jar -cvf myJar.jar \" and it would still cause the error.  \nsdumitriu - (22:00): OK, I'll try on myxwiki a live example  \nsdumitriu - (22:01): Simple hello world from groovy: http://incubator.myxwiki.org/xwiki/bin/view/Sandbox/groovy  \nsdumitriu - (22:01): I'll add a jar now  \nDSpair - (22:02): sdumitriu: \u00a0And you have to add: jars=\"attach:myJar.jar\" inside of the groovy tag.  \nDSpair - (22:03): Well, crazy!! It works there.  \nsdumitriu - (22:03): Yep  \nDSpair - (22:03): Is there possibly something I am missing in my Tomcat config?  \nsdumitriu - (22:04): http://incubator.myxwiki.org/xwiki/bin/view/Sandbox/groovy?viewer=code  \nsdumitriu - (22:05): So, tomcat-6.0.20, mysql, java 1.6  \nDSpair - (22:06): sdumitriu: \u00a0Nope, tomcat 5.5, Java 6.0.20, PostgreSQL  \nDSpair - (22:07): sdumitriu: \u00a0Actually, I have tried numerous combinations of Tomcat 5.5/6, Java 1.6.0.x, and PostgreSQL/MySQL on Linux and Windows.  \nsdumitriu - (22:08): DSpair: Voodoo  \nsdumitriu - (22:08): Try calling an exorcist :D  \nDSpair - (22:09): sdumitriu: \u00a0Hrrmmmm . . . I  \nDSpair - (22:09): sdumitriu: \u00a0Hrrmmmm . . . I'll get right on that . . . :P  \nDSpair - (22:20): sdumitriu and CalebJamesDeLisl: THANKS!!! You helped me narrow it down enough to figure it out.  \nCalebJamesDeLisl - (22:20): Voodoo did it? ;)  \nDSpair - (22:20): The problem was in the Tomcat configuration. In the server.xml file, the connector configuration has to be set to use UTF-8.  \nDSpair - (22:21): Once that was done, it all works perfectly.  \nflorinciu joined #xwiki at 22:22  \nflorinciu left at 22:23 (Client Quit  \nlpereira left at 22:31 (Quit: Leaving.  \nnpm left at 22:37 (Remote host closed the connection  \nnpm joined #xwiki at 22:37  \nlucaa joined #xwiki at 22:50  \nDSpair - (22:52): CalebJamesDeLisl: \u00a0OK, after changing the UTF-8 setting on Linux that runs fine, but on Windows it still does not work.  \nCalebJamesDeLisl - (22:57): Do you have an error log?  \nDSpair - (22:58): CalebJamesDeLisl: \u00a0Nope  \nDSpair - (22:58): No errors in the log.  \nDSpair - (22:59): I just enabled the java.security.debug and still no errors.  \nCalebJamesDeLisl - (23:00): I can see the possibility for a bug like this to slip by if it's only on Windxws. Didn't you have some error stack traces before?  \nDSpair - (23:08): CalebJamesDeLisl: \u00a0Not with attached jars.  \nCalebJamesDeLisl - (23:09): As far as Windxws goes I really can't help much since I dumped that software years ago.  \nlucaa left at 23:20 (Ping timeout: 245 seconds  \nsdumitriu - (23:29): DSpair: You could try to change the tomcat startup script to include en\\_US.UTF-8 as the system language/encoding  \nsdumitriu - (23:29): (on Windows)  \nDSpair - (23:31): sdumitriu: \u00a0Any idea on how to accomplish that?  \nsdumitriu - (23:34): -Dfile.encoding=UTF-8  \nEnygma` left at 23:45 (Ping timeout: 265 seconds  \nDSpair - (23:48): sdumitriu: \u00a0That did no good as either a CATALINA\\_OPTS or a JAVA\\_OPTS value.  \nDSpair - (23:53): I have also tried: export JAVA\\_OPTS=\"-Dfile.encoding=UTF-8 -Djavax.servlet.request.encoding=UTF-8\"  \nDSpair - (23:54): I wonder if I need to install UTF-8 on Windows before it will work?  \nDSpair - (23:59): According to M$, UTF-8 is built-in as of NT4.  \nDSpair - (23:59): So, this appears to be a Windows specific bug.  \n\n"}