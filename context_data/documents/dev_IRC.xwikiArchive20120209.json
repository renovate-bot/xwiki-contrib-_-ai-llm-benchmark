{"id": "dev:IRC.xwikiArchive20120209", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20120209", "title": "IRC Archive for channel #xwiki on 09 February 2012 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n00:54\u00a0<fmancinelli>\u00a0has quit  \n00:57\u00a0<jvdrean>\u00a0has quit  \n01:01\u00a0<kayasaman>\u00a0has quit  \n02:48\u00a0<tekzilla>\u00a0has quit  \n02:50\u00a0<tekzilla>\u00a0has joined #xwiki  \n03:42\u00a0<mflorea>\u00a0has quit  \n04:32\u00a0<interestedOne>\u00a0has quit  \n05:59\u00a0<Denis>\u00a0has quit  \n05:59\u00a0<Denis1>\u00a0has joined #xwiki  \n07:27\u00a0<vmassol>\u00a0has joined #xwiki  \n07:38\u00a0<vmassol1>\u00a0has joined #xwiki  \n07:39\u00a0<vmassol>\u00a0has quit  \n07:45\u00a0<SvenDowideit>\u00a0has quit  \n07:50\u00a0<SvenDowideit>\u00a0has joined #xwiki  \n08:06\u00a0<vmassol1>\u00a0this looks like a blocker for the 3.5 release  \n08:06\u00a0<vmassol1>\u00a0http://jira.xwiki.org/browse/XE-1113  \n08:17\u00a0<tmortagne>\u00a0has joined #xwiki  \n08:32\u00a0<CIA-120>\u00a0tmortagne\u000f master\u000f \\* r8bf7bcf\u000f https://github.com/xwiki/xwiki-platform/commit/8bf7bcf5c612b86e817b1fd18195642294ced2e9 \u000f/ xwiki-platform-core/xwiki-platform-extension/xwiki-platform-extension-api/src/test/java/org/xwiki/extension/repository/DefaultCoreExtensionRepositoryTest.java :\u000f XWIKI-7502: Replace notion of Container's ApplicationContext with the ...  \n08:38\u00a0<CIA-120>\u00a0tmortagne\u000f master\u000f \\* rfc538a2\u000f https://github.com/xwiki/xwiki-platform/commit/fc538a2158f7351bea0a1d706740e8e38e9166e0 \u000f/ xwiki-platform-core/xwiki-platform-extension/xwiki-platform-extension-api/src/test/java/org/xwiki/extension/test/RepositoryUtil.java :\u000f XWIKI-7503: Default repositories should be provided by the corresponding ...  \n08:49\u00a0<vmassol1>\u00a0sdumitriu: are you fixing the XE build? I hope you can get it fixed before you got to sleep :)  \n08:49\u00a0<sdumitriu>\u00a0Yes  \n08:49\u00a0<sdumitriu>\u00a0Pushing in a few seconds  \n08:50\u00a0<sdumitriu>\u00a0(checkstyle problems)  \n08:50\u00a0<vmassol1>\u00a0cool  \n08:51\u00a0<vmassol1>\u00a0reverting the spam  \n08:57\u00a0<CIA-120>\u00a0Sergiu Dumitriu\u000f master\u000f \\* rc78c5e7\u000f https://github.com/xwiki/xwiki-platform/commit/c78c5e76385a1c329ff1b1503bc8f7a8c554928b \u000f/ xwiki-platform-core/xwiki-platform-activitystream/src/main/java/com/xpn/xwiki/plugin/activitystream/migration/hibernate/R35000XWIKI6691DataMigration.java :\u000f XWIKI-6691: Change the mapping of the event requestId field to varchar(48) ...  \n08:57\u00a0<sdumitriu>\u00a0Landed  \n08:58\u00a0<vmassol1>\u00a0sdumitriu: so reading your commit I'll still get errros in the console?  \n08:58\u00a0<vmassol1>\u00a0+\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0R35000XWIKI6691DataMigration.logger.warn(  \n08:58\u00a0<vmassol1>\u00a0\u00a0  \n08:58\u00a0<vmassol1>\u00a0108  \n08:58\u00a0<vmassol1>\u00a0+\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Failed\u00a0to\u00a0apply\u00a0R35000XWIKI6691\u00a0Data\u00a0Migration\u00a0:\u00a0{}\",\u00a0ex.getMessage());  \n08:58\u00a0<sdumitriu>\u00a0No, just a warning  \n08:58\u00a0<vmassol1>\u00a0yes that's what I mean  \n08:58\u00a0<vmassol1>\u00a0that's not good  \n08:59\u00a0<vmassol1>\u00a0a warning is something important  \n08:59\u00a0<vmassol1>\u00a0that you need to look at and fix  \n08:59\u00a0<sdumitriu>\u00a0OK, there's only one solution to that  \n08:59\u00a0<sdumitriu>\u00a0Move the migrator in oldcore  \n08:59\u00a0<sdumitriu>\u00a0(or just ignore the error completely)  \n08:59\u00a0<vmassol1>\u00a0that'll fix the issue?  \n08:59\u00a0<vmassol1>\u00a0(the move)  \n08:59\u00a0<vmassol1>\u00a0I don't understand  \n08:59\u00a0<vmassol1>\u00a0what's the problem?  \n09:00\u00a0<vmassol1>\u00a0\"//\u00a0Ignore,\u00a0probably\u00a0the\u00a0database\u00a0doesn't\u00a0need\u00a0this\u00a0migration.\"  \n09:00\u00a0<vmassol1>\u00a0that comment doesn't look like it's a module issue  \n09:00\u00a0<sdumitriu>\u00a0The problem is that the packager plugin uses only oldcore, so the resulting hsqldb database will have a version that reflects only the migrators found in the oldcore jar  \n09:01\u00a0<sdumitriu>\u00a0So when a real XE will start on top of this database, it would seem that this migrator should be applied  \n09:01\u00a0<vmassol1>\u00a0ok I understand  \n09:02\u00a0<vmassol1>\u00a0let's think  \n09:02\u00a0<sdumitriu>\u00a0If we move the migrator to the oldcore jar, its version will be included in the database  \n09:02\u00a0<sdumitriu>\u00a0That is where I placed it initially  \n09:02\u00a0<sdumitriu>\u00a0But since this is strictly related to the activitystream, it should be packaged with the AS plugin  \n09:02\u00a0<vmassol1>\u00a0but  \n09:02\u00a0<vmassol1>\u00a0packager will result in a db version < 35000  \n09:02\u00a0<vmassol1>\u00a0right?  \n09:03\u00a0<vmassol1>\u00a0since it will not execute the migrator  \n09:03\u00a0<sdumitriu>\u00a0Yes  \n09:03\u00a0<vmassol1>\u00a0so when you execute XE it'll run the migrator  \n09:03\u00a0<vmassol1>\u00a0so that migrator will be executed only once  \n09:03\u00a0<vmassol1>\u00a0oh  \n09:03\u00a0<vmassol1>\u00a0ok it doesn't need to be applied  \n09:03\u00a0<vmassol1>\u00a0since it has the correct shcema already  \n09:03\u00a0<vmassol1>\u00a0got it  \n09:04\u00a0<vmassol1>\u00a0the packager forces the version of the DB?  \n09:04\u00a0<vmassol1>\u00a0(I don't recall)  \n09:04\u00a0<+tmortagne>\u00a0it does not force it, any access to the DB set the version when the DB schema is created or updated  \n09:05\u00a0<vmassol1>\u00a0tmortagne: where is that code already?  \n09:05\u00a0<Denis1>\u00a0sdumitriu: why did you keep the version to 35000 ?  \n09:05\u00a0<+tmortagne>\u00a0vmassol1: the store don't know where exactly  \n09:05\u00a0<sdumitriu>\u00a0Denis1: Why not?  \n09:05\u00a0<vmassol1>\u00a0so it means this code doesn't see the new migrator and hence sets the DB version to the wrong version  \n09:06\u00a0<+tmortagne>\u00a0vmassol1: the migrator does not exist for this code  \n09:06\u00a0<vmassol1>\u00a0so we need to devise a way to either distribute the migrators or package them all in one place  \n09:06\u00a0<Denis1>\u00a0sdumitriu: it cause the DBversion to be 35001, is that what you want ?  \n09:07\u00a0<vmassol1>\u00a0sdumitriu: FTM I'm +1 to move the migrator to oldcore since it doesn't have any strong dep on AS (in term of maven dep) and we can brainstorm about how to distribute migrators  \n09:07\u00a0<+tmortagne>\u00a0vmassol1: either they are all in one place or we have to make AS have its own version in the DB  \n09:07\u00a0<Denis1>\u00a0is now known as <Denis>  \n09:08\u00a0<+Denis>\u00a0vmassol1: the schema is in oldcore ?  \n09:08\u00a0<vmassol1>\u00a0AS schema, no  \n09:08\u00a0<+tmortagne>\u00a0then it's probably not going to work  \n09:08\u00a0<+Denis>\u00a0so there is obviously a deps to AS  \n09:08\u00a0<+tmortagne>\u00a0unless the migrator support it  \n09:09\u00a0<vmassol1>\u00a0there's a dep of course  \n09:09\u00a0<vmassol1>\u00a0it's related to AS  \n09:09\u00a0<vmassol1>\u00a0I was tlaking about maven dep  \n09:09\u00a0<+tmortagne>\u00a0and even if it support it the issue will be the same  \n09:09\u00a0<+Denis>\u00a0but what is exactly your issue, could you clarify ?  \n09:09\u00a0<vmassol1>\u00a0Denis: when you build a fresh XE it doesn't have the correct DB version  \n09:10\u00a0<vmassol1>\u00a0even though it has the correct shcema  \n09:10\u00a0<+tmortagne>\u00a0it has the correct version, just not for AS part  \n09:10\u00a0<+Denis>\u00a0what you means by build a fresh XE ?  \n09:10\u00a0<vmassol1>\u00a0from build  \n09:10\u00a0<vmassol1>\u00a0build from source  \n09:10\u00a0<vmassol1>\u00a0from master  \n09:10\u00a0<sdumitriu>\u00a0Denis: I don't understand your question, I used 35000 according to the vote you sent a while ago  \n09:10\u00a0<sdumitriu>\u00a0http://markmail.org/message/f4htfi3fuciykeef  \n09:11\u00a0<vmassol1>\u00a0Denis: git clone xwiki-enterprise; mvn clean install  \n09:11\u00a0<+Denis>\u00a0you should use 34999 for your migrator, the version in it is the latest version on which it should be applied, and it will move the DB to version 35000  \n09:11\u00a0<vmassol1>\u00a0so when you run XE the frist time it'll try to run the migrator even though it shouldn't  \n09:11\u00a0<vmassol1>\u00a0and it'll fail  \n09:11\u00a0<+tmortagne>\u00a0coul'nt we simply ass AS as the plugin dependency ?  \n09:11\u00a0<+tmortagne>\u00a0pretty sure you can do that in maven  \n09:11\u00a0<vmassol1>\u00a0BTW sdumitriu you could check if the migrator needs to run too  \n09:12\u00a0<+tmortagne>\u00a0s/ass/add/  \n09:12\u00a0<+tmortagne>\u00a0that way it should be ok  \n09:12\u00a0<vmassol1>\u00a0but that won't solve the issue of the wrong DB version which isn't correct  \n09:12\u00a0<+Denis>\u00a0I still do not get the issue  \n09:12\u00a0<vmassol1>\u00a0tmortagne: \u00a0in packager?  \n09:12\u00a0<sdumitriu>\u00a0vmassol1: There's another possibility, add a dependency on activitystream in the enterprise-database pom  \n09:12\u00a0<+tmortagne>\u00a0vmassol1: sure it will since the migrator will be found  \n09:12\u00a0<+tmortagne>\u00a0vmassol1: no  \n09:12\u00a0<+tmortagne>\u00a0not in packager  \n09:12\u00a0<+tmortagne>\u00a0in the XE pom where the packager is called  \n09:12\u00a0<+Denis>\u00a0the DB version is in the database, do we generate a database somewhere ?  \n09:12\u00a0<+tmortagne>\u00a0you can provide dependency to a plugin you execute  \n09:13\u00a0<vmassol1>\u00a0yes that looks ok  \n09:13\u00a0<vmassol1>\u00a0for now  \n09:13\u00a0<sdumitriu>\u00a0vmassol1: No idea how to check if it should run, the only real test is to check if the old column exists  \n09:13\u00a0<vmassol1>\u00a0sdumitriu: \u00a0you can check if the new column exist  \n09:13\u00a0<sdumitriu>\u00a0But there's no cross-RDBMS way to get that  \n09:13\u00a0<vmassol1>\u00a0(or if the old one exists)  \n09:13\u00a0<sdumitriu>\u00a0The new one will always exist  \n09:14\u00a0<vmassol1>\u00a0there's no standard SQL for that?  \n09:14\u00a0<vmassol1>\u00a0SQL92  \n09:14\u00a0<vmassol1>\u00a0?  \n09:14\u00a0<+Denis>\u00a0you can do it by tial and error, this is what I do for the dbverison itself  \n09:14\u00a0<sdumitriu>\u00a0Nope  \n09:14\u00a0<vmassol1>\u00a0sdumitriu: can try to add the dep in the database module?  \n09:14\u00a0<vmassol1>\u00a0see if it works fine  \n09:15\u00a0<vmassol1>\u00a0that looks like the best solution for now  \n09:15\u00a0<sdumitriu>\u00a0Will check  \n09:18\u00a0<+tmortagne>\u00a0btw it's not just a version issue if the the hbm is not in olcore it also mean the DB does not contains the AS schema  \n09:19\u00a0<+tmortagne>\u00a0so even for that it should be fixed  \n09:20\u00a0<sdumitriu>\u00a0Works  \n09:21\u00a0<+tmortagne>\u00a0sdumitriu: does the hibernate conf used for the packager has AS hbm ?  \n09:21\u00a0<vmassol1>\u00a0tmortagne: it doesn't need to perform any mirgation of the schema  \n09:21\u00a0<vmassol1>\u00a0since it's the correct schema on master  \n09:21\u00a0<vmassol1>\u00a0sdumitriu: can I change your log to this:  \n09:21\u00a0<vmassol1>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0R35000XWIKI6691DataMigration.logger.warn(  \n09:21\u00a0<vmassol1>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Failed to apply the R35000XWIKI6691 Data migrator. Reason: [{}]. It's likely that the database \"  \n09:21\u00a0<vmassol1>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0+ \"schema is already up to date and you can safely ignore this warning.\", ex.getMessage());  \n09:21\u00a0<vmassol1>\u00a0?  \n09:21\u00a0<+tmortagne>\u00a0vmassol1: i'm talking about creation  \n09:22\u00a0<+tmortagne>\u00a0which is what the packager is doing  \n09:22\u00a0<+tmortagne>\u00a0if it does not jave the hbm it's not going to create the AS schema at all  \n09:22\u00a0<+tmortagne>\u00a0ha  \n09:22\u00a0<+tmortagne>\u00a0have  \n09:22\u00a0<+Denis>\u00a0for me there is an easier way to go if AS is considered optionnal. Create a dummy migration in oldcore with a latter version than AS  \n09:23\u00a0<+tmortagne>\u00a0Denis: I prefer having the proper DB built for XE since we are in XE build  \n09:23\u00a0<+Denis>\u00a0but it means, that AS should be active on a migrated DB, as, the migration will never occur of course  \n09:23\u00a0<sdumitriu>\u00a0vmassol1: Hold on  \n09:23\u00a0<+tmortagne>\u00a0Denis: that's what we are doing  \n09:23\u00a0<+tmortagne>\u00a0just need to set the AS module as dependency  \n09:23\u00a0<+tmortagne>\u00a0and the migration will be found  \n09:23\u00a0<vmassol1>\u00a0sdumitriu: we still need to keep this warning since all our migrators need to be safe in case they're executed more than once  \n09:24\u00a0<+Denis>\u00a0this means it is not optionnal than  \n09:24\u00a0<sdumitriu>\u00a0If we include this migrator in the xe-database generation, the comment won't be valid, would it?  \n09:24\u00a0<vmassol1>\u00a0it still will  \n09:24\u00a0<vmassol1>\u00a0\"sdumitriu: we still need to keep this warning since all our migrators need to be safe in case they're executed more than once\"  \n09:24\u00a0<+Denis>\u00a0sdumitriu, you could avoid the warning by checking the situation first  \n09:25\u00a0<vmassol1>\u00a0even though it would be better to check of course and not have a warning at all  \n09:26\u00a0<+Denis>\u00a0you need a deps on logmanager to hide logs, do a select on the old column that would fails, catch it, and know the situation  \n09:27\u00a0<sdumitriu>\u00a0Denis: This is getting too complex  \n09:27\u00a0<+Denis>\u00a0this is very easy  \n09:27\u00a0<vmassol1>\u00a0it's not that hard sdumitriu and everything we do to make it simpler to user is good  \n09:27\u00a0<+Denis>\u00a0btw, why not using HQL ?  \n09:27\u00a0<vmassol1>\u00a0I remember when we wrote bad migratores in the past  \n09:27\u00a0<+Denis>\u00a0this would be safer  \n09:27\u00a0<vmassol1>\u00a0it caused us lots of problem  \n09:28\u00a0<vmassol1>\u00a0can you write HQL to check column?  \n09:28\u00a0<+Denis>\u00a0no, but the migration itself is not HQL, why ?  \n09:28\u00a0<vmassol1>\u00a0no idea about that...  \n09:29\u00a0<vmassol1>\u00a0maybe you cannot alter a table in HQL  \n09:29\u00a0<sdumitriu>\u00a0Because there's no way of getting a column  \n09:29\u00a0<sdumitriu>\u00a0A column that's not mapped to a property  \n09:29\u00a0<sdumitriu>\u00a0What happened is that I changed the name of the column that is mapped to a property  \n09:29\u00a0<sdumitriu>\u00a0Since Hibernate can't change the column type  \n09:29\u00a0<+Denis>\u00a0I have all you need  \n09:30\u00a0<+Denis>\u00a0using liquibase  \n09:30\u00a0<+Denis>\u00a0and ready  \n09:30\u00a0<+Denis>\u00a0this poor I was not aware before  \n09:30\u00a0<+Denis>\u00a0the problem, I would have taken more care to split my commits  \n09:32\u00a0<+Denis>\u00a0this would be all solved very simply with liquibase  \n09:32\u00a0<+Denis>\u00a0but it is probably too late for the release :(  \n09:33\u00a0<vmassol1>\u00a0probably yes  \n09:33\u00a0<vmassol1>\u00a0it's ok, we've lived with this for a long time now, we can wait a few more days/week :)  \n09:34\u00a0<+Denis>\u00a0the commit include id migration, but I could have split it if I was aware  \n09:36\u00a0<vmassol1>\u00a0Denis: did you check the community activity for liquibase?  \n09:37\u00a0<vmassol1>\u00a0looks acceptable: https://github.com/liquibase/liquibase/network/members  \n09:37\u00a0<vmassol1>\u00a0https://github.com/liquibase/liquibase/commits/master (latest is nov 2011 but that's ok)  \n09:38\u00a0<+Denis>\u00a0yes, and the code is clean  \n09:38\u00a0<vmassol1>\u00a0btw I need to reply to that liquibase mail, I don't think I did  \n09:38\u00a0<vmassol1>\u00a0sdumitriu: you're pushing?  \n09:39\u00a0<+Denis>\u00a0vmassol1: hope you will be positive since I have much code since than  \n09:39\u00a0<+tmortagne>\u00a0sdumitriu: don't forget to remove the  \n09:39\u00a0<+tmortagne>\u00a0\u00a0\u00a0\u00a0\u00a0<!-- Disable plugins mappings -->  \n09:39\u00a0<+tmortagne>\u00a0\u00a0\u00a0\u00a0\u00a0<xwiki.db.common.extraMappings />  \n09:39\u00a0<+tmortagne>\u00a0in xwiki-enterprise-database pom  \n09:39\u00a0<vmassol1>\u00a0I'm +1 in general Denis  \n09:40\u00a0<+Denis>\u00a0note that I have incorporated liquibase with our migration support  \n09:40\u00a0<CIA-120>\u00a0Sergiu Dumitriu\u000f master\u000f \\* rc74ea07\u000f https://github.com/xwiki/xwiki-enterprise/commit/c74ea07fec7414b79a5b78bde4c70410d451e086 \u000f/ xwiki-enterprise-database/pom.xml :\u000f [misc] Add dependency on the ActivityStream plugin when building the database - http://git.io/tI1Drg  \n09:40\u00a0<+Denis>\u00a0vmassol1: migration have now a method to fill up there own liquibase task, which are executed during schema updates  \n09:41\u00a0<+Denis>\u00a0now will be 4.x  \n09:41\u00a0<sdumitriu>\u00a0vmassol1: Indeed  \n09:42\u00a0<vmassol1>\u00a0you mean tmortagne?  \n09:42\u00a0<+Denis>\u00a0vmassol1: so, you may use liquibase two ways, one with its own way, and one inside our migration process  \n09:49\u00a0<fmancinelli>\u00a0has joined #xwiki  \n09:58\u00a0<CIA-120>\u00a0Sergiu Dumitriu\u000f master\u000f \\* ra1d27d1\u000f https://github.com/xwiki/xwiki-enterprise/commit/a1d27d1103f9a1cd4cc372b5dce97b4c8a5a2a9b \u000f/ xwiki-enterprise-database/pom.xml :\u000f [misc] Removed unneeded override - http://git.io/lzyppQ  \n09:58\u00a0<CIA-120>\u00a0Vincent Massol\u000f master\u000f \\* r6863963\u000f https://github.com/xwiki/xwiki-platform/commit/6863963b2af15f0743754533b50bfe549f3bb4d5 \u000f/ xwiki-platform-core/xwiki-platform-activitystream/src/main/java/com/xpn/xwiki/plugin/activitystream/migration/hibernate/R35000XWIKI6691DataMigration.java :\u000f XWIKI-6691: Change the mapping of the event requestId field to varchar(48) ...  \n10:02\u00a0<gdelhumeau>\u00a0has joined #xwiki  \n10:05\u00a0<jvdrean>\u00a0has joined #xwiki  \n10:06\u00a0<+Denis>\u00a0sdumitriu: I have read back the thread about version, it talks about database version, not the way to write migration  \n10:07\u00a0<+Denis>\u00a0there 2 mistake in my mail however, database current version was 15429, and the proposal A) would do 15430  \n10:08\u00a0<+Denis>\u00a0but, to get database version 35000 for release 3.5, you need a migrator that is 34999  \n10:08\u00a0<+Denis>\u00a0like the migrator 15428 produce a db with version 15429  \n10:16\u00a0<sdumitriu>\u00a0Hm...  \n10:16\u00a0<sdumitriu>\u00a0Still, I'd leave it like this  \n10:16\u00a0<sdumitriu>\u00a0For me it makes more sense to have a migrator introduced in 3.5 to have a 35xxx version  \n10:16\u00a0<sdumitriu>\u00a034999 looks odd  \n10:24\u00a0<+Denis>\u00a0vmassol1: WDYT ?  \n10:24\u00a0<+Denis>\u00a0tmortagne ?  \n10:27\u00a0<+tmortagne>\u00a0Denis: on migrator versions ?  \n10:27\u00a0<+Denis>\u00a0yes  \n10:28\u00a0<+Denis>\u00a0on migrator, name, version and resulting dbversion  \n10:28\u00a0<+tmortagne>\u00a0don't have strong opinion, why is the last version is incremented from the last migrator version ?  \n10:28\u00a0<+tmortagne>\u00a0maybe it should not  \n10:28\u00a0<+Denis>\u00a0it has alway been  \n10:28\u00a0<+tmortagne>\u00a0we could change that ?  \n10:30\u00a0<+Denis>\u00a0mmm, probably, it will change the dbversion, but since migrator are far from each other, it should not hurt, as far as I can imagine  \n10:39\u00a0<vmassol1>\u00a0otp  \n10:40\u00a0<vmassol1>\u00a0I kind of agree with sdumitriu. Just not sure if we vote the version scheme  \n10:40\u00a0<vmassol1>\u00a0\\*voted  \n10:40\u00a0<vmassol1>\u00a0(voted or agreed)  \n10:42\u00a0<+tmortagne>\u00a0we accept everything as attachment name no, right ?  \n10:42\u00a0<+tmortagne>\u00a0just seen that REST service still clean the attachment name  \n10:42\u00a0<+tmortagne>\u00a0s/no/now/  \n10:43\u00a0<+tmortagne>\u00a0probably the same for xmlrpc  \n10:43\u00a0<+tmortagne>\u00a0sdumitriu ?  \n10:44\u00a0<sdumitriu>\u00a0Yes, anything should be alowed  \n10:44\u00a0<+tmortagne>\u00a0actually there is still lots of attachment name clearing  \n10:44\u00a0<+Denis>\u00a0vmassol1: it have been voted, but only the db version, not how migrator are named  \n10:45\u00a0<+tmortagne>\u00a0found one in XWikiDocument#addAttachment  \n10:45\u00a0<+tmortagne>\u00a0sdumitriu: is thatexpected ?  \n10:45\u00a0<+Denis>\u00a0this is unchanged since the initial implementation  \n10:46\u00a0<sdumitriu>\u00a0tmortagne: Nope  \n10:47\u00a0<+tmortagne>\u00a0sdumitriu: should I remove it with the REST one ?  \n10:47\u00a0<sdumitriu>\u00a0Yes  \n10:48\u00a0<+tmortagne>\u00a0ok  \n10:48\u00a0<sburjan>\u00a0has joined #xwiki  \n10:52\u00a0<CIA-120>\u00a0tmortagne\u000f master\u000f \\* r50b251f\u000f https://github.com/xwiki/xwiki-platform/commit/50b251f62a2d18a84cc544243b8a284ea18a62b7 \u000f/ (3 files in 2 dirs):\u000f XWIKI-7506: Some code is still cleaning the attachment name - http://git.io/GPg3uQ  \n11:41\u00a0<madeye>\u00a0has joined #xwiki  \n11:46\u00a0<+sburjan>\u00a0hello everybody.  \n11:46\u00a0<+sburjan>\u00a0tmortagne: wew you able to dig ddeper in the ui-tests issue about \"leave/stay on page\" ?  \n11:47\u00a0<+sburjan>\u00a0because It seems you are right, running them individually works (at least for me)  \n11:47\u00a0<sdumitriu>\u00a0Huh, I introduced that  \n11:48\u00a0<sdumitriu>\u00a0Didn't check ui-tests to see if they fail  \n11:51\u00a0<+sburjan>\u00a0sdumitriu: wdym introduced it ? it's a FF window.. when you move back and forth and have forms in the page  \n11:52\u00a0<fmancinelli>\u00a0has quit  \n11:52\u00a0<sdumitriu>\u00a0sburjan: http://jira.xwiki.org/browse/XWIKI-6927  \n11:52\u00a0<+tmortagne>\u00a0sburjan: nop since I could not reproduce it was hard to debug and then I had to do something else  \n11:53\u00a0<+tmortagne>\u00a0can tell you that XWIKI-6927 does not work, except during tests actually  \n11:53\u00a0<+tmortagne>\u00a0(which produce a mess during tests)  \n11:53\u00a0<sdumitriu>\u00a0WDYM \"does not work\"?  \n11:54\u00a0<+tmortagne>\u00a0but I tryed to leave the page by closing it or by going somewhere else and never got any message  \n11:54\u00a0<+tmortagne>\u00a0same for sburjan it seems  \n11:54\u00a0<vmassol1>\u00a0sdumitriu: it's been failing for close to 2 weeks\u2026 we talked about it several times on IRC and we thought it was Marius who did something. Would be great if you could fix it quickly for the next 3.5 release  \n11:55\u00a0<sdumitriu>\u00a0Yep  \n11:55\u00a0<vmassol1>\u00a0reminder to self: send proposal to devs list for the next 3.5 release  \n11:57\u00a0<+sburjan>\u00a0If I manage to have the sme number of failures on windows as we have on jenkins, it is a good start on making ui-tests work with other browsers.. this is why I am eager to have ui-tests fixed  \n12:04\u00a0<+sburjan>\u00a0ok, I have found a test that fails because of this even if it is ran alone  \n12:05\u00a0<+sburjan>\u00a0I can see the test clicking on a checkbox and being unable to check it because of the Ff modal  \n12:05\u00a0<+sburjan>\u00a0testRegisterPasswordTooShort in RegiesterTest.java  \n12:10\u00a0<sdumitriu>\u00a0has left #xwiki  \n12:11\u00a0<+tmortagne>\u00a0I can now reproduce XWIKI-6927 with the very last version on maven.xwiki.org  \n12:11\u00a0<+tmortagne>\u00a0sburjan  \n12:12\u00a0<+sburjan>\u00a0using the test I mentioned above ?  \n12:12\u00a0<+tmortagne>\u00a0problem is that we probably have lots of tests to modify  \n12:12\u00a0<+tmortagne>\u00a0sburjan: not during tests  \n12:12\u00a0<+tmortagne>\u00a0in a normal XE  \n12:12\u00a0<+tmortagne>\u00a0I could not previously  \n12:12\u00a0<+tmortagne>\u00a0I did not had the popup  \n12:12\u00a0<+sburjan>\u00a0I see  \n12:12\u00a0<+tmortagne>\u00a0only during test  \n12:12\u00a0<+sburjan>\u00a0It is very hard to track down the ones that need to be modified ...  \n12:13\u00a0<+sburjan>\u00a0I mean the tests which fail because of this  \n12:13\u00a0<+tmortagne>\u00a0the first one failing i think  \n12:13\u00a0<+tmortagne>\u00a0problem is that the first test add a popup and make everything after it fail  \n12:14\u00a0<+sburjan>\u00a0exactly  \n12:14\u00a0<+tmortagne>\u00a0and add more popu  \n12:14\u00a0<+sburjan>\u00a0exactly  \n12:14\u00a0<+tmortagne>\u00a0not very fun when you get tons of popups to close  \n12:14\u00a0<+sburjan>\u00a0so it is very hard to see which test is failing because of its own popup or the popup from the previous test  \n12:14\u00a0<+sburjan>\u00a0I know .. :|  \n12:15\u00a0<+tmortagne>\u00a0so we need to test the first test alone, fix it, restart the wholee thing, etc...  \n12:15\u00a0<+sburjan>\u00a0ouch  \n12:15\u00a0<+tmortagne>\u00a0yea  \n12:15\u00a0<+tmortagne>\u00a0going to be fun  \n12:15\u00a0<+tmortagne>\u00a0hope there is not too much tests  \n12:16\u00a0<+tmortagne>\u00a0also tthis mean the test is probably doing something wrong anyway  \n12:16\u00a0<+tmortagne>\u00a0since there is no reason a test open edit and don't save, or at least just one to see what happen when editing without saving  \n12:22\u00a0<+sburjan>\u00a0from what I have investigated it should be less than 43 tests .. but I can't say the \\_exact\\_ number  \n12:23\u00a0<+sburjan>\u00a0because it seems that it is important for the test on what you click .. either the Leave page or stay on page .. could make a test fail or pass  \n12:24\u00a0<+sburjan>\u00a0but I ran all ui-tests and clicked on leave page/stay on page as soon as the modal appeared so I wouldn't block the next test  \n12:25\u00a0<+sburjan>\u00a0if you provide me for a fix for the first test that fails, I might help by identifying the test that need the fix  \n12:26\u00a0<+sburjan>\u00a0\\*tests  \n14:06\u00a0<+tmortagne>\u00a0sburjan: basically we need to find why the test is leaving the edit mode without canceling or saving and fix that  \n14:07\u00a0<+tmortagne>\u00a0or cleking on the popup is that's really what the test want but I doubt that  \n14:14\u00a0<+sburjan>\u00a0tmortagne: my guess is that in order to save speed we use the framework method to jump directly to another URL  \n14:15\u00a0<+sburjan>\u00a0this is why we don't save  \n14:16\u00a0<+sburjan>\u00a0we use shortcuts  \n14:31\u00a0<+tmortagne>\u00a0sburjan: what I don't see is why we go to edit mode if we don't want to edit  \n14:31\u00a0<+sburjan>\u00a0me neither. do you have a specific test that is doing that ?  \n14:32\u00a0<+tmortagne>\u00a0sburjan: yes the one making this popup appear :)  \n14:32\u00a0<+tmortagne>\u00a0that's how you get this  \n14:32\u00a0<+tmortagne>\u00a0you go to edit and you don't save or cancel  \n14:33\u00a0<vmassol1>\u00a0back, sent mail about new dates for 3.5  \n14:34\u00a0<+tmortagne>\u00a0but i don't know what test is doing that since as I said this does not seems right to me  \n14:37\u00a0<+Denis>\u00a0vmassol1: are you ok with XWIKI-7512 , I am about to commit it ?  \n14:38\u00a0<vmassol1>\u00a0yes looks good  \n14:38\u00a0<vmassol1>\u00a0(Denis)  \n14:40\u00a0<vmassol1>\u00a0just realizing there's no container module on e.x.o\u2026. going to fix that  \n14:40\u00a0<vmassol1>\u00a0(and add the environment module too)  \n14:40\u00a0<+Denis>\u00a0vmassol1: I also have XWIKI-7507 ready, do we try to better fix the 35000 migration, or not ?  \n14:41\u00a0<vmassol1>\u00a0I'd say wait for 4.0 for liquibase  \n14:41\u00a0<+Denis>\u00a0(it is now or never for 35000)  \n14:41\u00a0<vmassol1>\u00a0I'd say never  \n14:42\u00a0<vmassol1>\u00a03.5 is really short and we need it stable, we already have too many dangerous stuff in it IMO  \n14:42\u00a0<+Denis>\u00a0liquibase is not really a dangerous patch IMO  \n14:42\u00a0<AndreiHalici>\u00a0has joined #xwiki  \n14:42\u00a0<+Denis>\u00a0compare to SQL ALTER  \n14:43\u00a0<+Denis>\u00a0but I agree, it need to be tested, are we skipping RC1 ?  \n14:43\u00a0<vmassol1>\u00a0see my mail  \n14:44\u00a0<vmassol1>\u00a0actually you're right :)  \n14:45\u00a0<vmassol1>\u00a0we could skip RC1 instead of skipping M1  \n14:45\u00a0<vmassol1>\u00a0ddidn't even think about that ;)  \n14:45\u00a0<+Denis>\u00a0anyway, if this is not the final release, I consider that there is room for liquibase  \n14:46\u00a0<+Denis>\u00a0at worse, it could be reversed, no ?  \n14:46\u00a0<vmassol1>\u00a0no  \n14:46\u00a0<vmassol1>\u00a0I'm really against  \n14:46\u00a0<vmassol1>\u00a0it's way too dangerous at this point  \n14:46\u00a0<+Denis>\u00a0what do you found dangerous ?  \n14:47\u00a0<vmassol1>\u00a0unknown framework, unkonwn code, no time to test, very late in the release  \n14:47\u00a0<+Denis>\u00a0why no time test, why doing M1 than ?  \n14:47\u00a0<vmassol1>\u00a0master is going to be 4.0M1 in 2 days, it's just not worth it  \n14:48\u00a0<vmassol1>\u00a0(the risk)  \n14:48\u00a0<+Denis>\u00a0for me the risk is not to test migration 35000  \n14:48\u00a0<vmassol1>\u00a0it's not M1  \n14:48\u00a0<vmassol1>\u00a0it's RC2  \n14:48\u00a0<vmassol1>\u00a0RC1  \n14:48\u00a0<rmannibucau>\u00a0has joined #xwiki  \n14:48\u00a0<rmannibucau>\u00a0hi  \n14:48\u00a0<rmannibucau>\u00a0any offline editor for xwiki?  \n14:48\u00a0<vmassol1>\u00a0we've already spent several days testing the 3500 migrations  \n14:48\u00a0<rmannibucau>\u00a0i saw xeclipse but it seems outdated  \n14:48\u00a0<vmassol1>\u00a0and you see the result  \n14:48\u00a0<vmassol1>\u00a0and that's only 10 lines of code  \n14:49\u00a0<vmassol1>\u00a0rmannibucau: correct  \n14:49\u00a0<+Denis>\u00a0have it been tested on all supported DB ?  \n14:49\u00a0<rmannibucau>\u00a0vmassol1: does it mean it doesn't exist at all?  \n14:49\u00a0<vmassol1>\u00a0I have no clue  \n14:49\u00a0<vmassol1>\u00a0if it were me Denis I'd simply revert sergiu's commit  \n14:49\u00a0<rsjafe>\u00a0has joined #xwiki  \n14:49\u00a0<vmassol1>\u00a0I've found it way too dangerous and not tested  \n14:49\u00a0<+Denis>\u00a0I am +1  \n14:50\u00a0<+Denis>\u00a0this will allow it to be properly integrated with liquibase in 4.x  \n14:50\u00a0<rsjafe>\u00a0Hi there, good afternoon to everyone. I'm using XWiki Enterprise 3.3.1 and I'm trying to configure the email SMTP client. I didn't succeed in sending emails, I'm behind a firewall and proxy do I need to configure something in the JVM or in XWiki? I followed the instructions in the documentation about SMTP server. In the aditional properties how do I separate several properties? Do I add a...  \n14:50\u00a0<rsjafe>\u00a0...comma, a ';' or just a new line (enter)?  \n14:51\u00a0<+tmortagne>\u00a0rmannibucau: the last release is a bit outdated but there is beta version not yet released youcan find on http://maven.xwiki.org/snapshots/org/xwiki/eclipse/org.xwiki.eclipse.product/2.0.0-SNAPSHOT/  \n14:52\u00a0<vmassol1>\u00a0Denis: if you can convince sergiu that reverting his commit is best, I'm all for it  \n14:52\u00a0<vmassol1>\u00a0tmortagne: what would you think about this?  \n14:52\u00a0<+Denis>\u00a0I do not think we ever agree on this commit, so we could be ?1 on it, WDYT ?  \n14:52\u00a0<vmassol1>\u00a0sure but best is that he agrees :)  \n14:53\u00a0<vmassol1>\u00a0we could ask him first  \n14:53\u00a0<+Denis>\u00a0sure, of course  \n14:53\u00a0<vmassol1>\u00a0before invoke god's power  \n14:53\u00a0<vmassol1>\u00a0invoking  \n14:53\u00a0<vmassol1>\u00a0:)  \n14:53\u00a0<+Denis>\u00a0but I am ?1 since I see it  \n14:53\u00a0<rmannibucau>\u00a0tmortagne: thank you, i'll have a try  \n14:53\u00a0<+Denis>\u00a0just surprise you were not  \n14:53\u00a0<vmassol1>\u00a0well actually I asked sergiu to work on this...  \n14:53\u00a0<+tmortagne>\u00a0vmassol1: this commit seems dangerous and hacky to me, from what Denis explained to me would be nice to rethink it with liquibase  \n14:53\u00a0<vmassol1>\u00a0I didn't say for what version though  \n14:54\u00a0<vmassol1>\u00a0so on one hand I'm happy he fixed it  \n14:54\u00a0<vmassol1>\u00a0OTOH I found that the commit was not tested enough  \n14:54\u00a0<vmassol1>\u00a0and I'm worried  \n14:54\u00a0<+Denis>\u00a0but the way it is implemented is poor, I have worked hard to do far more than this, while avoiding so much direct access to DB  \n14:55\u00a0<vmassol1>\u00a0I understand  \n14:55\u00a0<vmassol1>\u00a0this commit is supposedly important for performance though  \n14:55\u00a0<vmassol1>\u00a0which is why it could be important for the 3.x cycle  \n14:56\u00a0<vmassol1>\u00a0we've regressed on the AS performance  \n14:56\u00a0<vmassol1>\u00a0it's slower than it used to be  \n14:56\u00a0<+Denis>\u00a0could'nt it be ported back from 4.x on a 3.5.1, or this one is never expected to happen ?  \n14:56\u00a0<vmassol1>\u00a0I'm not 100% sure this is the reason  \n14:56\u00a0<vmassol1>\u00a0but it could be  \n14:56\u00a0<vmassol1>\u00a0it could happen  \n14:56\u00a0<vmassol1>\u00a0don't know if we'll port that big an infra change thoug  \n14:56\u00a0<vmassol1>\u00a0though  \n14:57\u00a0<vmassol1>\u00a0it's for us to decide  \n14:57\u00a0<vmassol1>\u00a0it's a possibility  \n14:57\u00a0<+Denis>\u00a0but we could not fix it properly if we leave it in  \n14:58\u00a0<+Denis>\u00a0what would be far less dangerous is simple to change the column type without moving the datas  \n15:01\u00a0<rsjafe>\u00a0Excuse me for interrupting, I see you guys are having an important discussion about a project version. I'll wait until any of you can help me. I'm starting to use Xwiki on my project management.  \n15:01\u00a0<vmassol1>\u00a0rsjafe: cool!  \n15:06\u00a0<rmannibucau>\u00a0tmortagne: XEclipse 2 doesn't manage proxies?  \n15:06\u00a0<+tmortagne>\u00a0rmannibucau: no idea but I would be surprised that this is not managed by Eclipse  \n15:07\u00a0<rmannibucau>\u00a0me too but i ran the standalone version  \n15:07\u00a0<+tmortagne>\u00a0maybe somewhere in Window->preferences  \n15:07\u00a0<+tmortagne>\u00a0it's still Eclipse :)  \n15:07\u00a0<rmannibucau>\u00a0yep, not network config  \n15:08\u00a0<+tmortagne>\u00a0could not tell for sure, never trying it behind a proxy  \n15:08\u00a0<+Denis>\u00a0Github dead ? I am unable to commit, I am leaving 20mins, hope it will be better later...  \n15:09\u00a0<rmannibucau>\u00a0oki  \n15:09\u00a0<+tmortagne>\u00a0you should maybe ask on the mailing list, non of the XEClipse experts are connected right now  \n15:10\u00a0<+tmortagne>\u00a0Denis: seems to work well for me  \n15:10\u00a0<+tmortagne>\u00a0now at least  \n15:10\u00a0<rmannibucau>\u00a0i manage to connect through xmlrpc to our xwiki but some spaces can't be retrieved  \n15:10\u00a0<rmannibucau>\u00a0do you have the mailing list address please?  \n15:11\u00a0<rmannibucau>\u00a0tmortagne: it works with rest :)  \n15:11\u00a0<rmannibucau>\u00a0thank you for all  \n15:12\u00a0<rsjafe>\u00a0I'll just re-type my question, if anyone can help me: I'm using XWiki Enterprise 3.3.1 and I'm trying to configure the email SMTP client. I didn't succeed in sending emails, I'm behind a firewall and proxy do I need to configure something in the JVM or in XWiki?  \n15:12\u00a0<+tmortagne>\u00a0yea you should use REST, XMLRPC is really the old not really maintained way  \n15:13\u00a0<rmannibucau>\u00a0tmortagne: was not sure it was opened internally  \n15:14\u00a0<+tmortagne>\u00a0rmannibucau: \u00a0as for the mailing see http://dev.xwiki.org/xwiki/bin/view/Community/MailingLists  \n15:15\u00a0<rmannibucau>\u00a0thank you :)  \n15:15\u00a0<vmassol1>\u00a0rsjafe: did you check http://platform.xwiki.org/xwiki/bin/view/AdminGuide/Configuration#HConfiguringtheSMTPserver ?  \n15:16\u00a0<rsjafe>\u00a0vmassoll: yes I did try with my gmail account and with the configurations on that page but I get an error saying the mail was not sent  \n15:16\u00a0<vmassol1>\u00a0rsjafe: hmm this doesn't look too good: http://www.oracle.com/technetwork/java/faq-135477.html#proxy  \n15:17\u00a0<rsjafe>\u00a0in the JavaMail Properties what separator do I use in order to type multiple options?  \n15:18\u00a0<vmassol1>\u00a0I don't know, new line?  \n15:18\u00a0<vmassol1>\u00a0would be great to update http://platform.xwiki.org/xwiki/bin/view/AdminGuide/Configuration#HConfiguringtheSMTPserver when you find it :)  \n15:18\u00a0<rsjafe>\u00a0I was just checking to be sure, I tried ',' then ';' and finally just new line  \n15:19\u00a0<rsjafe>\u00a0I'll try at home after work and see if I can do it. Then I can test if it's the proxy or not (at home I don't have a proxy and can disable all firewalls)  \n15:19\u00a0<vmassol1>\u00a0rsjafe: ok great  \n15:27\u00a0<rmannibucau>\u00a0has quit  \n15:35\u00a0<+sburjan>\u00a0is someone working on ui-tests ?  \n15:35\u00a0<+tmortagne>\u00a0sburjan: going to  \n15:35\u00a0<+tmortagne>\u00a0was finishing something  \n15:36\u00a0<+tmortagne>\u00a0sburjan: \u00a0did you find a test producing a popup when executed alone ?  \n15:36\u00a0<+sburjan>\u00a0yes  \n15:37\u00a0<+sburjan>\u00a0I wrote earlier.. let me scroll up  \n15:37\u00a0<+tmortagne>\u00a0ok cool I can start with this one if you want  \n15:37\u00a0<+tmortagne>\u00a0ha yes  \n15:37\u00a0<+tmortagne>\u00a0let me see  \n15:37\u00a0<+tmortagne>\u00a0testRegisterPasswordTooShort  \n15:37\u00a0<+sburjan>\u00a0testRegisterPasswordTooShort in RegiesterTest.java  \n15:37\u00a0<+tmortagne>\u00a0RegiesterTest  \n15:37\u00a0<+sburjan>\u00a0yes  \n15:37\u00a0<+tmortagne>\u00a0lets see  \n15:38\u00a0<+sburjan>\u00a0but we can't control the order they are executed ..... so I don't know if this approach will help...  \n15:38\u00a0<+sburjan>\u00a0but first, please confirm that it fail when running alone  \n15:40\u00a0<+tmortagne>\u00a0what approach ? by goal is to fix the test so that they don't produce popup anymore or that they click on it  \n15:40\u00a0<+tmortagne>\u00a0don't see what this has to do with order  \n15:42\u00a0<+tmortagne>\u00a0I see whay this one is failing  \n15:42\u00a0<+Denis>\u00a0tmortagne: pull rebase I launch before leaving is still running...  \n15:42\u00a0<+sburjan>\u00a0I see it too.. but I am unable to find the code that shouold do the save but doesn;t  \n15:42\u00a0<+tmortagne>\u00a0Denis: \u00a0the website is working well at least  \n15:42\u00a0<+tmortagne>\u00a0sburjan: it's not really a save  \n15:43\u00a0<+Denis>\u00a0seems better now  \n15:43\u00a0<+tmortagne>\u00a0the thing is this code is checking field validation  \n15:43\u00a0<+Denis>\u00a0my previous try 30mins ago has failed  \n15:43\u00a0<+tmortagne>\u00a0during registratop,  \n15:43\u00a0<+tmortagne>\u00a0registration  \n15:43\u00a0<+tmortagne>\u00a0not edit mode but it's triggering the same behavior with popup  \n15:43\u00a0<+Denis>\u00a0got it to work :)  \n15:44\u00a0<CIA-120>\u00a0Denis Gervalle\u000f master\u000f \\* rbd7ca20\u000f https://github.com/xwiki/xwiki-platform/commit/bd7ca2032599107bad20c34dab41c8d89e15e70e \u000f/ (3 files in 3 dirs):\u000f XWIKI-7512: DB version is now equals to the latest data migration version - http://git.io/yqp3CQ  \n15:44\u00a0<+tmortagne>\u00a0probably because it's the same system than edit with buttons on the buttom  \n15:44\u00a0<+tmortagne>\u00a0so it's not just edit but any action with this form+somme button at the end layout  \n15:47\u00a0<+tmortagne>\u00a0sburjan: the best is probably to find a way to make gotoPage automatically avoid the popup some way, maybe a parameter or something  \n15:48\u00a0<+tmortagne>\u00a0not sure how this system is working  \n15:49\u00a0<+sburjan>\u00a0actually from what I can see .. the popup appears \\_before\\_ clicking the enable js validation checkbox  \n15:49\u00a0<vmassol1>\u00a0tmortagne: seems the template on e.x.o has deprecated xproperties  \n15:49\u00a0<vmassol1>\u00a0fixing  \n15:50\u00a0<vmassol1>\u00a0but you may need to fix that in the XR app maybe too  \n15:53\u00a0<+tmortagne>\u00a0vmassol1: XR does not have deprecated properties, that's because I modify the class on e.x.o instead of importing to be safe  \n15:53\u00a0<vmassol1>\u00a0ok  \n15:55\u00a0<AndreiHalici\\_>\u00a0has joined #xwiki  \n15:56\u00a0<AndreiHalici\\_>\u00a0has quit  \n15:59\u00a0<AndreiHalici>\u00a0has quit  \n16:01\u00a0<+tmortagne>\u00a0sburjan: this test does not click on anything as far as I can see, it fill a password field and look if it's validated  \n16:02\u00a0<+sburjan>\u00a0it enables js form validation from admin app. and it seems that it leaves some page in order to get to admin app. this is where the modal appears  \n16:02\u00a0<+tmortagne>\u00a0that's not the test, that's the setup so it's any test in this class  \n16:03\u00a0<+sburjan>\u00a0I am unable to attach my sources to the PO classes from platform in my eclipse  \n16:03\u00a0<+tmortagne>\u00a0this class is in platform-test module  \n16:04\u00a0<+sburjan>\u00a0yes, but my eclipse doesn't see the src jar because it seems I don't have it in my .m2  \n16:04\u00a0<+tmortagne>\u00a0sburjan: of course you don't have it it's SNAPSHOT  \n16:04\u00a0<+tmortagne>\u00a0jenkins does not deply source for SNASPHOT  \n16:05\u00a0<+tmortagne>\u00a0you will have to attach to a folder with the source in the repository  \n16:05\u00a0<+sburjan>\u00a0ok, let me try  \n16:06\u00a0<+sburjan>\u00a0worked, thanks  \n16:06\u00a0<+jvdrean>\u00a0anyone to discuss about https://github.com/xwiki/xwiki-platform/commit/b75ccce0119192ace2cdaff820f4a05ddc7964ae#diff-2 with me ? I'm waiting for sergiu to show up  \n16:07\u00a0<+jvdrean>\u00a0It seems that the list of indexes ( http://platform.xwiki.org/xwiki/bin/view/AdminGuide/Database+Administration ) should be updated but I'd like to verify it first  \n16:08\u00a0<+jvdrean>\u00a0the problem appears only with some of the indexes, for example XDD\\_LANGUAGE, since it has the same name in the mapping file and the script we provide: duplicate error on creation  \n16:09\u00a0<+tmortagne>\u00a0isn't the index script useless now ?  \n16:09\u00a0<+tmortagne>\u00a0indexes are supposed to be created automatically  \n16:11\u00a0<+jvdrean>\u00a0in any case the documentation should be updated  \n16:12\u00a0<+tmortagne>\u00a0if it's saying that the script should be used indeed  \n16:13\u00a0<vmassol1>\u00a0yes the doc needs to be updated  \n16:13\u00a0<vmassol1>\u00a0sergiu seems to forget that sometimes ;)  \n16:13\u00a0<vmassol1>\u00a0jvdrean if you can help to update the doc that would be great!  \n16:15\u00a0<+jvdrean>\u00a0ok, I guess we should remove the Indexes section then  \n16:16\u00a0<vmassol1>\u00a0there are some indexes not set  \n16:16\u00a0<vmassol1>\u00a0for ex sergiu just added one in XE 3.5 that we might revert  \n16:16\u00a0<vmassol1>\u00a0and the feed plugin indexes are not currently created automatically  \n16:17\u00a0<vmassol1>\u00a0we need to remove what we do automatically for sure  \n16:20\u00a0<+jvdrean>\u00a0do we really need a list in addition to the mapping file ?  \n16:21\u00a0<+jvdrean>\u00a0the feed plugin should also come with its mapping  \n16:21\u00a0<+jvdrean>\u00a0and about the indexes that we might add/remove, we do it in the hbm config  \n16:21\u00a0<+jvdrean>\u00a0or am I missing something ?  \n16:24\u00a0<+sburjan>\u00a0tmortagne: so the test I told you about isn't problematic ?  \n16:24\u00a0<+sburjan>\u00a0because I am investigating it  \n16:25\u00a0<+sburjan>\u00a0from what I can see, the fixture causes the test to fail. the setUp() method  \n16:26\u00a0<+tmortagne>\u00a0sburjan: the issue is probably before and triggered when this test is executed because the first thing it's foing is a gotopage  \n16:26\u00a0<+tmortagne>\u00a0s/foing/doing/  \n16:27\u00a0<+sburjan>\u00a0yes. and I don't see any \"clickSave\" in the fixture  \n16:27\u00a0<+sburjan>\u00a0so you check the enable js validation, but no save issues, which triggers the modal  \n16:28\u00a0<+sburjan>\u00a0sectionPage.clickSave(); it's there...  \n16:30\u00a0<+tmortagne>\u00a0no sure the best is to fix each test anyway, trying to think of a way to make gotopage bypass the popup  \n16:31\u00a0<+sburjan>\u00a0+1.. but I don't have any idea how to  \n16:31\u00a0<+tmortagne>\u00a0me neither yet :)  \n16:34\u00a0<+tmortagne>\u00a0maybe I can make gotopage unregister the observer responsible for showing the popup  \n16:35\u00a0<+sburjan>\u00a0I am trying to fix the test I told you about, but no much success. I am struggling to find the line that breaks  \n16:35\u00a0<vmassol1>\u00a0maybe there's a way to confgiure FF  \n16:35\u00a0<vmassol1>\u00a0to not show this popup  \n16:35\u00a0<vmassol1>\u00a0it's a FF popup right?  \n16:35\u00a0<vmassol1>\u00a0(haven't followed your discussion above, just catching up)  \n16:36\u00a0<+tmortagne>\u00a0I think we ask the browser to display it, not sure it's automatically managed by FF  \n16:36\u00a0<+sburjan>\u00a0I couldn't understand much from sergiu's implementation  \n16:37\u00a0<+sburjan>\u00a0because it seems a custom triggered default FF modal  \n16:38\u00a0<vmassol1>\u00a0we could also decide that this feature is configurable  \n16:39\u00a0<+sburjan>\u00a0ok, I found the line that breaks  \n16:39\u00a0<vmassol1>\u00a0this is the commit btw: https://github.com/xwiki/xwiki-platform/commit/3b6f3924da732e8286b209a0ee45c9400bfe0742#diff-1  \n16:40\u00a0<+sburjan>\u00a0but understanding the backend mechanism is beyond my knowledge  \n16:40\u00a0<vmassol1>\u00a0it's front end hehe ;)  \n16:41\u00a0<+tmortagne>\u00a0seems to be a simple observer so I guess we can unregister it some way (don't know well js observe)  \n16:41\u00a0<+sburjan>\u00a0check the public void recacheSecretToken() in TestUtils.java ... that is the one responsable for breaking at least the RegisterTest.java  \n16:41\u00a0<+sburjan>\u00a0and it has some comments about POST in it  \n16:42\u00a0<vmassol1>\u00a0tmortagne: what's wrong with clicking the popup btw?  \n16:42\u00a0<vmassol1>\u00a0since this would be what the user does normally  \n16:42\u00a0<+tmortagne>\u00a0vmassol1: there is not always a popup  \n16:42\u00a0<+tmortagne>\u00a0I want something in gotopage  \n16:43\u00a0<vmassol1>\u00a0hmm ok not for our direct api maybe  \n16:43\u00a0<+tmortagne>\u00a0which is always working and as quick as possible  \n16:44\u00a0<vmassol1>\u00a0I don't like hacks  \n16:44\u00a0<vmassol1>\u00a0maybe we could have a param in the url that prevents this check as a feature  \n16:44\u00a0<vmassol1>\u00a0something like &force=true (with a better name)  \n16:44\u00a0<+sburjan>\u00a0but how would users use that ? or it will only be used for tests ?  \n16:45\u00a0<vmassol1>\u00a0for tests  \n16:45\u00a0<vmassol1>\u00a0and for anyone needing that in js for ex  \n16:45\u00a0<+sburjan>\u00a0so you basically want to introduce a URL platform in XWiki just to make tests don't get the modal ?  \n16:45\u00a0<+tmortagne>\u00a0we are searching something for tests, user are supposed to get the popup  \n16:45\u00a0<+sburjan>\u00a0URL platform param  \n16:45\u00a0<vmassol1>\u00a0sburjan: read my answer fully ;)  \n16:45\u00a0<vmassol1>\u00a0\"and for anyone needing that in js for ex\"  \n16:46\u00a0<+sburjan>\u00a0yes, true  \n16:46\u00a0<vmassol1>\u00a0it's an \"api\"  \n16:46\u00a0<+sburjan>\u00a0maybe a checkbox in admin app ?  \n16:46\u00a0<vmassol1>\u00a0the other option is to have a config param but that's too general since we do want to check that we get that popup in some tests  \n16:46\u00a0<vmassol1>\u00a0nope  \n16:46\u00a0<vmassol1>\u00a0that's too general  \n16:46\u00a0<+sburjan>\u00a0I still don't understand clearly what triggers the modal  \n16:47\u00a0<vmassol1>\u00a0I pasted the linke to the code  \n16:47\u00a0<vmassol1>\u00a0link  \n16:47\u00a0<+sburjan>\u00a0POST, CSRF ?  \n16:47\u00a0<+tmortagne>\u00a0sburjan: 'xwiki:dom:loaded' event  \n16:47\u00a0<vmassol1>\u00a0https://github.com/xwiki/xwiki-platform/commit/3b6f3924da732e8286b209a0ee45c9400bfe0742#diff-1  \n16:47\u00a0<+tmortagne>\u00a0that's en event generated when you leave the page  \n16:47\u00a0<+sburjan>\u00a0too bad I don't undersant js very well  \n16:47\u00a0<+tmortagne>\u00a0when we receive it and it's edit mode we display the popu  \n16:47\u00a0<vmassol1>\u00a0tmortagne: I think it's when you enter ;)  \n16:48\u00a0<vmassol1>\u00a0the key is \"Event.stop(event);\"  \n16:48\u00a0<+tmortagne>\u00a0yes atcually this one \u00a0is to regsiter the other event  \n16:48\u00a0<+tmortagne>\u00a0beforeunload  \n16:49\u00a0<vmassol1>\u00a0yep  \n16:49\u00a0<vmassol1>\u00a0we register on submit  \n16:49\u00a0<+sburjan>\u00a0ok, so on dom:loaded we save the form, and if we change the form and want to leave the page, the actual form is compared with the backup and if they don't match you get the modal ? this is what I understand from the source code  \n16:49\u00a0<+tmortagne>\u00a0sburjan: we don't do anything with the form  \n16:49\u00a0<+tmortagne>\u00a0the browser call use before leaving the page and we get a change to cancel it  \n16:50\u00a0<+tmortagne>\u00a0that's all  \n16:50\u00a0<vmassol1>\u00a0actually it's not quite that  \n16:50\u00a0<vmassol1>\u00a0when the form is saved or cancelled  \n16:50\u00a0<vmassol1>\u00a0\u00a0document.observe('xwiki:actions:save',\u00a0initFormData);  \n16:50\u00a0<vmassol1>\u00a0document.observe('xwiki:actions:cancel',\u00a0initFormData);  \n16:50\u00a0<vmassol1>\u00a0hmm yes you're right tmortagne actually  \n16:50\u00a0<vmassol1>\u00a0misread  \n16:51\u00a0<vmassol1>\u00a0sburjan: it's \u00a0window.onbeforeunload\u00a0=\u00a0function(event)\u00a0{  \n16:51\u00a0<+tmortagne>\u00a0that's to set a status to know we are properly saving or canceling  \n16:51\u00a0<+tmortagne>\u00a0so that we don't display the popup  \n16:51\u00a0<vmassol1>\u00a0right  \n16:52\u00a0<+tmortagne>\u00a0found how to unregister an event but we need to decide what way we want to go  \n16:52\u00a0<+sburjan>\u00a0yes... \u00a0this is what I wrote up .. but the term backup wasn't correct ...  \n16:52\u00a0<vmassol1>\u00a0if\u00a0(originalFormData\u00a0!=\u00a0form.serialize() && <request param not set to some value>) {  \n16:53\u00a0<+sburjan>\u00a0we compare the new state with the previous saved state  \n16:54\u00a0<+sburjan>\u00a0this is good for users, bad for tests  \n16:57\u00a0<vmassol1>\u00a0my preference goes to a request param ATM  \n16:58\u00a0<vmassol1>\u00a0I find that less of a hack than unregistering some observer  \n16:58\u00a0<+tmortagne>\u00a0not sure what's the current URL from observer point of view  \n16:58\u00a0<vmassol1>\u00a0yeah was wondering too  \n16:58\u00a0<+tmortagne>\u00a0or maybe it's some parameter of the event of something  \n16:58\u00a0<+sburjan>\u00a0what if we put a \"clickSave\" in the goToURL method ?  \n16:59\u00a0<+tmortagne>\u00a0sburjan: what would it do ?  \n16:59\u00a0<+sburjan>\u00a0it would save the form before jumping to another page  \n16:59\u00a0<+tmortagne>\u00a0or you mean a js to execute save ?  \n16:59\u00a0<+tmortagne>\u00a0we don't always want to save  \n17:00\u00a0<+tmortagne>\u00a0so that's way worst than unregistering the event IMO  \n17:00\u00a0<+tmortagne>\u00a0the URL parameter is probably the best for performances  \n17:00\u00a0<+sburjan>\u00a0but afaik we have mores tests that save that tests that don;t  \n17:00\u00a0<+sburjan>\u00a0afair tests that don't save are usually exceptions, but I might be wrong  \n17:02\u00a0<+sburjan>\u00a0well talk about it tomorrow .. live ;)  \n17:02\u00a0<vmassol1>\u00a0not good  \n17:03\u00a0<vmassol1>\u00a0we need to fix this asap and this is a community decision  \n17:03\u00a0<+tmortagne>\u00a0nice timing :)  \n17:03\u00a0<+tmortagne>\u00a0vmassol1: talking about accessing the URL in the event \"Because it can't be done. The new location is private/sensitive information. Nobody wants you to know which sites they visit when they leave your site.\" :(  \n17:03\u00a0<vmassol1>\u00a0we need to talk about ti with sergiu  \n17:03\u00a0<+tmortagne>\u00a0http://stackoverflow.com/questions/1686687/how-can-i-get-the-destination-url-in-javascript-onbeforeunload-event  \n17:04\u00a0<+tmortagne>\u00a0yep  \n17:04\u00a0<vmassol1>\u00a0btw sergiu said he'll fix it....  \n17:04\u00a0<vmassol1>\u00a0but we may want to fix it faster...  \n17:04\u00a0<+tmortagne>\u00a0did he ?  \n17:04\u00a0<vmassol1>\u00a0yep  \n17:04\u00a0<+tmortagne>\u00a0ok missed that  \n17:05\u00a0<+sburjan>\u00a0he did, yes, I confirm :)  \n17:05\u00a0<vmassol1>\u00a0check 11:54 at http://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20120209  \n17:06\u00a0<+sburjan>\u00a0it is odd, because afaik browsers had this modal out of the box when users jump to another page with unsaved form data. Odd that we had explicitly made it trigger  \n17:06\u00a0<vmassol1>\u00a0just noticed I put a \"?\" when there shoudln't have been one  \n17:07\u00a0<+sburjan>\u00a0am I missing something ?  \n17:08\u00a0<+tmortagne>\u00a0vmassol1: All I see is a vague \"Yep\" just before leaving ;)  \n17:08\u00a0<vmassol1>\u00a0:)  \n17:08\u00a0<+sburjan>\u00a0but she did notice it when I asked you about it, and realized he introduced it ... so ... I think he is responsable :)  \n17:08\u00a0<+sburjan>\u00a0\\*he  \n17:08\u00a0<vmassol1>\u00a0that won't make it fix it fast  \n17:09\u00a0<vmassol1>\u00a0as I said it's been failing for 2 weeks  \n17:09\u00a0<vmassol1>\u00a02 full weeks....  \n17:09\u00a0<vmassol1>\u00a0with 10 mails every time there was a commit :)  \n17:09\u00a0<jvelo>\u00a0has joined #xwiki  \n17:11\u00a0<+tmortagne>\u00a0plus we talked about it several times here always mentioning the popup  \n17:33\u00a0<jvdrean>\u00a0has quit  \n17:34\u00a0<+sburjan>\u00a0see you tomorrow guys  \n17:34\u00a0<vmassol1>\u00a0yep, IRL, bye  \n17:34\u00a0<vmassol1>\u00a0guys please answer on the new dates for 3.5  \n17:42\u00a0<sdumitriu>\u00a0has joined #xwiki  \n17:52\u00a0<rsjafe>\u00a0has quit  \n17:53\u00a0<sburjan>\u00a0has quit  \n18:25\u00a0<CIA-120>\u00a0tmortagne\u000f master\u000f \\* r6c8697d\u000f https://github.com/xwiki/xwiki-platform/commit/6c8697ddff6e4f261e504295d4fd36cab669870e \u000f/ xwiki-platform-core/xwiki-platform-test/src/main/java/org/xwiki/test/ui/TestUtils.java :\u000f \\* Improve goToPage API ...  \n18:29\u00a0<CIA-120>\u00a0tmortagne\u000f master\u000f \\* rf54b09e\u000f https://github.com/xwiki/xwiki-platform/commit/f54b09ecfb2a85352bf3523758ee191684ece8fa \u000f/ xwiki-platform-core/xwiki-platform-test/src/main/java/org/xwiki/test/ui/TestUtils.java :\u000f Missing @since - http://git.io/k795SA  \n18:31\u00a0<CIA-120>\u00a0tmortagne\u000f master\u000f \\* r17f5241\u000f https://github.com/xwiki/xwiki-enterprise/commit/17f5241796763393a2cf639dc42d4e6b7debbf8f \u000f/ (3 files in 3 dirs):\u000f Improve codestyle - http://git.io/6SeEcw  \n18:31\u00a0<tmortagne>\u00a0has quit  \n18:35\u00a0<CIA-120>\u00a0Vincent Massol\u000f master\u000f \\* r606cba1\u000f https://github.com/xwiki/xwiki-platform/commit/606cba13c4d7949c85598e90d3442adddb3e89c6 \u000f/ xwiki-platform-core/xwiki-platform-test/src/main/java/org/xwiki/test/ui/TestUtils.java :\u000f Improved source comments so that we remember it in a few months time... ;) - http://git.io/U0WCDQ  \n19:02\u00a0<jvelo>\u00a0has quit  \n19:04\u00a0<abusenius>\u00a0has joined #xwiki  \n19:15\u00a0<gdelhumeau>\u00a0has quit  \n19:27\u00a0<+Denis>\u00a0sdumitriu: ping  \n19:28\u00a0<@sdumitriu>\u00a0Pong  \n19:28\u00a0<+Denis>\u00a0sdumitriu: I am trying to test dynamic custom mapping, I have taken the exemple in your draft: http://dev.xwiki.org/xwiki/bin/view/Drafts/DynamicCustomMapping  \n19:28\u00a0<@sdumitriu>\u00a0Why aren't you happy with the 35000 migrator?  \n19:29\u00a0<@sdumitriu>\u00a0That's not my draft... I just added a comment  \n19:29\u00a0<@sdumitriu>\u00a0cjd wrote it  \n19:29\u00a0<+Denis>\u00a0because it use native SQL, do a workaround due to limitation that will be remove in 4.x, and could not be fixed later due to this workaround  \n19:29\u00a0<+Denis>\u00a0ah, have not check  \n19:30\u00a0<+Denis>\u00a0the groovy code fail  \n19:30\u00a0<+Denis>\u00a0the link is badly produced, the ? is encoded in the document name, probably a 2.1 syntax stuff ?  \n19:31\u00a0<+Denis>\u00a0yes, in 2.0 it works  \n19:32\u00a0<cjd>\u00a0I'm not sure if dynamic custom mapping works anymore, it did when I wrote that but it's one of those untested unused features  \n19:32\u00a0<cjd>\u00a0nobody would cry if it broke one day  \n19:33\u00a0<cjd>\u00a0I wrote that up basicly because there was nothing about it at all, it was kind of an easter egg before that.  \n19:35\u00a0<+Denis>\u00a0cjd: I have written my id migration procedure to support it !  \n19:35\u00a0<+Denis>\u00a0so, I need to test it  \n19:35\u00a0<@sdumitriu>\u00a0Denis: So you'd like to postpone this migrator for 4.0?  \n19:35\u00a0<@sdumitriu>\u00a0I have another one just like it...  \n19:36\u00a0<+Denis>\u00a0that would be better in my opinion, since it will be simpler and not require moving any data anymore  \n19:36\u00a0<@sdumitriu>\u00a0OK, then vmassol1 should decide  \n19:36\u00a0<@sdumitriu>\u00a0Since I did it on request from Ludovic via Vincent  \n19:37\u00a0<+Denis>\u00a0have you measure the performance gain it provide ?  \n19:37\u00a0<@sdumitriu>\u00a0No, but it should have a pretty big impact on wikis with plenty of activity  \n19:37\u00a0<@sdumitriu>\u00a0(only when displaying the {{activity}} macro  \n19:39\u00a0<+Denis>\u00a0either we are sure to have deeply test it on all supported DB, or we leave it for 4.x IMO  \n19:41\u00a0<+Denis>\u00a0cjd: I have to leave for dinner, will you be there latter ?  \n19:42\u00a0<+Denis>\u00a0currently the custom table is created, but the mapping seems broken\u2026  \n19:56\u00a0<cjd>\u00a0I'll be around  \n20:00\u00a0<CIA-120>\u00a0Sergiu Dumitriu\u000f master\u000f \\* r37f38d0\u000f https://github.com/xwiki/xwiki-commons/commit/37f38d0a3633221f854412b2236f8985e812c3d9 \u000f/ (2 files in 2 dirs):\u000f Merge branch 'master' of https://github.com/ebeutler/xwiki-commons - http://git.io/KuXP5g  \n20:00\u00a0<CIA-120>\u00a0Sergiu Dumitriu\u000f master\u000f \\* r5bd7735\u000f https://github.com/xwiki/xwiki-commons/commit/5bd77353bbdaab35b7bd69f9ec9d14472c851d07 \u000f/ (3 files in 2 dirs):\u000f XWIKI-7504: Files within WEB-INF directory readable by using velocity ...  \n20:06\u00a0<vmassol1>\u00a0sdumitriu: my take is that it's not absolutely necessary for 3.5 since it can be worked around with documentation and manually setting the index. Now if you can guarantee it works for sure on all DBs we support then we could leave it but we need to be sure it really works.  \n20:07\u00a0<@sdumitriu>\u00a0No, I can't guarantee that  \n20:07\u00a0<@sdumitriu>\u00a0But we already have two other migrators that use SQL  \n20:07\u00a0<vmassol1>\u00a0the same kind of SQL?  \n20:07\u00a0<vmassol1>\u00a0I mean with ALTER TABLE?  \n20:07\u00a0<@sdumitriu>\u00a0Not quite, let me check  \n20:08\u00a0<@sdumitriu>\u00a0Yes, one does have the DROP COLUMN statement  \n20:08\u00a0<@sdumitriu>\u00a0And for that one we did find a case where it didn't work  \n20:08\u00a0<vmassol1>\u00a0ah\u2026 not very good then  \n20:08\u00a0<@sdumitriu>\u00a0// Anyway, in case we're using a DBMS which  \n20:08\u00a0<@sdumitriu>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0// doesn't support DROP COLUMN (such as Derby < 10.3.1.4), we can try to alter  \n20:08\u00a0<@sdumitriu>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0// the column to allow NULL values.  \n20:09\u00a0<@sdumitriu>\u00a0But Derby should be updated regularly, I doubt that anyone uses a 3 years old version of it  \n20:09\u00a0<vmassol1>\u00a0yeah but you'd be surprised :)  \n20:09\u00a0<vmassol1>\u00a0a lot of companies still run on jdk 1.4  \n20:10\u00a0<vmassol1>\u00a0but we could decide not to support old versions for sure  \n20:10\u00a0<@sdumitriu>\u00a0The other one that uses sql does a SELECT and a similar UPDATE:  \n20:10\u00a0<@sdumitriu>\u00a0\"update xwikidoc set XWD\\_ARCHIVE=' ' where XWD\\_ID=?\"  \n20:12\u00a0<vmassol1>\u00a0sdumitriu: what's your opinion?  \n20:12\u00a0<@sdumitriu>\u00a0Personally, I'm 60% towards including it in 3.5  \n20:12\u00a0<+Denis>\u00a0sdumitriu: for the UPDATE I have to do it myself, due to limitation in hibernate, and I am confident it will work  \n20:13\u00a0<+Denis>\u00a0but the ALTER is more suspicious  \n20:13\u00a0<@sdumitriu>\u00a0OK...  \n20:13\u00a0<@sdumitriu>\u00a0There is one option of improvement  \n20:13\u00a0<+Denis>\u00a0what cause me to think we should pospone is that moving data is not really needed, and once done, we should keep it  \n20:14\u00a0<@sdumitriu>\u00a0Instead of doing a batch with the two commands, execute each in a try catch  \n20:14\u00a0<+Denis>\u00a0could'nt we simple explain in the release note, what should be done to improve performance, and postpone to 4.x ?  \n20:15\u00a0<@sdumitriu>\u00a0So that moving the data doesn't depend on being able to drop the column  \n20:15\u00a0<vmassol1>\u00a0Denis: yes that's the safest route of course, it's just a missed opportunity if it works fine in practice  \n20:15\u00a0<@sdumitriu>\u00a0Since droping the column isn't mandatory  \n20:15\u00a0<vmassol1>\u00a0right now I'm 40-50% for keeping it  \n20:16\u00a0<vmassol1>\u00a03.x has a performance issue with the AS  \n20:16\u00a0<vmassol1>\u00a0so if it fixes that it's good to have it  \n20:16\u00a0<vmassol1>\u00a0what I don't know is if it fixes it or not  \n20:16\u00a0<vmassol1>\u00a0people don't read release notes  \n20:16\u00a0<+Denis>\u00a0the performance issue is not general  \n20:16\u00a0<vmassol1>\u00a0and by default they won't have the index set  \n20:17\u00a0<vmassol1>\u00a0so they'll judge xwiki based on the default  \n20:17\u00a0<+Denis>\u00a0it only arise when using the AS heavily  \n20:17\u00a0<vmassol1>\u00a0not really  \n20:17\u00a0<vmassol1>\u00a0jsut try it with base XE  \n20:17\u00a0<vmassol1>\u00a0it takes more than 7 seconds on oracle for the home page on base XE  \n20:17\u00a0<vmassol1>\u00a0and several seconds on hsqldb  \n20:17\u00a0<+Denis>\u00a0but I never keep AS myself in XE, so, this why I say not everybody is impacted  \n20:18\u00a0<+Denis>\u00a0and after the upgrade, have you a measured ?  \n20:18\u00a0<vmassol1>\u00a0nope  \n20:19\u00a0<vmassol1>\u00a0sdumitriu: please check the hack thomas and I did on the functional tests  \n20:19\u00a0<vmassol1>\u00a0I don't like it and we need a better solution  \n20:19\u00a0<vmassol1>\u00a0we did it while we were waiting for you  \n20:20\u00a0<vmassol1>\u00a0it's in TestUtils.gotoPage()  \n20:20\u00a0<vmassol1>\u00a0sdumitriu: you applied a pull request?  \n20:21\u00a0<vmassol1>\u00a0https://github.com/xwiki/xwiki-commons/commit/37f38d0a3633221f854412b2236f8985e812c3d9#commitcomment-950815  \n20:21\u00a0<vmassol1>\u00a0you should review it before accepting it  \n20:23\u00a0<@sdumitriu>\u00a0vmassol1: I did  \n20:23\u00a0<vmassol1>\u00a0i don't even see how it can pass the build  \n20:23\u00a0<@sdumitriu>\u00a0I refactored most of the code  \n20:23\u00a0<vmassol1>\u00a0you sure?  \n20:23\u00a0<@sdumitriu>\u00a0It passes because I added another commit on top of it  \n20:24\u00a0<vmassol1>\u00a0in another commit?  \n20:24\u00a0<@sdumitriu>\u00a0Hm...  \n20:24\u00a0<@sdumitriu>\u00a0Why don't I see it?  \n20:24\u00a0<vmassol1>\u00a0strange  \n20:24\u00a0<vmassol1>\u00a0this \u00a0looks better: https://github.com/xwiki/xwiki-commons/commit/5bd77353bbdaab35b7bd69f9ec9d14472c851d07  \n20:24\u00a0<vmassol1>\u00a0maybe a merge issue  \n20:25\u00a0<@sdumitriu>\u00a0It's this one: https://github.com/xwiki/xwiki-commons/commit/5bd77353bbdaab35b7bd69f9ec9d14472c851d07  \n20:25\u00a0<@sdumitriu>\u00a0But how do I get to it? Github says last commit is 37f38  \n20:25\u00a0<vmassol1>\u00a0I got it from https://github.com/xwiki/xwiki-commons/commits/  \n20:26\u00a0<vmassol1>\u00a0but it's not very nice that we get to see all the intermediary steps  \n20:26\u00a0<vmassol1>\u00a0(ie in several commits)  \n21:04\u00a0<@sdumitriu>\u00a0vmassol1: Indeed, the hack in TestUtils isn't nice  \n21:06\u00a0<vmassol1>\u00a0hmm thomas broke the build: http://ci.xwiki.org/job/xwiki-enterprise-test-pageobjects/900/console  \n21:08\u00a0<+Denis>\u00a0cjd: I am still stucked  \n21:08\u00a0<vmassol1>\u00a0hmm I think I broke the platform build with a checksrtyle issue, fixing  \n21:08\u00a0<vmassol1>\u00a0http://ci.xwiki.org/job/xwiki-platform/1489/console  \n21:09\u00a0<+Denis>\u00a0cjd: if I check the configuration using groovy, getStore().getConfiguration(), the custom mapped class is mapped  \n21:09\u00a0<cjd>\u00a0ok  \n21:09\u00a0<cjd>\u00a0do you have a failing test case I can look at?  \n21:10\u00a0<+Denis>\u00a0cjd: but the select you propose in the sample of your draft fails, saying it is not mapped  \n21:10\u00a0<cjd>\u00a0hmm ok  \n21:11\u00a0<+Denis>\u00a0any clue ? something I may have missed ?  \n21:12\u00a0<CIA-120>\u00a0Vincent Massol\u000f master\u000f \\* r181abd2\u000f https://github.com/xwiki/xwiki-platform/commit/181abd2f8a7336ed12fdcf626a310b7f5ba54831 \u000f/ xwiki-platform-core/xwiki-platform-activitystream/src/main/java/com/xpn/xwiki/plugin/activitystream/migration/hibernate/R35000XWIKI6691DataMigration.java :\u000f Fix checkstyle errors - http://git.io/F24g0g  \n21:12\u00a0<cjd>\u00a0Denis: this one? xc.getWiki().search(\"SELECT e.familyName from Employee e\", xc)  \n21:13\u00a0<+Denis>\u00a0yep, except my class is name Sandbox.DynamicClass  \n21:13\u00a0<cjd>\u00a0that has been broken for some time now  \n21:13\u00a0<cjd>\u00a0since 3.2ish  \n21:13\u00a0<cjd>\u00a0IIRC  \n21:14\u00a0<+Denis>\u00a0and why ?  \n21:15\u00a0<cjd>\u00a0http://dev.xwiki.org/xwiki/bin/view/Drafts/DynamicCustomMapping?viewer=changes&rev1=1.1&rev2=2.1  \n21:16\u00a0<cjd>\u00a0I'm not sure why it stopped working, when I first wrote it I'm pretty sure it worked but at some point someone mentioned that they couldn't get it working and I wasn't up to debugging it further  \n21:16\u00a0<+Denis>\u00a0ok  \n21:16\u00a0<+Denis>\u00a0but I had another similar issue  \n21:16\u00a0<+Denis>\u00a0I can save the object  \n21:17\u00a0<+Denis>\u00a0but I cannot get its value back in the editor  \n21:17\u00a0<+Denis>\u00a0if I check the database, it is properly saved  \n21:17\u00a0<cjd>\u00a0hmm  \n21:17\u00a0<cjd>\u00a0that could be a more recent break  \n21:18\u00a0<cjd>\u00a0although it should be ok since non-dynamic custom mapping is known to work  \n21:18\u00a0<cjd>\u00a0if that fails, everything explodes  \n21:18\u00a0<+Denis>\u00a0sure  \n21:18\u00a0<+Denis>\u00a0but I get an empty form  \n21:19\u00a0<cjd>\u00a0is this the way it is currently or after your changes?  \n21:20\u00a0<+Denis>\u00a0it is before my change, since what I need to test is migrations  \n21:20\u00a0<cjd>\u00a0hmm  \n21:20\u00a0<+Denis>\u00a0it is a little bit modified code including liquibase, but this should not be related  \n21:21\u00a0<cjd>\u00a0if a feature breaks in the woods and there's noone around to notice, did it ever really exist? ;)  \n21:23\u00a0<CIA-120>\u00a0Vincent Massol\u000f master\u000f \\* racfdc3e\u000f https://github.com/xwiki/xwiki-enterprise/commit/acfdc3e020fd049794a3ec1d692a539babdfa72b \u000f/ xwiki-enterprise-test/xwiki-enterprise-test-pageobjects/src/main/java/org/xwiki/test/po/watchlist/WatchlistUserProfilePage.java :\u000f Fix build, not 100% sure why it's failing to compile with Maven (compiles fine in my IDE). Something to do with conflicting signatures I think. - http://git.io/Kjc67g  \n21:23\u00a0<+Denis>\u00a0it puzzl me at least  \n21:26\u00a0<+Denis>\u00a0saving, updating works  \n21:27\u00a0<cjd>\u00a0if you save then close the editor and open it again is the value there?  \n21:27\u00a0<cjd>\u00a0s/close/navigate away from/  \n21:33\u00a0<+Denis>\u00a0just checked by code  \n21:34\u00a0<+Denis>\u00a0I get the object, the UUID is correct  \n21:34\u00a0<+Denis>\u00a0but getProperties return an empty arrya  \n21:39\u00a0<cjd>\u00a0hmm  \n21:39\u00a0<cjd>\u00a02012-02-09 15:54:54,379 [http://[::1]:8081/xwikiTrunk/bin/view/Main/dcm?injectMapping] WARN \u00a0c.x.x.s.XWikiHibernateStore \u00a0\u00a0\u00a0- Mapping contains invalid field name christianName  \n21:39\u00a0<cjd>\u00a0death by new hibernate?  \n21:40\u00a0<aulius>\u00a0has joined #xwiki  \n21:48\u00a0<aulius>\u00a0hello :)  \n21:48\u00a0<+Denis>\u00a0cjd: where did you get that ?  \n21:49\u00a0<cjd>\u00a0I just tried going through the draft and running the script  \n21:49\u00a0<+Denis>\u00a0I do not get that  \n21:50\u00a0<aulius>\u00a0I have small issue with 3.2 blog rss, maybe it was fixed in 3.3 or 3.4... maybe the fix is to upgrade :)  \n21:50\u00a0<aulius>\u00a03.2 xwiki, trying to use GlobalBlogRSS, and article contents showed there are not in UTF8 encoding, rss item titles are in UTF-8, and if I open posts directly, they show in UTF8...  \n21:51\u00a0<+Denis>\u00a0aulius: are you talking about malformed accentuated chars in rss content ?  \n21:52\u00a0<madeye>\u00a0has quit  \n21:55\u00a0<aulius>\u00a0Denis: I see '?' instead of UTF-8 chars (1 '?')  \n21:56\u00a0<+Denis>\u00a0aulius: I am aware of an issue in chars encoding, that affect content but not title, is that the issue ?  \n21:57\u00a0<aulius>\u00a0yes  \n22:00\u00a0<+Denis>\u00a0it is still not solved, have you search for a jira issue about it ?  \n22:00\u00a0<+Denis>\u00a0by the way, are you on 3.2 or 3.2.1 ?  \n22:01\u00a0<aulius>\u00a03.2 :)  \n22:01\u00a0<+Denis>\u00a0Even if it does not fix your issue, you should consider upgrading, since 3.2 has serious memory issue  \n22:04\u00a0<aulius>\u00a0well, I'm looking at it... it's just that I made a bit foolish decision to use PostgreSQL... so now I'm looking at 3.3 Release notes and they say to wait... and I remember seeing some email on xwiki-users about that Postgres issue  \n22:05\u00a0<aulius>\u00a0tried to migrate to MySQL using export/import with no luck (char #23; (or smth like that) is not xml character error)  \n22:07\u00a0<+Denis>\u00a0at least, move to 3.2.1  \n22:07\u00a0<aulius>\u00a0maybe that's because of lithuanian characters in page titles  \n22:07\u00a0<+Denis>\u00a0it has serious fixes  \n22:08\u00a0<aulius>\u00a0if pgsql support is broken in 3.2 also, then maybe it will work the same in 3.4? :)  \n22:09\u00a0<+Denis>\u00a0why do you say it is broken in 3.2 ?  \n22:10\u00a0<aulius>\u00a0from release notes :)  \n22:10\u00a0<aulius>\u00a0not that it doesn't work from my point of view  \n22:11\u00a0<aulius>\u00a03.3 relnotes say specifically to stay on 3.1.1 for postgresql  \n22:11\u00a0<aulius>\u00a0but since I installed 3.2 from start...  \n22:13\u00a0<aulius>\u00a0anyway, I will try to upgrade, maybe even to 3.4... maybe I succeed and won't get any additional grey hair  \n22:14\u00a0<+Denis>\u00a0mm  \n22:14\u00a0<+Denis>\u00a0it say also that it should be fixed in 3.3.1 and 3.4  \n22:16\u00a0<aulius>\u00a0well, I haven't seen anything about fixes :)  \n22:17\u00a0<aulius>\u00a0except mailing list, where as I understand was error report and fix (so maybe it's applied)  \n22:17\u00a0<+Denis>\u00a0maybe vmassol1 could have some clue, I know he use it  \n22:18\u00a0<vmassol1>\u00a0use what?  \n22:18\u00a0<vmassol1>\u00a0is now known as <vmassol>  \n22:18\u00a0<+Denis>\u00a0postgresql  \n22:18\u00a0<vmassol>\u00a0not really but I've spent some time trying to make it work with XWiki  \n22:19\u00a0<abusenius>\u00a0has quit  \n22:19\u00a0<vmassol>\u00a0I fixed a few issues in 3.4 AFAIR  \n22:19\u00a0<+Denis>\u00a0release not 3.3 says to stay on 3.1.1 and that a fix should be applied on 3.3.1 and 3.4  \n22:20\u00a0<+Denis>\u00a0but from release note in 3.3.1 or 3.4 this not clear if something had been doe  \n22:21\u00a0<aulius>\u00a0well, anyway, it shouldn't be worse than 3.2...  \n22:21\u00a0<+Denis>\u00a0sure  \n22:24\u00a0<aulius>\u00a0thank you for response/support!  \n22:25\u00a0<+Denis>\u00a0aulius: you're welcome  \n22:26\u00a0<+Denis>\u00a0do not hesitate to file a bug regarding the rss issue  \n22:28\u00a0<aulius>\u00a0ok, maybe I will :)  \n22:28\u00a0<aulius>\u00a0but probably it would be better to upgrade first  \n22:29\u00a0<+Denis>\u00a0cjd: seems we throw on dynamicSession.load(bclass.getName(), Integer.valueOf(object.getId()));  \n22:29\u00a0<+Denis>\u00a0but, I cannot reach the exception, it is simply ignore, and event with the debugger I miss it  \n22:39\u00a0<cjd>\u00a0IMO we can go ahead and propose dropping support for dynamic mapping on the list.  \n22:40\u00a0<aulius>\u00a0has quit  \n22:40\u00a0<cjd>\u00a0it's a poorly documented poorly tested feature and nobody seems to miss it  \n22:45\u00a0<+Denis>\u00a0it so close to be working  \n22:46\u00a0<+Denis>\u00a0an d it does not miss anyone since very few people are aware of it  \n22:51\u00a0<+Denis>\u00a0cjd: java.util.ConcurrentModificationException :(  \n22:53\u00a0<+Denis>\u00a0cjd: it seem to arise also for XWikiPreferences ?  \n22:53\u00a0<cjd>\u00a0hmm  \n22:53\u00a0<+Denis>\u00a0mmm  \n22:53\u00a0<+Denis>\u00a0maybe another issue in fact  \n22:53\u00a0<+Denis>\u00a0for my dynamic class I got  \n22:54\u00a0<+Denis>\u00a0Unknown entity: Sandbox.DynamicClass  \n23:03\u00a0<vmassol>\u00a0if someone has some time there are some tests to fix: http://ci.xwiki.org/job/xwiki-enterprise-test-escaping/org.xwiki.enterprise$xwiki-enterprise-test-escaping/1057/testReport/  \n23:18\u00a0<CIA-120>\u00a0Vincent Massol\u000f master\u000f \\* r4539b93\u000f https://github.com/xwiki/xwiki-platform/commit/4539b935284ed31393f397de7258d13705570bba \u000f/ xwiki-platform-core/pom.xml :\u000f XWIKI-7514: Upgrade to Groovy 1.8.6 - http://git.io/EHSrzQ  \n23:19\u00a0<vmassol>\u00a0has quit  \n23:20\u00a0<+Denis>\u00a0cjd: if I had well understand, you are about to load objects for a document, but to inject the mapping for that document in the factory, you check the classes of the object in the document, object that has not yet been loaded !  \n23:39\u00a0<+Denis>\u00a0whouah  \n23:39\u00a0<+Denis>\u00a0cjd: it works !  \n23:39\u00a0<+Denis>\u00a0but it seems that it will need some serious review to be properly fixed  \n23:40\u00a0<cjd>\u00a0what database are you using?  \n23:40\u00a0<+Denis>\u00a0MySQL  \n23:41\u00a0<+Denis>\u00a0what I do basically, is make a page that calls getStore().injectCustomMappings(context)  \n23:41\u00a0<+Denis>\u00a0after that, event the query works  \n23:41\u00a0<+Denis>\u00a0-t  \n23:42\u00a0<+Denis>\u00a0what I do not understand is all the other injection I see in load, save and delete  \n23:43\u00a0<+Denis>\u00a0in particular, in load, it could not do something really useful  \n23:43\u00a0<+Denis>\u00a0and all these do not keep their factory higher  \n23:44\u00a0<+Denis>\u00a0really puzzle by the code currently  \n23:47\u00a0<cjd>\u00a0I really support the idea of dropping dynamic custom mapping, unless someone wants to take it under their wing and be the champion for the feature it would make all of our lives easier if we didn't even claim to support it  \n23:53\u00a0<+Denis>\u00a0funny  \n23:53\u00a0<+Denis>\u00a0after passing my migration  \n23:53\u00a0<+Denis>\u00a0it works immediately  \n23:53\u00a0<+Denis>\u00a0since my migrator, to do the migration, properly inject it  \n23:54\u00a0<+Denis>\u00a0cjd: this feature seems really interesting IMO, but the implementation is too complex for the goal IMO  \n23:55\u00a0<+Denis>\u00a0I make no promise, but maybe on day I will take care of it  \n23:55\u00a0<cjd>\u00a0I liked it when I discovered it but it's an orphan feature and we'll never know if it breaks one day  \n\n"}