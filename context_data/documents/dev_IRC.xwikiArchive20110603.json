{"id": "dev:IRC.xwikiArchive20110603", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20110603", "title": "IRC Archive for channel #xwiki - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n00:26\u00a0<xwikibot>\u00a0has joined #xwiki  \n00:39\u00a0<sdumitriu>\u00a0has quit  \n00:39\u00a0<vmassol>\u00a0has quit  \n03:10\u00a0<abusenius>\u00a0has quit  \n03:18\u00a0<Enygma`>\u00a0has quit  \n04:59\u00a0<DrLou>\u00a0has quit  \n06:16\u00a0<DrLou>\u00a0has joined #xwiki  \n06:45\u00a0<@cjdelisle>\u00a0XWIKI-6619  \n06:54\u00a0<mflorea>\u00a0has joined #xwiki  \n07:01\u00a0<Denis>\u00a0has quit  \n07:09\u00a0<Denis>\u00a0has joined #xwiki  \n07:42\u00a0<DrLou>\u00a0has quit  \n08:21\u00a0<rrodriguez>\u00a0has quit  \n08:22\u00a0<rrodriguez>\u00a0has joined #xwiki  \n08:26\u00a0<rrodriguez>\u00a0has quit  \n09:11\u00a0<@cjdelisle>\u00a0looks like we have a serious issue with XEM  \n09:11\u00a0<@cjdelisle>\u00a0``Wiki \"newemptywiki\" creation failed: Error number 50035 in 5: Exception in plugin xpn.xwiki.plugin.wikimanager.Wiki Manager Plugin?: Wiki newemptywiki? database update failed Wrapped Exception: Error number 3202 in 3: Exception while reading document name = XWiki Preferences?, type = DOCUMENT?, parent = name = [XWiki?, type = SPACE?, parent = name = [newemptywiki?, type = WIKI?, parent = null?]] Wrapped Exception: Error number 3212 in 3:  \n09:16\u00a0<sburjan>\u00a0has joined #xwiki  \n09:25\u00a0<jvelociter>\u00a0has joined #xwiki  \n10:11\u00a0<vmassol>\u00a0has joined #xwiki  \n10:18\u00a0<evalica>\u00a0has joined #xwiki  \n10:51\u00a0<Enygma`>\u00a0has joined #xwiki  \n10:51\u00a0<@cjdelisle>\u00a0http://ci.xwiki.org/job/xwiki-enterprise-tests-3.1/24/org.xwiki.enterprise$xwiki-enterprise-test-ui/  \n10:51\u00a0<@cjdelisle>\u00a0\\o/  \n10:53\u00a0<+sburjan>\u00a0thumbs up :)  \n10:53\u00a0<jvelociter>\u00a0has quit  \n10:55\u00a0<mpaun>\u00a0has joined #xwiki  \n11:00\u00a0<jvelociter>\u00a0has joined #xwiki  \n11:04\u00a0<evalica>\u00a0has quit  \n11:09\u00a0<mpaun>\u00a0has quit  \n11:13\u00a0<evalica>\u00a0has joined #xwiki  \n11:32\u00a0<jvelociter\\_>\u00a0has joined #xwiki  \n11:34\u00a0<abusenius>\u00a0has joined #xwiki  \n11:36\u00a0<jvelociter>\u00a0has quit  \n11:36\u00a0<jvelociter\\_>\u00a0is now known as <jvelociter>  \n11:48\u00a0<vmassol>\u00a0has quit  \n12:32\u00a0<@cjdelisle>\u00a0mflorea: I see 2 tests failing here and they seem to be pretty old  \n12:32\u00a0<@cjdelisle>\u00a0http://ci.xwiki.org/job/xwiki-enterprise-tests-3.1/24/org.xwiki.enterprise$xwiki-enterprise-test-wysiwyg/#showFailuresLink  \n12:32\u00a0<@cjdelisle>\u00a0is it a trivial fix or should we report bugs and exclude them for now?  \n12:32\u00a0<@cjdelisle>\u00a0And is there anything I can do to help?  \n12:33\u00a0<evalica>\u00a0has quit  \n12:35\u00a0<Enygma`>\u00a0has quit  \n12:36\u00a0<+mflorea>\u00a0cjdelisle: I know, they are on my list. One needs to be fixed in the platform (WYSIWYG editor code) and one fails only on CI (because shortcut keys don't behave as expected). I'm handling both.  \n12:37\u00a0<@cjdelisle>\u00a0I saw the shortcut key thing happen locally (probably because my computer is very similar to the ci server)  \n12:37\u00a0<+mflorea>\u00a0you mean the test fails on you machine?  \n12:37\u00a0<@cjdelisle>\u00a0yes  \n12:37\u00a0<@cjdelisle>\u00a0can I help?  \n12:38\u00a0<+mflorea>\u00a0what FF version do you have?  \n12:38\u00a0<+mflorea>\u00a0for running tests I mean  \n12:38\u00a0<@cjdelisle>\u00a0hehe it's a nightly build of 3.6  \n12:38\u00a0<@cjdelisle>\u00a0I just used what I was using for everything at the time  \n12:40\u00a0<@cjdelisle>\u00a0What's happening is the shortcut key that's supposed to trigger save and continue is also used to open up the history bar.  \n12:40\u00a0<@cjdelisle>\u00a0\\*drop donw menu  \n12:40\u00a0<@cjdelisle>\u00a0and that's what happens  \n12:41\u00a0<+mflorea>\u00a0yes, but that doesn't prevent the save in my case  \n12:41\u00a0<+mflorea>\u00a0I can see the History menu is opened but the page is saved  \n12:42\u00a0<+mflorea>\u00a0can you save&continue using the shortcut?  \n12:42\u00a0<@cjdelisle>\u00a0What I see here is the history menu opens and then it does not close so later on an enter key is pressed which causes the \"my library\" thing to open  \n12:43\u00a0<@cjdelisle>\u00a0Yes I can but if I miss the shift key (so I hit alt+s) then I get a FF popup to save the document. After closing that, the next time I hit shift+ctrl+s I get the history menu instead of it saving.  \n12:46\u00a0<+mflorea>\u00a0there's no enter key  \n12:46\u00a0<@cjdelisle>\u00a0It might be an FF bug which causes the keydown hook to be temporarily lost.  \n12:46\u00a0<@cjdelisle>\u00a0Hmm, no enter key... I see the \"my library\" window pop up so I assumed that's what was happening.  \n12:46\u00a0<+mflorea>\u00a0I mean, the cancel button is pressed after the shortcut key  \n12:46\u00a0<@cjdelisle>\u00a0it says TEEva in the editor at the point when the \"my library\" pops up  \n12:47\u00a0<@cjdelisle>\u00a0is it possible shift+ctrl+h is pressed?  \n12:48\u00a0<@cjdelisle>\u00a0I will try again and cause it to dismiss the history dropdown menu by clicking and see if the \"my library\" repeats  \n12:48\u00a0<+mflorea>\u00a0I don't see how. note that Alt+Shift+s work fine both in FF 4.0.1 and FF 3.6.17  \n12:50\u00a0<@cjdelisle>\u00a0if I intervine by clicking in empty space to dismiss the dropdown menu the test passes  \n12:51\u00a0<+mflorea>\u00a0let me test something  \n12:57\u00a0<+mflorea>\u00a0cjdelisle: what happens if you replace \"s\" with \"S\"?  \n12:58\u00a0<@cjdelisle>\u00a0testing...  \n12:59\u00a0<@cjdelisle>\u00a0should I remove the shiftKeyDown() shiftKeyUp()?  \n12:59\u00a0<+mflorea>\u00a0nu, they are needed  \n12:59\u00a0<+mflorea>\u00a0without Shift you trigger save&view  \n13:01\u00a0<@cjdelisle>\u00a0still pops up  \n13:02\u00a0<+mflorea>\u00a0do you know if we have a test for save&continue shortcut in wiki edit mode?  \n13:03\u00a0<+mflorea>\u00a0I doubt it  \n13:03\u00a0<+mflorea>\u00a0the test should fails there too  \n13:03\u00a0<+mflorea>\u00a0s/fails/fail  \n13:03\u00a0<+mflorea>\u00a0what's strange is that in my case the History menu doesn't open when I test manually. It opens only during the test..  \n13:04\u00a0<@cjdelisle>\u00a0same here  \n13:04\u00a0<@cjdelisle>\u00a0and also the library opens even without the shift key.  \n13:05\u00a0<@cjdelisle>\u00a0ok  \n13:05\u00a0<evalica>\u00a0has joined #xwiki  \n13:05\u00a0<@cjdelisle>\u00a0alt+s+alt+s --> my library  \n13:08\u00a0<+mflorea>\u00a0I think I found the problem  \n13:08\u00a0<Enygma`>\u00a0has joined #xwiki  \n13:12\u00a0<+mflorea>\u00a0when you test manually in the browser, keyboard events are correlated, meaning that if a keyboard listener blocks a keydown event then the keypress and keyup are not fired anymore. In selenium on the other hand, events (including keyboard events) are simulated and thus it's the responsibility of the test to not fire keypress and keyup if keydown was blocked. Unfortunately the test can't know if an event was blocked so in our particular case the solution is t  \n13:12\u00a0<+mflorea>\u00a0@cjdelisle  \n13:13\u00a0<+mflorea>\u00a0let me know if it works for you  \n13:13\u00a0<@cjdelisle>\u00a0our particular case the solution is t <-- cut off there  \n13:13\u00a0<+mflorea>\u00a0arr  \n13:14\u00a0<+mflorea>\u00a0Unfortunately the test can't know if an event was blocked so in our particular case the solution is to trigger only the keydown event. To test, change \"true\" (=fireKeyPress) to false in the second parameter of typekeyInSource in typeShortcutsForSaveAndContinue  \n13:14\u00a0<@cjdelisle>\u00a0hmm  \n13:15\u00a0<+mflorea>\u00a0(I don't get any feedback when my message is truncated)  \n13:15\u00a0<@cjdelisle>\u00a0I would use a snippet of js because you know the next piece of js will not be executed until it unblocks  \n13:17\u00a0<@cjdelisle>\u00a0That all went a bit over my head but if it will work and it won't flicker then it sounds good.  \n13:17\u00a0<+mflorea>\u00a0what I meant is that the selenium API for firing keyboard events doesn't return a value to indicate if the event was blocked or not. You can write your own API but that complicates the test  \n13:21\u00a0<+mflorea>\u00a0basically, when you test manually the browser does this:  \n13:21\u00a0<+mflorea>\u00a0boolean stopped = fireKeyDown();  \n13:21\u00a0<+mflorea>\u00a0if (!stopped) {  \n13:21\u00a0<+mflorea>\u00a0\u00a0\u00a0fireKeyPress();  \n13:21\u00a0<+mflorea>\u00a0}  \n13:21\u00a0<+mflorea>\u00a0while the test, which tries to simulate this, does:  \n13:21\u00a0<+mflorea>\u00a0fireKeyDown();  \n13:21\u00a0<+mflorea>\u00a0fireKeyPress();  \n13:21\u00a0<+mflorea>\u00a0The consequence is that keypress is fired even if the keydown is stopped and thus the History menu is opened (by the keypress, not by the keydown, which is blocked by our JS code).  \n13:21\u00a0<abusenius>\u00a0has quit  \n13:22\u00a0<@cjdelisle>\u00a0hmm  \n13:23\u00a0<+mflorea>\u00a0(in the last message, I mean to say that keydown is blocked by out JS code, not keypress)  \n13:24\u00a0<@cjdelisle>\u00a0is there an easy fix?  \n13:25\u00a0<+mflorea>\u00a0yes, as I said, fire only keydown, I'm committing  \n13:28\u00a0<@cjdelisle>\u00a0I get it now, I was unaware that keydown and keypress were distinct events. Mostly due to not thinking it through  \n13:31\u00a0<vmassol>\u00a0has joined #xwiki  \n13:32\u00a0<@cjdelisle>\u00a0As far as macrotest I can't be much help since it passes on my machine.  \n13:34\u00a0<+mflorea>\u00a0yes, it passes on my laptop too, with FF 3.6.17, but I can reproduce the issue manually with FF 4.0.1, so I guess the same happens on CI. I'm going to fix the issue for FF 4 and hope this will fix the test on CI  \n13:35\u00a0<@cjdelisle>\u00a0If that doesn't work you can report an issue explaining the nature of the problem and exclude the test.  \n13:35\u00a0<@cjdelisle>\u00a0IMO a bug report with an explaination is much better than a test which reminds me 3 times a day that it is not working.  \n13:37\u00a0<@cjdelisle>\u00a0If you do decide to exclude the test, even though you'll have to comment it out since it's junit3, can you put @Ignore in a comment so we can find-grep for it later?  \n13:38\u00a0<@cjdelisle>\u00a0I've been doing that and adding a link to the jira issue for the flickering tests.  \n13:38\u00a0<+mflorea>\u00a0ok, but I think I can fix the issue  \n13:43\u00a0<vmassol>\u00a0has quit  \n14:07\u00a0<DrLou>\u00a0has joined #xwiki  \n14:10\u00a0<Denis>\u00a0has quit  \n14:30\u00a0<vmassol>\u00a0has joined #xwiki  \n14:53\u00a0<jamesxu>\u00a0has joined #xwiki  \n15:20\u00a0<evalica>\u00a0has quit  \n15:40\u00a0<abusenius>\u00a0has joined #xwiki  \n15:45\u00a0<evalica>\u00a0has joined #xwiki  \n15:49\u00a0<+sburjan>\u00a0XWIKI-6677  \n15:51\u00a0<evalica>\u00a0has quit  \n16:02\u00a0<Enygma`>\u00a0has quit  \n16:17\u00a0<vmassol>\u00a0I'm on holidays, but looking at BreadcrumbTest\u2026 Something strange happening. I get http://pastebin.com/364k5Bs6 but that's normally not possible since findElements shouldn't throw a timeout AFAIU\u2026. if you have any idea let me know, thanks  \n16:19\u00a0<vmassol>\u00a0the line that fails is:  \n16:19\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0result = this.breadcrumbDiv.findElements(By.xpath(\"a[text() = '\" + breadcrumbItem + \"']\"));  \n16:22\u00a0<jvelociter>\u00a0has quit  \n16:25\u00a0<vmassol>\u00a0ok I think I know why, fixing  \n16:26\u00a0<vmassol>\u00a0I know why  \n16:34\u00a0<evalica>\u00a0has joined #xwiki  \n16:34\u00a0<Enygma`>\u00a0has joined #xwiki  \n16:37\u00a0<evalica>\u00a0has quit  \n16:41\u00a0<mflorea>\u00a0has quit  \n17:06\u00a0<jvelociter>\u00a0has joined #xwiki  \n17:07\u00a0<jvelociter>\u00a0has quit  \n17:23\u00a0<rrodriguez>\u00a0has joined #xwiki  \n17:52\u00a0<sburjan>\u00a0has quit  \n18:48\u00a0<Enygma`>\u00a0has quit  \n19:40\u00a0<rrodriguez>\u00a0has quit  \n21:28\u00a0<finbrein>\u00a0has joined #xwiki  \n22:23\u00a0<sdumitriu>\u00a0has joined #xwiki  \n22:39\u00a0<vmassol>\u00a0has quit  \n22:55\u00a0<sdumitriu>\u00a0has quit  \n23:50\u00a0<vmassol>\u00a0has joined #xwiki  \n23:53\u00a0<vmassol>\u00a0has quit  \n\n"}