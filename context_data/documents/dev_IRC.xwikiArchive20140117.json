{"id": "dev:IRC.xwikiArchive20140117", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20140117", "title": "IRC Archive for channel #xwiki on 17 January 2014 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<vmassol>\u00a0has joined #xwiki  \n00:15\u00a0<vmassol>\u00a0has quit  \n00:27\u00a0<sdumitriu1>\u00a0has quit  \n00:51\u00a0<abusenius>\u00a0has quit  \n00:59\u00a0<vrachieru>\u00a0has joined #xwiki  \n01:06\u00a0<Denis>\u00a0has quit  \n01:11\u00a0<vmassol>\u00a0has joined #xwiki  \n01:16\u00a0<vmassol>\u00a0has quit  \n01:23\u00a0<vrachieru>\u00a0has quit  \n02:12\u00a0<vmassol>\u00a0has joined #xwiki  \n02:16\u00a0<vmassol>\u00a0has quit  \n03:13\u00a0<vmassol>\u00a0has joined #xwiki  \n03:18\u00a0<vmassol>\u00a0has quit  \n03:56\u00a0<Kebir>\u00a0has quit  \n04:14\u00a0<vmassol>\u00a0has joined #xwiki  \n04:18\u00a0<vmassol>\u00a0has quit  \n04:30\u00a0<Denis>\u00a0has joined #xwiki  \n05:14\u00a0<vmassol>\u00a0has joined #xwiki  \n05:19\u00a0<vmassol>\u00a0has quit  \n06:04\u00a0<Denis>\u00a0has quit  \n06:15\u00a0<vmassol>\u00a0has joined #xwiki  \n06:20\u00a0<vmassol>\u00a0has quit  \n07:16\u00a0<vmassol>\u00a0has joined #xwiki  \n07:21\u00a0<vmassol>\u00a0has quit  \n07:53\u00a0<risherry>\u00a0has joined #xwiki  \n07:53\u00a0<vmassol>\u00a0has joined #xwiki  \n07:55\u00a0<vmassol1>\u00a0has joined #xwiki  \n07:55\u00a0<vmassol>\u00a0has quit  \n08:00\u00a0<vmassol1>\u00a0has quit  \n08:06\u00a0<vmassol>\u00a0has joined #xwiki  \n08:08\u00a0<andreeapopescu>\u00a0has joined #xwiki  \n08:09\u00a0<tmortagne>\u00a0has joined #xwiki  \n08:14\u00a0<Kaisen>\u00a0has joined #xwiki  \n08:24\u00a0<Sidali>\u00a0has joined #xwiki  \n08:25\u00a0<Kaisen>\u00a0has quit  \n08:27\u00a0<kaisen>\u00a0has joined #xwiki  \n08:36\u00a0<Denis1>\u00a0has joined #xwiki  \n08:38\u00a0<Denis1>\u00a0is now known as <Denis>  \n08:41\u00a0<risherry>\u00a0has quit  \n08:54\u00a0<cjd>\u00a0has joined #xwiki  \n09:07\u00a0<KermitTheFragger>\u00a0has joined #xwiki  \n09:07\u00a0<Sidali>\u00a0has quit  \n09:15\u00a0<Kebir>\u00a0has joined #xwiki  \n09:15\u00a0<vrachieru>\u00a0has joined #xwiki  \n09:24\u00a0<vrachieru>\u00a0has quit  \n09:24\u00a0<vrachieru>\u00a0has joined #xwiki  \n09:26\u00a0<lucaa>\u00a0has joined #xwiki  \n09:26\u00a0<Sidali>\u00a0has joined #xwiki  \n09:43\u00a0<woshilapin>\u00a0has joined #xwiki  \n09:46\u00a0<lucaa>\u00a0has quit  \n09:57\u00a0<evalica>\u00a0has joined #xwiki  \n10:01\u00a0<msmeria>\u00a0has joined #xwiki  \n10:02\u00a0<lucaa>\u00a0has joined #xwiki  \n10:03\u00a0<sburjan>\u00a0has joined #xwiki  \n10:05\u00a0<andreeapopescu>\u00a0has quit  \n10:12\u00a0<mflorea>\u00a0has joined #xwiki  \n10:16\u00a0<evalica1>\u00a0has joined #xwiki  \n10:16\u00a0<evalica>\u00a0has quit  \n10:16\u00a0<polx>\u00a0has joined #xwiki  \n10:39\u00a0<Denis>\u00a0vmassol: Should the above be backported to 5.2 and 5.3 ?  \n10:45\u00a0<tmortagne>\u00a0Denis: it's configurable so it's not critical IMO  \n10:51\u00a0<Slashman>\u00a0has joined #xwiki  \n10:55\u00a0<mflorea>\u00a0has quit  \n10:55\u00a0<Denis>\u00a0vmassol, tmortagne: issue closed in 5.4RC1 with a small mention in the RN  \n10:55\u00a0<cjd>\u00a0Awesome that the issue was resolved, those stack traces are worth a lot more than we're probably giving them credit for  \n10:56\u00a0<mflorea>\u00a0has joined #xwiki  \n10:58\u00a0<Denis>\u00a0cjd: with this new setting, xwiki.org reach an efficiency of the cache at nearly 99% and a read/write ratio of 162. This is clearly a very efficient cache for just a few megabytes of memory usage :)  \n10:59\u00a0<andreeapopescu>\u00a0has joined #xwiki  \n10:59\u00a0<cjd>\u00a0nice  \n11:00\u00a0<cjd>\u00a0in many ways, XWiki and cjdns are trying to do the same things... take all of the manual configuration away and give the user a just-works solution. And over in cjdns land we often encounter the same types of \"how do we make it do something sane in this scenario\" problems  \n11:00\u00a0<cjd>\u00a0like deciding on the size of the cache  \n11:03\u00a0<Denis>\u00a0my experience here is that knowing the effective size in bytes of the cache based on the number of entries is very difficult with infinispan, there is nothing to help  \n11:10\u00a0<ClemensR>\u00a0has joined #xwiki  \n11:29\u00a0<andreeapopescu>\u00a0has quit  \n11:30\u00a0<GuillaumeF>\u00a0has joined #xwiki  \n11:35\u00a0<polx>\u00a0has quit  \n12:20\u00a0<andreeapopescu>\u00a0has joined #xwiki  \n12:51\u00a0<DarkKnightCZ>\u00a0has joined #xwiki  \n12:53\u00a0<kais3n>\u00a0has joined #xwiki  \n12:55\u00a0<kaisen>\u00a0has quit  \n12:55\u00a0<Kaisen>\u00a0has joined #xwiki  \n12:58\u00a0<kais3n>\u00a0has quit  \n13:57\u00a0<Denis>\u00a0has quit  \n14:58\u00a0<Denis>\u00a0has joined #xwiki  \n15:08\u00a0<DarkKnightCZ>\u00a0what is the best way to profile xwiki? i can run cpu sampler through jmx (using VisualVM), but that doesn't show everything.. for example, wiki is loading for about five seconds, com.mysql.jdbc.util.ReadAheadInputStream.fill() takes about 2.5 sec, but what about the rest?  \n15:10\u00a0<msmeria>\u00a0tmortagne: hi  \n15:11\u00a0<tmortagne>\u00a0msmeria: hi  \n15:12\u00a0<msmeria>\u00a0I'm doing a migration from 5.1 xem to 5.4-snap and I get this in DW: \"Preparing XAR extension plan\" and multiple lines like this in the console: \"Cleaning up unclosed ZipFile for archive D:\\xwiki\\tomcat\\work\\Catalina\\localhost\\xwiki\\extension\\repository\\org.xwiki.manager%3Axwiki-manager-ui-all\\5.1\\org.xwiki.manager%3Axwiki-manager-ui-all-5.1.xar\"  \n15:12\u00a0<msmeria>\u00a0and it seems to have been stuck like this for like 4mins  \n15:13\u00a0<msmeria>\u00a0I mean it's not stuck because I keep getting lines like that in the console...  \n15:13\u00a0<msmeria>\u00a0this happened before when migrating from 4.5.4 but randomly  \n15:14\u00a0<msmeria>\u00a07mins and counting...  \n15:16\u00a0<msmeria>\u00a0I'm on Tomcat 7/Postgres, but I remember this happening on hsqldb/jetty also  \n15:16\u00a0<tmortagne>\u00a0msmeria: I can't deduce much from it, did you tested before with 5.4-SNAPSHOT ?  \n15:17\u00a0<msmeria>\u00a0tmortagne: not with 5.4 snap. I was trying to migrate from 4.5.4 to 5.3-snap or another older version  \n15:18\u00a0<tmortagne>\u00a0I'm about to test some DW install anyway for XWIKI-9579  \n15:18\u00a0<tmortagne>\u00a0without reproducing it I have no idea why you have this  \n15:19\u00a0<tmortagne>\u00a0you don't have anything else than \"Cleaning up unclosed ZipFile for archive...\" in the log ?  \n15:19\u00a0<msmeria>\u00a0no. I have hundreds of lines like that now  \n15:19\u00a0<msmeria>\u00a0it's like an endless loop  \n15:20\u00a0<msmeria>\u00a0it's been 11mins now. I'm stopping it  \n15:20\u00a0<tmortagne>\u00a0I really don't understand what could cause this, all I can say is that I will try to reproduce  \n15:20\u00a0<msmeria>\u00a0me too  \n15:24\u00a0<woshilapin>\u00a0has quit  \n15:25\u00a0<woshilapin>\u00a0has joined #xwiki  \n15:26\u00a0<woshilapin>\u00a0has quit  \n15:26\u00a0<woshilapin>\u00a0has joined #xwiki  \n15:34\u00a0<tmortagne>\u00a0msmeria: I can't reproduce the errors you have in the log with a fresh install and the UI was properly installed. That said it looks like there is a lot of logs missing.  \n15:34\u00a0<tmortagne>\u00a0working on the missing log and I will try the upgrade  \n15:35\u00a0<tmortagne>\u00a0(tomcat7/MySQL in my case)  \n15:37\u00a0<msmeria>\u00a0tmortagne: ok. note that I got this only when I migrated to 5.4. I installed the XAR UI for 5.1 with superadmin  \n15:39\u00a0<tmortagne>\u00a0msmeria: you mean 5.1 UI was not installed by DW ?  \n15:41\u00a0<msmeria>\u00a0tmortagne: no. I installed it with the xar  \n15:41\u00a0<tmortagne>\u00a0ok  \n15:51\u00a0<msmeria>\u00a0tmortagne: unfortunately it seems to reproduce on jetty/hsqldb also  \n15:51\u00a0<msmeria>\u00a0it just started now so I'll give it a few minutes  \n15:51\u00a0<tmortagne>\u00a0I don't why the app server would change anyway  \n15:52\u00a0<tmortagne>\u00a0does the progress bar move ?  \n15:52\u00a0<msmeria>\u00a0no  \n15:53\u00a0<msmeria>\u00a0tmortagne: http://postimg.org/image/dsuqhd62l/full/  \n15:54\u00a0<msmeria>\u00a0scroll to the right to see the DW  \n15:54\u00a0<ClemensR>\u00a0is it possible to get a stack trace of the VM in that state ?  \n15:55\u00a0<tmortagne>\u00a0msmeria: anyway in my case it finish to prepare the XAR extension plan, IMO this is a infinite loop caused by a bug related to the fact that you upgrade from a single extension to a set of extensions  \n15:55\u00a0<andreeapopescu>\u00a0has quit  \n15:56\u00a0<tmortagne>\u00a0finishing with the log and will reproduce your use case  \n16:02\u00a0<evalica1>\u00a0has quit  \n16:27\u00a0<msmeria>\u00a0tmortagne: I think my issue was related to the fact that I imported the UI XAR with superadmin. I retested by installing the UI for 5.1 with DW and I was able to finish the migration  \n16:27\u00a0<msmeria>\u00a0I'll investigate more on Monday and create an issue if I can always reproduce it  \n16:31\u00a0<tmortagne>\u00a0msmeria: I'm about to start to reproduce the same thing anyway, if it's easy to reproduce (and it seems to be) I will surely reproduce today and I will take care of the jira issue  \n16:33\u00a0<msmeria>\u00a0tmortagne: ok. seems like I spoke too soon...  \n16:33\u00a0<msmeria>\u00a0I only managed to finished installing the UI for the main wiki  \n16:34\u00a0<msmeria>\u00a0I get the same thing now when I try to migrate a workspace  \n16:34\u00a0<tmortagne>\u00a0msmeria: a workspace is a single XAR imported programmatically  \n16:34\u00a0<msmeria>\u00a0so it may not be related to installing the xar ui after all  \n16:34\u00a0<tmortagne>\u00a0so it's the exact same use case  \n16:35\u00a0<msmeria>\u00a0then it's somehow random as it didn't reproduce for the main wiki just now  \n16:35\u00a0<tmortagne>\u00a0msmeria: I don't understand, you said that you has installed the main wiki using the DW  \n16:36\u00a0<tmortagne>\u00a0s/has/had/  \n16:36\u00a0<msmeria>\u00a0yes, I did  \n16:36\u00a0<tmortagne>\u00a0(when it worked)  \n16:36\u00a0<tmortagne>\u00a0so you don't have a single XAR  \n16:36\u00a0<tmortagne>\u00a0on the main wiki  \n16:36\u00a0<tmortagne>\u00a0from what you said there is nothing random: single XAR -> infinite loop  \n16:37\u00a0<msmeria>\u00a0oh...  \n16:37\u00a0<tmortagne>\u00a0it's not because you installed the main wiki with the DW that the workspaces are going to be clean extension trees  \n16:37\u00a0<tmortagne>\u00a0it's only since the refactoring done by Guillaume in 5.3 that we have properly installed subwikis from extensions point of view  \n16:39\u00a0<msmeria>\u00a0I see  \n16:39\u00a0<msmeria>\u00a0I'll leave you to it then, tmortagne  \n16:40\u00a0<msmeria>\u00a0bye for now  \n16:40\u00a0<msmeria>\u00a0has quit  \n16:40\u00a0<tmortagne>\u00a0msmeria: sure, thanks for the report  \n16:45\u00a0<Kaisen>\u00a0has quit  \n16:53\u00a0<vrachieru>\u00a0has quit  \n16:54\u00a0<sdumitriu1>\u00a0has joined #xwiki  \n16:55\u00a0<Denis>\u00a0has quit  \n17:17\u00a0<sburjan>\u00a0has quit  \n17:18\u00a0<woshilapin>\u00a0has quit  \n17:18\u00a0<woshilapin>\u00a0has joined #xwiki  \n17:32\u00a0<lucaa>\u00a0has quit  \n17:52\u00a0<DarkKnightCZ>\u00a0are there any side-effects for disabling activity stream? now, hibernate generates about 400 selects / second  \n18:01\u00a0<ClemensR>\u00a0any idea what it selects for? I mean which tables ?  \n18:02\u00a0<tmortagne>\u00a0DarkKnightCZ: activity stream table is mostly used for report so that's AS UI itself but also watchlist emails, I don't have much more things in mind  \n18:04\u00a0<tmortagne>\u00a0the AS on the home page is a bit expensive so maybe that's the one generating most of the selects if you have a lot of users accessing it  \n18:04\u00a0<DarkKnightCZ>\u00a0ClemensR: xwikistrings, xwikilargestrings, xwikiintegers mainly, xwikidoc  \n18:04\u00a0<DarkKnightCZ>\u00a0tmortagne: no active users, 65mb of logs, ~10 minutes uptime  \n18:05\u00a0<cjd>\u00a0has quit  \n18:05\u00a0<DarkKnightCZ>\u00a0\\*query logs (mysql general log)  \n18:06\u00a0<tmortagne>\u00a0what kind of log do you have ?  \n18:07\u00a0<tmortagne>\u00a0note that in the first 10 minutes there is a lot of things happening, for example it would be solr or lucene indexing  \n18:07\u00a0<tmortagne>\u00a0what makes you thing it's about activity stream ?  \n18:08\u00a0<tmortagne>\u00a0s/would/could/  \n18:10\u00a0<Kebir>\u00a0has quit  \n18:11\u00a0<DarkKnightCZ>\u00a0currently, i log everything on mysql side... i don't know if its activity stream, i was looking into xwiki and hibernate config and since it specifies AS \"creates biggest load on hibernate\", i thought i would disable it to see if it makes any difference  \n18:12\u00a0<tmortagne>\u00a0if you don't already have a solr index, it scan the whole wiki at startup, would be that if it's a new install or the upgrade of an old wiki  \n18:12\u00a0<tmortagne>\u00a0s/would/could/  \n18:13\u00a0<tmortagne>\u00a0loading a single document produce quite some selects  \n18:13\u00a0<tmortagne>\u00a0so loading all documents...  \n18:14\u00a0<DarkKnightCZ>\u00a0hmm, it looks like solr indeed, New index directory detected: old=null new=/srv/http/shared/storage/solr/./data/index/  \n18:14\u00a0<DarkKnightCZ>\u00a0but directory exists (and it's not first start)  \n18:20\u00a0<ClemensR>\u00a0has quit  \n18:23\u00a0<tmortagne>\u00a0has quit  \n18:23\u00a0<DarkKnightCZ>\u00a0hmm, upon loading simple, it generates about 1000 queries, so something is definitely wrong... what exactly is stored in xwikistrings / xwikilargestrings / xwikiintegers?  \n18:25\u00a0<woshilapin>\u00a0has quit  \n18:29\u00a0<mflorea>\u00a0has quit  \n18:36\u00a0<GuillaumeF>\u00a0has quit  \n18:41\u00a0<DarkKnightCZ>\u00a0has left #xwiki  \n18:43\u00a0<KermitTheFragger>\u00a0has quit  \n18:50\u00a0<andreeapopescu>\u00a0has joined #xwiki  \n19:04\u00a0<Slashman\\_>\u00a0has joined #xwiki  \n19:07\u00a0<Slashman>\u00a0has quit  \n19:16\u00a0<andreeapopescu>\u00a0has quit  \n19:18\u00a0<andreeapopescu>\u00a0has joined #xwiki  \n19:20\u00a0<GuillaumeF>\u00a0has joined #xwiki  \n19:26\u00a0<GuillaumeF>\u00a0has quit  \n19:27\u00a0<GuillaumeF>\u00a0has joined #xwiki  \n19:27\u00a0<Slashman\\_>\u00a0has quit  \n19:28\u00a0<GuillaumeF>\u00a0has quit  \n19:28\u00a0<GuillaumeF>\u00a0has joined #xwiki  \n19:29\u00a0<GuillaumeF>\u00a0has quit  \n19:29\u00a0<GuillaumeF1>\u00a0has joined #xwiki  \n19:37\u00a0<vmassol>\u00a0has quit  \n20:01\u00a0<GuillaumeF1>\u00a0has quit  \n20:07\u00a0<vmassol>\u00a0has joined #xwiki  \n20:09\u00a0<abusenius>\u00a0has joined #xwiki  \n20:11\u00a0<vrachieru>\u00a0has joined #xwiki  \n20:18\u00a0<vmassol>\u00a0has quit  \n20:44\u00a0<vmassol>\u00a0has joined #xwiki  \n20:49\u00a0<vrachieru>\u00a0has quit  \n20:50\u00a0<silverdrop>\u00a0has joined #xwiki  \n20:54\u00a0<Kebir>\u00a0has joined #xwiki  \n22:20\u00a0<andreeapopescu>\u00a0has quit  \n22:20\u00a0<silverdrop>\u00a0has quit  \n22:41\u00a0<Kebir>\u00a0has quit  \n23:00\u00a0<Sidali>\u00a0has quit  \n23:54\u00a0<polx>\u00a0has joined #xwiki\n"}