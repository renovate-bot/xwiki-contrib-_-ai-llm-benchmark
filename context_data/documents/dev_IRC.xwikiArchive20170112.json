{"id": "dev:IRC.xwikiArchive20170112", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20170112", "title": "IRC Archive for channel #xwiki on 12 January 2017 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<woshilapin>\u00a0has quit  \n02:07\u00a0<OSIMasson1>\u00a0has joined #xwiki  \n02:20\u00a0<sdumitriu>\u00a0has quit  \n02:20\u00a0<sdumitriu>\u00a0has joined #xwiki  \n02:22\u00a0<sdumitriu>\u00a0has quit  \n02:22\u00a0<sdumitriu>\u00a0has joined #xwiki  \n03:06\u00a0<sdumitriu>\u00a0has quit  \n03:41\u00a0<sdumitriu>\u00a0has joined #xwiki  \n06:23\u00a0<OSIMasson1>\u00a0has quit  \n06:38\u00a0<mflorea>\u00a0has joined #xwiki  \n08:47\u00a0<vmassol>\u00a0has joined #xwiki  \n09:09\u00a0<claakmann>\u00a0has quit  \n09:09\u00a0<acotiuga>\u00a0has joined #xwiki  \n09:10\u00a0<vmassol>\u00a0has quit  \n09:13\u00a0<vmassol>\u00a0has joined #xwiki  \n09:16\u00a0<mflorea>\u00a0has quit  \n09:17\u00a0<tmortagne>\u00a0has joined #xwiki  \n09:21\u00a0<msmeria>\u00a0has joined #xwiki  \n09:27\u00a0<acotiuga>\u00a0has quit  \n09:27\u00a0<acotiuga>\u00a0has joined #xwiki  \n09:36\u00a0<gdelhumeau>\u00a0has joined #xwiki  \n09:55\u00a0<mflorea>\u00a0has joined #xwiki  \n10:05\u00a0<vmassol1>\u00a0has joined #xwiki  \n10:05\u00a0<vmassol>\u00a0has quit  \n11:11\u00a0<evalica>\u00a0has joined #xwiki  \n11:21\u00a0<Enygma`>\u00a0has joined #xwiki  \n12:08\u00a0<acotiuga>\u00a0has quit  \n12:29\u00a0<vmassol1>\u00a0@mflorea: I've upgraded a wiki from 7.4.3 to 8.4.4 and when I edit a page I get the GWT editor. In the admin, the default editor is left as the default. Any idea what could do this?  \n12:30\u00a0<vmassol>\u00a0has joined #xwiki  \n12:30\u00a0<vmassol1>\u00a0has quit  \n12:31\u00a0<vmassol>\u00a0(sorry was disconnected)  \n12:35\u00a0<mflorea>\u00a0vmassol: No idea. Check if there are multiple instances of XWiki.EditorBindingClass added to the XWiki.XWikiPreferences page.  \n12:35\u00a0<vmassol>\u00a0ok otp, I'll check after, thx  \n12:35\u00a0<mflorea>\u00a0going to lunch, ttyl  \n12:44\u00a0<Craeckie[m]>\u00a0has left #xwiki  \n12:44\u00a0<blabla2[m]>\u00a0has left #xwiki  \n12:44\u00a0<M-yflory>\u00a0has left #xwiki  \n12:44\u00a0<jihad[m]>\u00a0has left #xwiki  \n12:44\u00a0<M-vmassol>\u00a0has left #xwiki  \n12:44\u00a0<M-mouhb>\u00a0has left #xwiki  \n13:16\u00a0<Slashman>\u00a0has joined #xwiki  \n13:42\u00a0<acotiuga>\u00a0has joined #xwiki  \n14:14\u00a0<evalica1>\u00a0has joined #xwiki  \n14:17\u00a0<evalica>\u00a0has quit  \n14:23\u00a0<msmeria1>\u00a0has joined #xwiki  \n14:24\u00a0<msmeria>\u00a0has quit  \n14:25\u00a0<vmassol>\u00a0mflorea: back, there's only such xobject  \n14:26\u00a0<vmassol>\u00a0I had a clean XWiki 7.4.3 instance with no changes and I upgraded to 8.4.4, no pages changed  \n14:26\u00a0<vmassol>\u00a0I can get CKEDitor if I force it in the admin UI  \n14:28\u00a0<mflorea>\u00a0and if you put it back to default ('--') you get GWT?  \n14:29\u00a0<vmassol>\u00a0yes  \n14:35\u00a0<mflorea>\u00a0you don't have any \"edit.defaultEditor.\\*\" in your xwiki.properties right?  \n14:41\u00a0<vmassol>\u00a0checking  \n14:41\u00a0<vmassol>\u00a0but since it's a clean instance probably not  \n14:43\u00a0<vmassol>\u00a0hmmm  \n14:43\u00a0<vmassol>\u00a0trying to find it  \n14:43\u00a0<mflorea>\u00a0vmassol: if there's no explicit wysiwyg editor set either in XWikiPreferences or in xwiki.properties then the first editor available is used. And by available I mean cm.getInstanceList(editorType).get(0) (not exactly like this but you get the point). So the order depends on how the editors have been registered and how the CM keeps the components registered under the hood.  \n14:44\u00a0<mflorea>\u00a0the issue I had is that I could not hard-code CKEditor in the platform code  \n14:44\u00a0<vmassol>\u00a0so we set a default in xwiki.properties?  \n14:44\u00a0<vmassol>\u00a0since by default we get CK  \n14:45\u00a0<mflorea>\u00a0we don't the wysiwyg editor in xwiki.properties  \n14:45\u00a0<mflorea>\u00a0actually we do it, but only for tests, because we run the tests with the GWT editor  \n14:45\u00a0<vmassol>\u00a0I don't undestand then  \n14:46\u00a0<vmassol>\u00a0you said \"if there's no explicit wysiwyg editor set either in XWikiPreferences or in xwiki.properties then the first editor available is used.\"  \n14:46\u00a0<vmassol>\u00a0so how can we guarantee that CK is the default?`  \n14:47\u00a0<mflorea>\u00a0I thought the order the CM returns the editor in this case is deterministic, i.e. it's always the same, so CKEditor would be the first, but it seems it's not the case, and in your instance, GWT is first in the list  \n14:48\u00a0<mflorea>\u00a0most probably  \n14:49\u00a0<mflorea>\u00a0on my instance, CK is the first, and I haven't set it explicitly  \n14:49\u00a0<vmassol>\u00a0you could try doing the same thing as I've done to check if you have th eproblem too  \n14:49\u00a0<vmassol>\u00a0take 7.4.3 and upgrade to 8.4.4  \n14:50\u00a0<vmassol>\u00a0now  \n14:50\u00a0<vmassol>\u00a0we need to decide if we want to do anything about it  \n14:50\u00a0<vmassol>\u00a0possibly not  \n14:50\u00a0<mflorea>\u00a0even if I don't have the problem, it could be related to how java keeps the older of a map internally  \n14:50\u00a0<vmassol>\u00a0hmmm  \n14:50\u00a0<mflorea>\u00a0s/older/order  \n14:50\u00a0<vmassol>\u00a0we'll still need to live with 8.4.x for at least a year  \n14:50\u00a0<vmassol>\u00a0it'll be our LTS for a year I mean  \n14:51\u00a0<vmassol>\u00a0so I should probably raise a jira  \n14:51\u00a0<vmassol>\u00a0wdyt?  \n14:51\u00a0<mflorea>\u00a0yes, we need to set CKEditor explicitly, but we need to see how/where  \n14:51\u00a0<mflorea>\u00a0as I said, we can't do it from platform  \n14:51\u00a0<mflorea>\u00a0we have to do it from XE  \n14:52\u00a0<mflorea>\u00a0which brings the CKEditor dep  \n14:54\u00a0<mflorea>\u00a0so we need to configure CKEditor from xwiki.properties, when building XE  \n14:59\u00a0<mflorea>\u00a0for tests we modify xwiki.properties from Java, but for this we need to modify xwiki.properties from xwiki-enterprise-web I guess  \n15:09\u00a0<raphael29\\_>\u00a0has joined #xwiki  \n15:31\u00a0<ClemensR>\u00a0has joined #xwiki  \n15:45\u00a0<vmassol>\u00a0mflorea: created http://jira.xwiki.org/browse/XE-1603  \n15:45\u00a0<woshilapin>\u00a0has joined #xwiki  \n15:47\u00a0<mflorea>\u00a0vmassol: it seems we do set CKEditor explicitly https://github.com/xwiki/xwiki-enterprise/blob/xwiki-enterprise-8.4.4/pom.xml#L110 . We need to see why it's not set in your case  \n15:48\u00a0<mflorea>\u00a0if I build xwiki-enterprise-web locally I get the property in xwiki.properties  \n15:50\u00a0<mflorea>\u00a0edit.defaultEditor.org.xwiki.rendering.syntax.SyntaxContent#wysiwyg=ckeditor  \n15:50\u00a0<mflorea>\u00a0edit.defaultEditor.org.xwiki.rendering.block.XDOM#wysiwyg=ckeditor  \n15:53\u00a0<mflorea>\u00a0vmassol: I just checked the 8.4.4 war and jetty-hsqldb zip and both have ckeditor explicitly set in xwiki.properties  \n15:54\u00a0<mflorea>\u00a0are you sure you don't have these properties in your xwiki.properties?  \n15:54\u00a0<mflorea>\u00a0see above  \n15:54\u00a0<mflorea>\u00a0because if you don't have them then it explains the problem  \n15:55\u00a0<vmassol>\u00a0checking  \n15:55\u00a0<vmassol>\u00a0rechecking  \n15:58\u00a0<vmassol>\u00a0ok I don't have them. Not sure why but I don't have them which explains it. My mistake in our discussion is that I didn't think we were setting anything in xwiki.prpoerties because it's our rule that this file can be empty and that we should always have default values configured in it.  \n15:58\u00a0<vmassol>\u00a0closing the issue  \n16:00\u00a0<vmassol>\u00a0(mflorea)  \n16:01\u00a0<mflorea>\u00a0vmassol: ok. you're right about the rule, but CKEditor is a special case.  \n16:02\u00a0<vmassol>\u00a0mflorea: why not force it in XWikiProperties?  \n16:03\u00a0<mflorea>\u00a0XWikiProperties is auto-generated, and it is in platform.  \n16:03\u00a0<vmassol>\u00a0ah yes  \n16:03\u00a0<mflorea>\u00a0it's a mandatory class  \n16:03\u00a0<vmassol>\u00a0so  \n16:03\u00a0<vmassol>\u00a0we could have provided another config class  \n16:03\u00a0<vmassol>\u00a0\\*config pazge  \n16:04\u00a0<mflorea>\u00a0we use another config class  \n16:04\u00a0<vmassol>\u00a0I meant page  \n16:04\u00a0<vmassol>\u00a0ie not in XWikiPreferences  \n16:04\u00a0<vmassol>\u00a0it's actually our rule to not use XWikiPreferences anymore  \n16:04\u00a0<vmassol>\u00a0:)  \n16:04\u00a0<vmassol>\u00a0and to introduce discrete \\*Config pages  \n16:05\u00a0<vmassol>\u00a0re xwiki.properties we should be able to remove the setting once we remove GWT in 9.x  \n16:06\u00a0<mflorea>\u00a0well, discrete \\*config pages work when you have only global config. In this case you can change the config per space, so you need to have a configuran page per space. It was natural to use the \"preference page\" to hold this configuration  \n16:07\u00a0<mflorea>\u00a0i.e. the WebPreference for spaces, and XWikiPreferences for wiki  \n16:10\u00a0<sorinello>\u00a0has quit  \n16:10\u00a0<sorinello>\u00a0has joined #xwiki  \n16:10\u00a0<sorinello>\u00a0has quit  \n16:10\u00a0<sorinello>\u00a0has joined #xwiki  \n16:12\u00a0<simfir>\u00a0has joined #xwiki  \n16:19\u00a0<msmeria1>\u00a0has quit  \n16:21\u00a0<msmeria>\u00a0has joined #xwiki  \n16:35\u00a0<vmassol>\u00a0has quit  \n16:54\u00a0<vmassol>\u00a0has joined #xwiki  \n17:01\u00a0<Slashman>\u00a0has quit  \n17:14\u00a0<Slashman>\u00a0has joined #xwiki  \n17:18\u00a0<acotiuga>\u00a0has quit  \n17:41\u00a0<msmeria>\u00a0has quit  \n17:48\u00a0<ClemensR>\u00a0has left #xwiki  \n18:06\u00a0<vmassol>\u00a0has quit  \n18:06\u00a0<OSIMasson1>\u00a0has joined #xwiki  \n18:17\u00a0<gdelhumeau>\u00a0has quit  \n18:24\u00a0<tmortagne>\u00a0has quit  \n18:31\u00a0<vmassol>\u00a0has joined #xwiki  \n19:16\u00a0<mflorea>\u00a0has quit  \n19:56\u00a0<sdumitriu>\u00a0has quit  \n20:00\u00a0<sdumitriu>\u00a0has joined #xwiki  \n20:09\u00a0<OSIMasson1>\u00a0has quit  \n20:31\u00a0<Slashman>\u00a0has quit  \n20:57\u00a0<OSIMasson1>\u00a0has joined #xwiki  \n20:59\u00a0<evalica1>\u00a0has quit  \n21:01\u00a0<OSIMasson1>\u00a0has quit  \n21:09\u00a0<Enygma`>\u00a0has quit  \n21:29\u00a0<raphael29\\_>\u00a0has quit  \n23:19\u00a0<vmassol>\u00a0has quit\n"}