{"id": "dev:IRC.xwikiArchive20110915", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20110915", "title": "IRC Archive for channel #xwiki - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n01:09\u00a0<pturcotte>\u00a0has joined #xwiki  \n01:20\u00a0<jvdrean>\u00a0has quit  \n01:43\u00a0<rrodriguez>\u00a0has quit  \n04:11\u00a0<+mflorea>\u00a0sdumitriu: ping  \n04:12\u00a0<@sdumitriu>\u00a0Pong  \n04:14\u00a0<@sdumitriu>\u00a0mflorea: You're up early  \n04:14\u00a0<+mflorea>\u00a0:)  \n04:14\u00a0<+mflorea>\u00a0I haven't slept  \n04:14\u00a0<+mflorea>\u00a0would be awesome if you can find the time to review my last two commits (real commits, not the merge) on feature-sheets branch, see https://github.com/xwiki/xwiki-platform/commits/feature-sheets  \n04:14\u00a0<+mflorea>\u00a0this one is the most important https://github.com/xwiki/xwiki-platform/commit/aca51893724cb5203e5c7f5cbecdd62d91ec0a1c  \n04:15\u00a0<@sdumitriu>\u00a0OK  \n04:15\u00a0<@sdumitriu>\u00a0After that, you're all set for this release  \n04:15\u00a0<@sdumitriu>\u00a0?  \n04:15\u00a0<+mflorea>\u00a0from the second one https://github.com/xwiki/xwiki-platform/commit/783b42800eb70d883c2b6cc8383dfea2d1026761 the SheetDocumentDisplayer class is interesting  \n04:17\u00a0<+mflorea>\u00a0yes, I'm 90% done. What I still need to do is revert some changes to the velocity templates that I previously did on feature-sheets branch and that I don't need anymore (because the sheet is now automatically applied when getRenderedContent is called).  \n04:17\u00a0<+mflorea>\u00a0but I'll do this after I sleep a few hours  \n04:21\u00a0<@sdumitriu>\u00a0OK Marius  \n04:22\u00a0<@sdumitriu>\u00a0I hope at least you're not still at the office  \n04:22\u00a0<+mflorea>\u00a0btw, if you want to test on a 3.2 snapshot, you need \\_only\\_ the jars: xwiki-platform-legacy-oldcore (including of course the modified xwiki-platform-oldcore), xwiki-platform-display, xwiki-platform-sheet-api and xwiki-platform-rendering-macro-include. You can test by editing Blog.BlogIntroduction and deleting the content (the include macro)  \n04:22\u00a0<+mflorea>\u00a0nop :) I'm at home  \n04:23\u00a0<+mflorea>\u00a0ok, going to sleep  \n04:23\u00a0<@sdumitriu>\u00a0Bye  \n04:24\u00a0<mflorea>\u00a0has quit  \n04:30\u00a0<Denis>\u00a0has quit  \n04:30\u00a0<DrLou>\u00a0has joined #xwiki  \n04:42\u00a0<DrLou>\u00a0has quit  \n07:46\u00a0<mflorea>\u00a0has joined #xwiki  \n07:46\u00a0<@sdumitriu>\u00a0mflorea: Up already?  \n07:46\u00a0<+mflorea>\u00a0:)  \n07:46\u00a0<+mflorea>\u00a0yep  \n07:47\u00a0<finbrein>\u00a0has joined #xwiki  \n07:47\u00a0<@sdumitriu>\u00a0Good, I have a question  \n07:47\u00a0<+mflorea>\u00a0shoot  \n07:47\u00a0<@sdumitriu>\u00a0How does a blog post know which sheet to use?  \n07:47\u00a0<@sdumitriu>\u00a0I don't see anything in the blog post document, in the sheet, or in the class  \n07:50\u00a0<+mflorea>\u00a0The sheet manager knows: the blog post has an object of \u00a0type BlogPostClass, and the manager looks for a sheet for this class. If it can't find any explicit bindings it fall-back on naming convention BlogPostClass -> BlogPostSheet and since BlogPostSheet exists it assumes it is the expected sheet  \n07:51\u00a0<@sdumitriu>\u00a0Ah, indeed  \n07:51\u00a0<@sdumitriu>\u00a0Forgot about that  \n08:06\u00a0<@cjdelisle>\u00a0http://blogs.davenportlibrary.com/kids/wp-content/calvin-hobbes-christmas-tree.gif  \n08:20\u00a0<@sdumitriu>\u00a0Mixing git index-filter, git update-index, bash, sed, regular expressions...  \n08:20\u00a0<@sdumitriu>\u00a0This is getting interesting  \n08:30\u00a0<vmassol>\u00a0has joined #xwiki  \n08:38\u00a0<tmortagne>\u00a0has joined #xwiki  \n09:20\u00a0<@sdumitriu>\u00a0vmassol: Finally, I have something to extract a module with a clean history  \n09:20\u00a0<@sdumitriu>\u00a0A bit faster than tree-filter  \n09:21\u00a0<@sdumitriu>\u00a0mflorea: I'm going to catch some sleep, I'll continue to review tomorrow  \n09:21\u00a0<@sdumitriu>\u00a0(later today for you)  \n09:21\u00a0<+mflorea>\u00a0great. I'm cleaning up my changes in the mean time (especially the velocity template changes)  \n09:22\u00a0<@sdumitriu>\u00a0By the way, I use this to see all the changes:  \n09:22\u00a0<@sdumitriu>\u00a0https://github.com/xwiki/xwiki-platform/compare/master...feature-sheets  \n09:22\u00a0<+mflorea>\u00a0yep, me too  \n09:22\u00a0<+mflorea>\u00a0I'm going now through all the changes  \n09:24\u00a0<@cjdelisle>\u00a0I think I found the problem with panels on myxwiki, someone's redefining panelheader and it's breaking it for everyone.  \n09:25\u00a0<@sdumitriu>\u00a0cjdelisle: Yes, it's known  \n09:25\u00a0<@sdumitriu>\u00a0It's old  \n09:25\u00a0<@sdumitriu>\u00a0Tried to find who exactly redefines it but couldn't find anything  \n09:25\u00a0<@sdumitriu>\u00a0I searched in the database files (on the filesystem) directly without any luck  \n09:27\u00a0<@cjdelisle>\u00a0it's breaking the update to 3.2 royally  \n09:28\u00a0<@sdumitriu>\u00a0Why? It used to be like this since a long time ago  \n09:28\u00a0<@sdumitriu>\u00a0And the only solution is to restart tomcat  \n09:28\u00a0<@cjdelisle>\u00a0rewriting the macros in syntax 2.0 makes them fail miserably  \n09:29\u00a0<@cjdelisle>\u00a0and they are in syntax2.0 in the version 3.2  \n09:29\u00a0<sdumitriu>\u00a0has quit  \n09:30\u00a0<+tmortagne>\u00a0s/macros/panels/ ?  \n09:32\u00a0<@cjdelisle>\u00a0it's the #panelheader macro that's overridden somewhere  \n09:32\u00a0<@cjdelisle>\u00a0I thought that had been fixed  \n09:33\u00a0<+tmortagne>\u00a0yes it should be fixed  \n09:33\u00a0<+tmortagne>\u00a0normally each page load macros in its own velocity namespace  \n09:33\u00a0<+tmortagne>\u00a0and pretty sure there is unit tests for it  \n09:33\u00a0<@cjdelisle>\u00a0maybe it's a syntax1.0 thing?  \n09:34\u00a0<+tmortagne>\u00a0supposed to be the same whatever the syntaxe  \n09:34\u00a0<+tmortagne>\u00a0it's done at getRenderedContent level  \n09:34\u00a0<+tmortagne>\u00a0hmm wodering if that's really done properly for panels actually  \n09:34\u00a0<@cjdelisle>\u00a0anyway I thought overriding anything in macros.vm was explicitly forbidden  \n09:35\u00a0<+tmortagne>\u00a0cjdelisle: not sure there is really a way to explocitely forbid that  \n09:35\u00a0<@cjdelisle>\u00a0{{velocity}}{{{ #panelheader('hai') }}}{{/velocity}} pasted into a page shows the overridden version  \n09:36\u00a0<+tmortagne>\u00a0it depends what namespace is use for where this velocity macro is redifined  \n09:37\u00a0<+tmortagne>\u00a0if it's root namespace then yes you are going to see in even in pages  \n09:37\u00a0<+tmortagne>\u00a0that would indicate it's not in a page  \n09:38\u00a0<+tmortagne>\u00a0but I don't see where else  \n09:38\u00a0<@cjdelisle>\u00a0I wonder if it's in a skin override attachment?  \n09:38\u00a0<+tmortagne>\u00a0even if that would explain why sdumitriu ccould not find it in the db  \n09:38\u00a0<@cjdelisle>\u00a0I don't really understand skin attachments, they are zip files?  \n09:38\u00a0<+tmortagne>\u00a0maybe, not sure what is used to execute skin overrides  \n09:41\u00a0<@cjdelisle>\u00a0if they are zipped then that would at least explain why it was never found.  \n09:43\u00a0<+tmortagne>\u00a0in any case if anyone can redefine a farm velocity macro in his subwiki skin zipped or not it's a bug to fix  \n09:44\u00a0<+tmortagne>\u00a0right now the velocity namespace is set for the page content rendering but should be set for the whole page display I think  \n09:44\u00a0<+tmortagne>\u00a0that's probably the issue  \n09:51\u00a0<sburjan>\u00a0has joined #xwiki  \n10:32\u00a0<jvdrean>\u00a0has joined #xwiki  \n11:40\u00a0<vmassol>\u00a0mflorea: I see you're modifying some app (like the blog app). What happens if someone updates to XE 3.2 final but doesn't update the blog app for ex. Will it continue to work?  \n11:41\u00a0<vmassol>\u00a0(want to be sure we're backward compatible at the page level)  \n11:42\u00a0<+mflorea>\u00a0yep, it should work fine. I update the blog (and I updating the administration app) just for the proof of concept  \n11:43\u00a0<vmassol>\u00a0ok good  \n11:43\u00a0<vmassol>\u00a0thanks  \n11:46\u00a0<pturcotte>\u00a0has quit  \n12:11\u00a0<+tmortagne>\u00a0sburjan: BTW I added some stuff in the demo UI of EM yesterday and this morning  \n12:11\u00a0<+tmortagne>\u00a0no new features, just exposing more information  \n12:23\u00a0<jvdrean>\u00a0has quit  \n12:27\u00a0<@cjdelisle>\u00a0restarting myxwiki to enable debug logging on the velocity engine to find where the macro is redefined.  \n12:28\u00a0<vmassol>\u00a0k  \n12:33\u00a0<+sburjan>\u00a0tmortagne: I will test it next week  \n12:33\u00a0<+sburjan>\u00a0guys, it seems we are getting spammed on the dev list  \n12:33\u00a0<vmassol>\u00a0sburjan: used to get spam I think  \n12:33\u00a0<+sburjan>\u00a0with forgery web sites  \n12:33\u00a0<vmassol>\u00a0hmm unless my spam filter is removing them  \n12:34\u00a0<+sburjan>\u00a0[[email\u00a0protected]](https://dev.xwiki.org/cdn-cgi/l/email-protection)  \n12:34\u00a0<+sburjan>\u00a0is the sender e-mail address  \n12:34\u00a0<vmassol>\u00a0yep I'ver emoved that user  \n12:34\u00a0<vmassol>\u00a0check the mails  \n12:34\u00a0<vmassol>\u00a0they must be old  \n12:34\u00a0<+sburjan>\u00a03 days ago  \n12:34\u00a0<vmassol>\u00a0yep  \n12:34\u00a0<+sburjan>\u00a0cool  \n12:34\u00a0<vmassol>\u00a0that's old :)  \n12:38\u00a0<+sburjan>\u00a0;)  \n12:44\u00a0<@cjdelisle>\u00a02011-09-15 10:43:49,548 [http://evrueppurr.myxwiki.org/xwiki/bin/view/Blog/] DEBUG o.x.v.i.DefaultVelocityEngine \u00a0- Velocimacro : added VM panelheader: source=/templates/macros.vm  \n12:45\u00a0<@cjdelisle>\u00a0foundit  \n12:45\u00a0<vmassol>\u00a0nice catch!  \n12:45\u00a0<@cjdelisle>\u00a0or maybe not, it says \"added\" not overridden  \n12:46\u00a0<@cjdelisle>\u00a0I'll look carefully at that subwiki anyway  \n13:08\u00a0<@cjdelisle>\u00a0http://xwikiday.myxwiki.org/  \n13:08\u00a0<@cjdelisle>\u00a0nice web design  \n13:08\u00a0<vmassol>\u00a0yep that was a wiki done by XWiki SAS  \n13:09\u00a0<vmassol>\u00a0(not used anymore ATM)  \n13:10\u00a0<@cjdelisle>\u00a0I'm just loading all of the pages looking for anything else which reports overriding those macros  \n13:10\u00a0<@cjdelisle>\u00a0\\*each wiki  \n13:25\u00a0<@cjdelisle>\u00a0http://slussen.myxwiki.org/xwiki/bin/edit/Main/SlussenSkin?editor=object  \n13:26\u00a0<@cjdelisle>\u00a0bingo  \n13:26\u00a0<@cjdelisle>\u00a02011-09-15 11:23:27,092 [http://slussen.myxwiki.org/xwiki/bin/view/Start/WebHome] DEBUG o.x.v.i.DefaultVelocityEngine \u00a0- Velocimacro : added VM panelheader: source=  \n13:27\u00a0<vmassol>\u00a0that rings a bell, I think I had found this wiki before  \n13:27\u00a0<vmassol>\u00a0sergiu looked at it AFAIR but said that wasn't the problem. Anyway I don't fully remember  \n13:30\u00a0<jvdrean>\u00a0has joined #xwiki  \n13:36\u00a0<jvelociter>\u00a0has joined #xwiki  \n13:41\u00a0<@cjdelisle>\u00a0yup, I'm 99% sure that's the one, it has the same onclick= that's showing up in the macro  \n13:43\u00a0<vmassol>\u00a0k cool  \n13:45\u00a0<@cjdelisle>\u00a0it looks like it would be pretty difficult work around it in their skin without breaking them but I'll see if I can repeat the problem and maybe we can get a quick fix rolled out.  \n13:47\u00a0<vmassol>\u00a0sounds good  \n13:57\u00a0<+sburjan>\u00a0maven.xwiki.org is down ?  \n13:57\u00a0<+sburjan>\u00a0no, just slow  \n13:59\u00a0<@cjdelisle>\u00a0XWIKI-6972  \n14:05\u00a0<@cjdelisle>\u00a0restarting myxwiki with debug logging in velocity removed so we don'e end up with 10GB of logs  \n14:18\u00a0<+mflorea>\u00a0vmassol: I'm ready to merge the feature-sheets branch  \n14:18\u00a0<vmassol>\u00a0mflorea: ok...  \n14:18\u00a0<DrLou>\u00a0has joined #xwiki  \n14:18\u00a0<+mflorea>\u00a0let's see how it goes  \n14:20\u00a0<@cjdelisle>\u00a0I kind of feel like I need a new way of visualizing code to trace an execution path through oldcore  \n14:25\u00a0<pturcotte>\u00a0has joined #xwiki  \n14:54\u00a0<@cjdelisle>\u00a0return XWikiVelocityRenderer.evaluate(content, \"\", (VelocityContext) context.get(\"vcontext\"),  \n14:54\u00a0<@cjdelisle>\u00a0(in parseTemplate(String template, String skin, XWikiContext context))  \n14:54\u00a0<@cjdelisle>\u00a0\"\" <-- put in root namespace  \n15:06\u00a0<sdumitriu>\u00a0has joined #xwiki  \n15:06\u00a0<@cjdelisle>\u00a0sdumitriu: I think I found it: http://slussen.myxwiki.org/xwiki/bin/edit/Main/SlussenSkin?editor=object  \n15:07\u00a0<@sdumitriu>\u00a0Yep, I thought that too for a long time  \n15:07\u00a0<@sdumitriu>\u00a0But it's not that one  \n15:08\u00a0<@sdumitriu>\u00a0I mean it wasn't the one that was causing problems before  \n15:08\u00a0<@cjdelisle>\u00a0how do you know?  \n15:08\u00a0<@sdumitriu>\u00a0It does redefine the macros, true  \n15:08\u00a0<@sdumitriu>\u00a0So it is causing your problem  \n15:08\u00a0<@sdumitriu>\u00a0But there's another one that was messing things up even worse  \n15:09\u00a0<@cjdelisle>\u00a0XWIKI-6972  \n15:12\u00a0<@cjdelisle>\u00a0https://github.com/xwiki/xwiki-platform/blob/master/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/XWiki.java#L1832  \n15:13\u00a0<@cjdelisle>\u00a0if someone defines a skin document, that shouldn't be put in the root namespace correct?  \n15:14\u00a0<@sdumitriu>\u00a0I wonder what would break if we set a proper namespace there  \n15:15\u00a0<@cjdelisle>\u00a0I think the namespace should be: \u00a0Wiki:Space.SkinName  \n15:16\u00a0<@cjdelisle>\u00a0Since header is parsed every time a page is loaded with a skin applied, it shouldn't be possible to break the header  \n15:17\u00a0<@cjdelisle>\u00a0I suppose there might be things which define macros in the footer and expect them to work above the footer and there's a possibility of them breaking but is that going to be very common?  \n15:20\u00a0<@cjdelisle>\u00a0I guess I have to look more closely at how velocity handles namespaces  \n16:38\u00a0<+mflorea>\u00a0tmortagne: do you know why http://ci.xwiki.org/job/xwiki-platform/org.xwiki.platform$xwiki-platform-extension-repository-aether/630/testReport/org.xwiki.extension.repository.aether.internal/AetherDefaultRepositoryManagerTest/testResolve/ is failing?  \n16:38\u00a0<+tmortagne>\u00a0mflorea: sounds like a missing push :)  \n16:38\u00a0<+tmortagne>\u00a0it's the last build ?  \n16:38\u00a0<+tmortagne>\u00a0checking  \n16:39\u00a0<+mflorea>\u00a0it is failing for the past 4 builds  \n16:39\u00a0<+mflorea>\u00a0I hope it's not related to my branch merge  \n16:40\u00a0<+tmortagne>\u00a0ha no looks like a fixed one test and not the other  \n16:40\u00a0<+tmortagne>\u00a0it's not your fault for sure ;)  \n16:40\u00a0<+mflorea>\u00a0good  \n16:40\u00a0<+mflorea>\u00a0:)  \n16:41\u00a0<+mflorea>\u00a0I'm waiting to see if there are any functional tests failing after the merge, but I need platform to build first  \n16:43\u00a0<+tmortagne>\u00a0mflorea: should be ok now  \n16:43\u00a0<+mflorea>\u00a0great, thanks  \n16:44\u00a0<+tmortagne>\u00a0ha there is not only failing tests  \n16:44\u00a0<+tmortagne>\u00a0Caused by: org.sonatype.aether.transfer.ArtifactNotFoundException: Could not find artifact org.xwiki.platform:xwiki-platform-display:jar:3.2-SNAPSHOT in xwiki-snapshots (http://nexus.xwiki.org/nexus/content/groups/public-snapshots)  \n16:44\u00a0<+tmortagne>\u00a0:)  \n16:45\u00a0<+mflorea>\u00a0nexus cache issue?  \n16:45\u00a0<+mflorea>\u00a0no :) my fault  \n16:45\u00a0<+mflorea>\u00a0fixing it  \n16:46\u00a0<+mflorea>\u00a0n00b mistake  \n16:46\u00a0<@sdumitriu>\u00a0Forgot to add it as a submodule to the platform pom?  \n16:46\u00a0<+mflorea>\u00a0yep  \n16:46\u00a0<+mflorea>\u00a0:)  \n17:01\u00a0<vmassol>\u00a0sdumitriu: I'd like to start creating a feature branch in platform for the new model and thus move the model I've put in \u00a0xwiki-contrib/sandbox into my platform branch. I was thinking that preserving history would be nice. Could I use your script to do that?  \n17:02\u00a0<@sdumitriu>\u00a0Yes  \n17:02\u00a0<@sdumitriu>\u00a0Let me clean it up  \n17:04\u00a0<vmassol>\u00a0ok thanks  \n17:04\u00a0<vmassol>\u00a0guys do we still need the \"remotes/origin/enabled-csrf-protection\" branch?  \n17:05\u00a0<@sdumitriu>\u00a0Probably not, it was merged IIRC  \n17:05\u00a0<@sdumitriu>\u00a0Checking  \n17:05\u00a0<vmassol>\u00a0ah yes github compare  \n17:06\u00a0<@sdumitriu>\u00a0Yep, all merged  \n17:06\u00a0<@sdumitriu>\u00a0I did git cherry HEAD refs/remotes/origin/enabled-csrf-protection  \n17:07\u00a0<vmassol>\u00a0ah nice didn't know about this  \n17:33\u00a0<@sdumitriu>\u00a0vmassol: Where do you want the module to appear after extracting it? Root of the repo, /xwiki-model/, xwiki-platform-core/xwiki-platform-model/, something else?  \n17:34\u00a0<+jvdrean>\u00a0Hi, do we have know issues with $xwiki.copyDocument in 3.1 ?  \n17:41\u00a0<vmassol>\u00a0sdumitriu: xwiki-platform-core/xwiki-platform-model/  \n17:42\u00a0<@sdumitriu>\u00a0This one already exists  \n17:42\u00a0<vmassol>\u00a0yes  \n17:42\u00a0<@sdumitriu>\u00a0You will get conflicts when mergin, I think  \n17:42\u00a0<vmassol>\u00a0not really  \n17:42\u00a0<@sdumitriu>\u00a0OK  \n17:42\u00a0<vmassol>\u00a0because in sandbox they're in differnet modules  \n17:42\u00a0<vmassol>\u00a0I'll need to do the merge locally anywya but it'll be a simpl eone  \n17:43\u00a0<vmassol>\u00a0sdumitriu: I want to merge this in my branch, not on master (just making sure)  \n17:43\u00a0<@sdumitriu>\u00a0OK  \n17:44\u00a0<@sdumitriu>\u00a0Sending you the script after I check it works  \n17:44\u00a0<vmassol>\u00a0k thanks  \n17:59\u00a0<tmortagne>\u00a0has quit  \n18:01\u00a0<@sdumitriu>\u00a0vmassol: Sent  \n18:02\u00a0<@sdumitriu>\u00a0Report any problems you have  \n18:44\u00a0<vmassol>\u00a0sdumitriu: thanks  \n18:45\u00a0<@sdumitriu>\u00a0Works?  \n18:45\u00a0<vmassol>\u00a0was away haven't tried yet  \n18:45\u00a0<vmassol>\u00a0will let you know  \n18:47\u00a0<vmassol>\u00a0sburjan: fyi XE-1016  \n18:49\u00a0<+sburjan>\u00a0looks nice  \n18:49\u00a0<+sburjan>\u00a0Improvements in the mouse emulation (movement, click, double click, context  \n18:49\u00a0<+sburjan>\u00a0click)  \n18:51\u00a0<+sburjan>\u00a0this should be nice, but I don't know if select text within a container WebElement is implemented  \n19:34\u00a0<sburjan>\u00a0has quit  \n19:42\u00a0<vmassol>\u00a0has quit  \n20:35\u00a0<lpereira>\u00a0has joined #xwiki  \n20:58\u00a0<DrLou>\u00a0has quit  \n21:01\u00a0<vmassol>\u00a0has joined #xwiki  \n21:04\u00a0<DrLou>\u00a0has joined #xwiki  \n21:27\u00a0<vmassol>\u00a0mflorea: hi  \n21:27\u00a0<vmassol>\u00a0I see you've used this for creating a logger:  \n21:27\u00a0<vmassol>\u00a0private static final Logger LOGGER = LoggerFactory.getLogger(ConfiguredDocumentDisplayer.class);  \n21:27\u00a0<+mflorea>\u00a0yes  \n21:27\u00a0<vmassol>\u00a0but the best way is:  \n21:27\u00a0<vmassol>\u00a0@Inject Logger logger;  \n21:27\u00a0<vmassol>\u00a0s/best/canonical  \n21:28\u00a0<+mflorea>\u00a0nice..  \n21:28\u00a0<+mflorea>\u00a0wasn't aware of this  \n21:28\u00a0<+mflorea>\u00a0I'll update my code  \n21:28\u00a0<vmassol>\u00a0ok cool  \n21:28\u00a0<vmassol>\u00a0btw I've added missing @Singleton  \n21:28\u00a0<+mflorea>\u00a0thanks  \n21:29\u00a0<vmassol>\u00a0@Inject private Logger logger;  \n21:29\u00a0<vmassol>\u00a0(missed \"private\" above)  \n21:29\u00a0<+mflorea>\u00a0right  \n21:33\u00a0<vmassol>\u00a0mflorea: another point  \n21:33\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0String format = \"Failed to lookup document displayer with hint [%s]. Using default document displayer.\";  \n21:33\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0LOGGER.warn(String.format(format, documentDisplayerHint));  \n21:34\u00a0<vmassol>\u00a0the best practice is to use:  \n21:34\u00a0<vmassol>\u00a0this.logger.warn(\"Failed to lookup document displayer with hint {}. Using default document displayer.\", documentDisplayerHint);  \n21:35\u00a0<+mflorea>\u00a0nice, but what if I want to also log the exception?  \n21:35\u00a0<+mflorea>\u00a0ie. warn(String, Throwable)  \n21:36\u00a0<+mflorea>\u00a0but maybe that is not needed  \n21:36\u00a0<vmassol>\u00a0well in this example you're not logging the exception  \n21:36\u00a0<+mflorea>\u00a0sure  \n21:36\u00a0<vmassol>\u00a0now they're missing an api  \n21:36\u00a0<vmassol>\u00a0AFAIK  \n21:36\u00a0<vmassol>\u00a0I'm nt sure why  \n21:36\u00a0<+mflorea>\u00a0I'm wondering about the cases when the exception is also logged  \n21:36\u00a0<vmassol>\u00a0maybe they support it  \n21:37\u00a0<vmassol>\u00a0maybe http://www.slf4j.org/apidocs/org/slf4j/Logger.html#warn(java.lang.String, java.lang.Object, java.lang.Object)  \n21:37\u00a0<vmassol>\u00a0maybe the first or second param can be an exception  \n21:37\u00a0<vmassol>\u00a0I need to google a bit  \n21:37\u00a0<vmassol>\u00a0I don't know the answer  \n21:37\u00a0<+mflorea>\u00a0anyway, it's not that important to log the exception for a warning  \n21:38\u00a0<vmassol>\u00a0found it  \n21:38\u00a0<vmassol>\u00a0http://www.slf4j.org/faq.html#paramException  \n21:38\u00a0<vmassol>\u00a0as the last param  \n21:38\u00a0<vmassol>\u00a0:)  \n21:38\u00a0<+mflorea>\u00a0:) nice  \n21:39\u00a0<+mflorea>\u00a0I'll update the code  \n21:39\u00a0<+mflorea>\u00a0thanks  \n21:39\u00a0<vmassol>\u00a0but yes  \n21:39\u00a0<vmassol>\u00a0we shouldn't print stack trace with warnings  \n21:39\u00a0<vmassol>\u00a0only with errors  \n21:42\u00a0<vmassol>\u00a0btw technically a displayer doesn't display btw ;)  \n21:43\u00a0<vmassol>\u00a0they seem to generate XDOM  \n21:43\u00a0<+mflorea>\u00a0yes, I followed Thomas's suggestion  \n21:43\u00a0<vmassol>\u00a0the renderer renders and the template display  \n21:43\u00a0<vmassol>\u00a0;)  \n21:44\u00a0<vmassol>\u00a0generating XDOM is very good. I was just commenting on the naming  \n21:44\u00a0<+mflorea>\u00a0well, the \"displayer\" name was taken from http://dev.xwiki.org/xwiki/bin/view/Design/FrontEndArchitecture  \n21:45\u00a0<vmassol>\u00a0yep  \n21:45\u00a0<vmassol>\u00a0I know  \n21:46\u00a0<vmassol>\u00a0I'm really happy that we've started this module at last! :)  \n21:46\u00a0<+mflorea>\u00a0:)  \n21:49\u00a0<vmassol>\u00a0hmmm seems you're executing content to get the title in extractTitleFromContent  \n21:50\u00a0<vmassol>\u00a0in DocumentTitleDisplayer  \n21:50\u00a0<vmassol>\u00a0AFAIR we had decided not to do this in the past  \n21:50\u00a0<+mflorea>\u00a0yes, that was the behavior in XWikiDocument  \n21:50\u00a0<vmassol>\u00a0hmm I don't remember this  \n21:50\u00a0<vmassol>\u00a0I remember the opposite  \n21:51\u00a0<+mflorea>\u00a0nop, I'm pretty sure  \n21:51\u00a0<vmassol>\u00a0becasue we said it was too dangerous  \n21:51\u00a0<vmassol>\u00a0(and not performant)  \n21:51\u00a0<vmassol>\u00a0let me check  \n21:51\u00a0<vmassol>\u00a0maybe I'm mixing with another getTitle api  \n21:53\u00a0<+mflorea>\u00a0https://github.com/xwiki/xwiki-platform/commit/aca51893724cb5203e5c7f5cbecdd62d91ec0a1c#diff-14  \n21:53\u00a0<+mflorea>\u00a0look for getRenderedContentTitle  \n21:54\u00a0<vmassol>\u00a0I'm probably confused. I'm pretty sure I remmeber that a document with only an include in it will not get its title extracted  \n21:54\u00a0<vmassol>\u00a0oh I know  \n21:54\u00a0<vmassol>\u00a0it's only rendering the header  \n21:54\u00a0<+mflorea>\u00a0yes  \n21:55\u00a0<vmassol>\u00a0ok my bad, that's ok  \n21:55\u00a0<vmassol>\u00a0btw you don't have unit tests for the new modules it seems  \n21:55\u00a0<vmassol>\u00a0I don't see any in display module  \n21:55\u00a0<+mflorea>\u00a0yes..  \n21:55\u00a0<vmassol>\u00a0(which means they were not developed TDD\u2026 bad bad ;))  \n21:56\u00a0<vmassol>\u00a0we really need 80-90% coverage for all new code  \n21:56\u00a0<vmassol>\u00a0I wonder how you've tested them, it's so much easier with unit tests  \n21:56\u00a0<vmassol>\u00a0anyway please add them when you can  \n21:57\u00a0<+mflorea>\u00a0I know.. I was saved by the unit tests in old core and include macro  \n21:57\u00a0<+mflorea>\u00a0I will  \n21:58\u00a0<vmassol>\u00a0I like the fact that each class doesn't have much code, this tends to mean it has a good design  \n21:58\u00a0<vmassol>\u00a0I think there are some fine tuning to do on the exception handling part  \n22:00\u00a0<+mflorea>\u00a0I had to split the code as mush as possible because I was getting cyclomatic complexity very easy (too many imports)  \n22:01\u00a0<+mflorea>\u00a0yes, exception handling needs to be improved  \n22:05\u00a0<finbrein>\u00a0has quit  \n22:07\u00a0<vmassol>\u00a0mflorea: do you know why we need a displayer in the include macro when context is current?  \n22:07\u00a0<vmassol>\u00a0I was expecting the displayer to be used only when context is NEW  \n22:08\u00a0<+mflorea>\u00a0just to prevent duplicating the getContent method, especially when the section is specified  \n22:09\u00a0<+mflorea>\u00a0and for consistency  \n22:09\u00a0<vmassol>\u00a0I need to think a bit more about this but there are some things that we need to fix in the platform rendering  \n22:09\u00a0<+mflorea>\u00a0displayParameters.setContentTransformed(false) => the displayer does nothing more than to retrieve the content  \n22:10\u00a0<vmassol>\u00a0we need to move the include macro in the rendering module in the future  \n22:11\u00a0<vmassol>\u00a0IMO we need some way to return a XDOM without having to perform any rendering in the macro itself  \n22:11\u00a0<vmassol>\u00a0even when context = NEW  \n22:12\u00a0<vmassol>\u00a0i need to brainstorm a bit with thomas about this  \n22:12\u00a0<vmassol>\u00a0but this would allow to more cleanly separate rendering from the rest  \n22:12\u00a0<vmassol>\u00a0(rest = other platform modules)  \n22:13\u00a0<vmassol>\u00a0I'll let you know if I come up with something  \n22:13\u00a0<+mflorea>\u00a0I guess you need a way to mark that a subtree of XDOM is transformed in new context  \n22:13\u00a0<vmassol>\u00a0yes  \n22:13\u00a0<vmassol>\u00a0exatly  \n22:13\u00a0<vmassol>\u00a0exactly  \n22:15\u00a0<vmassol>\u00a0exception handling is a btit strange here:  \n22:15\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0try {  \n22:15\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0result = documentDisplayer.display(documentBridge, displayParameters);  \n22:15\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0} catch (Exception e) {  \n22:15\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0throw new MacroExecutionException(e.getMessage(), e);  \n22:15\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0}  \n22:15\u00a0<vmassol>\u00a0display doesn't thrown an excpetion and yet we expect one, which tends to mean mayb dsplay should thrown an excpetion  \n22:15\u00a0<+mflorea>\u00a0:) that's actually a hack to make a test of include macro pass  \n22:16\u00a0<vmassol>\u00a0(not sure why it doesn't thwo one)  \n22:16\u00a0<vmassol>\u00a0Macro and Transformations do throw an exception  \n22:17\u00a0<vmassol>\u00a0and it seems to me it's possible to get all sort of problems when calling a displayer  \n22:17\u00a0<+mflorea>\u00a0indeed  \n22:17\u00a0<vmassol>\u00a0I see a lot of throw RuntimeException in displayer  \n22:17\u00a0<+mflorea>\u00a0yep  \n22:17\u00a0<vmassol>\u00a0IMO the problem is that display() methjod doesn't throw a DisplayException  \n22:17\u00a0<+mflorea>\u00a0that was the quick solution  \n22:18\u00a0<+mflorea>\u00a0indeed, an expected DisplayException in the API is better  \n22:19\u00a0<vmassol>\u00a0would be good that we stabilize the api as much as possibe before the final 3.2 release  \n22:19\u00a0<vmassol>\u00a0I'll continue to review the committed code tomorrow  \n22:21\u00a0<vmassol>\u00a0lots of failing functional tests remain apparently  \n22:26\u00a0<+mflorea>\u00a0hmm, they weren't failing just after I merged the branch  \n22:26\u00a0<vmassol>\u00a0the webstandarsd one seem to be caused by a jvm crash  \n22:26\u00a0<+mflorea>\u00a0I need to check them  \n22:26\u00a0<vmassol>\u00a0I'm restartgin them now  \n22:27\u00a0<vmassol>\u00a0I also updated selenium to 2.6.0  \n22:27\u00a0<vmassol>\u00a0but I ran it locally first  \n22:27\u00a0<vmassol>\u00a0and all tests were passing locally  \n22:27\u00a0<vmassol>\u00a0(except the famous one that doesn't pass on my mac)  \n22:27\u00a0<+mflorea>\u00a0:)  \n22:28\u00a0<+mflorea>\u00a0so it still fails with 2.6.0, I need to check if it fail without my hack  \n22:28\u00a0<vmassol>\u00a0indeed  \n22:29\u00a0<finbrein>\u00a0has joined #xwiki  \n22:37\u00a0<mflorea>\u00a0has quit  \n22:43\u00a0<vmassol>\u00a0ok only 1 error in webstandard now  \n22:43\u00a0<vmassol>\u00a0http://ci.xwiki.org/job/xwiki-enterprise-test-webstandards/org.xwiki.enterprise$xwiki-enterprise-test-webstandards/281/testReport/org.xwiki.test.webstandards/RSSValidationTest/Validating\\_RSS\\_validity\\_for\\_\\_\\_\\_xwiki\\_\\_bin\\_\\_view\\_\\_Main\\_\\_LuceneSearch\\_xpage\\_plain\\_outputSyntax\\_plain\\_text\\_wiki\\_executed\\_as\\_guest/  \n22:43\u00a0<vmassol>\u00a0got to go, bed time  \n22:44\u00a0<vmassol>\u00a0has quit  \n22:55\u00a0<finbrein>\u00a0has quit  \n22:56\u00a0<finbrein>\u00a0has joined #xwiki  \n23:10\u00a0<pturcotte>\u00a0has quit  \n23:14\u00a0<jvdrean>\u00a0has quit  \n\n"}