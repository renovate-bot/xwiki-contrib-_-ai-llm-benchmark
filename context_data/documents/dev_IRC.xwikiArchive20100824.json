{"id": "dev:IRC.xwikiArchive20100824", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20100824", "title": "IRC Archive for channel #xwiki - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\nlpereira left at 00:06 (Quit: Leaving.  \nabusenius left at 01:52 (Ping timeout: 252 seconds  \nMartinCleaver left at 01:53 (Read error: Connection reset by peer  \nMartinCleaver joined #xwiki at 01:53  \nMartinCleaver left at 01:56 (Read error: Connection reset by peer  \nMartinCleaver joined #xwiki at 01:56  \nMartinCleaver left at 03:25 (Ping timeout: 240 seconds  \nsdumitriu left at 03:32 (Ping timeout: 264 seconds  \nvenkatesh joined #xwiki at 05:06  \nnpm left at 07:14 (Remote host closed the connection  \nnpm joined #xwiki at 07:19  \nxipe\\_ joined #xwiki at 07:28  \nxipe left at 07:32 (Remote host closed the connection  \ntmortagne joined #xwiki at 08:09  \nmflorea joined #xwiki at 08:09  \nkibahop joined #xwiki at 08:12  \nkibahop left #xwiki at 08:12  \nsilviar joined #xwiki at 08:27  \nasrfel joined #xwiki at 09:01  \nlucaa left at 09:05 (Ping timeout: 276 seconds  \nlpereira joined #xwiki at 09:20  \nmicw joined #xwiki at 09:28  \nmicw - (09:28): hi  \ncjdelisle - (09:28): hi  \nmicw - (09:28): since we upgraded to xwiki 2.4 (from 2.1-m1) the #includeMacros(\"space.Pagename\") is not working anymore  \nmicw - (09:29): then i put some text on the included page, it occurs on the page with the include code. but macros are ignored  \ncjdelisle - (09:29): #includeForm(\"Space.page\")?  \nmicw - (09:29): what's wron with #includeMacros?  \nmicw - (09:29): we use a plugin for drawing mockups (balsamiq) which automatically adds this code  \nnpm left at 09:29 (Remote host closed the connection  \nnpm joined #xwiki at 09:30  \ncjdelisle - (09:30): Hmm. There was a change to how macros are stored, your code may have been relying on a bug :/  \nmicw - (09:30): includeform has the same behaviour  \nmicw - (09:30): the macros are stored as velocity macros on a page  \nmicw - (09:31): this page contains {{velocity}}  \nmicw - (09:31): {{html}}  \nmicw - (09:31): #macro(mockup $name) ...  \ncjdelisle - (09:31): So you have velocity macros on pageA and you need them on pageB?  \nmicw - (09:31): yes  \ncjdelisle - (09:31): Does pageB include pageA?  \ncjdelisle - (09:32): The old way was that once a macro was loaded for the first time, it would last the life of the program. This was a memory leak bug.  \ncjdelisle - (09:32): Now pageB needs to include pageA if pageB wants to have macros from pageA  \ncjdelisle - (09:33): I use the new include macro for this.  \nmicw - (09:33): how is this donw?  \ncjdelisle - (09:33): in pageB:  \nmicw - (09:33): donw?  \nmicw - (09:33): hm  \nmicw - (09:33): done ^^  \ncjdelisle - (09:33): {{include document=\"Space.PageA\"/}}  \ncjdelisle - (09:33): put that above where the macro is used for the first time.  \ncjdelisle - (09:33): You should be good.  \nmicw - (09:34): ok that works  \nmicw - (09:34): but i have t fix hunderd of pages now :-/  \ncjdelisle - (09:34): Hmm. maybe you could automate it?  \nmicw - (09:35): i should ^^  \ncjdelisle - (09:35): Is it like one \"scripts\" page which is included everywhere?  \ntmortagne - (09:35): that's weird there is no reason for #includeMacros(\"space.Pagename\") \u00a0to not work anymore, that sounds like a bug  \ntmortagne - (09:35): it should do pretty much the same thing than {{include document=\"Space.PageA\"/}}  \ncjdelisle - (09:35): If it calls #includeForm then it's probably broken.  \ncjdelisle - (09:37): #macro(includeMacros $topic)  \ncjdelisle - (09:37): $xwiki.includeForm($topic)  \ncjdelisle - (09:37): #end  \nmicw - (09:38): where is this macro defined?  \ncjdelisle - (09:38): it's in macros.vm  \nmicw - (09:38): where can i find this?  \ncjdelisle - (09:38): Hmm. maybe you could just change that to say {{include...  \nmicw - (09:39): ./xwiki-enterprise-web-2.4/templates/macros.vm ?  \ncjdelisle - (09:39): yup.  \nmicw - (09:39): do i have to restart?  \ncjdelisle - (09:39): No you don't.  \nmicw - (09:39): it's really #macro(includeMacros $topic)  \nmicw - (09:39): $xwiki.includeForm($topic)  \nmicw - (09:39): #end  \nlucaa joined #xwiki at 09:39  \nmicw - (09:40): to what shall i change it?  \nmicw - (09:40): i'll look at the old one  \nsburjan joined #xwiki at 09:40  \ncjdelisle - (09:40): try changing it to:  \ncjdelisle - (09:40): #macro(includeMacros $topic)  \nmicw - (09:40): hm, it was the same there  \ntmortagne - (09:40): #includeInContext  \ntmortagne - (09:40): instead of #incldueForm  \nmicw - (09:41): includeincontext is xwiki.includeForm($topic)  \ntmortagne - (09:41): s/incldueForm//includeForm/  \ncjdelisle - (09:41): IIRC includeInContext is same as includeForm  \nmicw - (09:41): it is  \ntmortagne - (09:41): cjdelisle: no it's not supposed to be the same  \ntmortagne - (09:41): hmm  \ntmortagne - (09:41): wait  \ntmortagne - (09:41): actually they are the same  \ntmortagne - (09:41): I was thinking of #includeInTopix  \ntmortagne - (09:41): Topic  \ncjdelisle - (09:41): I would replace $xwiki.IncludeForm with {{include document=\"$topic\"/}}  \ntmortagne - (09:42): and there is absolutely no reason for includeform for not working  \ncjdelisle - (09:42): That will break if you are using it with syntax 1.0 pages.  \ntmortagne - (09:42): cjdelisle: why do you say includeForm is broken ? if it's is it's an important regression  \ncjdelisle - (09:42): Vincent changed the way macros are stored, I don't think includeForm was fixed.  \nsilviar left at 09:43 (Quit: Leaving.  \ntmortagne - (09:43): I know Vincent fioxed the way of handling macro but he did it at rendering level, that should not change anything for #includeForm  \nmicw - (09:44): now my page contains {{include document=\"Mockups.MacrosV2\"/}}  \nmicw - (09:44): as text  \nmicw - (09:44): and i had to restart tomcat  \nmicw - (09:44): to see itz  \ncjdelisle - (09:44): IncludeForm calls getRenderedContent which means the other page is rendered seperately. I thought we had that working. I'll write a regression test to see.  \narkub joined #xwiki at 09:45  \nmicw - (09:45): {{include document=\"$topic\"/}} is not valid velocity code  \ncjdelisle - (09:45): Are you using syntax version 1.0?  \nmicw - (09:45): no  \nmicw - (09:45): 2.0  \ncjdelisle - (09:46): {{include.... is syntax 2.0 wiki. It's not velocity.  \nmicw - (09:46): what is the meaning of the 2nd parameter of $xwiki.includeForm (a boolean)?  \nmicw - (09:46): i changed the code of the includeMacro macro  \ncjdelisle - (09:47): It decides whether the output should be wrapped in <pre> tags  \nmicw - (09:47): ok  \nmicw - (09:47): not what i need  \nmicw - (09:47): any other method i could call that may work?  \nsilviar joined #xwiki at 09:47  \ntmortagne - (09:48): cjdelisle: using getRenderedContent does not mean that a page is rendered separately  \ncjdelisle - (09:49): I can't remember exactly what the problem was but I do remember there was a problem with includeForm.  \ntmortagne - (09:49): that would make xwiki/1.0 syntax absolutely unusable and we would have lots of failing tests  \ncjdelisle - (09:50): I was thinking that change would get micw's system up and working again.  \nmicw - (09:50): which change?  \nmicw - (09:51): plz tell me. i need to have it running (atm only with xwiki 2.0 syntax)  \ncjdelisle - (09:51): replace:  \ncjdelisle - (09:51): #macro(includeMacros $topic)  \ncjdelisle - (09:51): \u00a0$xwiki.includeForm($topic)  \ncjdelisle - (09:51): #end  \ncjdelisle - (09:51): with:  \ncjdelisle - (09:51): #macro(includeMacros $topic)  \ncjdelisle - (09:51): \u00a0{{include document=\"$topic\" /}}  \ncjdelisle - (09:51): #end  \ncjdelisle - (09:52): If we have a bug, we have to fix it but obviously your system needs to function today.  \nmicw - (09:52): i did this bus the code is shown in the page as text  \ncjdelisle - (09:53): hang on, yesting this om my machine.  \nmicw - (09:54): thx  \nmicw - (09:55): http://community.balsamiq.com/balsamiq/topics/cant\\_see\\_mockups\\_on\\_xwiki\\_pages  \ntmortagne - (10:01): ok the issue is actually only when using #include\\* in a xwiki/2.0 document  \nmicw - (10:01): \"only\" ...  \ntmortagne - (10:01): in which #include\\* are deprectaed since a very long time  \ntmortagne - (10:02): {{include}} is supposed to be the new way  \ncjdelisle - (10:02): No deprecation warnings were dumped into the logs.  \ntmortagne - (10:03): cjdelisle: yes but we don't have xwiki/2.0 velocity warning system  \nmicw - (10:04): ^^  \nmicw - (10:04): cjdelisle, any idea how i can get the {{include}} work in the velocity macro?  \ntmortagne - (10:04): if we tag them as deprected that would produce a warning even when you use it from xwiki/1.0 or templates  \nmicw - (10:05): in the page i have {{velocity}}{{html}}#includeMacros(\"Mockups.MacrosV2\"){{/html}}{{/velocity}}  \nmicw - (10:05): in the macro the code you mentioned above  \ncjdelisle - (10:06): I can't get #includeMacros to call forward to {{include. The next best if going to be writing a script to automatically replace all instances of #includeMacros(\"Mockups.MacrosV2\") with {{include document=\"Mockups.MacrosV2\"/}}  \nmicw - (10:08): any hint how can i automate this in my wiki?  \ncjdelisle - (10:10): start with a searchDocuments call and then take the list of document names, getDocument each one, use substitution and then document.save() each one.  \ncjdelisle - (10:10): Back up the database first. But you do that daily right? ;)  \nsdumitriu joined #xwiki at 10:10  \nmicw - (10:10): sure  \nabusenius joined #xwiki at 10:11  \ncjdelisle - (10:14): \"ok the issue is actually only when using #include\\* in a xwiki/2.0 document in which #include\\* are deprectaed since a very long time\" \u00a0\u00a0syntax/1.0 is deprecated too right?  \nmicw - (10:14): thx. i use search and one of our employees to change it  \ncjdelisle - (10:14): You should be able to use an automatic script to edit the documents.  \ncjdelisle - (10:15): doc = $xwiki.getDocument($name)  \ncjdelisle - (10:15): $document.setContent($document.getContent().replaceAll(\"oldInclude\", \"newInclude\"))  \ncjdelisle - (10:16): $document.save()  \ncjdelisle - (10:16): In a loop.  \ncjdelisle - (10:16): !!! Back up database first !!!  \ntmortagne - (10:16): cjdelisle: \"syntax/1.0 is deprecated too rights\", it's not really the same thing, {{include}} macro as always been the only valid way to include pages/macros in xwiki/2.0 content  \nmicw left #xwiki at 10:16  \nmicw joined #xwiki at 10:17  \ntmortagne - (10:17): #include\\* was mostly deprecate because they never fully worked in xwiki/2.0 syntax  \ncjdelisle - (10:17): It actually did work as far as I remember.  \ncjdelisle - (10:18): In fact {{include has some trouble with including syntax/1.0 docs into syntax/2.0 documents which #includeform was fine with.  \nmicw - (10:22): any idea why there are problems with umlauts (utf8 charcaters)?  \nmicw - (10:22): e.g. i have one in a title and the document is listed as \"Server Software f&#252;r Windows\"  \nmicw - (10:23): instread of using a \"\u009d\"  \nmicw - (10:23): that's only wrong with the topmost title (which is derived from the first caption which is displayed correctly)  \ncjdelisle - (10:24): In display mode or edit mode?  \nKermitTheFragger joined #xwiki at 10:24  \ntmortagne left at 10:28 (Read error: Connection reset by peer  \ntmortagne joined #xwiki at 10:29  \nmicw - (10:32): in display mode it's wrong (and also on lists where the document is shown). in edit mode anything is fine  \ncjdelisle - (10:32): What is the browser you're seeing this in?  \nmicw - (10:33): ff 3.6  \nmicw - (10:33): ie as well  \nmicw - (10:33): seems that it is quoted twice  \ntmortagne - (10:34): i seen some commit about double escaping fixed very recently  \nmicw - (10:34): <div id=\"document-title\"><h1>Terminal-Server Software f&amp;#252;r Windows</h1></div>  \ntmortagne - (10:34): probably abusenius  \nabusenius - (10:37): micw: it's probbly because the escaping method we switched to is too precautios  \nabusenius - (10:37): it escapes all non-ascii characters even in utf8  \nmicw - (10:38): quite useless ^^  \nabusenius - (10:39): it is ok for html, but not for xhtml, although most programs show it correctly  \ncjdelisle - (10:39): yea ', \", and < should be enough for security purposes.  \nabusenius - (10:39): xml standard says escape xml-significant chars  \nabusenius - (10:40): but when encoding is iso, we need to escape the rest too  \nmicw - (10:40): &amp;#252; has to be shown as &#252;  \nmicw - (10:40): it's simply wrong  \nabusenius - (10:40): ah, right this is overescaped  \nmicw - (10:40): cool word ^^  \ntmortagne - (10:40): yep looks indeed like double escaping  \nabusenius - (10:41): we should really add an overescaping tests  \nabusenius - (10:43): micw: which version btw?  \nmicw - (10:43): 2.4  \nmicw - (10:44): 2.4.30451  \nevalica joined #xwiki at 10:49  \nabusenius - (10:56): hm, cannot reproduce  \nEnygma` joined #xwiki at 10:56  \nabusenius - (10:57): micw, how exactly do you create those pages?  \ncjdelisle - (10:57): it was an upgrade.  \nabusenius - (10:58): maybe they had escaped characters in the title  \nabusenius - (10:58): (to make it look correctly on the previeous version)  \nmicw - (10:58): the title simply conatins umlauts  \nabusenius - (10:59): if you go to edit?  \nvmassol joined #xwiki at 11:26  \nvmassol left at 11:39 (\\*.net \\*.split  \ntmortagne left at 11:39 (\\*.net \\*.split  \ntmortagne joined #xwiki at 11:40  \nsburjan - (12:04): hello. who is gonna remove flickr plugin from core and move it to contrib-retired ?  \nsburjan - (12:05): I'm saying this because we shouldn't allow it to exist in M1, especially that we voted to remove it  \ncjdelisle - (12:05): do you have a patch?  \nsburjan - (12:06): well, it involves moving physically some files out of the core, and svn doesnt support there kind of periations to be included in a patch  \nsburjan - (12:06): \\*these  \ncjdelisle - (12:07): Do you know if there's anything which needs to be changed?  \nsburjan - (12:07): well... afaik there are 3 files that mention the flickr plugin  \nsburjan - (12:08): 1.the pom.xml from xwiki-core project  \nvmassol joined #xwiki at 12:08  \ncjdelisle - (12:09): is there an issue number for this?  \nsburjan - (12:09): no, I didn't created a jira  \nsburjan - (12:09): should I create one ?  \ncjdelisle - (12:10): I think there should be an issue, even if only to point to people who were using it and upgraded.  \nsburjan - (12:10): okay  \nsburjan - (12:10): I'm on it  \nsburjan - (12:10): I'll be back with the issue created  \nabusenius left at 12:15 (Quit: Konversation terminated!  \nabusenius joined #xwiki at 12:15  \nsilviar left at 12:26 (Quit: Leaving.  \ncjdelisle - (12:33): sburjan: You should be able to commit in the retired section now.  \narkub left at 12:42 (Ping timeout: 258 seconds  \nvmassol left at 12:48 (Quit: Leaving.  \nvmassol joined #xwiki at 12:48  \nsburjan - (12:55): well cjdelisle .. thanks for the commit right, I'll \u00a0have to look into it so I won't mess up something by accident  \nsdumitriu - (12:56): sburjan: I'll do the commit  \nsburjan - (12:56): ok  \nsburjan - (12:57): I was about to tell you that :P  \nsburjan - (12:57): so you'll create the patches too ?  \nsdumitriu - (12:57): abusenius: How did you move stuff from the contrib repo to the MAIN REPO?  \nsdumitriu - (12:57): sburjan: yes  \nsburjan - (12:58): sdumitriu, : okay :)  \nsburjan - (12:58): one day I'd like to commit too ... when I'll know more on how to do this in a safe way  \ncjdelisle - (12:59): Do people often turn on the setting to check password each page load?  \nsdumitriu - (13:00): cjdelisle: No idea  \ncjdelisle - (13:00): xwiki-crypto takes ~200ms to check a password so porting would be a bad idea for those people.  \ncjdelisle - (13:04): Well if you're going to move flickr then I'll start looking into porting passwords again.  \nsburjan - (13:04): flickr is baiscally 2 classes and you have to patch 2 or 3 files to remove the reference from them  \ncjdelisle - (13:05): And maybe make it build over in contrib?  \nsburjan - (13:05): the vote was to remove it from core and stop including it in the default release  \nsburjan - (13:06): so I guess .. not  \ncjdelisle - (13:06): http://i.imgur.com/Jecj9.gif :D  \nsburjan - (13:06): it's deprecated, the api changed since then, so untill someone will rewrite it with current api, there is no use to include it in default bundle  \nsburjan - (13:06): :))  \nsburjan - (13:08): thomasM suggested we remove all the plugins from the core, but maybe some of them are still used in the wild. I'm almost sure flickr isnt, because it's broken, so it's no use  \nsburjan - (13:08): \\*used by anyone  \ncjdelisle - (13:09): +1 for me. I think query plugin can go as well.  \ncjdelisle - (13:09): Anyone know what's the deal with the mail plugin?  \nsburjan - (13:09): well.. I don't know, i only proposed flickr .. don't know about the other plugins  \ncjdelisle - (13:10): yes, in future I mean.  \nsburjan - (13:10): well.. in future exerything in xwiki-core/plugins will have to be moved out in plugins dir  \nsburjan - (13:11): core is core, plugins are plugins  \nsburjan - (13:12): plugins dir = /platform/trunks/plugins  \nsilviar joined #xwiki at 13:13  \nsburjan - (13:13): sdumitriu, : so should I still create a JIRA issue for the flickr plugin ?  \nsdumitriu - (13:13): Yes  \nvmassol left at 13:16 (Quit: Leaving.  \nsburjan - (13:16): jira XWIKI-5427  \nsburjan - (13:18): sdumitriu, : should I assign this to you ?  \nsdumitriu - (13:18): Yes  \ncjdelisle - (13:19): :) I love looking through HibernateStore and seeing @Deprecated everywhere. It feels more manageable already.  \nsdumitriu - (13:19): :)  \ncjdelisle - (13:20): I think I have a fix. If there is a prop of a different type with the same id as the one you try to save, the other one gets deleted first.  \ncjdelisle - (13:21): Then just change PasswordClass.getProperty to return a largeString and they will be ported over as they're saved.  \nsburjan - (13:21): sdumitriu, : I think I need to have some right in order to assign tasks to people .. .because I can't find the \u00a0assign interface  \ncjdelisle - (13:22): Usually people just assign stuff to themselves.  \ncjdelisle - (13:22): We don't really use the assignment feature of jira.  \nsburjan - (13:23): yeah, but I never saw on my account the possibility to assign issues :)  \ncjdelisle - (13:24): At XWikiHibernateStore line 1424, There's this horrible block of commented code which seems to have had it's \\n's stripped. Anyone care if I remove it?  \nabusenius - (13:25): sdumitriu: I moved it over url... is there something bad about it?  \nsdumitriu - (13:25): No  \nsdumitriu - (13:25): I reached the same conclusion  \nabusenius - (13:25): svn mv htpps://bla https://blub  \nsdumitriu - (13:25): But it will be a bit more difficult, since it's not moving a whole project, but just some files  \nsburjan - (13:26): sdumitriu, : you're talking about flickr ?  \nsdumitriu - (13:26): Yes  \nsburjan - (13:28): anyway.. I can't find a way to assign that to you .. so I'll have to use cron in my mind as a reminder  \nsdumitriu - (13:31): I assigned it to myself  \nsburjan - (13:32): :)  \nsburjan - (13:33): so I guess you need special rights to be able to assign ?  \ncjdelisle - (13:33): XHS.saveXWikiProperty tries to end the transaction twice (if everything goes right.) I'm going to remove call so it's only ended inside of the finally block.  \ncjdelisle - (13:35): err I mean move the rollback from the finally block to the catch block since it's already committed unless an exception is caught.  \nmicw - (13:50): any idea what else has changed with encoding from 2.1 to 2.4? when i srach for something containing an umlaut, the search term is added to the uri and then wrong decoded  \ncjdelisle - (13:56): micw: I tried a search with a \u00fc and I don't see the broken encoding.  \nmicw - (13:56): strange  \nmicw - (13:57): this happens only since the upgrade. which browser and servlet container do you use?  \ncjdelisle - (13:58): I'm using jetty.  \ncjdelisle - (13:59): And ff.  \ncjdelisle - (13:59): Tomcat might have something to do with it. Tomcat is not utf-8 by default.  \nmicw - (13:59): any idea how url parameters are decoded by jetty?  \nmicw - (13:59): that's it  \nmicw - (14:00): the problem is a lag in the rfc for uris. there's no way to tell the encoding and no standard. so some implementations use latin1 (most common), other use utf8, other the encoding of the body  \nmicw - (14:02): tomcat needs to be set to \"useBodyEncodingForURI=true\"  \ncjdelisle - (14:03): coffee time. bbiab  \nvenkatesh left at 14:05 (Remote host closed the connection  \nlucaa left at 14:15 (Ping timeout: 265 seconds  \nsburjan - (14:22): I am testing the date format on General Preferences on latest 2.5 SNAPSHOT  \nlucaa joined #xwiki at 14:24  \nMartinCleaver joined #xwiki at 14:27  \nMartinCleaver left at 14:27 (Excess Flood  \narkub joined #xwiki at 14:42  \nsburjan - (14:47): What is the filed that must be set to true when I want to force users go through email when registering ?  \nsburjan - (14:48): because Administer Wiki/Registration -> Use email verification set to yes I still allows me to register and login without any email confirmation  \nsburjan - (14:49): is this normal behaviour ?  \ncjdelisle - (15:02): It never was but it does sound natural that it should be required.  \nsburjan - (15:09): well I shouldnt be able to login until I confirm my account from the email I got  \nsburjan - (15:09): and, still I can  \nsburjan - (15:10): assuming the setting i am refering to is the one that does this  \ncjdelisle - (15:15): That sounds broken.  \ncjdelisle - (15:15): I'll look in to it.  \nMartinCleaver joined #xwiki at 15:17  \nsburjan - (15:17): yeah, it seems broken  \nMartinCleaver left at 15:19 (Client Quit  \nMartinCleaver joined #xwiki at 15:20  \nsburjan - (15:21): Silvia confirmed this too  \nsburjan - (15:21): on 2.3.2 too  \nsburjan - (15:21): which should be stable  \nsburjan - (15:22): again ... assuming THIS is the setting that forces this  \ncjdelisle - (15:22): It's probably been there since <2.1  \nsburjan - (15:22): well this is a major bug  \nsburjan - (15:22): please try to confirm :P  \ncjdelisle - (15:22): I made some changes to the registration interface in 2.2 but Didn't change that particular thing.  \ncjdelisle - (15:22): s/D/d  \nsburjan - (15:23): well.. regarding that. you should make a little more longer the password input field  \ncjdelisle - (15:23): If you feel like writing a ui-test, that would be awesome.  \nsburjan - (15:23): it breaks the UI look, and awkward short for the minimum password requirement  \nsburjan - (15:23): this would be another sugestion  \ncjdelisle - (15:24): I kept the standard but it's definitely a valid suggestion.  \nsburjan - (15:24): yeah, that's a good Idea  \nsburjan - (15:24): but this is a little bit complicated, because I have no way of knowing within UI-test if the mail was sent with success  \ncjdelisle - (15:24): I have been thinking about registration/login in a lightbox. what do you think of that?  \nsburjan - (15:25): yes, that could be an approach too  \ncjdelisle - (15:25): org.xwiki.it.ui.invitation.InvitationTest tests the sending of email.  \nsburjan - (15:26): but this uses the xwiki javamail ?  \nsburjan - (15:26): or you have included another javamail lib just for the invite app ?  \ncjdelisle - (15:26): yup  \nsburjan - (15:26): okay.. I'll start doing that  \ncjdelisle - (15:26): It uses the regular mail plugin. The test uses greenmail.  \nsburjan - (15:27): so wiki uses greenmail ? I though it uses old school javamail  \ncjdelisle - (15:27): greenmail is used for testing the mail server.  \ncjdelisle - (15:27): s/server/sender/  \nsburjan - (15:27): funny part is i was able to configure it and use xwiki's sas mail smtp .. using the javamail params :))  \nsburjan - (15:27): oh, i see  \nsburjan - (15:27): I'll write a test that proves the bug  \nsburjan - (15:28): but It won't be committed until it's fixed, because it will fail the build :)  \nsburjan - (15:28): I'll wait for sdumitriu to confirm too  \ncjdelisle - (15:29): You can open an issue and attach the test. That will make the fix real easy.  \nsburjan - (15:29): well I'm not gonna attach a fix, I'm gonna attach the test to prove the bug  \ncjdelisle - (15:30): That's what I meant.  \nsburjan - (15:30): so tell me  \nsburjan - (15:30): xwiki uses what version of javamail ?  \nsburjan - (15:30): I want to improve the mail documentation, because the current is a mess  \ncjdelisle - (15:31): http://svn.xwiki.org/svnroot/xwiki/platform/core/trunk/xwiki-core/pom.xml  \ncjdelisle - (15:31): <dependency>  \ncjdelisle - (15:31): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<groupId>javax.mail</groupId>  \ncjdelisle - (15:31): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<artifactId>mail</artifactId>  \ncjdelisle - (15:31): \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<version>1.4</version>  \nsburjan - (15:32): thanks  \nsburjan - (15:32): tomrrow at first hour I'll start working on these things  \nsburjan - (15:32): I wasn't happy on how mail settings are documented from the start  \nsburjan - (15:32): sdumitriu, : are you around ?  \nsburjan - (15:34): cjdelisle, : the mailsender plugin uses also XWiki's CORE javamail lib ?  \ncjdelisle - (15:34): If you look at the .pom file you see that dependency is needed only for the mail sender.  \ncjdelisle - (15:35): BTW: Repeated your bug. I just manually set a user to inactive then logged in as that user.  \ncjdelisle - (15:35): Not sure how old that is but it's old.  \nsburjan - (15:35): well this is another bug then  \nsburjan - (15:36): I was refering to the bug that allows to login untill you confirm the account creation via mail  \nsburjan - (15:36): so this is another  \nsburjan - (15:36): both major IMO  \nsburjan - (15:36): i'll write this down too for testing  \nsburjan - (15:37): cjdelisle, : about what pom.xml are you refering too ?  \ncjdelisle - (15:37): http://svn.xwiki.org/svnroot/xwiki/platform/core/trunk/xwiki-core/pom.xml  \nsburjan - (15:38): yeah I know  \nsburjan - (15:38): but we alos have a plugin that sends mail  \nsburjan - (15:38): \\*also  \nsburjan - (15:38): http://code.xwiki.org/xwiki/bin/view/Plugins/MailSenderPlugin  \nsburjan - (15:39): this plugin uses the same core-level class, right ?  \nsburjan - (15:39): basically I'm asking if there is ONE lib that handles all that is related to emailing system. One lib to be used by all  \ncjdelisle - (15:39): hmm you're right. different mail plugin. checking...  \nsburjan - (15:40): this would be the epic ideal approach  \nsburjan - (15:40): so we don't have 2 libs for same thing  \ncjdelisle - (15:40): http://svn.xwiki.org/svnroot/xwiki/platform/xwiki-plugins/trunk/mailsender/pom.xml  \ncjdelisle - (15:41): It depends on xwiki-core and doesn't list a dependency for javax.mail  \ncjdelisle - (15:41): Thus it's using the same version.  \nsburjan - (15:46): that's good  \nsburjan - (15:47): suggestion: why don't you make Invitation app to use the core platform settings for email system ?  \nsburjan - (15:47): afaik you have another page to set up the params for invitationapp mailing system  \nsburjan - (15:48): http://localhost:8080/xwiki/bin/admin/XWiki/XWikiPreferences?admin=globaladmin&section=Invitation  \nsburjan - (15:48): although, you form is better than the default platform's form :)  \nsburjan - (15:49): we should merge these 2 into one single form. WDYT ?  \nsburjan - (15:50): this would be great for XECS and Cloud  \nsburjan - (15:53): be back in 40 minz  \nsburjan left at 15:53 (Quit: Ex-Chat  \ntmortagne - (16:08): sdumitriu: i'm working on http://jira.xwiki.org/jira/browse/XPLUCENE-62 and i get a pretty weir behavior, it has actually nothing to do with Lucene, the issue is that the text given to the input field is \"broken\" some way when getting $request.getParameter('text')  \ntmortagne - (16:09): any idea ?  \ntmortagne - (16:09): looks like the browser send the parameter in an encoding and the server is reading it as another encoding or something like that  \ntmortagne - (16:09): but we don't have this issue with the document content  \ntmortagne - (16:10): (i mean with wiki editor)  \ntmortagne - (16:10): i'm checking with another browser (i'm using FF 3.6.9pre)  \ntmortagne - (16:13): same thing with Chrome 5.0.375.127  \ntmortagne - (16:16): hmm works well when i change method from GET to POST  \ntmortagne - (16:16): is it some limitation of GET ?  \ntmortagne - (16:22): have to go, back in 1/2 hours  \nsburjan` - (16:27): I'm back  \ncjdelisle - (16:28): The invitation stuff extends the default stuff so if you leave it blank then it's the same.  \ncjdelisle - (16:28): should be documented on code.xwiki.org  \nsburjan` - (16:34): well..  \nsburjan` - (16:34): tomorrow I'll refactor the documentation on setting up mail on platform  \nsburjan` - (16:34): to include i that documentation more params  \nsburjan` - (16:35): so users know without to search for javamail config  \nsburjan` - (16:35): this is whay I am proposing a merge.. and create a better mailing system setup  \nsburjan` - (16:35): because t he platform's one doesnt have the options you included in your app  \nsburjan` - (16:35): I mean it supports them, but you have to add them as javamail params ....  \nsburjan` - (16:36): not inline form  \nsburjan` - (16:36): do you get my pov ?  \ncjdelisle - (16:36): What else does the mailer get used for? I forgot.  \nsburjan` - (16:37): registration, I guess watchlist too  \nsburjan` - (16:37): mailsender plugin and Invitation Application  \nsburjan` - (16:37): but maybe I'm missing something  \nsburjan` - (16:38): we should check if all these 4 use the platform mailing system  \ncjdelisle - (16:38): Ahh yes the watchlist.  \nsburjan` - (16:39): don't yot think it would be optimal to have one single interface to configure all these 4 .. I mean.. from the same place ?  \nsburjan` - (16:39): if all of them use the same lib  \ncjdelisle - (16:40): The reason why I didn't use the same location is because everyone can read the contents of XWikiProperties.  \ncjdelisle - (16:40): If you use a password for your mailer, then it would be public if in XWikiProperties.  \ncjdelisle - (16:41): The Invitation config is not public.  \nsburjan` - (16:41): hmmm .. but this is a whole in security  \nsburjan` - (16:41): saying your app is safe in this case.. butthe others 3 ?  \nsburjan` - (16:42): anyone could read the password field from there.. gaining the platform's mail server credentials  \ncjdelisle - (16:42): Well my intent was to improve security going forward.  \nsburjan` - (16:42): well .. this is a pretty nasty thing  \ncjdelisle - (16:42): Do you have access to the secret jira issues?  \nsburjan` - (16:42): but you can access that file only from local fs, right ? or it can be accessed remotely too ?  \nsburjan` - (16:42): nop :)  \nsburjan` - (16:43): we should talk to sdumitriu and abusenius about this  \ncjdelisle - (16:43): I think it's well established that XWiki.XWikiPreferences is a public document.  \nsburjan` - (16:43): i know that  \nsburjan` - (16:43): but we should find a way to hide the passwd  \nsburjan` - (16:44): if tehre is one elegant way  \nsburjan` - (16:45): isnt there a way for javamail to support password obfuscation when params are not hardcoded ?  \ncjdelisle - (16:45): Maybe in the future we will configure the mail sender seperate from XWikiPreferences.  \nsburjan` - (16:45): yeah ..  \nsburjan` - (16:45): so we're stuck :)  \nsburjan` - (16:45): i was going to send a proposal tomorrow for merging  \ncjdelisle - (16:45): There are bigger security issues than that :)  \nsburjan` - (16:45): but now .. bad idea  \nsburjan` - (16:45): i know  \nsburjan` - (16:46): but I'm thinking in terms of usability for end-user  \nsburjan` - (16:46): and it's elegant to have one place for setting up the system .. instead of multiple  \ncjdelisle - (16:46): IMO XWikiPreferences is a white elephent.  \nsburjan` - (16:47): but can you access xwiki preferences from remote ?  \ncjdelisle - (16:47): yes.  \nsburjan` - (16:47): fail :)  \ncjdelisle - (16:47): It's a public document.  \nsburjan` - (16:48): i'll dig into that  \ncjdelisle - (16:48): The permissions on it are explicitly set so the public can view it.  \nsburjan` - (16:48): odd that pref settings are accessible directly  \nsburjan` - (16:48): most appz store this file outside web folder  \ncjdelisle - (16:48): It's not a file.  \ncjdelisle - (16:49): It's an XWikiDocument in the database.  \nabusenius - (16:49): an unrelated question, is there a way to access some settings in old xwiki.cfg from outside of the core?  \ncjdelisle - (16:49): No. Unless you're attacking, then yes :)  \nabusenius - (16:50): lol  \nabusenius - (16:50): what if I need to? migrate this configuration to xwiki.properties?  \ncjdelisle - (16:51): propose moving the configuration and see what would need to be ported to use xwiki.properties.  \nabusenius - (16:52): \\*sigh\\*  \nsburjan` - (16:56): wsell cjdelisle, abusenius : if we find a solution we could propose it for 2.5 release  \ncjdelisle - (16:57): Maybe write an application to act as a front end for the plugin?  \nsburjan` - (16:58): or create a cfg file outside of visible access, special for storing credential data  \ncjdelisle - (16:58): \"outside of visible access\" lol  \nabusenius - (16:59): anything that is not object property is better :)  \nabusenius - (16:59): although currently it doesn'T help much  \nabusenius - (16:59): \\*wouldn't  \ncjdelisle - (17:00): XWiki is a really big application, that's why any kind of security analysis is near impossible.  \ncjdelisle - (17:00): That was part of my motivation for writing xwiki-crypto. Nothing can really be trusted so trust nothing.  \nsburjan` - (17:00): wel i know. but a lot of big apps store this kind of data in special cfg files  \nabusenius - (17:00): it is possible, you can safely say that it is insecure ;)  \nsburjan` - (17:01): well, you're the securityguys, youknow better  \nabusenius - (17:01): we could at least introduce something like encrypted property  \ncjdelisle - (17:02): Another big app is Oracle, they are in the same boat except they act irresponsibly by saying it's \"unbreakable\".  \nabusenius - (17:02): to store sensitive data encrypted with a key stored in configuration  \ncjdelisle - (17:02): Then you need to protect the configuration.  \nsburjan` - (17:02): is it safe to store sensitive data in db ?  \ncjdelisle - (17:02): no  \ncjdelisle - (17:03): is it safe to store on the filesystem?  \ncjdelisle - (17:03): yes if the xwiki user doesn't have read access :)  \nabusenius - (17:03): :)  \nabusenius - (17:03): at least it is harder to do  \ncjdelisle - (17:03): haha  \nsburjan` - (17:03): well ... storing them on fs will enable thieves to achieve goal only with access to physical machine, at least not remotely  \nabusenius - (17:03): and we do plan to add security manager at some point :)  \nabusenius - (17:04): sburjan`: lol, nice one  \ncjdelisle - (17:04): SecurityManager will go a long way. Unfortunately Java has some security problems of it's own.  \nsilviar left at 17:04 (Quit: Leaving.  \nabusenius - (17:04): well, thats outside of our scope  \nsdumitriu - (17:05): re Confirmed Registration: you can log in right after registering, without confirming your account, it's just that you can't do anything with your account  \nsdumitriu - (17:05): Can you edit anything?  \nabusenius - (17:05): the attacker could as well break out of another vm and own the machine to hack xwiki, we cannot stop this  \ncjdelisle - (17:05): Well if it ends in pwnage it doesn't help much.  \nsburjan` - (17:05): sdumitriu: didnt try. tomorrow I'll try doing more with the unconfirmed user  \nsburjan` - (17:05): sdumitriu: didnt try. tomorrow I'll try doing more with the unconfirmed user  \ncjdelisle - (17:06): that up arrow is so close to the enter key  \nsburjan` - (17:06): but is this intended / normal behaviour ?  \nsburjan` - (17:07): you shouldnt be able to login until you confirm  \nsdumitriu - (17:07): Setting a user as inactive doesn't prevent login, just prevents all the actions after that (edit, view, delete, comment, anything)  \nabusenius - (17:07): sburjan`: when you'll test what a user can do, check also what he can do on the own profile  \nsburjan` - (17:07): i know  \ncjdelisle - (17:07): umm. I just created a user, made him inactive, logged in, opened my profile, set myself active.  \nabusenius - (17:07): imo you can allready start writing profile worm  \nsburjan` - (17:07): but this doesnt still seem to be the right way to do it.  \nsburjan` - (17:08): to be allowed to login with 0 rights  \ncjdelisle - (17:08): \"profile worm\" yea but you can do this to myspace, facebook etc.  \nsburjan` - (17:09): well .. sdumitriu: then I won't report these since you know obout them  \nsburjan` - (17:09): but IMO it is wrong  \nabusenius - (17:09): cjdelisle: right, thats another problem  \nsburjan` - (17:10): the actual account should be created \\*after\\* confirming  \ncjdelisle - (17:10): http://cbloomrants.blogspot.com/2010/08/08-02-10-java-will-be-faster-than-c.html \u00a0Now there's an optimist.  \nlpereira left at 17:10 (Quit: Leaving.  \nsburjan` - (17:11): one day the whole platform will break with this kind of behaviour (yeah, a pessimistic approach)  \nsdumitriu - (17:11): sburjan`: cjdelisle could look into that, since he did something similar for the invitaion app  \ncjdelisle - (17:12): I did what?  \nsburjan` - (17:12): to create a security mechanism for the platform mail as he did on invitation app ?  \nsdumitriu - (17:12): No  \nsdumitriu - (17:12): Registering the account after the user confirms it  \nsdumitriu - (17:13): Actually it's not that similar to the invitation app  \nsdumitriu - (17:13): Nevermind  \ncjdelisle - (17:13): Yea it's an optional thing which requires PR.  \nsdumitriu - (17:13): sburjan`: Did you also set the \"Check Active fields for user authentication\" property to Yes?  \nsburjan` - (17:14): no  \nsburjan` - (17:14): at least I dont think so  \nsdumitriu - (17:14): Without it, it doesn't matter if an account is active or not  \nsburjan` - (17:14): i only checkd the first field  \nsdumitriu - (17:14): It's simply ignored  \nsburjan` - (17:14): i didn;t know what that option does  \nsburjan` - (17:15): tomorrow I'll look into it  \nsburjan` - (17:15): anyway, 2 checkboxes for one functionality  \nsdumitriu - (17:16): Yes, they should be used together most of the times  \nsdumitriu - (17:16): But there is one scenario when only the first one is needed  \nsburjan` - (17:17): is there any reason for Check Active fields for user authentication ?  \nsdumitriu - (17:17): It's not a verification, just a welcome message  \nsdumitriu - (17:17): For that you change the content of the verification mail to just say \"Welcome\"  \nsdumitriu - (17:17): But it's a trick  \ncjdelisle - (17:17): s/trick/hack/?  \nsdumitriu - (17:17): Yeah  \nsburjan` - (17:18): sdumitriu: sorry, I'm not following  \nsdumitriu - (17:18): I mean:  \nvmassol joined #xwiki at 17:18  \nsdumitriu - (17:18): Normally, both fields have to be enabled so that you get proper user verification by email  \nsdumitriu - (17:18): With it, the user receives two mails  \nsburjan` - (17:18): yes  \nsdumitriu - (17:18): The first one says something like \"to confirm your account, click here\"  \nsburjan` - (17:19): 2 confirmations  \nsdumitriu - (17:19): After clicking there, he gets another mail, \"Well done, you exist\"  \nsburjan` - (17:19): and the other .. welcome to xwiki, your account is active  \nsburjan` - (17:19): yepp  \nsdumitriu - (17:19): But a lazy admin can change the first mail so that it says \"Well done, you exist\"  \nsdumitriu - (17:19): The user doesn't see a confirmation link, just the welcome message  \nsdumitriu - (17:20): The account theoretically is inactive  \nsburjan` - (17:20): so who confirms if the user doesnt get the email ?  \nsdumitriu - (17:20): But that doesn't matter, since the wiki doesn't check if the account is active or not  \nsdumitriu - (17:20): Nobody confirms, it doesn't matter, as long as the second preference is not enabled  \nmicw left at 17:21 (Quit: Verlassend  \ncjdelisle - (17:21): {{unrelated}} What's the deal with the classType field in the property table? What is it used for? Is it deprecated?  \nsburjan` - (17:21): so the admin will hace to manually make the account active ?  \nsdumitriu - (17:21): Which table?  \ncjdelisle - (17:22): XWikiProperty  \nsdumitriu - (17:22): sburjan`: No, the account can be inactive, if the second property is not enabled, the wiki never checks if the account is active or not  \nvmassol left at 17:22 (Client Quit  \nsdumitriu - (17:22): The \"active\" field is completely irrelevant  \ncjdelisle - (17:22): err BaseProperty  \ncjdelisle - (17:22): <property name=\"classType\" type=\"string\">  \nsdumitriu - (17:22): All users are active  \nsdumitriu - (17:22): cjdelisle: In hbm.xml?  \ncjdelisle - (17:22): yea.  \nsburjan` - (17:23): sdumitriu: I think I understand what you're saying  \nvmassol joined #xwiki at 17:24  \ncjdelisle - (17:24): I'd like to load it in XHS.saveXWikiProperty so that if the new prop is a different class than the stored prop then the stored prop is cleared. That way migrating properties in a class is easy.  \ncjdelisle - (17:25): So If I try to save a LargeString with the same id as an existing StringProp, it doesn't blow up.  \nsburjan` - (17:25): sdumitriu: what I dont understand is why by default xwiki doesnt check these fields, why is there the need to the second chkbox  \nsburjan` - (17:26): to \"force\" check  \nsdumitriu - (17:26): No reason  \nsdumitriu - (17:26): It just happens to be like that  \nabusenius - (17:26): :)  \nsburjan` - (17:26): well.. it was implemented in the UI too .. so it must have some purpose  \nsburjan` - (17:27): :)  \nsburjan` - (17:28): the purpose is to allow inactive users to login ?  \nsdumitriu - (17:28): Backwards compatibility?  \nsdumitriu - (17:28): Initially there was no \"active\" setting  \nsdumitriu - (17:28): Then introducing it means that after an upgrade no account works anymore  \nsdumitriu - (17:29): So it had to be optional  \nsburjan` - (17:29): still don't get the oint to have an active user and be able to login, if you can do nothing good ;)  \nsdumitriu - (17:29): cjdelisle: The classType setting is not that relevant  \nsburjan` - (17:29): still don't get the point to have an inactive user and be able to login, if you can do nothing good ;)  \nsdumitriu - (17:29): I doubt that it matters, at least for BaseProperty  \nabusenius - (17:30): sburjan`: it is supposed to give you a warm feeling ^^  \ncjdelisle - (17:30): Should I avoid using it lest it be removed in the future?  \nsburjan` - (17:30): sdumitriu : I see. so I won't touch this .. althought IMO is bad. back compatib keeps us tied  \nasrfel left at 17:30 (Quit: Leaving.  \ncjdelisle - (17:30): \\*I do plan to run this change by the list first.  \nsburjan` - (17:31): maybe easier and elegant to create a db migrration tool than keep all these obsolete settings in ui  \nsburjan` - (17:31): and not able to break the chains  \nmflorea - (17:32): sdumitriu: is \"defer\":false working for jsx in XE 2.4?  \nmflorea - (17:32): I couldn't find the issue  \nmflorea - (17:32): jira issue  \nsdumitriu - (17:37): mflorea: It should  \nmflorea - (17:38): ok, thanks  \nsburjan` - (17:39): abusenius : but if someone with inactive user besides the warm greeting starts exploiting an app to retrieve some data from the server ?  \nabusenius - (17:40): that was a joke  \nsburjan` - (17:40): :))  \nsburjan` - (17:42): I'm the only one who sees these behaviours as bad behaviuors ?  \nsdumitriu - (17:42): No  \nsburjan` - (17:42): I'm refering about logging in as inactive user :)  \nsdumitriu - (17:42): It is bad  \nsburjan` - (17:44): I really don't want to sound paranoic, but it's useless to add killer apps to platform is core is getting strange behaviours. I's not all just adding, we need a strong core  \nsburjan` - (17:44): to extend safely and elegantly on it  \nsburjan` - (17:46): don;t know exactly the interaction between appz and platform, but is it possible that an app doesnt verify the active/inactive state of an account and grant that user access to some pages that are out of the inactive users' scope ?  \nlucaa left at 17:48 (Quit: Leaving.  \nsburjan` - (17:48): if an xwiki instance forces users to auth, means that data stored in plain text is sensitive too, I'm not refering to passwords  \nlucaa joined #xwiki at 17:53  \nabusenius left at 18:14 (Ping timeout: 240 seconds  \nMartinCleaver left at 18:33 (Quit: MartinCleaver  \nabusenius joined #xwiki at 18:36  \nKermitTheFragger left at 18:42 (Quit: Leaving  \nvmassol left at 18:46 (Quit: Leaving.  \nvmassol joined #xwiki at 18:57  \nvmassol left at 19:00 (Client Quit  \nlucaa left at 19:12 (Ping timeout: 264 seconds  \nevalica left at 19:14 (Quit: Leaving.  \narkub left at 19:16 (Quit: Leaving  \npenyaskito\\_\\_ joined #xwiki at 20:03  \npenyaskito\\_ left at 20:07 (Ping timeout: 265 seconds  \nvmassol joined #xwiki at 20:12  \nsdumitriu left at 20:13 (Ping timeout: 240 seconds  \nvmassol left at 20:30 (Quit: Leaving.  \nEnygma` left at 20:54 (Quit: Leaving.  \nEnygma` joined #xwiki at 20:54  \ntmortagne left at 21:02 (Quit: Leaving.  \nlucaa joined #xwiki at 21:56  \nlucaa left at 22:11 (Ping timeout: 252 seconds  \nmflorea left at 22:19 (Quit: Leaving.  \nsdumitriu joined #xwiki at 22:20  \nsdumitriu - (22:20): cjdelisle: Hm, classType is useful for PropertyClass  \ncjdelisle - (22:21): Cool. I didn't want to propose adding code which would use it if nothing else was legitimately using it and it could be removed.  \nvmassol joined #xwiki at 22:40  \nvmassol left at 22:41 (Client Quit  \nEnygma` left at 22:56 (Ping timeout: 265 seconds  \ntmortagne joined #xwiki at 23:01  \ntmortagne left #xwiki at 23:01  \nMartinCleaver joined #xwiki at 23:08  \n\n"}