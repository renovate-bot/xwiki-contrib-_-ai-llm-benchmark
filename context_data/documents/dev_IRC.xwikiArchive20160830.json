{"id": "dev:IRC.xwikiArchive20160830", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20160830", "title": "IRC Archive for channel #xwiki on 30 August 2016 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<ansuz>\u00a0has quit  \n01:30\u00a0<martinus\\_\\_>\u00a0has quit  \n01:33\u00a0<martinus\\_\\_>\u00a0has joined #xwiki  \n01:49\u00a0<martinus\\_\\_>\u00a0has quit  \n01:51\u00a0<mflorea>\u00a0has quit  \n01:55\u00a0<martinus\\_\\_>\u00a0has joined #xwiki  \n07:17\u00a0<msmeria>\u00a0has joined #xwiki  \n08:28\u00a0<vmassol>\u00a0has joined #xwiki  \n08:37\u00a0<sdumitriu1>\u00a0has quit  \n08:44\u00a0<acotiuga>\u00a0has joined #xwiki  \n08:51\u00a0<tmortagne>\u00a0has joined #xwiki  \n08:58\u00a0<tmortagne>\u00a0has quit  \n08:59\u00a0<tmortagne>\u00a0has joined #xwiki  \n09:13\u00a0<sdumitriu1>\u00a0has joined #xwiki  \n09:30\u00a0<mflorea>\u00a0has joined #xwiki  \n09:35\u00a0<gdelhumeau>\u00a0has joined #xwiki  \n09:45\u00a0<ansuz>\u00a0has joined #xwiki  \n10:19\u00a0<Enygma`>\u00a0has joined #xwiki  \n10:20\u00a0<evalica>\u00a0has joined #xwiki  \n10:30\u00a0<xwikibot>\u00a0has joined #xwiki  \n10:38\u00a0<vmassol>\u00a0tmortagne: thanks for your comment on the diff between Text and PureText  \n10:38\u00a0<vmassol>\u00a0so I guess this means I need to change the type for the WikiMacroClass \"code\" property which I had set to puretext  \n10:38\u00a0<tmortagne>\u00a0has left #xwiki  \n10:38\u00a0<vmassol>\u00a0it should be \"text\" instead  \n10:38\u00a0<vmassol>\u00a0right?  \n10:38\u00a0<vmassol>\u00a0oops he's left :)  \n10:39\u00a0<tmortagne>\u00a0has joined #xwiki  \n10:39\u00a0<vmassol>\u00a0(since it contains wiki markup)  \n10:42\u00a0<vmassol>\u00a0fixing  \n11:10\u00a0<Trefex>\u00a0if i should upgrade, what's the upgrade path?  \n11:10\u00a0<Trefex>\u00a0thanks :D  \n11:10\u00a0<vmassol>\u00a0Trefex: upgrading is always good :)  \n11:10\u00a0<vmassol>\u00a0(almost always)  \n11:11\u00a0<vmassol>\u00a0hehe  \n11:11\u00a0<Trefex>\u00a0directly is ok ?  \n11:11\u00a0<vmassol>\u00a0yes  \n11:11\u00a0<Trefex>\u00a0ya gonna snapshot the VM before i spuose  \n11:11\u00a0<Trefex>\u00a0s/though/saw/  \n11:11\u00a0<vmassol>\u00a0yep it is!  \n11:11\u00a0<vmassol>\u00a0it now even supports wysiwyg editing  \n11:11\u00a0<vmassol>\u00a0bad bot!  \n11:11\u00a0<Trefex>\u00a0lol  \n11:12\u00a0\\*\u00a0Trefex punches the bot  \n11:12\u00a0<vmassol>\u00a0but I've made it optional  \n11:12\u00a0<vmassol>\u00a0no longer bundled by default  \n11:12\u00a0<Trefex>\u00a0really? Can I try it somewhere in a demo ?  \n11:12\u00a0<vmassol>\u00a0so you need to install it as an extension  \n11:12\u00a0<vmassol>\u00a0in your wiki :)  \n11:12\u00a0<Trefex>\u00a0before i upgrade :D  \n11:12\u00a0<vmassol>\u00a0you can try in your wiki but you need to remove the existing one  \n11:12\u00a0<vmassol>\u00a0there are instructions here:  \n11:13\u00a0<vmassol>\u00a0http://extensions.xwiki.org/xwiki/bin/view/Extension/Markdown+Syntaxes/#HPrerequisites26InstallationInstructions  \n11:13\u00a0<vmassol>\u00a0so in your case:  \n11:13\u00a0<vmassol>\u00a0\"To do so remove the following 2 JARs:WEB-INF/lib/xwiki-rendering-syntax-markdown10-<version>.jar and WEB-INF/lib/xwiki-rendering-syntax-markdown11-<version>.jar.\"  \n11:13\u00a0<vmassol>\u00a0and then restart and install the extension  \n11:14\u00a0<Trefex>\u00a0ok two options :d  \n11:15\u00a0<Trefex>\u00a0is there a doc page about the new editor capability for markdown ?  \n11:15\u00a0<Trefex>\u00a0If it works well, it's HUGE for us :)  \n11:16\u00a0<vmassol>\u00a0TBH it's preliminary work but should work for the basic mardown syntax. I need someone who uses MD to try it out for real  \n11:17\u00a0<vmassol>\u00a0my tests are done on contrived and small examples  \n11:17\u00a0<vmassol>\u00a0so you could help me test it and tune it  \n11:17\u00a0<vmassol>\u00a0do you have a wiki on myxwiki.org?  \n11:23\u00a0<vmassol>\u00a0Trefex: releasing a new version now  \n11:24\u00a0<Trefex>\u00a0vmassol: i don't have a wiki there i think, but i can make one?  \n11:24\u00a0<vmassol>\u00a0no need  \n11:24\u00a0<vmassol>\u00a0I'll install it on playground so that you can try it  \n11:25\u00a0<Trefex>\u00a0vmassol: ok perfect, let me know  \n11:25\u00a0<vmassol>\u00a0ah no  \n11:25\u00a0<vmassol>\u00a0can't  \n11:25\u00a0<vmassol>\u00a0:)  \n11:25\u00a0<vmassol>\u00a0playground is running 7.4.2  \n11:25\u00a0<vmassol>\u00a0so just do what I mentioned above  \n11:25\u00a0<vmassol>\u00a0(remove the 2 jars and install the extension)  \n11:26\u00a0<vmassol>\u00a0(if you want to try it)  \n11:26\u00a0<tmortagne>\u00a0if you just want to test it the simplest is probably to use a jetty/hsqldb 8.2.1 instance  \n11:26\u00a0<vmassol>\u00a0yep true  \n11:26\u00a0<tmortagne>\u00a0plus you get to test other 8.2.1 stuff before upgrade  \n11:27\u00a0<Trefex>\u00a0what's that  \n11:27\u00a0<tmortagne>\u00a0Trefex: \"Demon installation\" on http://www.xwiki.org/xwiki/bin/view/Download/DownloadVersion/?projectVersion=8.2.1  \n11:27\u00a0<Trefex>\u00a0Zip Package ?  \n11:28\u00a0<tmortagne>\u00a0s/Demon/Demo/  \n11:28\u00a0<tmortagne>\u00a0I prefer the zip package but it's just different way to install the same thing  \n11:28\u00a0<Trefex>\u00a0uh i could run it in a virtualbox  \n11:28\u00a0<tmortagne>\u00a0(the zip package does not put crap around)  \n11:28\u00a0<tmortagne>\u00a0no need it's completely portable app  \n11:29\u00a0<tmortagne>\u00a0you get embedded database, all data stay in the folder  \n11:29\u00a0<Trefex>\u00a0i can run in my Mac?  \n11:29\u00a0<tmortagne>\u00a0yes anywhere you have Java installed  \n11:29\u00a0<tmortagne>\u00a0you just unzip and run  \n11:29\u00a0<vmassol>\u00a0mflorea: i'm on myxwiki.org and I'm running the EM Extension Updater. I'm checking for updates on farm but I see it's checking all subwikis, is that normal?  \n11:30\u00a0<vmassol>\u00a0maybe we can't check just on the main wiki?  \n11:30\u00a0<tmortagne>\u00a0vmassol: checking just on main wiki is the default AFAIK, you explicitely asked for farm if it search on all wikis  \n11:30\u00a0<vmassol>\u00a0(which is a pity when you have 300 subwikis and you're looking for an extensions on the main wiki)  \n11:30\u00a0<Trefex>\u00a0holy moly  \n11:30\u00a0<Trefex>\u00a0that is fantastic  \n11:30\u00a0<vmassol>\u00a0ahhhh I could have misread or misunderstood the text  \n11:31\u00a0<vmassol>\u00a0it's very long, let's hope it doesn't bring myxwiki.org down :)  \n11:31\u00a0<mflorea>\u00a0vmassol: \"I'm checking for updates on farm\" <-- this means on all subwikis  \n11:31\u00a0<vmassol>\u00a0can't stop it...  \n11:32\u00a0<mflorea>\u00a0it's a job, runs in a background thread  \n11:32\u00a0<mflorea>\u00a0and yes, you can't stop it atm  \n11:32\u00a0<tmortagne>\u00a0vmassol: it's finished as far as I can see  \n11:32\u00a0<vmassol>\u00a0yep just now  \n11:33\u00a0<vmassol>\u00a0hmm didn't list anything  \n11:33\u00a0<tmortagne>\u00a0yes there seems to be some error  \n11:33\u00a0<vmassol>\u00a0org.xwiki.extension.job.plan.internal.DefaultExtensionPlanNode cannot be cast to org.xwiki.extension.job.internal.AbstractInstallPlanJob$ModifableExtensionPlanNode  \n11:33\u00a0<vmassol>\u00a0anyway I'll do the upgreade of the extension I wanted manually  \n11:33\u00a0<vmassol>\u00a0but this might be something we need to fix  \n11:37\u00a0<Trefex>\u00a0k will get back to you  \n11:37\u00a0<Trefex>\u00a0but so far i see  \n11:37\u00a0<Trefex>\u00a0error when rendering  \n11:37\u00a0<Trefex>\u00a0when editing the page again, all normal whitespaces are gone  \n11:38\u00a0<vmassol>\u00a0Trefex: when editing a page using MD?  \n11:38\u00a0<Trefex>\u00a0yep  \n11:38\u00a0<vmassol>\u00a0(using the wysiwyg editor)  \n11:38\u00a0<Trefex>\u00a0and the WYSIWYG is broken in the editor  \n11:38\u00a0<vmassol>\u00a0refresh your cache maybe  \n11:38\u00a0<vmassol>\u00a0browser cache  \n11:38\u00a0<vmassol>\u00a0you're supposed to see CKEditor btw  \n11:39\u00a0<Trefex>\u00a0http://imgur.com/a/c1Yv3  \n11:39\u00a0<Trefex>\u00a0second image now here too: http://imgur.com/a/c1Yv3  \n11:39\u00a0<Trefex>\u00a0this was after i hit save once  \n11:39\u00a0<Trefex>\u00a0brb vmassol  \n11:40\u00a0<vmassol>\u00a0wait  \n11:40\u00a0<vmassol>\u00a0Trefex: would be nice if you could open a jira issue at http://jira.xwiki.org/browse/MARKDOWN with content with which you can reproduce the problem  \n11:40\u00a0<vmassol>\u00a0(it has to be a problem with the content since I don't get this problem even with complex content)  \n11:41\u00a0<Trefex>\u00a0you can see the content in the screenshot  \n11:41\u00a0<Trefex>\u00a0it's not that complex  \n11:41\u00a0<Trefex>\u00a0i have meeting now, i'll do later  \n11:41\u00a0<vmassol>\u00a0I don't see it  \n11:41\u00a0<vmassol>\u00a0I only see the error  \n11:41\u00a0<Trefex>\u00a0refresh the page  \n11:41\u00a0<vmassol>\u00a0ok got it  \n11:41\u00a0<vmassol>\u00a0thanks  \n11:41\u00a0<vmassol>\u00a0see you later  \n11:50\u00a0<vmassol>\u00a0ok I can reproduce the NPE, fixing  \n11:51\u00a0<vmassol>\u00a0then I need to reproduce the newline issue  \n11:51\u00a0<vmassol>\u00a0FTR this NPE issue you had it already in your current version :)  \n12:05\u00a0<vmassol>\u00a0FTR the issue is having a space in the image reference  \n12:06\u00a0<vmassol>\u00a0(this is not supported by MD and pegdown)  \n12:06\u00a0<vmassol>\u00a0preventing the NPE  \n12:33\u00a0<vmassol>\u00a0tmortagne: what do you think is better to do for the MD parser when there's a space in an image reference (ex: \"![label](ref with space)\"):  \n12:33\u00a0<vmassol>\u00a0option 1: generate ![label] \u00a0+ the text \"(ref with space)\"  \n12:34\u00a0<vmassol>\u00a0option 2: generate an exception failing the whole MD rendering saying that spaces are not supported in image ref  \n12:34\u00a0<vmassol>\u00a0?  \n12:34\u00a0<vmassol>\u00a0I'm hesitating  \n12:36\u00a0<vmassol>\u00a0the problem with option 1 is that it doesn't generate something that has much meaning  \n12:37\u00a0<vmassol>\u00a0actually in html it generates  \n12:37\u00a0<vmassol>\u00a0\"<p>(link with space)</p>\"  \n12:37\u00a0<vmassol>\u00a0<p>(ref with space)</p>  \n12:41\u00a0<vmassol>\u00a0basically pegdown ignores the reference part when there's a space  \n12:42\u00a0<vmassol>\u00a0I could generate something with the label  \n12:42\u00a0<vmassol>\u00a0bu t not sure what would make sense  \n12:56\u00a0<vmassol>\u00a0ok I know what I'll do  \n12:56\u00a0<vmassol>\u00a0since I've done it already for links  \n12:56\u00a0<vmassol>\u00a0I'll consider the label to be the reference  \n13:15\u00a0<tmortagne>\u00a0vmassol: I don't know what is best, I would look a other MD rendered like github  \n13:15\u00a0<tmortagne>\u00a0i.e. the best is to do the same as other tools  \n13:16\u00a0<vmassol>\u00a0good idea  \n13:16\u00a0<vmassol>\u00a0but they probbaly handle spaces :)  \n13:16\u00a0<tmortagne>\u00a0then it's a pegdown bug  \n13:16\u00a0<vmassol>\u00a0it is IMO  \n13:16\u00a0<vmassol>\u00a0but that doesn't help us :)  \n13:16\u00a0<tmortagne>\u00a0is it reported on their side ?  \n13:16\u00a0<vmassol>\u00a0you reported it  \n13:16\u00a0<vmassol>\u00a0for links  \n13:16\u00a0<vmassol>\u00a0but it's the same  \n13:17\u00a0<tmortagne>\u00a0ok, don't remember  \n13:17\u00a0<vmassol>\u00a0https://github.com/sirthias/pegdown/issues/216  \n13:17\u00a0<tmortagne>\u00a0maybe we could try to fix it ourself then and provide a pull request, should make easier to have it  \n13:17\u00a0<vmassol>\u00a0too bad we don't have an ErrorBlock  \n13:17\u00a0<vmassol>\u00a0for inline errors  \n13:18\u00a0<vmassol>\u00a0I can generate something like \"Error: \u2026.\"  \n13:19\u00a0<vmassol>\u00a0yes it's pluggable and we can most likely plug a custom parser part  \n13:19\u00a0<vmassol>\u00a0but it's complex  \n13:22\u00a0<tmortagne>\u00a0vmassol: seems to me the real issue for you use case is actually https://github.com/sirthias/pegdown/issues/92  \n13:22\u00a0<tmortagne>\u00a0[label](url) syntax is only for urls  \n13:22\u00a0<vmassol>\u00a0yes  \n13:23\u00a0<vmassol>\u00a0we do support the [[\u2026]]\u00a0syntax, it's only missing labels support in pegdown  \n13:23\u00a0<vmassol>\u00a0but that's for links  \n13:23\u00a0<vmassol>\u00a0not images  \n13:29\u00a0<gene>\u00a0has quit  \n13:29\u00a0<gene>\u00a0has joined #xwiki  \n13:45\u00a0<mflorea>\u00a0vmassol: re http://jira.xwiki.org/browse/XWIKI-12832 and http://jira.xwiki.org/browse/XWIKI-13183 I think we should \\*by default\\* display the page titles in the current locale and sort the pages by the raw translated title (which is the closest to what we display). WDYT?  \n13:48\u00a0<vmassol>\u00a0(mflorea, will check this after lunch, finishing somthing first then going for lunch)  \n13:49\u00a0<mflorea>\u00a0the downside is the order of the default pages we get when you install XWiki  \n13:49\u00a0<mflorea>\u00a0order by name: Blog, Home, Sandbox, XWiki (<-- what we currently have)  \n13:49\u00a0<mflorea>\u00a0order by title: Blog, XWiki, Home, Sandbox  \n13:50\u00a0<mflorea>\u00a0that is because Blog title is empty and XWiki title uses $services.localization, so the title starts with $  \n13:51\u00a0<tmortagne>\u00a0mflorea: what does \"\\*by default\\*\" mean ?  \n13:51\u00a0<mflorea>\u00a0what you see in the navigation panel and in the page index  \n13:51\u00a0<mflorea>\u00a0and the breadcrumb trees  \n13:51\u00a0<mflorea>\u00a0what you get with {{documentTree /}}  \n13:54\u00a0<tmortagne>\u00a0what about adding a configuration somewhere to indicate what source to use for document tree and provide (at least) the following two sources:  \n13:54\u00a0<tmortagne>\u00a0\\* a raw title based one (the one used by default)  \n13:54\u00a0<tmortagne>\u00a0\\* a Solr based one (configured in XE)  \n13:54\u00a0<tmortagne>\u00a0?  \n13:54\u00a0<vmassol>\u00a0Trefex: just fixed the white space issue: http://jira.xwiki.org/browse/MARKDOWN-12  \n13:56\u00a0<tmortagne>\u00a0Solr is the best implementation in term of performances but it's not very nice to make core feature like document tree require it when we want solr to be an extension  \n13:56\u00a0<mflorea>\u00a0tmortagne: db is faster than solr  \n13:57\u00a0<mflorea>\u00a0but we don't have the rendered title  \n13:57\u00a0<tmortagne>\u00a0yes so it's not faster :)  \n13:58\u00a0<tmortagne>\u00a0I'm talking about source here, not just the first request to get the list  \n13:58\u00a0<tmortagne>\u00a0Solr is by far the fastest because of title rendering  \n13:58\u00a0<mflorea>\u00a0now, the Solr schema as it is right now doesn't provide all the required info. We would need to index spaces, in order to be able to support the holes we can have in the hierarchy  \n13:59\u00a0<tmortagne>\u00a0that's something we want anyway I think  \n14:00\u00a0<mflorea>\u00a0for my fix I'm still using the db, but I moved the code that controls the hierarchy in a component. So we can later add an implementation based on Solr  \n14:01\u00a0<mflorea>\u00a0the document tree uses $services.tree.nestedPages.getChildren(...)  \n14:05\u00a0<vmassol>\u00a0Trefex: new line work fine here. Can you tell me exactly what you've typed so that I can reproduce?  \n14:05\u00a0<vmassol>\u00a0(going for lunch now but I'll read your answer when I'm back)  \n14:19\u00a0<mflorea>\u00a0tmortagne: one thing that I'm not sure how we could implement in Solr is \"sort by translated title with fallback on default translation\". i.e. if the document has a translation for the current locale, then use its title otherwise use the title of the default translation. I'm currently using a left join on DB, but for Sold we need something different.  \n14:19\u00a0<mflorea>\u00a0actually the fallback is [translated title, default title, page name]  \n14:20\u00a0<tmortagne>\u00a0mflorea: don't we have something already for this ? solr is supposed to have a field locales with all the supported locales for which this title fit  \n14:20\u00a0<mflorea>\u00a0for Solr we probably need to have a field that does this fallback at index time  \n14:20\u00a0<tmortagne>\u00a0well that's the thing we have this field already  \n14:21\u00a0<mflorea>\u00a0tmortagne: how would you use this locales field to sort the results?  \n14:21\u00a0<mflorea>\u00a0sort by [translated title, default title, page name]  \n14:22\u00a0<tmortagne>\u00a0what do you mean by sort  \n14:22\u00a0<tmortagne>\u00a0this field filters  \n14:22\u00a0<mflorea>\u00a0the child nodes are sorted  \n14:22\u00a0<mflorea>\u00a0in the tree  \n14:22\u00a0<tmortagne>\u00a0sure but but the sort is done \"after\" the filtering  \n14:23\u00a0<mflorea>\u00a0ok, then how would you express this filter \"given me the translation, or, if it doesn't exist give me the default translation\"  \n14:23\u00a0<tmortagne>\u00a0you don't  \n14:24\u00a0<mflorea>\u00a0you need to  \n14:24\u00a0<tmortagne>\u00a0again you have a \"locales\" field which you contains all the supported locales for which this document is the right one  \n14:25\u00a0<tmortagne>\u00a0for example if you have in supported languages \"fr, en\" a document with locale \"\" and no translations you will all 3 locales in \"locales\" field  \n14:25\u00a0<mflorea>\u00a0using locales=en doesn't match multiple translations?  \n14:25\u00a0<tmortagne>\u00a0all you have to do with do the Solr request with a locales which is part of the supported locales  \n14:26\u00a0<tmortagne>\u00a0locales=en will matches only documents you would see if you have en as current locale  \n14:27\u00a0<tmortagne>\u00a0the \"locales\" field contains all the supported locales for which the document is the one to show in the UI  \n14:28\u00a0<tmortagne>\u00a0the fallback is \"calculated\" during index basically  \n14:30\u00a0<tmortagne>\u00a0I initially did this so that the main Solr search would look in all the documents you would see with the current locale instead on only the documents explicitly for the current locale  \n14:30\u00a0<tmortagne>\u00a0so this field is pretty old  \n14:31\u00a0<mflorea>\u00a0I know it'old  \n14:34\u00a0<mflorea>\u00a0I though there could be multiple translations of a doc matched by locales=en, but it's not the case  \n14:35\u00a0<tmortagne>\u00a0\"so this field is pretty old\" = might have been broken since it is not used anymore in the main UI but it's what it's supposed to do  \n14:36\u00a0<mflorea>\u00a0it shouldn't be broken, I don't remember touching it, but indeed the search UI doesn't use it  \n14:37\u00a0<tmortagne>\u00a0anyway import thing is that the concept already exist and just need to check if it still work and fix it otherwise since that would be a regression  \n14:37\u00a0<mflorea>\u00a0now, another thing that worries me about Solr is sort and pagination performance. Solr is super fast for getting the fist page of result sorted by score  \n14:37\u00a0<mflorea>\u00a0but if you want to paginate and sort by something else, it may not be that super fast  \n14:38\u00a0<tmortagne>\u00a0sort performances is not so bad (especially compared to render each title one by one :)), highlight is  \n14:38\u00a0<tmortagne>\u00a0s/highlight is/highlight is pretty bad/  \n14:39\u00a0<tmortagne>\u00a0this remind me that we are starting to be quite behind on Solr version, they often improve performances  \n14:39\u00a0<mflorea>\u00a0another thing, if a page uses $services.localization in its title, what do we index?  \n14:40\u00a0<tmortagne>\u00a0whatever was the current locale when this document was saved I guess  \n14:41\u00a0<mflorea>\u00a0most probably, so the sort won't be perfect  \n14:42\u00a0<tmortagne>\u00a0not in this used case no, the only way around would be to have a field for each locale and render the title for each locale when the document is saved  \n14:42\u00a0<tmortagne>\u00a0anyway it's not possible to fully support dynamic titles  \n14:42\u00a0<tmortagne>\u00a0it could depend on the current user, the date, etc...  \n14:42\u00a0<tmortagne>\u00a0but won't be better with DB  \n15:01\u00a0<vmassol>\u00a0mflorea: back. You still \u00a0need my input or is the discussion with thomas enough?  \n15:02\u00a0<mflorea>\u00a0the discussion with tmortagne was on a different subject (related though)  \n15:02\u00a0<Trefex>\u00a0am back vmassol, will try to create a use case for you  \n15:03\u00a0<vmassol>\u00a0Trefex: ok great thanks. I'm watiing for see if there's a bug before releasing a new version of the markdown extension  \n15:03\u00a0<mflorea>\u00a0basically my initial question is where it's fine if the user sees \"XWiki, Blog, Main, Sandbox\" in the tree by default  \n15:03\u00a0<Trefex>\u00a0vmassol: ok it breaks when you drag and drop an image into the WYSIWIG part, and then save  \n15:03\u00a0<vmassol>\u00a0actually it works  \n15:03\u00a0<vmassol>\u00a0I think  \n15:04\u00a0<Trefex>\u00a0well i can do a video if you want :)  \n15:04\u00a0<vmassol>\u00a0but you must not have spaces in the image name  \n15:04\u00a0<Trefex>\u00a0ah  \n15:04\u00a0<Trefex>\u00a0that is a shitty constraint  \n15:04\u00a0<Trefex>\u00a0can't you rename those in import ?  \n15:04\u00a0<vmassol>\u00a0and the image syntax only accepts urls  \n15:04\u00a0<vmassol>\u00a0see https://github.com/sirthias/pegdown/issues/243  \n15:04\u00a0<vmassol>\u00a0and https://github.com/sirthias/pegdown/issues/24392  \n15:05\u00a0<vmassol>\u00a0wrong last link  \n15:05\u00a0<vmassol>\u00a0(https://github.com/sirthias/pegdown/issues/92)  \n15:05\u00a0<vmassol>\u00a0mflorea: where = whether? checking what you said above  \n15:05\u00a0<Trefex>\u00a0so you opened a ticket and an issue  \n15:05\u00a0<Trefex>\u00a0and you say it works :D  \n15:06\u00a0<vmassol>\u00a0what I mean is that it only fails if you have spaces  \n15:06\u00a0<mflorea>\u00a0yes, \"whether it's fine\"  \n15:06\u00a0<Trefex>\u00a0vmassol: ok, can i rename an attachment?  \n15:06\u00a0<Trefex>\u00a0or somehow remove white spaces on import ?  \n15:06\u00a0<vmassol>\u00a0no  \n15:06\u00a0<vmassol>\u00a0no  \n15:06\u00a0<vmassol>\u00a0:)  \n15:06\u00a0<vmassol>\u00a0attachment names support all chars  \n15:07\u00a0<Trefex>\u00a0roh  \n15:07\u00a0<Trefex>\u00a0then we don't want to use it yet :)  \n15:07\u00a0<Trefex>\u00a0let me do some other tests  \n15:08\u00a0<vmassol>\u00a0actually  \n15:08\u00a0<vmassol>\u00a0forget that  \n15:08\u00a0<Trefex>\u00a0no tests?  \n15:08\u00a0<vmassol>\u00a0wdym?  \n15:08\u00a0<Trefex>\u00a0not sure what you mean :)  \n15:09\u00a0<M-mouhb>\u00a0has quit  \n15:09\u00a0<M-mouhb>\u00a0has joined #xwiki  \n15:09\u00a0<M-cjd>\u00a0has quit  \n15:09\u00a0<M-yflory>\u00a0has quit  \n15:09\u00a0<M-cjd>\u00a0has joined #xwiki  \n15:10\u00a0<M-yflory>\u00a0has joined #xwiki  \n15:10\u00a0<Chris[m]>\u00a0has quit  \n15:10\u00a0<jihad[m]>\u00a0has quit  \n15:11\u00a0<Trefex>\u00a0vmassol:  \n15:11\u00a0<Trefex>\u00a0try the following  \n15:11\u00a0<Chris[m]>\u00a0has joined #xwiki  \n15:11\u00a0<Trefex>\u00a0https://paste.fedoraproject.org/417261/62700147/  \n15:11\u00a0<Trefex>\u00a0save, edit, save  \n15:11\u00a0<Trefex>\u00a0now it is fucked and the content of the code block vanished  \n15:12\u00a0<vmassol>\u00a0mflorea: not sure what you mean by \"basically my initial question is where it's fine if the user sees \"XWiki, Blog, Main, Sandbox\" in the tree by default\"  \n15:12\u00a0<vmassol>\u00a0Trefex: ok, I'l try. Coud you also find how to reproduce the issue you had with newlines  \n15:12\u00a0<vmassol>\u00a0?  \n15:13\u00a0<Trefex>\u00a0vmassol: that happens when you insert an image with spaces  \n15:13\u00a0<Trefex>\u00a0then it renders the edit window by putting everything in one line  \n15:15\u00a0<mflorea>\u00a0vmassol: currently the navigation panel shows \"Blog, Home, Sandbox, XWiki\". The nodes appear sorted (because the tree is sorted by page name). With my changes the navigation panel will display \"XWiki, Blog, Home, Sandbox\", which is the order when you sort by (raw) page title.  \n15:16\u00a0<jihad[m]>\u00a0has joined #xwiki  \n15:16\u00a0<vmassol>\u00a0mflorea: I don't get it. You want to sort by raw page title but not display the titles?  \n15:18\u00a0<mflorea>\u00a0no, I'm just explaining you how the navigation panel looks like when sorted by page name vs. sorted by page title, and I would like to know if you're ok with how it looks like when sorted by raw page title  \n15:18\u00a0<vmassol>\u00a0sorry but I can't answer without seeing how it's displayed with titles  \n15:18\u00a0<vmassol>\u00a0(I don't know them by heart)  \n15:18\u00a0<vmassol>\u00a0would you have an image?  \n15:18\u00a0<mflorea>\u00a0I just showed you..  \n15:18\u00a0<vmassol>\u00a0I don't understand  \n15:18\u00a0<vmassol>\u00a0\"Blog\" is the title?  \n15:19\u00a0<vmassol>\u00a0and \"XWiki\" is the title?  \n15:19\u00a0<vmassol>\u00a0so why is \"XWiki\" before \"Blog\"?  \n15:19\u00a0<vmassol>\u00a0(I'm mssing some data/context to understand)  \n15:19\u00a0<mflorea>\u00a0you can check on your instance, \"Blog\" is the rendered title of the Blog home page  \n15:20\u00a0<vmassol>\u00a0raw title is what?  \n15:20\u00a0<mflorea>\u00a0empty, for Blog.WebHome  \n15:20\u00a0<vmassol>\u00a0so raw title is WebHome, is that it?  \n15:20\u00a0<mflorea>\u00a0the tree display the rendered title, no change here  \n15:21\u00a0<mflorea>\u00a0raw title is what you put in the title field in wiki edit mode. It's not WebHome. For Blog.WebHome the title field is left empty  \n15:23\u00a0<vmassol>\u00a0so what's the proposal? to have the sort by default or to have it as an option?  \n15:23\u00a0<vmassol>\u00a0because it doesn't look that good  \n15:23\u00a0<vmassol>\u00a0I remember saying \"\"Just to be clear, what's a no go for me is not that we sort by raw title but that we sort on something different than what we display (so if we display raw titles then sorting by raw titles is ok).\"\"  \n15:24\u00a0<mflorea>\u00a0the reason \"XWiki\" appears before \"Blog\" is because the row title of XWiki.WebHome is \"$services.localization...\"  \n15:25\u00a0<mflorea>\u00a0vmassol: you cannot sort exactly on what we display as long as we have dynamic titles, there's no perfect solution here.  \n15:25\u00a0<mflorea>\u00a0the question is whether sorting by raw title is better than sorting by page name  \n15:26\u00a0<mflorea>\u00a0I think it is, for the end user, even if the navigation panel show XWiki before  \n15:26\u00a0<vmassol>\u00a0I don't know  \n15:26\u00a0<vmassol>\u00a0I would need to see this in action for real  \n15:26\u00a0<vmassol>\u00a0hard to answer  \n15:26\u00a0<vmassol>\u00a0now for the tree entries you get in a clean wiki  \n15:27\u00a0<vmassol>\u00a0I guess it could be possible to tune some titles so that they appear in the \"right\" order  \n15:27\u00a0<mflorea>\u00a0the users won't change the navigation panel or the page index to change the sort order, if we don't use title sort by default  \n15:27\u00a0<vmassol>\u00a0unless ther'e's a sorting option in the panel  \n15:27\u00a0<mflorea>\u00a0and the users will care more about their content  \n15:28\u00a0<mflorea>\u00a0not the default pages  \n15:28\u00a0<vmassol>\u00a0we can be sure they'll ask questions anyway  \n15:28\u00a0<vmassol>\u00a0especially if the default doesn't match the order  \n15:34\u00a0<tmortagne>\u00a0mflorea: content is not just simple wiki pages, entries created in some app usually have empty title  \n15:34\u00a0<mflorea>\u00a0empty title is fine, there's a fallback on page name in this case  \n15:34\u00a0<mflorea>\u00a0the problem is with velocity code in page titles  \n15:34\u00a0<tmortagne>\u00a0but the page name might not have much to do with the rendered title  \n15:35\u00a0<mflorea>\u00a0sure, I didn't say it's perfect, there's no perfect solution  \n15:36\u00a0<tmortagne>\u00a0well that's my point too, \"we sort on something different than what we display\" is impossible to reach 100% if we show display title  \n15:37\u00a0<tmortagne>\u00a0mflorea: like you I'm fine with it but as long as vmassol make it a blocker I don't see any way to support rendered titles  \n15:46\u00a0<vmassol>\u00a0\"empty title is fine, there's a fallback on page name in this case\" why is it fine?  \n15:46\u00a0<vmassol>\u00a0for nested pages this means \"WebHome\", no?  \n15:47\u00a0<msmeria>\u00a0has quit  \n15:49\u00a0<vmassol>\u00a0IMO the documentTree macro should support several options: display rendered titles or page names and sort on raw title or page name. Then the question is about the default and what we want to have in the Nav Panel and in AllDocs's tree tab, by default (and whether it's possible to change the view from there).  \n15:50\u00a0<vmassol>\u00a0It's really hard to know what's the best default without seeing it on a default wiki and on a wiki with data (for example some existing wiki).  \n15:50\u00a0<vmassol>\u00a0which is why I was asking for some images  \n15:51\u00a0<vmassol>\u00a0I'm fine to try whatever you want to not be blocked though  \n15:51\u00a0<vmassol>\u00a0let's sya it differently  \n15:52\u00a0<vmassol>\u00a0without seeing more and spending more time to try it out under various situations, I'm 0  \n15:52\u00a0<vmassol>\u00a0(not -1 and not +1). I'll go with what you think is best  \n15:52\u00a0<vmassol>\u00a0(since you've worked on the topic a lot more than I've done)  \n15:53\u00a0<vmassol>\u00a0FTR this is exactly what I mentioned in the jira issue too  \n15:54\u00a0<vmassol>\u00a0ok not exactly, but close :)  \n15:54\u00a0<vmassol>\u00a0Anca said:  \n15:55\u00a0<vmassol>\u00a0\"I changed the type of the issue from \"improvement\" to \"bug\" because, for the end user, seeing a hierarchy as the one in the attachmenthttp://jira.xwiki.org/secure/attachment/32536/32536\\_UnsortedDocumentTree.png looks more like a bug than an improvement. It's difficult to understand why that tree looks like that.\"  \n15:55\u00a0<vmassol>\u00a0my bet is that someone will report a bug soon after we do this, saying that same thing, in the opposite direction ;)  \n15:55\u00a0<vmassol>\u00a0especially since by default it'll look unsorted  \n15:55\u00a0<vmassol>\u00a0by default \u00a0= when starting with xwiki  \n15:56\u00a0<mflorea>\u00a016:46 <vmassol> for nested pages this means \"WebHome\", no?  \n15:56\u00a0<mflorea>\u00a0no  \n15:57\u00a0<mflorea>\u00a0for nested pages it means the space name, I've taken care of this  \n15:57\u00a0<vmassol>\u00a0ok  \n15:57\u00a0<tmortagne>\u00a0mflorea: IMO if we show display title, Solr is the solution that will give the less complain (since that's the only one storing them, at least display title in the context when the document was saved). We will have way too many issues with applications with a DB based solution  \n15:58\u00a0<vmassol>\u00a0mflorea: \u00a0a quick offtopic solution. Can I still have a debug view of the WYSIWYG even with CK? I don't reember what query string parameter I should use (but debug=true doesn't seem to work)  \n15:59\u00a0<vmassol>\u00a0too bad if we don't have it with CK, it was a nice feature when debugging a rendering issue in the wysiwyg ;)  \n15:59\u00a0<blabla2[m]>\u00a0has quit  \n16:00\u00a0<M-vmassol>\u00a0has quit  \n16:02\u00a0<mflorea>\u00a0tmortagne: Solr provides a solution for the rendered title, but it brings its own complexities. I find it strange to use a search engine to get the data for the tree. Solr wasn't meant for this and I'm worried that its performance may decrease when it's used as a store rather than as a search engine. I remember reading somewhere that it's not recommended to use only Solr to store your content  \n16:04\u00a0<vmassol>\u00a0so you're saying that solr is not a contender for elasticsearch for example  \n16:04\u00a0<mflorea>\u00a0vmassol: I'm not sure what debug mode you are referring to  \n16:04\u00a0<vmassol>\u00a0because ES is supposed to be used as a store for sure  \n16:04\u00a0<vmassol>\u00a0mflorea: the mode where you could side the various inputs side by side  \n16:04\u00a0<blabla2[m]>\u00a0has joined #xwiki  \n16:04\u00a0<vmassol>\u00a0s/side/see  \n16:04\u00a0<vmassol>\u00a0syntax before conversion to HTML  \n16:04\u00a0<vmassol>\u00a0s/syntax/content  \n16:05\u00a0<vmassol>\u00a0content after HTML conversion  \n16:05\u00a0<vmassol>\u00a0content after conversion back to syntax  \n16:05\u00a0<M-vmassol>\u00a0has joined #xwiki  \n16:05\u00a0<mflorea>\u00a0I haven't use that in years  \n16:05\u00a0<mflorea>\u00a0you have the network tab  \n16:05\u00a0<mflorea>\u00a0that's what I use, I forgot about this debug mode  \n16:05\u00a0<mflorea>\u00a0brb  \n16:05\u00a0<vmassol>\u00a0testing  \n16:06\u00a0<vmassol>\u00a0hmm  \n16:07\u00a0<vmassol>\u00a0don't see the request  \n16:07\u00a0<vmassol>\u00a0wait  \n16:07\u00a0<vmassol>\u00a0I was filtering on XHR only  \n16:07\u00a0<vmassol>\u00a0:)  \n16:09\u00a0<vmassol>\u00a0still trying to find it  \n16:10\u00a0<vmassol>\u00a0ok I'm stopping searching  \n16:10\u00a0<vmassol>\u00a0I'll just put breakpoints in the code...  \n16:28\u00a0<mflorea>\u00a0vmassol: you need to Save & Continue or switch to Source to see the request  \n16:32\u00a0<vmassol>\u00a0ah ok  \n16:33\u00a0<vmassol>\u00a0mflorea: could you help me location the place where I can put a breakpoint in CK  \n16:33\u00a0<vmassol>\u00a0the place where it converts from HTML to the target syntax  \n16:34\u00a0<mflorea>\u00a0the conversion is done on the server side  \n16:34\u00a0<vmassol>\u00a0so still using the gwt service?  \n16:35\u00a0<vmassol>\u00a0(don't remember exactly the same)  \n16:35\u00a0<vmassol>\u00a0looking ofr it...  \n16:35\u00a0<mflorea>\u00a0no  \n16:35\u00a0<vmassol>\u00a0DefaultHTMLConverter  \n16:35\u00a0<mflorea>\u00a0for save action there is the ConversionFilter (servlet filter)  \n16:35\u00a0<mflorea>\u00a0which calls DefaultHTMLConverter indeed  \n16:36\u00a0<vmassol>\u00a0fromHTML() I gurss  \n16:36\u00a0<mflorea>\u00a0yes  \n16:36\u00a0<vmassol>\u00a0thx  \n16:37\u00a0<mflorea>\u00a0this is for save action  \n16:37\u00a0<vmassol>\u00a0hmm something is weird  \n16:38\u00a0<vmassol>\u00a0this is what I see when editing in CK: https://www.evernote.com/l/AHfhJJT1bIVMcq\\_dTZvHddsRJGuWV8\\_xyoU  \n16:38\u00a0<vmassol>\u00a0but when I hit save  \n16:38\u00a0<vmassol>\u00a0in fromHTML() I get the following HTML as input  \n16:39\u00a0<vmassol>\u00a0https://gist.githubusercontent.com/vmassol/6810a932570eab2f14424786a319a991/raw/23db91bbe85a59496f92dba37fc9f3438a4efa83/gistfile1.txt  \n16:39\u00a0<vmassol>\u00a0as you can see the content has been lost  \n16:40\u00a0<xwikiorg\\_guest\\_8>\u00a0has joined #xwiki  \n16:40\u00a0<mflorea>\u00a0that's normal  \n16:40\u00a0<vmassol>\u00a0ah ? :)  \n16:40\u00a0<mflorea>\u00a0what you see in CK is the macro output, we don't submit the macro output  \n16:41\u00a0<mflorea>\u00a0the macro output is not saved  \n16:41\u00a0<vmassol>\u00a0argh\u2026.  \n16:41\u00a0<xwikiorg\\_guest\\_8>\u00a0b  \n16:42\u00a0<xwikiorg\\_guest\\_8>\u00a0hey there  \n16:42\u00a0<xwikiorg\\_guest\\_8>\u00a0i'm new to open source  \n16:42\u00a0<xwikiorg\\_guest\\_8>\u00a0could i get some help  \n16:43\u00a0<mflorea>\u00a0vmassol: the macro content is missing from the macro marker it seems  \n16:43\u00a0<mflorea>\u00a0!--startmacro:code|-|language=\"php\"|-|-->  \n16:43\u00a0<mflorea>\u00a0this means {{code language=\"php\" /}}  \n16:43\u00a0<mflorea>\u00a0no content  \n16:43\u00a0<vmassol>\u00a0yes that's what I get in output thus failing the round trip  \n16:44\u00a0<vmassol>\u00a0checking the HTML syntax code now  \n16:44\u00a0<mflorea>\u00a0check the HTML input, is the macro content correctly encoded in the macro marker?  \n16:44\u00a0<mflorea>\u00a0there may be an issue there  \n16:44\u00a0<xwikiorg\\_guest\\_8>\u00a0has quit  \n16:44\u00a0<vmassol>\u00a0you mean output of toHTML()?  \n16:46\u00a0<mflorea>\u00a0I don't think so, let me check  \n16:46\u00a0<vmassol>\u00a0seems good: https://gist.githubusercontent.com/vmassol/48d366a188bd29f3f28b1daf4daa5014/raw/851f54f347c9cbdad1d9a0c1eaad0318e936d312/gistfile1.txt  \n16:46\u00a0<mflorea>\u00a0$!services.wysiwyg.toAnnotatedXHTML($source.content, $source.syntax.toIdString())  \n16:47\u00a0<vmassol>\u00a0(what I've pasted is hte output of toHTML())  \n16:47\u00a0<vmassol>\u00a0ie from source syntax to HTML  \n16:47\u00a0<vmassol>\u00a0then CK uses that HTML  \n16:48\u00a0<mflorea>\u00a0ok, let's check with a validator  \n16:53\u00a0<mflorea>\u00a0seems to be valid  \n16:54\u00a0<vmassol>\u00a0so the content is lost somewhere inside ck processing right?  \n16:54\u00a0<vmassol>\u00a0(when saving)  \n16:54\u00a0<vmassol>\u00a0I guess you have some cleanup when saving  \n16:54\u00a0<vmassol>\u00a0before calling fromHTML()  \n16:55\u00a0<mflorea>\u00a0yes, on the client side  \n16:55\u00a0<vmassol>\u00a0what shall I do? Shall I open a jira issue with the HTML input?  \n16:56\u00a0<vmassol>\u00a0can I debug further or is it going to be complex for me?  \n16:58\u00a0<vmassol>\u00a0what's strange is that it seems to work with with xwiki syntax 2.1  \n16:58\u00a0<vmassol>\u00a0s/with with/fine with  \n17:00\u00a0<vmassol>\u00a0wait  \n17:00\u00a0<vmassol>\u00a0needs ot use the same input  \n17:00\u00a0<vmassol>\u00a0maybe it's the <php> causing the problem  \n17:00\u00a0<vmassol>\u00a0testing  \n17:00\u00a0<mflorea>\u00a0could be an issue on https://github.com/xwiki-contrib/application-ckeditor/blob/master/plugins/src/main/resources/xwiki-macro/plugin.js#L204 (parseMacroCall / serializeMacroCall)  \n17:01\u00a0<vmassol>\u00a0yep  \n17:01\u00a0<mflorea>\u00a0I have some unit tests in https://github.com/xwiki-contrib/application-ckeditor/blob/master/plugins/src/test/resources/xwiki-macro.js#L147  \n17:01\u00a0<vmassol>\u00a0same proboem with xwiki syntax 2.1  \n17:01\u00a0<mflorea>\u00a0I could add a unit test for this use case  \n17:01\u00a0<vmassol>\u00a0so the issue  \n17:01\u00a0<vmassol>\u00a0is the first <  \n17:01\u00a0<vmassol>\u00a0if I remove it, it works fine  \n17:02\u00a0<vmassol>\u00a0mflorea: https://gist.github.com/vmassol/dc197aa21e04438c445ef605f8fb8e53  \n17:02\u00a0<mflorea>\u00a0maybe because it's not XML-encoded  \n17:03\u00a0<vmassol>\u00a0yes most likely  \n17:03\u00a0<vmassol>\u00a0so could be a HTML syntax bug actually  \n17:03\u00a0<vmassol>\u00a0checking that  \n17:04\u00a0<mflorea>\u00a0but it's strange that https://validator.w3.org doesn't complain  \n17:05\u00a0<vmassol>\u00a0it would be strange that we have this bug since forever...  \n17:10\u00a0<vmassol>\u00a0so the code is in XHTMLMacroRenderer  \n17:10\u00a0<vmassol>\u00a0and then we call printXMLComment() which may contain the bug  \n17:10\u00a0<vmassol>\u00a0checking more  \n17:10\u00a0<acotiuga>\u00a0has quit  \n17:11\u00a0<vmassol>\u00a0haha this cals XMLUtils.escapeXMLComment()  \n17:11\u00a0<vmassol>\u00a0checking there now  \n17:13\u00a0<vmassol>\u00a0indeed it doesn't escape the <  \n17:13\u00a0<vmassol>\u00a0now I need to find the HTML spec to see if we need to escape < in html comments or not  \n17:17\u00a0<vmassol>\u00a0well  \n17:17\u00a0<vmassol>\u00a0still need to find the answer but AFAIr it's always been accepted to have < in comments....  \n17:18\u00a0<vmassol>\u00a0reading https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/The\\_Importance\\_of\\_Correct\\_HTML\\_Commenting  \n17:20\u00a0<vmassol>\u00a0yep it's valid  \n17:20\u00a0<vmassol>\u00a0mflorea: so XHTMLMacroRenderer is doing the right thing apparently and it shouldn't be the problem  \n17:21\u00a0<mflorea>\u00a0yes, I don't think the problem is on the server side, it must be on the client side, but I need to debug the CKEditor code. You should report an issue  \n17:25\u00a0<gdelhumeau>\u00a0Caused by: org.xwiki.component.manager.ComponentLookupException: Can't find descriptor for the component [role = [interface org.xwiki.xml.html.filter.HTMLFilter] hint = [link]]  \n17:26\u00a0<gdelhumeau>\u00a0I'm creating this new component  \n17:26\u00a0<gdelhumeau>\u00a0declaring it in components.txt  \n17:26\u00a0<gdelhumeau>\u00a0added @ComponentList({ LinkFilter.class, ...) to my test class  \n17:26\u00a0<gdelhumeau>\u00a0anyway, the test still claim that my component descriptor does not exist  \n17:27\u00a0<tmortagne>\u00a0you sure you have @Named(\"link\") ?  \n17:27\u00a0<vmassol>\u00a0it's probably true :)  \n17:28\u00a0<gdelhumeau>\u00a0@Component  \n17:28\u00a0<gdelhumeau>\u00a0@Named(\"link\")  \n17:28\u00a0<gdelhumeau>\u00a0and:  \n17:28\u00a0<gdelhumeau>\u00a0@Inject  \n17:28\u00a0<gdelhumeau>\u00a0\u00a0\u00a0\u00a0\u00a0private HTMLFilter linkFilter;  \n17:29\u00a0<vmassol>\u00a0can you show components.txt?  \n17:29\u00a0<tmortagne>\u00a0components.txt does not really matter since it's not used here  \n17:30\u00a0<gdelhumeau>\u00a0https://up1.xwikisas.com/#\\_Ajel5P5WE8L0Omh9h4Snw  \n17:30\u00a0<tmortagne>\u00a0what rule are you using ? MockitoComponentMockingRule ?  \n17:30\u00a0<vmassol>\u00a0mflorea: I've modified your test and built CKeditor app  \n17:31\u00a0<vmassol>\u00a0mflorea: and it still passes which means either the test is not executed or it's not doing much :)  \n17:31\u00a0<gdelhumeau>\u00a0MockitoComponentMockingRule<HTMLCleaner> mocker  \n17:32\u00a0<tmortagne>\u00a0it's public and you have @Rule ?  \n17:32\u00a0<vmassol>\u00a0mflorea: at line 152, I've replaced [content: '=\"|-|\\\\',] with [content: '<=\"|-|\\\\',]  \n17:32\u00a0<gdelhumeau>\u00a0yes  \n17:32\u00a0<gdelhumeau>\u00a0and it's an old test already  \n17:32\u00a0<gdelhumeau>\u00a0so it used to work  \n17:32\u00a0<tmortagne>\u00a0which test is that ?  \n17:32\u00a0<gdelhumeau>\u00a0the only thing new is the inject I showed you  \n17:32\u00a0<mflorea>\u00a0vmassol: I tried that myself, it just means the content is lost somewhere else, not when parsing/serializing the \u00a0macro call  \n17:32\u00a0<gdelhumeau>\u00a0DefaultHTMLCleanerTest in commons  \n17:33\u00a0<gdelhumeau>\u00a0commons-xml  \n17:33\u00a0<vmassol>\u00a0mflorea: ok I'll raise a jira for you  \n17:33\u00a0<tmortagne>\u00a0and LinkFilter is in xwiki-commons-xml ?  \n17:33\u00a0<mflorea>\u00a0it could also be a \"feature\" of CKEditor, that strips \"insecure\" content  \n17:33\u00a0<gdelhumeau>\u00a0I've created near the old filters  \n17:34\u00a0<gdelhumeau>\u00a0so yes, in the \u00a0same module  \n17:34\u00a0<mflorea>\u00a0vmassol: such as http://ckeditor.com/forums/FCKeditor-2.x/Stop-converting-processing-instructions-comments  \n17:34\u00a0<mflorea>\u00a0(but this is old)  \n17:34\u00a0<vmassol>\u00a0ok  \n17:34\u00a0<mflorea>\u00a0I need to debug CK and see what's happening  \n17:35\u00a0<vmassol>\u00a0good finding Trefex! :)  \n17:35\u00a0<tmortagne>\u00a0gdelhumeau: I don't really have any other idea than debugging MockitoComponentMockingRule  \n17:35\u00a0<gdelhumeau>\u00a0the funny thing is that I also have a problem with IDEA  \n17:37\u00a0<gdelhumeau>\u00a0oh got it  \n17:37\u00a0<gdelhumeau>\u00a0the error came from an other test class ;-(  \n17:38\u00a0<tmortagne>\u00a0gdelhumeau: you could start with a breakpoint in org.xwiki.test.internal.ComponentRegistrator#getComponentDeclarationsFromAnnotation  \n17:39\u00a0<vmassol>\u00a0mflorea: http://jira.xwiki.org/browse/CKEDITOR-100  \n17:40\u00a0<mflorea>\u00a0ok, thanks  \n17:42\u00a0<vmassol>\u00a0mflorea: \u00a0I think you're right  \n17:42\u00a0<vmassol>\u00a0changing the issue  \n17:42\u00a0<vmassol>\u00a0the issue seems to be with the \"<?\" combination  \n17:43\u00a0<Trefex>\u00a0vmassol: welcome  \n17:45\u00a0<vmassol>\u00a0Trefex: seems you have knack for that  \n17:45\u00a0<vmassol>\u00a0:)  \n17:45\u00a0<vmassol>\u00a0finding weird situations...  \n17:45\u00a0<Trefex>\u00a0yeah  \n17:45\u00a0<vmassol>\u00a0so you resume your test but please don't use the combination \"<?\" in a macro :)  \n17:46\u00a0<vmassol>\u00a0s/so you/so you can/  \n17:46\u00a0<vmassol>\u00a0(when editing in the wysiwyg editor)  \n17:46\u00a0<vmassol>\u00a0(when using CKeditor)  \n17:46\u00a0<vmassol>\u00a0Trefex: I'm still interested by reproducing the new lines issue that you got earlier on  \n17:47\u00a0<Trefex>\u00a0vmassol: just drag a image in with spaces in the name  \n17:47\u00a0<Trefex>\u00a0save, edit, done  \n17:47\u00a0<vmassol>\u00a0I've fixed that already  \n17:47\u00a0<vmassol>\u00a0the image with space in name  \n17:47\u00a0<Trefex>\u00a0then it should be ok  \n17:47\u00a0<Trefex>\u00a0no  \n17:47\u00a0<vmassol>\u00a0ok trying  \n17:47\u00a0<vmassol>\u00a0without space in name  \n17:48\u00a0<vmassol>\u00a0works fine for me  \n17:48\u00a0<vmassol>\u00a0what should it do?  \n17:48\u00a0<Trefex>\u00a01 sec phone  \n17:49\u00a0<Trefex>\u00a0so, i think because the image had spaces, the rendering got screwed  \n17:49\u00a0<Trefex>\u00a0and newlines were removed  \n17:49\u00a0<vmassol>\u00a0trying  \n17:50\u00a0<Trefex>\u00a0you can see the result here: http://imgur.com/PMwRqvK  \n17:50\u00a0<vmassol>\u00a0nop  \n17:50\u00a0<vmassol>\u00a0nope  \n17:50\u00a0<vmassol>\u00a0doesn't screw up the layout  \n17:50\u00a0<Trefex>\u00a0this was rendered properly with newlines and image before clicking save  \n17:50\u00a0<vmassol>\u00a0(there's no reason it should)  \n17:50\u00a0<Trefex>\u00a0then error, then edit, it looks like this  \n17:50\u00a0<vmassol>\u00a0it may depend where you dragged the image maybe  \n17:51\u00a0<Trefex>\u00a0at the end  \n17:51\u00a0<vmassol>\u00a0ah you  \n17:51\u00a0<vmassol>\u00a0you got this after editing the second time?  \n17:51\u00a0<vmassol>\u00a0got it!  \n17:51\u00a0<vmassol>\u00a0I could reproduce  \n17:51\u00a0<Trefex>\u00a0create post (add text + images), save, edit  \n17:51\u00a0<Trefex>\u00a0ok  \n17:51\u00a0<vmassol>\u00a0the save works  \n17:51\u00a0<vmassol>\u00a0except for the error  \n17:51\u00a0<Trefex>\u00a0yep but the edit doesn't  \n17:51\u00a0<vmassol>\u00a0but then when you edit the second time you get the problem  \n17:52\u00a0<Trefex>\u00a0ya  \n17:52\u00a0<Trefex>\u00a0when i test, i TEST :D  \n17:52\u00a0<vmassol>\u00a0and yes it doesn't reproduce after removing the spaces in the ref  \n17:52\u00a0<vmassol>\u00a0so that's fixed too  \n17:52\u00a0<vmassol>\u00a0cool  \n17:52\u00a0\\*\u00a0Trefex dances  \n17:53\u00a0<vmassol>\u00a0anything else?  \n17:53\u00a0<vmassol>\u00a0:)  \n17:53\u00a0<Trefex>\u00a0mhhhh  \n17:53\u00a0<Trefex>\u00a0not for now  \n17:53\u00a0<Trefex>\u00a0waiting for you to release new version, so i can try in jetty  \n17:53\u00a0<Trefex>\u00a0and THEN I'll test it  \n17:53\u00a0<Trefex>\u00a0ohhh i'll test it real good  \n17:53\u00a0<vmassol>\u00a0you can test  \n17:54\u00a0<vmassol>\u00a0just don't put spaces in image names  \n17:54\u00a0\\*\u00a0Trefex that sounds weird  \n17:54\u00a0<vmassol>\u00a0that's all  \n17:54\u00a0<vmassol>\u00a0don't need to wait  \n17:54\u00a0<Trefex>\u00a0nah i'll wait  \n17:54\u00a0<Trefex>\u00a0wanna test the real use case  \n17:54\u00a0<vmassol>\u00a0I'm not going to release  \n17:54\u00a0<Trefex>\u00a0also in 4 mins i have to go  \n17:54\u00a0<vmassol>\u00a0:)  \n17:54\u00a0<vmassol>\u00a0at every bug fix  \n17:54\u00a0<vmassol>\u00a0I'd like to gather a few before doing a new release  \n17:54\u00a0<Trefex>\u00a0fine  \n17:54\u00a0\\*\u00a0Trefex grumbles  \n17:54\u00a0<vmassol>\u00a0so it would gelp if you could test a bit more  \n17:54\u00a0<vmassol>\u00a0:)  \n17:55\u00a0<vmassol>\u00a0thanks! :)  \n17:55\u00a0<vmassol>\u00a0have to swtich context too  \n17:55\u00a0<vmassol>\u00a0since MD shouldn't be my priority at the moment  \n17:55\u00a0<vmassol>\u00a0...  \n17:56\u00a0<Trefex>\u00a0vmassol: http://foaas.com/thumbs/:This%20Guy/:Trefex  \n17:56\u00a0<Trefex>\u00a0hehe  \n17:56\u00a0<Trefex>\u00a0thought you'd like this service :D  \n17:56\u00a0<Trefex>\u00a0https://www.foaas.com/  \n17:57\u00a0<vmassol>\u00a0sounds funny (even though I don't think I get the joke) :)  \n17:57\u00a0<Trefex>\u00a0mhhh you have to enact it  \n17:57\u00a0<Trefex>\u00a0anyhow, there are other more funny ones :P  \n17:58\u00a0<vmassol>\u00a0hehe  \n17:58\u00a0<vmassol>\u00a0I just hope you're happy that I spent some time fixing MD stuff in xwiki  \n17:58\u00a0<Trefex>\u00a0dude, it's epic  \n17:58\u00a0\\*\u00a0Trefex thanks vmassol warmheartadly  \n17:59\u00a0<vmassol>\u00a0np, this I understands better :)  \n17:59\u00a0<vmassol>\u00a0lol  \n17:59\u00a0<Trefex>\u00a0we use it exclusively to document all our Ops stuff  \n18:00\u00a0<vmassol>\u00a0that's cool  \n18:04\u00a0<Trefex>\u00a0vmassol: good evening Vincent. See you tomorrow for updates on the MD front! Thanks for the awesome work and also thanks for fixing things on the lower end of your prio  \n18:06\u00a0<vmassol>\u00a0good evening Trefex  \n18:34\u00a0<vmassol1>\u00a0has joined #xwiki  \n18:40\u00a0<tmortagne>\u00a0has quit  \n18:47\u00a0<mflorea>\u00a0has quit  \n18:52\u00a0<vmassol1>\u00a0has quit  \n18:57\u00a0<Pbas>\u00a0has quit  \n19:03\u00a0<sagarhani>\u00a0has quit  \n19:11\u00a0<Pbas>\u00a0has joined #xwiki  \n19:20\u00a0<sagarhani>\u00a0has joined #xwiki  \n19:38\u00a0<vmassol>\u00a0has joined #xwiki  \n19:41\u00a0<vmassol>\u00a0has quit  \n19:42\u00a0<vmassol>\u00a0has joined #xwiki  \n19:50\u00a0<evalica>\u00a0has quit  \n19:50\u00a0<Enygma`>\u00a0has quit  \n19:52\u00a0<vmassol>\u00a0has quit  \n21:21\u00a0<mflorea>\u00a0has joined #xwiki  \n21:28\u00a0<mflorea>\u00a0has quit  \n{{/code}}\n"}