{"id": "dev:IRC.xwikiArchive20150914", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20150914", "title": "IRC Archive for channel #xwiki on 14 September 2015 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<Denis1>\u00a0has joined #xwiki  \n04:05\u00a0<cpe>\u00a0has quit  \n04:06\u00a0<cpe>\u00a0has joined #xwiki  \n04:11\u00a0<Denis1>\u00a0has quit  \n04:59\u00a0<cpe\\_>\u00a0has joined #xwiki  \n05:03\u00a0<cpe>\u00a0has quit  \n05:07\u00a0<MasterPiece>\u00a0has joined #xwiki  \n05:29\u00a0<MasterPiece>\u00a0has quit  \n05:49\u00a0<Chuguniy>\u00a0has quit  \n06:03\u00a0<Ramona1>\u00a0has joined #xwiki  \n07:44\u00a0<Ramona1>\u00a0has quit  \n07:44\u00a0<Ramona1>\u00a0has joined #xwiki  \n07:45\u00a0<rrodriguez>\u00a0has quit  \n08:03\u00a0<Ramona1>\u00a0has quit  \n08:25\u00a0<silverdr1p>\u00a0has quit  \n08:26\u00a0<silverdrop>\u00a0has joined #xwiki  \n08:28\u00a0<Ramona1>\u00a0has joined #xwiki  \n08:31\u00a0<KermitTheFragger>\u00a0has joined #xwiki  \n08:33\u00a0<Denis>\u00a0has joined #xwiki  \n08:40\u00a0<mflorea>\u00a0has joined #xwiki  \n08:42\u00a0<woshilapin>\u00a0has quit  \n08:48\u00a0<tmortagne>\u00a0has joined #xwiki  \n08:53\u00a0<vmassol>\u00a0has joined #xwiki  \n08:53\u00a0<vmassol>\u00a0good morning everyone  \n08:53\u00a0<vmassol>\u00a0today is supposed to be release day for 7.2RC1 but we still have a few issues  \n08:53\u00a0<vmassol>\u00a0so I guess we'll slip by one day  \n08:53\u00a0<vmassol>\u00a0we still have about 4 failing tests too  \n08:53\u00a0<vmassol>\u00a0actually let me check, possibly less since I saw Edy finx one yesterday  \n08:54\u00a0<vmassol>\u00a0hmm 5 now  \n08:55\u00a0<tmortagne>\u00a0vmassol: in the 5 it's very possible we have a few flickering too since we have several since a long time now  \n08:55\u00a0<vmassol>\u00a0I saw 1 flickering for sure  \n08:55\u00a0<vmassol>\u00a0(but we still need to fix it :))  \n08:56\u00a0<vmassol>\u00a0(at some point...)  \n09:00\u00a0<tmortagne>\u00a0wow jira 6.4 changed a lot, I'm totally lost on jboss jira  \n09:01\u00a0<msmeria>\u00a0has joined #xwiki  \n09:02\u00a0<Ramona2>\u00a0has joined #xwiki  \n09:02\u00a0<Ramona1>\u00a0has quit  \n09:06\u00a0<vmassol>\u00a0checking tests to try to fix some...  \n09:07\u00a0<vmassol>\u00a0took http://ci.xwiki.org/job/xwiki-platform/org.xwiki.platform$xwiki-platform-administration-test-tests/1844/testReport/org.xwiki.administration.test.ui/ResetPasswordTest/resetForgottenPassword/  \n09:07\u00a0<vmassol>\u00a0s/took/claimed  \n09:07\u00a0<vmassol>\u00a0tmortagne: feeling bold this morning? :)  \n09:08\u00a0<tmortagne>\u00a0not really, it's bugfix releases so I tough it would be better  \n09:09\u00a0<tmortagne>\u00a0there is an upgrade of aspectjrt but I will wait for this one since every time they change something in the signatures  \n09:09\u00a0<vmassol>\u00a0yes better push upgrades to 7.3M1 IMO  \n09:09\u00a0<vmassol>\u00a0ouch deluge again here\u2026 raining like hell  \n09:10\u00a0<tmortagne>\u00a0was last night for me :)  \n09:11\u00a0<vmassol>\u00a0was all the week end here :)  \n09:11\u00a0<vmassol>\u00a0but apparently there were very severe rains in the south of France over the weekend  \n09:11\u00a0<vmassol>\u00a0much worse than here  \n09:11\u00a0<vmassol>\u00a0with some highway collapsing...  \n09:12\u00a0<Ramona2>\u00a0has quit  \n09:14\u00a0<Ramona1>\u00a0has joined #xwiki  \n09:16\u00a0<Ramona2>\u00a0has joined #xwiki  \n09:16\u00a0<Ramona1>\u00a0has quit  \n09:17\u00a0<lynxt>\u00a0has joined #xwiki  \n09:17\u00a0<tillo>\u00a0has joined #xwiki  \n09:18\u00a0<Ramona2>\u00a0has quit  \n09:20\u00a0<Ramona1>\u00a0has joined #xwiki  \n09:32\u00a0<vmassol>\u00a0guys I have some git issue, maybe you had this before too  \n09:32\u00a0<vmassol>\u00a0I have a stubborn file  \n09:32\u00a0<vmassol>\u00a0I cannot revert it  \n09:32\u00a0<vmassol>\u00a0I cannt git checkout it either  \n09:32\u00a0<vmassol>\u00a0it stays there with some changes  \n09:33\u00a0<vmassol>\u00a0no permission issue  \n09:33\u00a0<Pbas>\u00a0has joined #xwiki  \n09:33\u00a0<vmassol>\u00a0I can remove it and when I do git checkout again, it comes back with changes  \n09:33\u00a0<vmassol>\u00a0any idea?  \n09:33\u00a0<vmassol>\u00a0the change is on the @version $idXXXXX$  \n09:35\u00a0<vmassol>\u00a0anyway  \n09:35\u00a0<vmassol>\u00a0I'm committing it  \n09:35\u00a0<woshilapin>\u00a0has joined #xwiki  \n09:36\u00a0<tmortagne>\u00a0what is the file ? sounds like someone commited a generated @version tag which git does not like too much  \n09:37\u00a0<vmassol>\u00a0DeletePageTest in platform  \n09:37\u00a0<vmassol>\u00a0hmmm  \n09:37\u00a0<tmortagne>\u00a0usually it means somone committed with a git client that does not support this kind of setting (like jgit)  \n09:37\u00a0<vmassol>\u00a0actually I had some changes in this file which I committed (some imports)  \n09:37\u00a0<vmassol>\u00a0and then I got the problem  \n09:38\u00a0<tmortagne>\u00a0s/somone/someone/  \n09:38\u00a0<vmassol>\u00a0hmm I have an idea  \n09:38\u00a0<vmassol>\u00a0I tried netbeans over the weekend and I committed the import changes from it  \n09:38\u00a0<tmortagne>\u00a0could be it yes  \n09:38\u00a0<tmortagne>\u00a0it the same issue en Eclipse which use EGit/JGit  \n09:39\u00a0<tmortagne>\u00a0s/it/it's/  \n09:39\u00a0<vmassol>\u00a0ok  \n09:41\u00a0<gdelhumeau>\u00a0has joined #xwiki  \n09:52\u00a0<vmassol>\u00a0hmhmm http://ci.xwiki.org/job/xwiki-platform/1845/console  \n09:52\u00a0<vmassol>\u00a0let's see what the build in progress will say...  \n09:54\u00a0<vmassol>\u00a0hmm re http://ci.xwiki.org/job/xwiki-platform\\_Sonar/409/consoleFull this is a problem I get very frequently locally too  \n09:55\u00a0<vmassol>\u00a0[ERROR] Failed to execute goal org.xwiki.platform:xwiki-platform-tool-packager-plugin:7.2-SNAPSHOT:package (default) on project xwiki-platform-activeinstalls-test-tests: Failed to create context to import XAR files: Failed to get the list of components to load: JAR entry META-INF/components.txt not found in /home/hudsonagent/.m2/repository/org/xwiki/commons/xwiki-commons-component-api/7.2-SNAPSHOT/xwiki-commons-component-api-7.2-SNAPSH  \n09:55\u00a0<vmassol>\u00a0Caused by: java.io.FileNotFoundException: JAR entry META-INF/components.txt not found in /home/hudsonagent/.m2/repository/org/xwiki/commons/xwiki-commons-component-api/7.2-SNAPSHOT/xwiki-commons-component-api-7.2-SNAPSHOT.jar  \n09:55\u00a0<vmassol>\u00a0ofc the file is there...  \n09:55\u00a0<Slashman>\u00a0has joined #xwiki  \n09:55\u00a0<vmassol>\u00a0(didn't check in this case but when I have it locally the file is there)  \n10:04\u00a0<tmortagne>\u00a0I never gets it locally but it happen often on jenkins yes  \n10:19\u00a0<ClemensR>\u00a0has joined #xwiki  \n10:30\u00a0<tmortagne>\u00a0hmm \"Failed to deploy artifacts: Could not transfer artifact org.xwiki.platform:xwiki-platform-statistics:pom:7.2-20150914.082004-72 from/to nexus.xwiki.org (http://nexus.xwiki.org/nexus/content/repositories/snapshots/): The target server failed to respond\"  \n10:39\u00a0<gsmeria>\u00a0has joined #xwiki  \n10:47\u00a0<evalica>\u00a0has joined #xwiki  \n11:01\u00a0<Enygma`>\u00a0has joined #xwiki  \n11:03\u00a0<silverdrop>\u00a0has quit  \n11:42\u00a0<vmassol>\u00a0guys WDYT about http://jira.xwiki.org/browse/XWIKI-12558 ?  \n11:49\u00a0<tmortagne>\u00a0vmassol: does not means using findElements is always wrong ? A first step should probably be to deprecated it in that case since rights now when looking at XWikiWebDriver#findElements there is nothing explaining this method should never be used  \n11:49\u00a0<vmassol>\u00a0no findElement is good  \n11:49\u00a0<vmassol>\u00a0if you expect it to exist  \n11:49\u00a0<vmassol>\u00a0it'll wait till the element is found  \n11:49\u00a0<vmassol>\u00a0can be 1s, 2s, etc but if it reaches 10s then it's not used correctly  \n11:50\u00a0<vmassol>\u00a0it should be used in the majority of cases  \n11:50\u00a0<vmassol>\u00a0it should not be used to verify that something does not exist  \n11:50\u00a0<tmortagne>\u00a0it's not really clear in XWIKI-12558 what you propose exactly, when reading the issue it seems like you want to generate a warning every time this method is used  \n11:51\u00a0<vmassol>\u00a0\"for functional tests that take more time than they should\"  \n11:51\u00a0<vmassol>\u00a0only in those cases  \n11:51\u00a0<vmassol>\u00a0checking the wording  \n11:51\u00a0<vmassol>\u00a0looks ok: \"Several tests are wrongly using findElements() when they're looking for some element that don't exist (thus incurring the timeout). \"  \n11:54\u00a0<tmortagne>\u00a0seems to be the warning is not really going to help much since we have a lot of log, should probably fail the test right away  \n11:54\u00a0<tmortagne>\u00a0s/to be/to me/  \n11:54\u00a0<vmassol>\u00a0sure but I mentioned that too in the issue  \n11:54\u00a0<tmortagne>\u00a0I know  \n11:54\u00a0<vmassol>\u00a0right now I'm not 100% sure there won't be false postiives  \n11:54\u00a0<vmassol>\u00a0and also we would need to fix a good portion of the places first  \n11:55\u00a0<vmassol>\u00a0ATM I don't know how many tests there are in total  \n11:55\u00a0<vmassol>\u00a0so my first step is to check this number  \n11:55\u00a0<vmassol>\u00a0I'll also check the 4 errors found in the admin tests  \n11:56\u00a0<vmassol>\u00a0to see if they're real or not  \n11:56\u00a0<tmortagne>\u00a0ok but I'm pretty sure nobody ever look at this kind of warning (unless they are actually searching for those), in any case this warning is not going to harm so I see no reason to do it for your need  \n11:56\u00a0<vmassol>\u00a0yes I agree  \n11:56\u00a0<tmortagne>\u00a0\\*to not do it  \n11:57\u00a0<vmassol>\u00a0I want to make it fail something once it's proven to work fine  \n11:57\u00a0<vmassol>\u00a0otherwise it's of no use  \n11:57\u00a0<vmassol>\u00a0or not much  \n12:00\u00a0<vmassol>\u00a0going out on early lunch now, bb in 40mn  \n12:10\u00a0<Enygma`>\u00a0has quit  \n12:10\u00a0<Enygma`>\u00a0has joined #xwiki  \n12:24\u00a0<silverdrop>\u00a0has joined #xwiki  \n12:49\u00a0<silverdr1p>\u00a0has joined #xwiki  \n12:52\u00a0<silverdrop>\u00a0has quit  \n12:55\u00a0<Denis>\u00a0has quit  \n14:02\u00a0<Ramona1>\u00a0has quit  \n14:04\u00a0<Ramona1>\u00a0has joined #xwiki  \n14:18\u00a0<vmassol>\u00a0hmmm http://ci.xwiki.org/job/xwiki-platform/org.xwiki.platform$xwiki-platform-panels-test-tests/1847/testReport/org.xwiki.panels.test.ui/PanelTest/limitPanelViewRight/ is not possible\u2026 :)  \n14:20\u00a0<Enygma`>\u00a0vmassol: that`s a known flicer  \n14:23\u00a0<vmassol>\u00a0Enygma`: sure but I'm trying to fix it  \n14:23\u00a0<Enygma`>\u00a0cool  \n14:23\u00a0<vmassol>\u00a0but it doesn't seem possible at all...  \n14:23\u00a0<Enygma`>\u00a0:)  \n14:23\u00a0<vmassol>\u00a0would you have a few mn so that I explain what I've found to you to see where I'm wrong?  \n14:23\u00a0<Enygma`>\u00a0just like the wysiwyg copy/paste issue? :)  \n14:23\u00a0<Enygma`>\u00a0shoot  \n14:23\u00a0<vmassol>\u00a0skype?  \n14:25\u00a0<Enygma`>\u00a0ok  \n14:32\u00a0<Denis>\u00a0has joined #xwiki  \n14:37\u00a0<Trefex>\u00a0has joined #xwiki  \n14:54\u00a0<Trefex>\u00a0has quit  \n15:07\u00a0<Ramona1>\u00a0has quit  \n15:11\u00a0<Trefex>\u00a0has joined #xwiki  \n15:19\u00a0<vmassol>\u00a03 failures in http://ci.xwiki.org/job/xwiki-enterprise-test-ui/lastCompletedBuild/testReport/ now  \n15:53\u00a0<Enygma`>\u00a0I`m looking at http://ci.xwiki.org/job/xwiki-enterprise-test-ui/lastCompletedBuild/org.xwiki.enterprise$xwiki-enterprise-test-ui/testReport/org.xwiki.test.ui/RestoreDeletedPageTest/restore/ but I don`t get how it worked before...  \n15:53\u00a0<Enygma`>\u00a0After deleting a page, being on the \"delete success\" page, you can not click \"delete\" again... you need to go into view mode on that page to see the recycle bin/restore screen  \n15:54\u00a0<Enygma`>\u00a0this test wants to double delete a document  \n15:57\u00a0<Trefex>\u00a0has quit  \n15:57\u00a0<Enygma`>\u00a0gdelhumeau: any idea? https://github.com/xwiki/xwiki-enterprise/blob/master/xwiki-enterprise-test/xwiki-enterprise-test-ui/src/test/it/org/xwiki/test/ui/RestoreDeletedPageTest.java#L65  \n15:58\u00a0<gdelhumeau>\u00a0looking  \n15:58\u00a0<Enygma`>\u00a0this was the failure: http://ci.xwiki.org/job/xwiki-enterprise-test-ui/1484/org.xwiki.enterprise$xwiki-enterprise-test-ui/testReport/org.xwiki.test.ui/RestoreDeletedPageTest/restore/  \n15:58\u00a0<Enygma`>\u00a0apparently it`s a flicker since it is gone now  \n15:59\u00a0<Enygma`>\u00a0apparently it works, but I don`t get why  \n15:59\u00a0<Enygma`>\u00a0(since the failure made sense to me)  \n15:59\u00a0<vmassol>\u00a0note: I'm fixing http://ci.xwiki.org/job/xwiki-enterprise-test-ui/lastCompletedBuild/org.xwiki.enterprise$xwiki-enterprise-test-ui/testReport/org.xwiki.test.ui/BreadcrumbsTest/testBreadcrumbs/  \n16:00\u00a0<Enygma`>\u00a0yep, noticed :)  \n16:00\u00a0<vmassol>\u00a0:)  \n16:01\u00a0<Enygma`>\u00a0we need to look into http://jira.xwiki.org/browse/XWIKI-12554  \n16:02\u00a0<Trefex>\u00a0has joined #xwiki  \n16:05\u00a0<Enygma`>\u00a0I`ll take a shot at it  \n16:11\u00a0<vmassol>\u00a0mflorea: I'm fixing BreadcrumbsTest which could have failed after your change for http://jira.xwiki.org/browse/XWIKI-12549 . What's the rule of the breadcrumb when you don't have permission to view a page?  \n16:11\u00a0<gdelhumeau>\u00a0Enygma`: I understand why it's a flicker  \n16:11\u00a0<vmassol>\u00a0mflorea: we don't display the title but just the page name?  \n16:11\u00a0<gdelhumeau>\u00a0The DeletingPage po describes the page with the progress bar  \n16:11\u00a0<mflorea>\u00a0yes  \n16:12\u00a0<vmassol>\u00a0ok, fixing test  \n16:12\u00a0<gdelhumeau>\u00a0if this page has been generated before the delete job have actually deleted the page, then you can have the delete button  \n16:12\u00a0<gdelhumeau>\u00a0if the job has already worked, the delete button is not displayed  \n16:12\u00a0<gdelhumeau>\u00a0it explains the flicker  \n16:12\u00a0<gdelhumeau>\u00a0but the PO is not logical  \n16:13\u00a0<gdelhumeau>\u00a0so you're right, the failure \\*should\\* make sense :)  \n16:13\u00a0<Enygma`>\u00a0:)  \n16:13\u00a0<Enygma`>\u00a0so it`s currently passing by chance :)  \n16:13\u00a0<Trefex>\u00a0has quit  \n16:14\u00a0<gdelhumeau>\u00a0or it breaks by lack of chance :)  \n16:14\u00a0<Enygma`>\u00a0:)  \n16:14\u00a0<Enygma`>\u00a0so are you handling it?  \n16:14\u00a0<gdelhumeau>\u00a0yes  \n16:14\u00a0<Enygma`>\u00a0cool, thanks!  \n16:15\u00a0<gdelhumeau>\u00a0I think going back to view mode will return the result expected by the DeletePageOutcomePage po  \n16:19\u00a0<vmassol>\u00a0test should be ok now  \n16:20\u00a0<vmassol>\u00a0what about http://ci.xwiki.org/job/xwiki-enterprise-test-wysiwyg/lastCompletedBuild/org.xwiki.enterprise$xwiki-enterprise-test-wysiwyg/testReport/org.xwiki.test.wysiwyg/ImageTest/testEditImageWithLink/ real failure? flicker?  \n16:22\u00a0<tmortagne>\u00a0vmassol: looks like a flicker  \n16:25\u00a0<gsmeria>\u00a0has left #xwiki  \n16:25\u00a0<vmassol>\u00a0this could be interesting, too bad it's not integrated by default with the mail notif plugin to not send false positives: https://wiki.jenkins-ci.org/display/JENKINS/Build+Failure+Analyzer  \n16:27\u00a0<vmassol>\u00a0I'm looking for a jenkins plugin that will record flickering (unstable) tests, do you know any?  \n16:28\u00a0<tmortagne>\u00a0sounds like something quite complex to do  \n16:28\u00a0<vmassol>\u00a0an easy way is to record stability for all tests and display them sorted by # of failed occurences  \n16:29\u00a0<vmassol>\u00a0like this one (but it's a bit old): https://wiki.jenkins-ci.org/display/JENKINS/Test+stability+plugin  \n16:29\u00a0<vmassol>\u00a0(and it's not detailed)  \n16:31\u00a0<tmortagne>\u00a0not sure about that, you will get the same information for a real test failing since 3 builds and a flickering test that failed 3 times in the history  \n16:31\u00a0<vmassol>\u00a0sure but over time the flickers should stand out with more failures  \n16:32\u00a0<tmortagne>\u00a0depends how old is the history  \n16:32\u00a0<vmassol>\u00a0yes  \n16:32\u00a0<tmortagne>\u00a0with our current 20 builds history not sure it will stand that much  \n16:32\u00a0<tmortagne>\u00a0at least not test that don't flicker too often  \n16:33\u00a0<Enygma`>\u00a0vmassol: https://wiki.jenkins-ci.org/display/JENKINS/Flaky+Test+Handler+Plugin ? did not really read all of it  \n16:34\u00a0<Enygma`>\u00a0works together with some surefire configuration option  \n16:34\u00a0<Enygma`>\u00a0\"rerunFailingTestsCount\"  \n16:34\u00a0<vmassol>\u00a0reading, thx  \n16:36\u00a0<tmortagne>\u00a0looks interesting indeed  \n16:37\u00a0<Enygma`>\u00a0apparently, \"flaky\" is the commonly used terminology instead of \"flickering\" :)  \n16:37\u00a0<vmassol>\u00a0yeah was not searching with the right keyword :)  \n16:38\u00a0<Enygma`>\u00a0https://maven.apache.org/surefire/maven-surefire-plugin/examples/rerun-failing-tests.html  \n16:38\u00a0<Enygma`>\u00a0apparently others have the same problems as we do  \n16:38\u00a0<Enygma`>\u00a0:)  \n16:44\u00a0<tmortagne>\u00a0just rerunFailingTestsCount=2 even without the plugin might reduce the flickering a lot already  \n16:46\u00a0<vmassol>\u00a0and cool 2.18 is out: http://repo1.maven.org/maven2/org/apache/maven/plugins/maven-surefire-plugin/  \n16:46\u00a0<vmassol>\u00a0even 2.18.1  \n16:46\u00a0<vmassol>\u00a0w're using 2.16  \n17:02\u00a0<vmassol>\u00a0discussing with david gageot about flickering tests :)  \n17:02\u00a0<msmeria>\u00a0has quit  \n17:02\u00a0<vmassol>\u00a0FTR he's created https://github.com/dgageot/simplelenium for this reason  \n17:03\u00a0<vmassol>\u00a0which is very interesting IMO  \n17:04\u00a0<vmassol>\u00a0find(\".name\")  \n17:04\u00a0<vmassol>\u00a0\u00a0.contain(\"a word\")  \n17:04\u00a0<vmassol>\u00a0\u00a0.not().beDisplayed();  \n17:05\u00a0<vmassol>\u00a02 things: he does the find till what is expected is there (or large timeout) and the assertion is also re-executed several times to handle stale elements  \n17:05\u00a0<gdelhumeau>\u00a0We have a little problem  \n17:05\u00a0<gdelhumeau>\u00a0If I delete a terminal document  \n17:06\u00a0<gdelhumeau>\u00a0When I have the success message when the document is deleted  \n17:06\u00a0<gdelhumeau>\u00a0I have a link to go back to the page  \n17:06\u00a0<gdelhumeau>\u00a0but when I delete a terminal document, the generated link leads to the non-terminal version of the page  \n17:06\u00a0<Trefex>\u00a0has joined #xwiki  \n17:06\u00a0<gdelhumeau>\u00a0and of couse I don't see the old one and I cannot restore it (from this place)  \n17:08\u00a0<mflorea>\u00a0has quit  \n17:11\u00a0<Trefex>\u00a0has quit  \n17:12\u00a0<Enygma`>\u00a0I don`t get this: http://jira.xwiki.org/browse/XWIKI-12554  \n17:12\u00a0<Enygma`>\u00a0When a group name is filled, the save action is called on the new group document. The save action does not fail if the document already exists (since it sees the save as a new version), so why was it behaving differently in the past?  \n17:12\u00a0<Enygma`>\u00a0the javascript code calls that save action in an AJAX and displays the alert if the ajax fails  \n17:13\u00a0<Enygma`>\u00a0but why would it fail?  \n17:24\u00a0<tmortagne>\u00a0Enygma`: I did not had time to debug it but it used to fail for sure, we even have a UI test about this (which is what made me look at it in the first place since the test was failing with wrong error message before of \"document\" -> \"page\")  \n17:24\u00a0<tmortagne>\u00a0it 's been broken last week it seems  \n17:25\u00a0<tmortagne>\u00a0s/before of/because of/  \n17:26\u00a0<Enygma`>\u00a0I am looking inside XWikiDocument.readFromTemplate and there is this (weird) check:  \n17:26\u00a0<Enygma`>\u00a0if (templateDocumentReference != null) {  \n17:26\u00a0<tmortagne>\u00a0maybe it used to use something else than the save action since I agree with you that save action does not care about already existing document  \n17:27\u00a0<Enygma`>\u00a0shouldn`t it have been (!content.equals(\"\\n\") && !content.equals(\"\")) || isNew() ?  \n17:28\u00a0<Enygma`>\u00a0I meant || !isNew()  \n17:29\u00a0<Enygma`>\u00a0i.e. if a template is used, then if the document is not new OR the content is not empty, then fail  \n17:30\u00a0<gdelhumeau>\u00a0I've opened http://jira.xwiki.org/browse/XWIKI-12563  \n17:31\u00a0<Enygma`>\u00a0nevermind what I just said  \n17:31\u00a0<Enygma`>\u00a0gdelhumeau: I think you need to use ?spaceRedirect=false  \n17:32\u00a0<Enygma`>\u00a0to avoid the WebHome URL tricks  \n17:32\u00a0<gdelhumeau>\u00a0hmm but the user is not supposed to know...  \n17:32\u00a0<Enygma`>\u00a0not-a-bug-but-a-feature :)  \n17:32\u00a0<Enygma`>\u00a0the user is not supposed to do that  \n17:32\u00a0<Enygma`>\u00a0unless he is advanced  \n17:32\u00a0<Enygma`>\u00a0and read the docs :)  \n17:32\u00a0<gdelhumeau>\u00a0you mean deleting a document?  \n17:32\u00a0<gdelhumeau>\u00a0a user is supposed to do that  \n17:33\u00a0<Enygma`>\u00a0restoring a technical document  \n17:33\u00a0<Enygma`>\u00a0that is what you are doing  \n17:33\u00a0<gdelhumeau>\u00a0then I udpate the test to create a non terminal page instead of fixing the use-casE?  \n17:34\u00a0<Enygma`>\u00a0I guess we should have it for both cases in the end  \n17:34\u00a0<Enygma`>\u00a0but the practice in this cases was to updated the test for the case that was written originally  \n17:34\u00a0<Enygma`>\u00a0i.e. terminal  \n17:34\u00a0<Enygma`>\u00a0then add the non-terminals when possible  \n17:35\u00a0<tmortagne>\u00a0I don't agree at all with the \"not-a-bug-but-a-feature\"  \n17:35\u00a0<Enygma`>\u00a0though from an usability pov, I do see some possible confusion coming our way  \n17:35\u00a0<tmortagne>\u00a0we display a checkbox to create final documents in the create UI so advanced user should also have the possibility to retore final documents  \n17:36\u00a0<Enygma`>\u00a0so what do you propose, some kind of disambiguation UI for advanced users?  \n17:36\u00a0<Enygma`>\u00a0asking them what they wanted to access when 2 options exist for that URL?  \n17:37\u00a0<tmortagne>\u00a0Enygma`: it's already indicated in the issue: we should have two list IMO  \n17:37\u00a0<Enygma`>\u00a0or maybe they should use the recycle bin UI  \n17:38\u00a0<Enygma`>\u00a0tmortagne: that`s not a solution  \n17:38\u00a0<tmortagne>\u00a0why not ?  \n17:38\u00a0<Enygma`>\u00a0you no longer see any list  \n17:38\u00a0<Enygma`>\u00a0since you reach an existing doc  \n17:38\u00a0<tmortagne>\u00a0and ?  \n17:38\u00a0<tmortagne>\u00a0the use case we are talking about here is when there is none  \n17:39\u00a0<tmortagne>\u00a0it does not make sense to not see anything when you just delete you final page  \n17:39\u00a0<Enygma`>\u00a0IMO it does not exist to fix only this case  \n17:39\u00a0<gdelhumeau>\u00a0I personnaly didnot understand the issue immediatly  \n17:39\u00a0<Enygma`>\u00a0either we fix both or none (and rely on the recycle bin UI)  \n17:39\u00a0<gdelhumeau>\u00a0and I know the concepts :)  \n17:39\u00a0<tmortagne>\u00a0those are two very different things  \n17:39\u00a0<tmortagne>\u00a0and two very different way to handle them  \n17:40\u00a0<tmortagne>\u00a0IMO we should fix the obvious one first and discuss the other one after that  \n17:41\u00a0<Enygma`>\u00a0the issue actually does not mention your usecase, tmortagne  \n17:41\u00a0<Enygma`>\u00a0it's mentions generically deleted terminal pages  \n17:42\u00a0<tmortagne>\u00a0because gdelhumeau did not tough about your other use case  \n17:42\u00a0<tmortagne>\u00a0looks a the example he provided  \n17:42\u00a0<tmortagne>\u00a0so what the issue does not talk about is the other thing you mentioned and you can create another issue for it IMO if you want  \n17:43\u00a0<gdelhumeau>\u00a0it was very confusing to not see my deleted document just after having deleted it indeed  \n17:44\u00a0<Enygma`>\u00a0so there is this case as well: if you have both A.B.WebHome and A.B ... when you delete either one of them, accessing it again in view mode shows the other one :)  \n17:44\u00a0<tmortagne>\u00a0it could be ok to not get the shortcut restore list when a webhome already exist but it's not acceptable to not see anything at all when you just deleted a page  \n17:45\u00a0<tmortagne>\u00a0Enygma`: I understood you r use case and again it's something different and cannot really be handled the same way IMO  \n17:45\u00a0<Enygma`>\u00a0why not generate the proper link in the deletion of a terminal page?  \n17:45\u00a0<tmortagne>\u00a0the use case described by the issue is very easy to fix  \n17:46\u00a0<Enygma`>\u00a0i.e. when a terminal page is deleted, redirect in view mode on the page, but with the ?spaceRedirect=false parameter set  \n17:46\u00a0<tmortagne>\u00a0it's not just about the redirect when you just deleted a page  \n17:46\u00a0<Enygma`>\u00a0so that the user sees the correctly deleted page?  \n17:46\u00a0<tmortagne>\u00a0you delete a page and then reuse the same URL you were using before and don't even see the page can be restored  \n17:47\u00a0<Enygma`>\u00a0I guess we should at least separate the 2 lists  \n17:48\u00a0<tmortagne>\u00a0I don't see the point in discussing this where what is proposed in the issue is do easy and useful, again if you are worried about the other use case you mentioned you should create another jira so that we can discuss how to deal with it if we want to  \n17:48\u00a0<Enygma`>\u00a0instead of merging them in the same table  \n17:48\u00a0<tmortagne>\u00a0this is what I proposed in the issue  \n17:50\u00a0<Enygma`>\u00a0ok  \n18:08\u00a0<woshilapin>\u00a0has quit  \n18:28\u00a0<tmortagne>\u00a0Enygma`: added a comment in XWIKI-12554  \n18:28\u00a0<tmortagne>\u00a0but when I do exactly what the test is doing to get not message  \n18:28\u00a0<tmortagne>\u00a0s/to get/I get/  \n18:28\u00a0<KermitTheFragger>\u00a0has quit  \n18:29\u00a0<Enygma`>\u00a0weird  \n18:32\u00a0<Enygma`>\u00a0hmm, but wait  \n18:32\u00a0<Enygma`>\u00a0that test is cheating  \n18:32\u00a0<Enygma`>\u00a0setFieldValue(\"content\", \"some content\");  \n18:32\u00a0<Enygma`>\u00a0as I was investigating before...  \n18:32\u00a0<Enygma`>\u00a0the save action does fail, but if you use a template on an existing document that has content  \n18:33\u00a0<Enygma`>\u00a0this test sets content on the existing doc, so save action will fail  \n18:33\u00a0<Enygma`>\u00a0in the present issue, a groups document does not have content  \n18:33\u00a0<Enygma`>\u00a0so the save action will not fail when using the template on an existing group document  \n18:34\u00a0<Enygma`>\u00a0IMO, the code itself is wrong  \n18:34\u00a0<Enygma`>\u00a0and has been wrong from the beginning  \n18:36\u00a0<tmortagne>\u00a0indeed I skipped that line about content  \n18:36\u00a0<Enygma`>\u00a0the only thing in my mind that could have made the original code to work is the time before we had the sheet system  \n18:36\u00a0<Enygma`>\u00a0since at that time, most likely the group template contained some include call  \n18:36\u00a0<Enygma`>\u00a0to the sheet  \n18:36\u00a0<Enygma`>\u00a0or something like that  \n18:36\u00a0<Enygma`>\u00a0but now, with the sheet system, we don`t have content anymore  \n18:36\u00a0<Enygma`>\u00a0so the code`s assumptions fail  \n18:37\u00a0<Enygma`>\u00a0that weird \"if\" in the save action is horrible IMO anyway  \n18:37\u00a0<Enygma`>\u00a0and we should dump it  \n18:38\u00a0<Enygma`>\u00a0in XWikiDocument I mean, readFromTemplate  \n18:38\u00a0<Enygma`>\u00a0https://github.com/xwiki/xwiki-platform/blob/master/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/doc/XWikiDocument.java#L3708  \n18:39\u00a0<Enygma`>\u00a0I can`t imagine when you would want to consider an empty document as inexistent.... besides, the objects are completely ingored  \n18:40\u00a0<tmortagne>\u00a0yes using the content does not make much sense  \n18:41\u00a0<tmortagne>\u00a0sounds like the goal was more or less to forbid creating a document that already been created from a template  \n18:42\u00a0<tmortagne>\u00a0but it's a very hacky way to do it  \n18:43\u00a0<Enygma`>\u00a0this also applies for edit mode  \n18:43\u00a0<Enygma`>\u00a0if you apply a template in edit mode on an empty or new document, you can use the template  \n18:43\u00a0<Enygma`>\u00a0but if the document has some content, says the page already exists  \n18:45\u00a0<Enygma`>\u00a0probably makes sense if you first create an empty document (to allocate the name) and then use the template to edit it  \n18:45\u00a0<Enygma`>\u00a0and we do that a lot AFAIK  \n18:46\u00a0<tmortagne>\u00a0I don't see why we need this  \n18:46\u00a0<tmortagne>\u00a0what we do a lot is do a redirect to the new page when we get the name  \n18:46\u00a0<tmortagne>\u00a0I don't see why we would need to actually create it  \n18:46\u00a0<Enygma`>\u00a0actually you may be right  \n18:46\u00a0<Enygma`>\u00a0though I remember we also have a mode in the template provider to so save&edit  \n18:47\u00a0<Enygma`>\u00a0but maybe it`s not entirely an issue there  \n18:47\u00a0<tmortagne>\u00a0seems to me applying a template on an already existing document does not make much sense and just work by luck right now  \n18:48\u00a0<Enygma`>\u00a0agreed  \n18:48\u00a0<tmortagne>\u00a0but I don't agree with the fail, it should probably just ignore the template parameter IMO  \n18:49\u00a0<tmortagne>\u00a0when the document already exist  \n18:49\u00a0<Enygma`>\u00a0well, then probably the save action should fail on an non-existent document, and the create action should be used to create  \n18:49\u00a0<Enygma`>\u00a0so that the create action can fail on an already existent document  \n18:50\u00a0<Enygma`>\u00a0but right now we (ab)use the save action for both and it creates issues like this  \n18:52\u00a0<Enygma`>\u00a0one option would be to use the REST API to see if the page already exists  \n18:52\u00a0<Enygma`>\u00a0until we fix the bigger issues in the platform  \n18:54\u00a0<tmortagne>\u00a0yes right now for the group use ideally it should probably check in live if the name can be used and not enabled clicking on \u00a0the create button, like for the wiki creation  \n18:54\u00a0<tmortagne>\u00a0user creation probably have the same issue  \n19:15\u00a0<tmortagne>\u00a0has quit  \n19:25\u00a0<Enygma`>\u00a0has quit  \n19:27\u00a0<evalica>\u00a0has quit  \n19:40\u00a0<ClemensR>\u00a0has quit  \n20:02\u00a0<gdelhumeau>\u00a0has quit  \n20:57\u00a0<woshilapin>\u00a0has joined #xwiki  \n21:24\u00a0<Slashman>\u00a0has quit  \n21:43\u00a0<Denis>\u00a0has quit  \n21:54\u00a0<Denis1>\u00a0has joined #xwiki  \n23:49\u00a0<vmassol>\u00a0has quit  \n23:58\u00a0<Denis1>\u00a0has quit\n"}