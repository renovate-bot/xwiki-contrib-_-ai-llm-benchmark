{"id": "dev:IRC.xwikiArchive20111126", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20111126", "title": "IRC Archive for channel #xwiki on 26 November 2011 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n00:10\u00a0<Enygma`>\u00a0has quit  \n01:04\u00a0<jvelociter>\u00a0has quit  \n01:17\u00a0<SvenDowideit>\u00a0has quit  \n01:17\u00a0<SvenDowideit>\u00a0has joined #xwiki  \n04:49\u00a0<DrLou>\u00a0has quit  \n07:46\u00a0<tekzilla>\u00a0has quit  \n07:48\u00a0<tekzilla>\u00a0has joined #xwiki  \n08:02\u00a0<npm\\_>\u00a0is now known as <npm>  \n09:29\u00a0<vmassol>\u00a0has joined #xwiki  \n09:34\u00a0<sburjan`>\u00a0has quit  \n09:35\u00a0<sburjan`>\u00a0has joined #xwiki  \n10:37\u00a0<tmortagne>\u00a0has joined #xwiki  \n10:37\u00a0<tmortagne>\u00a0has left #xwiki  \n10:51\u00a0<DrLou>\u00a0has joined #xwiki  \n11:52\u00a0<evalica>\u00a0has joined #xwiki  \n11:56\u00a0<evalica>\u00a0has quit  \n11:58\u00a0<jvelociter>\u00a0has joined #xwiki  \n11:58\u00a0<+jvelociter>\u00a0hi vmassol  \n11:58\u00a0<+jvelociter>\u00a0I have a question regarding the velocity module  \n12:09\u00a0<vmassol>\u00a0jvelociter: hi  \n12:09\u00a0<+jvelociter>\u00a0vmassol: hello  \n12:10\u00a0<+jvelociter>\u00a0well I sort of figured it out in the mean time. But still maybe there is a better way : I'm sending emails from a scheduler job and I'm trying to pass a velocity context to the mail sender that is created from an engine that has my custom skin macros.vm in the list of skins  \n12:10\u00a0<+jvelociter>\u00a0the problem being sheduler job contextes don't have a context skin AFAIU  \n12:11\u00a0<+jvelociter>\u00a0finally I did it this way : externalize my macros to another .vm that I added to the macro list in xwiki.cfg  \n12:11\u00a0<vmassol>\u00a0the code is in DefaultVelocityManager  \n12:11\u00a0<@cjdelisle>\u00a0vmassol: re rollback(), you need a transaction to search and you need to end a transaction one way or another so rollback() is the safer method if you didn't intend to write to the db.  \n12:11\u00a0<+jvelociter>\u00a0yep, I've read that  \n12:11\u00a0<vmassol>\u00a0it creates a Velocity engine per skin  \n12:12\u00a0<vmassol>\u00a0per skin that has a macros.vm  \n12:12\u00a0<+jvelociter>\u00a0so how can I get a hold of a context that is created from a specific engine ?  \n12:12\u00a0<vmassol>\u00a0cjdelisle: that sounds strange to me to stat a transaction for read only  \n12:12\u00a0<+jvelociter>\u00a0i.e. the one with my skin macros.vm  \n12:12\u00a0<vmassol>\u00a0why do you need a tx?  \n12:13\u00a0<vmassol>\u00a0(tx can be costly too)  \n12:13\u00a0<@cjdelisle>\u00a0it would be possible in autocommit mode but I don't think hibernate allows that  \n12:14\u00a0<vmassol>\u00a0jvelociter: not sure, maybe call getVelocityEngine after having set the skin in the context?  \n12:14\u00a0<vmassol>\u00a0I see this in getSkin: skin = (String) context.get(\"skin\");  \n12:14\u00a0<+jvelociter>\u00a0hum right I didn't thought of that  \n12:15\u00a0<+jvelociter>\u00a0but actually externalizing those macros is a good thing after all  \n12:15\u00a0<+jvelociter>\u00a0they are not skin macros anyway, they are email macros  \n12:17\u00a0<vmassol>\u00a0cjdelisle: my bad apparently you always need a tx at the DB level even for read only  \n12:17\u00a0<vmassol>\u00a0(http://community.jboss.org/wiki/Non-transactionalDataAccessAndTheAuto-commitMode)  \n12:17\u00a0<vmassol>\u00a0it's just very strange from an api POV to call rollback()  \n12:18\u00a0<@cjdelisle>\u00a0yea, again in autocommit mode it doesn't work that way but autocommit is warned against  \n12:19\u00a0<vmassol>\u00a0http://forum.springsource.org/archive/index.php/t-61086.html  \n12:21\u00a0<vmassol>\u00a0the reason I got to this is because I was profiling XE and found that a substantial amount of time is spent on rollback() (like 15 or 20% of overall times)  \n12:21\u00a0<vmassol>\u00a0so I was worried that something was amiss  \n12:21\u00a0<vmassol>\u00a0but apparently it's ok so I'm fine (although I find this slightly misleading)  \n12:21\u00a0<@cjdelisle>\u00a0what is slow is not being able to send a query and let a callback be called when it's finished but j2ee is not really event based.  \n12:22\u00a0<@cjdelisle>\u00a0and jdbc is definitely not event based  \n13:38\u00a0<evalica>\u00a0has joined #xwiki  \n13:45\u00a0<evalica>\u00a0has quit  \n14:26\u00a0<DrLou>\u00a0has quit  \n14:26\u00a0<CIA-102>\u00a0tmortagne\u000f feature-improvecm\u000f \\* r724f201\u000f \u000f/ (2 files in 2 dirs):\u000f XCOMMONS-63: Optimize EmbeddableComponentManager ...  \n14:31\u00a0<CIA-102>\u00a0Vincent Massol\u000f master\u000f \\* rf39445e\u000f \u000f/ (7 files in 3 dirs):\u000f Revert \"XCOMMONS-62: Allow Event Listeners to have priorities\" since it broke several tests in platform (need to review and fix them before committing again) ...  \n14:45\u00a0<mflorea>\u00a0has joined #xwiki  \n14:53\u00a0<vmassol>\u00a0has quit  \n15:02\u00a0<CIA-102>\u00a0Sergiu Dumitriu\u000f master\u000f \\* r4cf724f\u000f \u000f/ (3 files):\u000f XWIKI-7181: Core extension pagination does not work ...  \n15:03\u00a0<DrLou>\u00a0has joined #xwiki  \n15:53\u00a0<Enygma`>\u00a0has joined #xwiki  \n16:54\u00a0<Enygma`>\u00a0has quit  \n16:54\u00a0<Enygma`1>\u00a0has joined #xwiki  \n16:58\u00a0<Enygma`1>\u00a0has quit  \n17:02\u00a0<mflorea>\u00a0has quit  \n18:22\u00a0<vmassol>\u00a0has joined #xwiki  \n18:49\u00a0<CIA-102>\u00a0tmortagne\u000f feature-improvecm\u000f \\* rad444af\u000f \u000f/ xwiki-commons-core/xwiki-commons-component/xwiki-commons-component-default/src/main/java/org/xwiki/component/embed/EmbeddableComponentManager.java :\u000f XCOMMONS-63: Optimize EmbeddableComponentManager ...  \n19:35\u00a0<vmassol>\u00a0has quit  \n22:34\u00a0<vmassol>\u00a0has joined #xwiki  \n22:42\u00a0<vmassol>\u00a0has quit  \n\n"}