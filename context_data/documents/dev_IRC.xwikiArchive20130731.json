{"id": "dev:IRC.xwikiArchive20130731", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20130731", "title": "IRC Archive for channel #xwiki on 31 July 2013 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<npm>\u00a0has quit  \n00:20\u00a0<npm>\u00a0has joined #xwiki  \n03:57\u00a0<kstuart>\u00a0has quit  \n07:43\u00a0<evalica>\u00a0has joined #xwiki  \n08:17\u00a0<tmortagne>\u00a0has joined #xwiki  \n08:18\u00a0<npm>\u00a0has quit  \n08:22\u00a0<mflorea>\u00a0has joined #xwiki  \n08:54\u00a0<msmeria>\u00a0has joined #xwiki  \n09:10\u00a0<vmassol>\u00a0has joined #xwiki  \n09:28\u00a0<sburjan>\u00a0has joined #xwiki  \n09:34\u00a0<gdelhumeau>\u00a0has joined #xwiki  \n09:39\u00a0<sburjan>\u00a0has quit  \n09:40\u00a0<sburjan>\u00a0has joined #xwiki  \n09:40\u00a0<KermitTheFragger>\u00a0has joined #xwiki  \n09:48\u00a0<camil7>\u00a0has joined #xwiki  \n10:30\u00a0<vmassol>\u00a0we have some big issues on our build in the ci  \n10:30\u00a0<vmassol>\u00a0platform hasn't built for a long time  \n10:30\u00a0<vmassol>\u00a0I upgraded jenkins yesterday night in the hope of fixing the issue  \n10:31\u00a0<vmassol>\u00a0but it seems it's still there  \n10:31\u00a0<vmassol>\u00a0seems the problem is in xwiki-platform-extension-handler-xar  \n10:31\u00a0<vmassol>\u00a0it always stop there  \n10:31\u00a0<vmassol>\u00a0\"Build timed out (after 90 minutes). Marking the build as aborted.  \n10:31\u00a0<vmassol>\u00a0\"  \n10:31\u00a0<vmassol>\u00a0so I don't think it's jenkins the problem  \n10:43\u00a0<Slashman>\u00a0has joined #xwiki  \n10:47\u00a0<tmortagne>\u00a0vmassol: I fixed the xar handler tests  \n10:47\u00a0<vmassol>\u00a0thanks!  \n10:47\u00a0<tmortagne>\u00a0that's what my last commit was about  \n10:48\u00a0<tmortagne>\u00a0but not sure why it was blocking before  \n11:03\u00a0<tdelafosse>\u00a0has joined #xwiki  \n11:05\u00a0<sburjan>\u00a0Hello. I have made a \u00a0UI \u00a0fix for \u00a0http://extensions.xwiki.org/xwiki/bin/view/Extension/PDF+Export+Panel+Application, but the issue is that the application is not on Github. \u00a0It only has the attached XAR to the page. What is the best practice ? Should I export it as XAR and upload the version 2 ?  \n11:07\u00a0<tmortagne>\u00a0sburjan: either you put all that on github and release it on maven repository yourself or you do what has been done already and add a new version with the attachment on the page  \n11:07\u00a0<tmortagne>\u00a0your choice  \n11:07\u00a0<sburjan>\u00a0tmortagne: in order to start small, I will repack it and attach the new XAR to the page  \n11:08\u00a0<tmortagne>\u00a0sburjan: and don't forget to add a new version object associated to the new attachment  \n11:08\u00a0<sburjan>\u00a0tmortagne: yes, doing it now, I'll ping you if I have issues  \n11:11\u00a0<sburjan>\u00a0tmortagne: does it matter how I name the XAR ? V1 is Panels.PDFExport.xar, and if I will put my V1.1 as Panels.PDFExportV1.1.xar is it ok ?  \n11:14\u00a0<tmortagne>\u00a0sburjan: as you want, you have to indicate the name of the attachment in the version object anyway but it's always better to stay consistent  \n11:18\u00a0<sburjan>\u00a0tmortagne: done, thanks  \n11:19\u00a0<vmassol>\u00a0it's a good idea to move all code to contrib  \n11:20\u00a0<sburjan>\u00a0yes, also for code reviewing  \n11:35\u00a0<tmortagne>\u00a0has quit  \n12:14\u00a0<mflorea>\u00a0has quit  \n13:04\u00a0<mflorea>\u00a0has joined #xwiki  \n14:29\u00a0<kstuart>\u00a0has joined #xwiki  \n14:38\u00a0<tmortagne>\u00a0has joined #xwiki  \n14:41\u00a0<tmortagne>\u00a0vmassol: jira seems to be super fast since the upgrade  \n14:41\u00a0<tmortagne>\u00a0jenkins sorry  \n14:41\u00a0<vmassol>\u00a0yes they've worked on it i think, this is cool  \n14:41\u00a0<vmassol>\u00a0I'll report to sacha in a few days after we've used it more  \n14:41\u00a0<vmassol>\u00a0the dashboard ui is a bit misaligned though , not sure why yet  \n14:42\u00a0<vmassol>\u00a0probably just some long names on our side  \n14:42\u00a0<tmortagne>\u00a0did not noticed  \n14:43\u00a0<tmortagne>\u00a0only think a bit annoying is that the build queue width is too low (at least for me)  \n14:43\u00a0<tmortagne>\u00a0thing  \n14:44\u00a0<tmortagne>\u00a0or maybe that's what you were talking about  \n14:45\u00a0<tmortagne>\u00a0it's probably because of \u00a0jobs names like \" \u00a0\u00a0xwiki-manager-test-webstandards-feature-authorization-context \"  \n14:46\u00a0<vmassol>\u00a0yep  \n15:10\u00a0<vmassol>\u00a0btw tmortagne, for webjars, it works as a custom action but it won't work as a filter  \n15:11\u00a0<vmassol>\u00a0because a filter will execute before we've set the thread context CL  \n15:11\u00a0<vmassol>\u00a0(so it won't see the extensions)  \n15:11\u00a0<vmassol>\u00a0not sure where we modify the thread context CL though, any idea?  \n15:11\u00a0<vmassol>\u00a0I guess I can search for it  \n15:11\u00a0<tmortagne>\u00a0the thread CL set is triggered by EC init so the filter just have to init it  \n15:12\u00a0<vmassol>\u00a0found the location, in: ThreadClassloaderExecutionContextInitializer  \n15:13\u00a0<tmortagne>\u00a0yes  \n15:15\u00a0<vmassol>\u00a0trying  \n15:15\u00a0<vmassol>\u00a0if it can work, I think a filter is better than an action, wdyt?  \n15:15\u00a0<tmortagne>\u00a0it's lighter yes  \n15:15\u00a0<tmortagne>\u00a0the filter could also set itself the right CL if it does not need the EC  \n15:16\u00a0<vmassol>\u00a0yep  \n15:16\u00a0<vmassol>\u00a0same as is done in ThreadClassloaderExecutionContextInitializer but maybe that will require the EC somewhere in the path  \n15:17\u00a0<vmassol>\u00a0yes it will: \u00a0\u00a0\u00a0\u00a0private EntityReferenceValueProvider provider;  \n15:17\u00a0<vmassol>\u00a0hmm actually  \n15:17\u00a0<vmassol>\u00a0this part is not needed  \n15:17\u00a0<vmassol>\u00a0we're global  \n15:18\u00a0<vmassol>\u00a0so I just need ClassLoaderManager  \n15:18\u00a0<tmortagne>\u00a0well it could be nice to support webjar installed only for a specific wiki  \n15:18\u00a0<vmassol>\u00a0indeed  \n15:18\u00a0<vmassol>\u00a0I'll do the EC init then  \n15:19\u00a0<tmortagne>\u00a0but what is really need is to find the current wiki  \n15:19\u00a0<tmortagne>\u00a0you don't have to do it through the EC  \n15:20\u00a0<vmassol>\u00a0sure but it's a bit complex to simulate and thus put what is needed  \n15:20\u00a0<tmortagne>\u00a0simulate what ?  \n15:20\u00a0<vmassol>\u00a0construct the EC  \n15:20\u00a0<vmassol>\u00a0with only the required info  \n15:20\u00a0<vmassol>\u00a0(or find the current wiki which is the same)  \n15:20\u00a0<tmortagne>\u00a0classLoaderManager does not need the EC  \n15:20\u00a0<tmortagne>\u00a0you don't have to use ThreadClassloaderExecutionContextInitializer  \n15:20\u00a0<vmassol>\u00a0sure but you need the current wiki  \n15:21\u00a0<vmassol>\u00a0and this needs to be extracted from the URL  \n15:21\u00a0<tmortagne>\u00a0if you dod a custom filter you will need to take care of parsing the URL etc anyway  \n15:21\u00a0<vmassol>\u00a0I could use my URL module for that but it's a bit of work  \n15:21\u00a0<vmassol>\u00a0yes I do some parsing but it's very simple parsing  \n15:21\u00a0<vmassol>\u00a0String resourceName = StringUtils.substringAfter(httpServletRequest.getRequestURL().toString(), WEBJAR\\_PATH);  \n15:22\u00a0<vmassol>\u00a0I'd need to implement some xwiki-platform-url component to do it properly  \n15:22\u00a0<vmassol>\u00a0but yes this is the best way normally  \n15:23\u00a0<vmassol>\u00a0ok I'll do something simple for now since this is just a POC ATM, I'll send an email soon  \n15:23\u00a0<vmassol>\u00a0i got it working with a custom actio and I'm now doing a filter  \n15:23\u00a0<vmassol>\u00a0once I have a working POC I'll sedn a proposal email  \n15:25\u00a0<tmortagne>\u00a0creating a proper XWikiContext and initialize a ExecutionContext is not exactly \"something simple\"  \n15:26\u00a0<tmortagne>\u00a0if you do all that then you can stay in a custom action  \n15:27\u00a0<vmassol>\u00a0I know  \n15:36\u00a0<Enygma`>\u00a0has joined #xwiki  \n16:02\u00a0<sburjan>\u00a0Hello. I have somehow managed to lose my PR right on my Admin user :) hasAdminRights returns true, but hasProgrammingRights() returns false. I have tried to revert to the version 1.1 of the Admin user, no success. Any idea how can I recovery my PR rights ?  \n16:06\u00a0<sburjan>\u00a0I fixed, sorry for the noise  \n16:19\u00a0<Enygma`>\u00a0has quit  \n16:26\u00a0<camil7>\u00a0vmassol: small typo: change on ReleaseNotes.WebHome says Release Notes for XWiki 5.1 Milestone 1 \u00a0\u00a0... for the 5.2M1 release ;)  \n16:27\u00a0<vmassol>\u00a0yeah whoever created them copied from the prevoous ones but failed to change that  \n16:27\u00a0<vmassol>\u00a0oh wait  \n16:27\u00a0<vmassol>\u00a0got it  \n16:27\u00a0<vmassol>\u00a0fixing  \n16:27\u00a0<vmassol>\u00a0thought you were referring to inside the RN  \n16:27\u00a0<vmassol>\u00a0thanks  \n16:28\u00a0<tmortagne>\u00a0can't find any public/velocity API to delete an attachment, am I blind ?  \n16:29\u00a0<tmortagne>\u00a0I checked Document and XWiki but there is nothing that looks like deleteAttachment  \n16:29\u00a0<vmassol>\u00a0removeAttachment  \n16:29\u00a0<vmassol>\u00a0in XWikiDocument  \n16:29\u00a0<vmassol>\u00a0ah not public  \n16:29\u00a0<tmortagne>\u00a0yes public  \n16:29\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0public void deleteAttachment(XWikiAttachment attachment, boolean toRecycleBin, XWikiContext context)  \n16:29\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0throws XWikiException  \n16:29\u00a0<tmortagne>\u00a0I know how to do it in XWikiDocument  \n16:30\u00a0<tmortagne>\u00a0that's XWikiDocument  \n16:30\u00a0<vmassol>\u00a0I don't think there is for public public  \n16:30\u00a0<tmortagne>\u00a0I don't understand why, we even have public API to get deleted attachment  \n16:31\u00a0<vmassol>\u00a0probably because nobody asked for one and we got around by using some private api  \n16:32\u00a0<Enygma`>\u00a0has joined #xwiki  \n16:41\u00a0<evalica>\u00a0has quit  \n16:41\u00a0<msmeria>\u00a0has quit  \n16:41\u00a0<sburjan>\u00a0has quit  \n16:55\u00a0<evalica>\u00a0has joined #xwiki  \n16:56\u00a0<evalica>\u00a0has quit  \n17:06\u00a0<tdelafosse>\u00a0has quit  \n17:13\u00a0<sdumitriu1>\u00a0has joined #xwiki  \n17:18\u00a0<vmassol>\u00a0has quit  \n17:58\u00a0<gdelhumeau>\u00a0has quit  \n18:19\u00a0<npm>\u00a0has joined #xwiki  \n18:30\u00a0<KermitTheFragger>\u00a0has quit  \n18:59\u00a0<camil7>\u00a0has quit  \n19:17\u00a0<mflorea>\u00a0has quit  \n19:23\u00a0<Slashman>\u00a0has quit  \n19:46\u00a0<abusenius\\_>\u00a0has joined #xwiki  \n19:50\u00a0<vmassol>\u00a0has joined #xwiki  \n20:06\u00a0<vmassol>\u00a0guys  \n20:06\u00a0<cjd>\u00a0?  \n20:06\u00a0<vmassol>\u00a0tmortagne: could the enteprrise build error be caused by the change in dep for aether?  \n20:06\u00a0<vmassol>\u00a0Found duplicate classes in [asm:asm:3.3.1,org.ow2.asm:asm:4.1] :  \n20:06\u00a0<vmassol>\u00a0see http://ci.xwiki.org/job/xwiki-enterprise/10352/consoleText  \n20:07\u00a0<vmassol>\u00a0ah there are also aether dups apparently  \n20:09\u00a0<tmortagne>\u00a0asm seems to come from sisu which come from aether  \n20:10\u00a0<tmortagne>\u00a0I don't see how we could have duplicated aether  \n20:10\u00a0<tmortagne>\u00a0we have only one module with that dependency  \n20:11\u00a0<tmortagne>\u00a0it's not duplicated aether  \n20:11\u00a0<tmortagne>\u00a0META-INF/sisu/javax.inject.Named  \n20:12\u00a0<tmortagne>\u00a0that's a sisu component descriptor that's all  \n20:12\u00a0<tmortagne>\u00a0we need to add it to the excludes  \n20:12\u00a0<tmortagne>\u00a0same thing for about.html probably  \n20:13\u00a0<tmortagne>\u00a0asm duplicate one is a bit trickier  \n20:13\u00a0<tmortagne>\u00a0and we are going to have that asm issue all the time...  \n20:13\u00a0<tmortagne>\u00a0will see tomorrow if I can simply get rid of sisu dependencies  \n20:14\u00a0<tmortagne>\u00a0I think it's required only if you use it and I don't  \n20:14\u00a0<tmortagne>\u00a0(still using plexus)  \n20:32\u00a0<vmassol>\u00a0has quit  \n20:44\u00a0<tmortagne>\u00a0has quit  \n21:00\u00a0<sdumitriu1>\u00a0has quit  \n22:39\u00a0<npm>\u00a0has quit  \n22:40\u00a0<kstuart>\u00a0has quit  \n23:01\u00a0<cjd>\u00a0has quit  \n23:04\u00a0<abusenius\\_>\u00a0has quit  \n23:05\u00a0<Enygma`>\u00a0has quit  \n23:41\u00a0<kstuart>\u00a0has joined #xwiki\n"}