{"id": "dev:IRC.xwikiArchive20120709", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20120709", "title": "IRC Archive for channel #xwiki on 09 July 2012 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n00:00\u00a0<mflorea>\u00a0has quit  \n02:02\u00a0<CIA-114>\u00a0Sergiu Dumitriu\u000f master\u000f \\* r3ff7c95\u000f https://github.com/xwiki/xwiki-platform/commit/3ff7c9564343c6dafb22ee29b80192f6e95d94e1 \u000f/ xwiki-platform-core/xwiki-platform-web/src/main/webapp/resources/uicomponents/suggest/suggest.js :\u000f XWIKI-8021: XWiki.widgets.Suggest widget should work in a positioned container - http://git.io/auDciA  \n02:13\u00a0<CIA-114>\u00a0Sergiu Dumitriu\u000f master\u000f \\* r90909c7\u000f https://github.com/xwiki/xwiki-enterprise/commit/90909c737e341bdef989084ac5fc68c953167737 \u000f/ xwiki-enterprise-ui/src/main/resources/XWiki/SharePage.xml :\u000f XE-1211: SharePage dialog: Recipient suggestions list is incorrectly positioned when scrolling down - http://git.io/1Jk-Iw  \n03:00\u00a0<cjd\\_>\u00a0has joined #xwiki  \n03:40\u00a0<CIA-114>\u00a0Sergiu Dumitriu\u000f master\u000f \\* rdbda023\u000f https://github.com/xwiki/xwiki-platform/commit/dbda0236262ed9214f9eb105f55495c5c22cd877 \u000f/ (2 files in 2 dirs):\u000f XWIKI-8022: Add standard XWiki behaviors to dynamically inserted HTML content - http://git.io/lJdr5g  \n04:53\u00a0<ssavi>\u00a0has quit  \n05:05\u00a0<ssavi>\u00a0has joined #xwiki  \n05:08\u00a0<ssavi>\u00a0has quit  \n06:19\u00a0<ssavi>\u00a0has joined #xwiki  \n06:35\u00a0<DSpair\\_AFK>\u00a0has quit  \n07:38\u00a0<mflorea>\u00a0has joined #xwiki  \n07:48\u00a0<polx>\u00a0has joined #xwiki  \n08:16\u00a0<polx>\u00a0has quit  \n08:54\u00a0<polx>\u00a0has joined #xwiki  \n08:55\u00a0<vmassol>\u00a0has joined #xwiki  \n08:55\u00a0<tmortagne>\u00a0has joined #xwiki  \n09:26\u00a0<ssavi>\u00a0has quit  \n09:35\u00a0<CIA-114>\u00a0Vincent Massol\u000f master\u000f \\* rcf2f597\u000f https://github.com/xwiki/xwiki-commons/commit/cf2f597593ce2ec2c9c486d4c80abcf9c963e15c \u000f/ xwiki-commons-core/xwiki-commons-test/src/main/java/org/xwiki/test/AbstractMockingComponentTestCase.java :\u000f XCOMMONS-215: Allow not loading all components during unit tests for better control and improved performances - http://git.io/3hmNkA  \n09:36\u00a0<vmassol>\u00a0good morning  \n09:37\u00a0<vmassol>\u00a0today is release day for 4.2M1  \n09:37\u00a0<vmassol>\u00a0do we have a release manager?  \n09:37\u00a0<vmassol>\u00a0we also need to release 4.1.3 ASAP  \n09:37\u00a0<vmassol>\u00a0on my side I'd like to upgrade myxwiki.org and xwiki.org this week to 4.1.3  \n09:38\u00a0<vmassol>\u00a0so we need a RM for 4.1.3 and a RM for 4.2M1  \n09:38\u00a0<vmassol>\u00a0any volunteer?  \n09:42\u00a0<vmassol>\u00a0ok I'll take the 4.1.3 release.  \n09:42\u00a0<vmassol>\u00a0we need someone for 4.2M1  \n10:07\u00a0<gdelhumeau>\u00a0has joined #xwiki  \n10:14\u00a0<polx>\u00a0has quit  \n10:23\u00a0<Enygma`>\u00a0has joined #xwiki  \n10:25\u00a0<evalica>\u00a0has joined #xwiki  \n10:39\u00a0<vmassol>\u00a0guys, are you ok for me to stop myxwiki for 1 hour to migrate it to 4.1.3? I'd like to do this migration ASAP before we release 4.1.3 just to have one more real world test that 4.1.3 works fine  \n10:43\u00a0<vmassol>\u00a0no answer, it means you're fine then!  \n10:50\u00a0<CIA-114>\u00a0tmortagne\u000f feature-extensiondistribution\u000f \\* r843971a\u000f https://github.com/xwiki/xwiki-platform/commit/843971ac7176c5a67b632ae1d8efec47170b64e0 \u000f/ xwiki-platform-core/xwiki-platform-extension/xwiki-platform-extension-script/src/main/java/org/xwiki/extension/script/internal/ExtensionManagerScriptService.java :\u000f XWIKI-7896: Display a global install/upgrade wizard when starting an new version of an XWiki instance - http://git.io/leQcWw  \n10:50\u00a0<CIA-114>\u00a0tmortagne\u000f master\u000f \\* ra41c3f8\u000f https://github.com/xwiki/xwiki-platform/commit/a41c3f8ec5628af697e7de3690003a33a5092999 \u000f/ (2 files in 2 dirs):\u000f XWIKI-8011: When saving a wiki macro document the author of the macro should be used to check right instead of the current user - http://git.io/zPcAMw  \n10:50\u00a0<+tmortagne>\u00a0vmassol: +1  \n10:58\u00a0<CIA-114>\u00a0tmortagne\u000f master\u000f \\* r992df25\u000f https://github.com/xwiki/xwiki-platform/commit/992df2581e77f1ed1e56ae730579470afb632e99 \u000f/ (3 files in 2 dirs):\u000f XWIKI-8018: Typo in infinispan cache module : LocaInfinispanCacheFactory instead of LocalInfinispanCacheFactory - http://git.io/6XZ\\_nw  \n11:00\u00a0<vmassol>\u00a0has quit  \n11:01\u00a0<vmassol>\u00a0has joined #xwiki  \n11:04\u00a0<sburjan>\u00a0has joined #xwiki  \n11:04\u00a0<polx>\u00a0has joined #xwiki  \n11:25\u00a0<vmassol>\u00a0tmortagne: btw XE fails to start properly, are you on it?  \n11:25\u00a0<vmassol>\u00a0(wiki macros init issue)  \n11:25\u00a0<vmassol>\u00a0ah just seen a comit  \n11:26\u00a0<vmassol>\u00a0commit  \n11:26\u00a0<+tmortagne>\u00a0vmassol: you mean the message about missing classes N  \n11:26\u00a0<+tmortagne>\u00a0?  \n11:26\u00a0<vmassol>\u00a0I mean the fact that wiki macros are not registered when XE starts  \n11:26\u00a0<vmassol>\u00a0btw WikiMacroInitialiserListener.java \u2014> typo: Initializer  \n11:27\u00a0<+tmortagne>\u00a0I committed something about it, it's only with hsqldb/jetty because the wikiready event is not sent by packager  \n11:30\u00a0<+tmortagne>\u00a0I need to go, back in about 2 hours  \n11:33\u00a0<+tmortagne>\u00a0actually will go in 30min  \n11:37\u00a0<vmassol>\u00a0myxwiki.org migration failed again :(  \n11:50\u00a0<tmortagne>\u00a0has quit  \n11:50\u00a0<tmortagne1>\u00a0has joined #xwiki  \n11:53\u00a0<+sburjan>\u00a0ouch  \n12:06\u00a0<CIA-114>\u00a0tmortagne\u000f master\u000f \\* r182a489\u000f https://github.com/xwiki/xwiki-commons/commit/182a489f88a3eb366b54b9b17032b0c11fd0dee2 \u000f/ (2 files):\u000f XCOMMONS-217: org.xwiki.job.internal.DefaultJobProgress listener does not properly take into account multithreading - http://git.io/F4udHA  \n12:06\u00a0<CIA-114>\u00a0tmortagne\u000f master\u000f \\* r0a98b43\u000f https://github.com/xwiki/xwiki-commons/commit/0a98b436986d12cb0da022f2d3a644d023f93eb7 \u000f/ xwiki-commons-core/xwiki-commons-logging/xwiki-commons-logging-api/src/main/java/org/xwiki/logging/event/LogEvent.java :\u000f [misc] Add toString() to make easier to debug LogEvent - http://git.io/V2j8Pg  \n12:08\u00a0<tmortagne1>\u00a0has quit  \n12:12\u00a0<vmassol>\u00a0myxwiki.org back on 3.5\u2026.  \n12:27\u00a0<+sburjan>\u00a0http://www.developsense.com/blog/2009/08/testing-vs-checking/ a very interesting article  \n12:50\u00a0<polx>\u00a0has quit  \n13:35\u00a0<polx>\u00a0has joined #xwiki  \n13:39\u00a0<polx>\u00a0has quit  \n13:49\u00a0<polx>\u00a0has joined #xwiki  \n13:58\u00a0<jvelo>\u00a0has joined #xwiki  \n14:03\u00a0<tmortagne>\u00a0has joined #xwiki  \n14:05\u00a0<jvelo>\u00a0has quit  \n14:08\u00a0<vmassol>\u00a0ok I've fully updated http://platform.xwiki.org/xwiki/bin/view/AdminGuide/Backup Let me know if you see anything missing  \n14:18\u00a0<CIA-114>\u00a0tmortagne\u000f master\u000f \\* rb2232b5\u000f https://github.com/xwiki/xwiki-commons/commit/b2232b5973a3a6701b4025fc8e8a8259cb536382 \u000f/ xwiki-commons-core/xwiki-commons-job/src/test/java/org/xwiki/job/internal/DefaultJobProgressTest.java :\u000f XCOMMONS-217: org.xwiki.job.internal.DefaultJobProgress listener does not properly take into account multithreading - http://git.io/GpXjDA  \n14:28\u00a0<CIA-114>\u00a0Sergiu Dumitriu\u000f master\u000f \\* ra65c0f9\u000f https://github.com/xwiki/xwiki-platform/commit/a65c0f9fb32b2970b207e58fef790874de41784e \u000f/ xwiki-platform-core/xwiki-platform-web/src/main/webapp/resources/js/xwiki/widgets/jumpToPage.js :\u000f [misc] Make the jumpToPage dialog work with the new suggest positioning - http://git.io/vtK9\\_g  \n15:20\u00a0<tmortagne>\u00a0has quit  \n15:22\u00a0<tmortagne>\u00a0has joined #xwiki  \n15:41\u00a0<polx>\u00a0has quit  \n15:46\u00a0<Kephhh>\u00a0has joined #xwiki  \n15:47\u00a0<Kephhh>\u00a0has quit  \n15:47\u00a0<gdelhumeau>\u00a0Hey  \n15:47\u00a0<gdelhumeau>\u00a0I'va got a problem  \n15:47\u00a0<gdelhumeau>\u00a0https://ezcrypt.it/hk5n#H0XdUzJibrzY6w6hUfBFTDMv  \n15:47\u00a0<gdelhumeau>\u00a0When I start tomcat  \n15:47\u00a0<gdelhumeau>\u00a0SEVERE: The web application [/xwiki] appears to have started a thread named [Thread-2] but has failed to stop it. This is very likely to create a memory leak.  \n15:47\u00a0<gdelhumeau>\u00a0Jul 9, 2012 3:45:46 PM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads  \n15:47\u00a0<gdelhumeau>\u00a0SEVERE: The web application [/xwiki]  \n15:48\u00a0<cjd\\_>\u00a0My understanding is this is a known issue and not critical.  \n15:48\u00a0<cjd\\_>\u00a0is now known as <cjd>  \n15:49\u00a0<cjd>\u00a0is now known as <cjd\\_>  \n15:49\u00a0<gdelhumeau>\u00a0But my application don't start  \n15:49\u00a0<gdelhumeau>\u00a0HTTP Status 404 -  \n15:49\u00a0<gdelhumeau>\u00a0type Status report  \n15:49\u00a0<gdelhumeau>\u00a0message  \n15:49\u00a0<gdelhumeau>\u00a0description The requested resource () is not available.  \n15:49\u00a0<cjd\\_>\u00a0that's no good  \n15:49\u00a0<gdelhumeau>\u00a0obviously :)  \n15:49\u00a0<vmassol>\u00a0gdelhumeau: don't stop webapp  \n15:49\u00a0<vmassol>\u00a0instead stop tomcat and restart it  \n15:50\u00a0<vmassol>\u00a0the log you've shown seems to be from a webapp stop  \n15:50\u00a0<gdelhumeau>\u00a0I used xinit  \n15:51\u00a0<vmassol>\u00a0the problem  \n15:51\u00a0<vmassol>\u00a0is not what is in the log  \n15:52\u00a0<gdelhumeau>\u00a0sudo /etc/init.d/xwiki.sh restart  \n15:52\u00a0<gdelhumeau>\u00a0[sudo] password for gdelhumeau:  \n15:52\u00a0<gdelhumeau>\u00a0Restarting Tomcat ...  \n15:52\u00a0<gdelhumeau>\u00a0Stopping Tomcat ...  \n15:52\u00a0<gdelhumeau>\u00a0Using CATALINA\\_BASE: \u00a0\u00a0/usr/local/tomcat  \n15:52\u00a0<gdelhumeau>\u00a0Using CATALINA\\_HOME: \u00a0\u00a0/usr/local/tomcat  \n15:52\u00a0<gdelhumeau>\u00a0Using CATALINA\\_TMPDIR: /usr/local/tomcat/temp  \n15:52\u00a0<gdelhumeau>\u00a0Using JRE\\_HOME: \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0/usr/local/java  \n15:52\u00a0<gdelhumeau>\u00a0Using CLASSPATH: \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0/usr/local/tomcat/bin/bootstrap.jar  \n15:52\u00a0<gdelhumeau>\u00a0Using CATALINA\\_PID: \u00a0\u00a0\u00a0/var/tmp/catalina.pid  \n15:52\u00a0<vmassol>\u00a0no  \n15:52\u00a0<gdelhumeau>\u00a0OpenOffice Daemon is not running!  \n15:52\u00a0<gdelhumeau>\u00a0Starting Tomcat Server ...  \n15:52\u00a0<gdelhumeau>\u00a0OpenOffice Daemon is not running!  \n15:52\u00a0<vmassol>\u00a0no paste here  \n15:52\u00a0<gdelhumeau>\u00a0Using CATALINA\\_BASE: \u00a0\u00a0/usr/local/tomcat  \n15:52\u00a0<gdelhumeau>\u00a0Using CATALINA\\_HOME: \u00a0\u00a0/usr/local/tomcat  \n15:52\u00a0<vmassol>\u00a0use pastebin  \n15:52\u00a0<gdelhumeau>\u00a0Using CATALINA\\_TMPDIR: /usr/local/tomcat/temp  \n15:52\u00a0<vmassol>\u00a0;)  \n15:52\u00a0<gdelhumeau>\u00a0Using JRE\\_HOME: \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0/usr/local/java  \n15:52\u00a0<gdelhumeau>\u00a0Using CLASSPATH: \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0/usr/local/tomcat/bin/bootstrap.jar  \n15:52\u00a0<gdelhumeau>\u00a0Using CATALINA\\_PID: \u00a0\u00a0\u00a0/var/tmp/catalina.pid  \n15:52\u00a0<vmassol>\u00a0what happens is that for some reason xwiki doesn't start  \n15:52\u00a0<vmassol>\u00a0and thus tomcat stops it  \n15:53\u00a0<vmassol>\u00a0the logs about failing to stop threads is not the issue IMO  \n15:53\u00a0<vmassol>\u00a0you don't need to read this:  \n15:53\u00a0<vmassol>\u00a0http://platform.xwiki.org/xwiki/bin/view/AdminGuide/InstallationTomcat#HSEVERE:ErrorlistenerStart  \n15:54\u00a0<vmassol>\u00a0then restart  \n15:54\u00a0<gdelhumeau>\u00a0ok  \n15:58\u00a0<vmassol>\u00a0FYI I'm going to try again the migration to XWiki 4.1.3 on myxwiki.org. Downtime will be 1 to 2 hours starting at 16:00GMT+2  \n16:00\u00a0<Inge->\u00a0has quit  \n16:00\u00a0<+sburjan>\u00a0what went wrong this morning ?  \n16:01\u00a0<vmassol>\u00a0hmm I think the upgrades notes are wrong on http://myxwiki.org/xwiki/bin/view/XWiki/Upgrading. We need to upgrade the second node before we upgrade the XARs,  \n16:01\u00a0<vmassol>\u00a0ah no forget that  \n16:01\u00a0<vmassol>\u00a0it's ok since the load balancer goes only to node1  \n16:07\u00a0<polx>\u00a0has joined #xwiki  \n16:07\u00a0<gdelhumeau>\u00a0should I put \"org.apache.catalina.core.ContainerBase.[Catalina].level\" on logback.xml ?  \n16:07\u00a0<gdelhumeau>\u00a0should I change \u00a0[Catalina] by something?  \n16:08\u00a0<cjd>\u00a0has joined #xwiki  \n16:08\u00a0<cjd\\_>\u00a0has quit  \n16:17\u00a0<gdelhumeau>\u00a0http://pastebin.com/G8sk9Psg  \n16:21\u00a0<Inge->\u00a0has joined #xwiki  \n16:24\u00a0<CIA-114>\u00a0Marius Dumitru Florea\u000f master\u000f \\* rf507bc0\u000f https://github.com/xwiki/xwiki-platform/commit/f507bc043cf4bb1287a47290930e542c6bd4731b \u000f/ (2 files in 2 dirs):\u000f XWIKI-8024: XWikiDocument#setAsContextDoc doesn't set the 'cdoc' in the Velocity context - http://git.io/yW66kA  \n17:21\u00a0<jvelo>\u00a0has joined #xwiki  \n17:21\u00a0<jvelo>\u00a0has quit  \n17:21\u00a0<jvelo>\u00a0has joined #xwiki  \n17:21\u00a0<sburjan>\u00a0has quit  \n17:24\u00a0<vmassol>\u00a0ok myxwiki.org node1 upgraded and I've imported the xar on the main wiki  \n17:24\u00a0<vmassol>\u00a0some issues  \n17:24\u00a0<vmassol>\u00a0on http://myxwiki.org/xwiki/bin/view/XWiki/VincentMassol there's a problem with a velocity macro  \n17:25\u00a0<vmassol>\u00a0and in the logs we have constantly tons of these: https://gist.github.com/3077139  \n17:25\u00a0<vmassol>\u00a0(tmortagne)  \n17:32\u00a0<gdelhumeau>\u00a0vmassol> I don't see any change  \n17:32\u00a0<gdelhumeau>\u00a0in my issue  \n17:32\u00a0<vmassol>\u00a0gdelhumeau: sorry I don't have the time to help you right now  \n17:32\u00a0<vmassol>\u00a0I'm upgrading myxwiki.org  \n17:33\u00a0<CIA-114>\u00a0Marius Dumitru Florea\u000f master\u000f \\* rf2a9e99\u000f https://github.com/xwiki/xwiki-platform/commit/f2a9e99b1a2dfac3c08b6e2d6a5bb2113a42d07f \u000f/ (2 files in 2 dirs):\u000f XWIKI-8025: XWikiDocument#backup/restoreContext doesn't update the reference to the Velocity context stored on the XWiki context - http://git.io/2C3Lfg  \n17:45\u00a0<CIA-114>\u00a0Marius Dumitru Florea\u000f master\u000f \\* r84028d8\u000f https://github.com/xwiki/xwiki-platform/commit/84028d8d9df2f80955d7c4c2c1bf44d495f7884a \u000f/ (2 files in 2 dirs):\u000f XWIKI-8025: XWikiDocument#backup/restoreContext doesn't update the reference to the Velocity context stored on the XWiki context - http://git.io/DbAtWw  \n17:55\u00a0<vmassol>\u00a0tmortagne: ping ping  \n17:55\u00a0<vmassol>\u00a0so nobody has any idea why there's this problem on myxwiki.org  \n17:55\u00a0<vmassol>\u00a0http://myxwiki.org/xwiki/bin/view/XWiki/VincentMassol  \n17:55\u00a0<vmassol>\u00a0?  \n17:58\u00a0<vmassol>\u00a0it happens on the various profile tabs  \n17:58\u00a0<gdelhumeau>\u00a0what is the content of your \"e-mail\" field?  \n17:58\u00a0<vmassol>\u00a0profile and preferences tab to be precise  \n17:58\u00a0<jvelo>\u00a0has quit  \n17:58\u00a0<vmassol>\u00a0my email address  \n17:58\u00a0<vmassol>\u00a0hmm in edit mode it's more fun  \n18:01\u00a0<@sdumitriu>\u00a0vmassol: The problem is that in the XWikiUsers class the email field has a custom displayer which uses {{velocity}}  \n18:02\u00a0<@sdumitriu>\u00a0But the class document itself is in the 1.0 syntax  \n18:02\u00a0<@sdumitriu>\u00a0So the displayer isn't executed, it is dumped in the sheet output  \n18:02\u00a0<@sdumitriu>\u00a0Which then tries to execute it  \n18:02\u00a0<@sdumitriu>\u00a0This was a bug that was fixed, custom displayers were executed in the syntax of the document that wanted to display the field, not in the syntax of the class  \n18:04\u00a0<@sdumitriu>\u00a0I changed the class syntax, it seems to be working now  \n18:05\u00a0<vmassol>\u00a0you changed what document?  \n18:05\u00a0<@sdumitriu>\u00a0XWiki.XWikiUsers  \n18:05\u00a0<polx>\u00a0has quit  \n18:05\u00a0<vmassol>\u00a0I have imported it  \n18:06\u00a0<vmassol>\u00a0from the XAR  \n18:06\u00a0<vmassol>\u00a0why do we need to make a change to it?  \n18:06\u00a0<vmassol>\u00a0my question is more general  \n18:06\u00a0<vmassol>\u00a0do we have this somewhere in the release notes?  \n18:06\u00a0<@sdumitriu>\u00a0http://myxwiki.org/xwiki/bin/view/XWiki/XWikiUsers?viewer=history  \n18:06\u00a0<@sdumitriu>\u00a0No \"Imported\" version in there  \n18:07\u00a0<@sdumitriu>\u00a0Or maybe you imported from the wrong XAR  \n18:07\u00a0<vmassol>\u00a0that's really weird because I've been extra careful  \n18:07\u00a0<vmassol>\u00a0sdumitriu: I've imported from http://myxwiki.org/xwiki/bin/import/XWiki/XWikiPreferences?editor=globaladmin&section=Import  \n18:07\u00a0<@sdumitriu>\u00a0XWikiUsers isn't in the XAR  \n18:08\u00a0<vmassol>\u00a0indeed  \n18:08\u00a0<vmassol>\u00a0it's created in java  \n18:08\u00a0<@sdumitriu>\u00a0I think we might have removed it when we decided that auto-created classes should not be in the XAR  \n18:08\u00a0<vmassol>\u00a0so we have an upgrade bug  \n18:10\u00a0<vmassol>\u00a0the problem is going to be there on all subwikis  \n18:11\u00a0<vmassol>\u00a0btw we also have this issue (I'm in chrome) when editing the profile: http://www.evernote.com/shard/s119/sh/2193c895-18ec-45e0-adaf-af1e845ace9d/649459835619064a592318ddf6a4ecd1  \n18:12\u00a0<polx>\u00a0has joined #xwiki  \n18:21\u00a0<vmassol>\u00a0sdumitriu: would be good to find a solution for 4.1.3  \n18:23\u00a0<@sdumitriu>\u00a0vmassol: Also because the document is in the 1.0 syntax  \n18:23\u00a0<@sdumitriu>\u00a0This time the user document  \n18:23\u00a0<@sdumitriu>\u00a0Try now  \n18:24\u00a0<vmassol>\u00a0try what sdumitriu?  \n18:25\u00a0<@sdumitriu>\u00a0Editing your profile  \n18:25\u00a0<@sdumitriu>\u00a0That message comes from the old TinyMCE editor  \n18:25\u00a0<vmassol>\u00a0sdumitriu: ah indeed, hmm we need to convert our user profiles  \n18:26\u00a0<@sdumitriu>\u00a0Yep  \n18:26\u00a0<vmassol>\u00a0I think I wrote some scripts a while ago  \n18:26\u00a0<vmassol>\u00a0I've done it for xwiki.org AFAIR  \n18:30\u00a0<vmassol>\u00a0sdumitriu: we still need to find a soltuion for upgrading users  \n18:30\u00a0<vmassol>\u00a0for XWikiUsers  \n18:30\u00a0<vmassol>\u00a0right now all wikis on myxwiki.org are fialing on local user profiles for ex  \n18:31\u00a0<@sdumitriu>\u00a0We could force the migration in the core  \n18:32\u00a0<@sdumitriu>\u00a0Using a migrator  \n18:32\u00a0<@sdumitriu>\u00a0It's not bulletproof, since some user profiles fields might get broken  \n18:32\u00a0<@sdumitriu>\u00a0WDYT?  \n18:32\u00a0<@sdumitriu>\u00a0Is it safe to attempt automatic syntax conversion?  \n18:34\u00a0<@sdumitriu>\u00a0vmassol: I've thought more about it, and there are two problems:  \n18:34\u00a0<@sdumitriu>\u00a01. the fact that the email field is using a {{velocity}} custom displayer, even though the sheet is still in the 1.0 syntax  \n18:34\u00a0<vmassol>\u00a0and no automatic syntax onversion is not safe  \n18:34\u00a0<@sdumitriu>\u00a02. the fact that existing user profiles are in the 1.0 syntax  \n18:34\u00a0<@sdumitriu>\u00a0For 2 it isn't safe to attempt to automatically fix that  \n18:35\u00a0<@sdumitriu>\u00a0So I'd like to propose changing that error message  \n18:35\u00a0<@sdumitriu>\u00a0Instead of \"try firefox\", we should say something like:  \n18:37\u00a0<@sdumitriu>\u00a0\"This document is using the deprecated xwiki/1.0 syntax, which doesn't provide a WYSIWYG editor compatible with your browser. We recommend updating to the default xwiki/2.1 syntax. This can be done automatically, however the conversion isn't 100% accurate, so a manual check of the content and data fields is recommended. Would you like to proceed with the automatic conversion? [OK] [Cancel]\"  \n18:38\u00a0<@sdumitriu>\u00a0We could even make this message appear all the time, not just in non-IE/FF  \n18:38\u00a0<@sdumitriu>\u00a0An active push to make users migrate to the new syntax  \n18:38\u00a0<@sdumitriu>\u00a0The problem is that non-technical users might be scared by this message...  \n18:39\u00a0<@sdumitriu>\u00a0For 1, the blame rests on who added that custom displayer in the class and didn't check the current class document syntax  \n18:39\u00a0<vmassol>\u00a0so 1 is easy to fix by changing the custom displayer code?  \n18:40\u00a0<@sdumitriu>\u00a0A quick fix would be to add an extra branch in the class updater code and only wrap with {{velocity}} if the syntax is not 1.0  \n18:40\u00a0<vmassol>\u00a0(so that it supports 1.0)  \n18:40\u00a0<@sdumitriu>\u00a0Not sure if there's anything else to change in the code, I think not but better check  \n18:40\u00a0<vmassol>\u00a0ok we need to check who's done that so that he fixes this asap for 4.1.3  \n18:40\u00a0<@sdumitriu>\u00a0Hm, it also uses a {{html}} inside in edit mode  \n18:41\u00a0<@sdumitriu>\u00a0To wrap the input  \n18:44\u00a0<vmassol>\u00a0re 1 XWikiUsers can be easily converted to 2.0 or 2.1 syntax since it's not supposed to contain content  \n18:45\u00a0<vmassol>\u00a0it's more a general question of how we want to handle this use case  \n18:45\u00a0<vmassol>\u00a0if we do content migrators where do we put them, etc  \n18:49\u00a0<@sdumitriu>\u00a0Well, I'm not sure it can be migrated  \n18:50\u00a0<@sdumitriu>\u00a0There might be other fields with custom displayers that are written in the 1.0 syntax  \n18:50\u00a0<@sdumitriu>\u00a0And migrating will make those fail  \n18:51\u00a0<vmassol>\u00a0there are 2 things to do: 1/ Fix this for 4.1.3 quickly and 2/ longer term: maybe start thinking about a Syntax Center in the admin to find all documents in a given syntax and perform conversions, etc  \n18:55\u00a0<@sdumitriu>\u00a0Enygma`: You did 68017501  \n18:57\u00a0<@sdumitriu>\u00a0https://github.com/xwiki/xwiki-platform/commit/68017501#diff-1  \n19:01\u00a0<abusenius>\u00a0has joined #xwiki  \n19:03\u00a0<gdelhumeau>\u00a0has quit  \n19:06\u00a0<evalica>\u00a0has quit  \n19:12\u00a0<polx>\u00a0has quit  \n19:13\u00a0<+Enygma`>\u00a0sdumitriu, vmassol: yep, I did that for the user profile customization feature. (Just read the conversation)  \n19:14\u00a0<+Enygma`>\u00a0sorry for the inconvenience... nobody noticed it at the pull request review.  \n19:15\u00a0<+Enygma`>\u00a0AFAIU from the discussion above, the proposed solution is to check the current document syntax of XWiki.XWikiUsers and to make sure the custom displayer is compatible.  \n19:16\u00a0<+Enygma`>\u00a0though the problem will be the same when the XWikiUsers page gets converted to 2.x syntax  \n19:16\u00a0<@sdumitriu>\u00a0Enygma`: Yes  \n19:16\u00a0<+Enygma`>\u00a0so does it make sense to apply such a \"fix\"?  \n19:16\u00a0<@sdumitriu>\u00a0Yes  \n19:17\u00a0<@sdumitriu>\u00a0Currently it is wrong, since the displayer code should be in the same syntax as the class  \n19:17\u00a0<@sdumitriu>\u00a0We'll see what we do with the migration when we'll attempt that  \n19:18\u00a0<+Enygma`>\u00a0ok then. Anyway, I did not know about the mechanism (same syntax as the class) so I will fix it to respect this logic.  \n19:19\u00a0<+Enygma`>\u00a0will take care of it tomorrow  \n19:19\u00a0<@sdumitriu>\u00a0Well, the mechanism wasn't valid at that time  \n19:19\u00a0<@sdumitriu>\u00a0But it was a bug, since the same property can be displayed in different documents of different syntaxes  \n19:19\u00a0<@sdumitriu>\u00a0The only thing constant is the class and the displayer  \n19:20\u00a0<vmassol>\u00a0sdumitriu: note that on the Preferences tab I had the same issue for the timezone  \n19:20\u00a0<vmassol>\u00a0do we have a custom displayer for that too?  \n19:20\u00a0<vmassol>\u00a0(jvdrean)  \n19:20\u00a0<@sdumitriu>\u00a0vmassol: Yes  \n19:20\u00a0<@sdumitriu>\u00a0http://myxwiki.org/xwiki/bin/edit/XWiki/XWikiUsers?editor=class  \n19:20\u00a0<@sdumitriu>\u00a0Again with a {{velocity}} wrapper  \n19:20\u00a0<vmassol>\u00a0so we need to fix this too  \n19:22\u00a0<@sdumitriu>\u00a0Looked at all the field, those are the only two with a custom displayer  \n19:31\u00a0<tmortagne>\u00a0has quit  \n19:54\u00a0<Denis>\u00a0has joined #xwiki  \n20:27\u00a0<CIA-114>\u00a0Marius Dumitru Florea\u000f master\u000f \\* r5823153\u000f https://github.com/xwiki/xwiki-platform/commit/5823153b80aadf49c756a47904d45ea5e22f56a4 \u000f/ xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/doc/XWikiDocument.java :\u000f XWIKI-8027: XWikiDocument#restoreContext doesn't restore properly the script context - http://git.io/98rjQw  \n21:06\u00a0<Enygma`>\u00a0has quit  \n21:17\u00a0<vmassol>\u00a0has quit  \n21:18\u00a0<evalica>\u00a0has joined #xwiki  \n21:25\u00a0<mflorea>\u00a0has quit  \n21:39\u00a0<mflorea>\u00a0has joined #xwiki  \n22:04\u00a0<jvelo>\u00a0has joined #xwiki  \n22:39\u00a0<abusenius>\u00a0has quit  \n22:40\u00a0<polx>\u00a0has joined #xwiki  \n22:42\u00a0<evalica>\u00a0has quit  \n23:28\u00a0<mflorea>\u00a0has quit  \n23:32\u00a0<jvelo>\u00a0has quit  \n\n"}