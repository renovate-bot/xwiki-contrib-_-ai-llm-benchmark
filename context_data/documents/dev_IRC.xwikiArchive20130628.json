{"id": "dev:IRC.xwikiArchive20130628", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20130628", "title": "IRC Archive for channel #xwiki on 28 June 2013 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<sdumitriu1>\u00a0has quit  \n00:52\u00a0<sburjan`>\u00a0has quit  \n00:53\u00a0<sburjan`>\u00a0has joined #xwiki  \n04:30\u00a0<Denis1>\u00a0has joined #xwiki  \n05:51\u00a0<Denis1>\u00a0has quit  \n07:35\u00a0<mflorea>\u00a0has joined #xwiki  \n07:50\u00a0<vmassol>\u00a0has joined #xwiki  \n07:52\u00a0<abusenius>\u00a0has joined #xwiki  \n07:53\u00a0<evalica>\u00a0has joined #xwiki  \n08:09\u00a0<tmortagne>\u00a0has joined #xwiki  \n08:32\u00a0<abusenius>\u00a0has quit  \n09:10\u00a0<sburjan>\u00a0has joined #xwiki  \n09:30\u00a0<msmeria>\u00a0has joined #xwiki  \n09:56\u00a0<GuillaumeF>\u00a0has joined #xwiki  \n10:31\u00a0<sburjan>\u00a0tmortagne: unfortunately, the SOLR is same even with you commit from yesterday :(  \n10:31\u00a0<tmortagne>\u00a0sburjan: did you modified the properties in xwiki.properties as I suggested you ?  \n10:31\u00a0<sburjan>\u00a0no, let me try that  \n10:32\u00a0<tmortagne>\u00a0try to put higher values in there  \n10:33\u00a0<tmortagne>\u00a0for example 400 instead of 50 for solr.indexer.batch.size  \n10:33\u00a0<tmortagne>\u00a0and a higher solr.indexer.batch.maxLength  \n10:34\u00a0<tmortagne>\u00a0you see the queue size lowering slowly 1 by 1 it the bad guys is you database  \n10:34\u00a0<tmortagne>\u00a0\\*it means  \n10:34\u00a0<sburjan>\u00a0tmortagne: I can't find that config key in xwiki.properties  \n10:35\u00a0<tmortagne>\u00a0that means you don't have the last snapshot  \n10:35\u00a0<tmortagne>\u00a0but that's probably because of jenkins  \n10:35\u00a0<sburjan>\u00a0I'm on RC1  \n10:35\u00a0<tmortagne>\u00a0its not in RC1  \n10:35\u00a0<sburjan>\u00a0ah ok  \n10:35\u00a0<tmortagne>\u00a0anyway those properties still exist even if they are not listed  \n10:36\u00a0<tmortagne>\u00a0looks at https://github.com/xwiki/xwiki-platform/blob/master/xwiki-platform-tools/xwiki-platform-tool-configuration-resources/src/main/resources/xwiki.properties.vm  \n10:36\u00a0<sburjan>\u00a0I don't think that the latest 5.2 snapshot contains your commit  \n10:36\u00a0<tmortagne>\u00a0don't worry about my commit  \n10:36\u00a0<tmortagne>\u00a0the properties exist since a long time in the code  \n10:37\u00a0<sburjan>\u00a0ok, so I can put these in my RC1 and they will work ?  \n10:37\u00a0<tmortagne>\u00a0my commit just changed the default  \n10:37\u00a0<tmortagne>\u00a0allocate a lot of memory to your jvm and put very high values for those two properties in your xwiki.properties file  \n10:38\u00a0<tmortagne>\u00a0something like  \n10:38\u00a0<tmortagne>\u00a0solr.indexer.batch.maxLength=10000000  \n10:38\u00a0<tmortagne>\u00a0that should make the solr module send the entire database in one raw to the Solr server  \n10:39\u00a0<tmortagne>\u00a0at least that way you will see if the slow one is the database or Solr  \n10:39\u00a0<sburjan>\u00a0Ok. allocating 2 GB for my instance and starting up  \n10:39\u00a0<Denis1>\u00a0has joined #xwiki  \n10:41\u00a0<sburjan>\u00a0tmortagne: it worked like a charm :) Indexed in 10 seconds :)  \n10:41\u00a0<sburjan>\u00a0I can search for everything now :)  \n10:42\u00a0<sburjan>\u00a0but searching for \\*:\\* returns 13 results  \n10:42\u00a0<sburjan>\u00a0but now $services.solr.getQueueSize() is 0 !  \n10:42\u00a0<tmortagne>\u00a0sburjan: did not make sure you have access to hidden documents ?  \n10:43\u00a0<sburjan>\u00a0tmortagne: ok, now I get 331 :)  \n10:43\u00a0<tmortagne>\u00a0\\*:\\* does not return you hidden document if you are not supposed to see hidden documents  \n10:44\u00a0<sburjan>\u00a0so 331 is ok for a jetty+hsqldb XE ?  \n10:44\u00a0<sburjan>\u00a0afaik the XAR has more than 331 docs, but I might be wrong  \n10:44\u00a0<tmortagne>\u00a0no idea  \n10:44\u00a0<tdelafosse>\u00a0has joined #xwiki  \n10:44\u00a0<vmassol>\u00a0sburjan: just go to alldocs  \n10:45\u00a0<vmassol>\u00a0you'll have the number  \n10:45\u00a0<sburjan>\u00a0indeed, it's the same number. so search resturns all pages  \n10:45\u00a0<sburjan>\u00a0thanks for the tip vmassol \u00a0:)  \n10:45\u00a0<sburjan>\u00a0ok, so how can we narrow down the slowness thing. Could we maybe increase the default values ? :)  \n10:45\u00a0<tmortagne>\u00a0sburjan: again I did incresed them in my latest commit  \n10:46\u00a0<tmortagne>\u00a0which is why I told you to restest  \n10:46\u00a0<tmortagne>\u00a0it was almost sent 1 by 1 before  \n10:46\u00a0<sburjan>\u00a0ah ok  \n10:46\u00a0<sburjan>\u00a0it means now it must be instant on your and vmassol's computer :)  \n10:47\u00a0<tmortagne>\u00a0which means that for some reason sending data to Solr not matter how many datas there is is pretty sol in your case  \n10:47\u00a0<sburjan>\u00a0yes, seems a disk issue, not a CPU issue on my side  \n10:48\u00a0<sburjan>\u00a0because indexing should eat a lot of CPU, but my CPU seems fine with your values from above  \n10:48\u00a0<tmortagne>\u00a0still I'm supprised that you can load 331 document in 10 secondes  \n10:48\u00a0<tmortagne>\u00a0probably because of hsqldb which load everything in memory  \n10:48\u00a0<tmortagne>\u00a0I always test in mysql  \n10:49\u00a0<sburjan>\u00a0and my coolers are noisy like a NASA spacecraft taking off  \n10:49\u00a0<sburjan>\u00a0for 10 seconds :)  \n10:49\u00a0<vmassol>\u00a0notice: for some reason ci fails to restart, I'm going to restart it by hand  \n10:49\u00a0<tmortagne>\u00a0maybe it's simply a bug in Solr hopefully fixed in more recent versions  \n10:50\u00a0<tmortagne>\u00a0(which we can't upgrade because of restlet yet)  \n10:50\u00a0<sburjan>\u00a0tmortagne: now I am going to try with the values from your commit (the new default values)  \n10:50\u00a0<sburjan>\u00a0# solr.indexer.batch.size=50  \n10:51\u00a0<sburjan>\u00a0# solr.indexer.batch.maxLength=10000  \n10:51\u00a0<tmortagne>\u00a0sburjan: you will have an issue with that since the main issue was that solr.indexer.batch.maxLength was getting the value from solr.indexer.batch.size  \n10:51\u00a0<tmortagne>\u00a0I did not really changed the values, I fixed solr.indexer.batch.maxLength  \n10:51\u00a0<sburjan>\u00a0ah.. ok  \n10:51\u00a0<sburjan>\u00a0so my problem won't be fixed by your commit  \n10:51\u00a0<tmortagne>\u00a0you can try the last 5.1-SNAPSHOT which seems ok on jenkins  \n10:52\u00a0<tmortagne>\u00a0why ?  \n10:52\u00a0<sburjan>\u00a0ok  \n10:52\u00a0<Denis1>\u00a0is now known as <Denis>  \n10:52\u00a0<tmortagne>\u00a0again before my commit you had 50 assigned to solr.indexer.batch.maxLength  \n10:52\u00a0<tmortagne>\u00a0which means that it was sending data when reaching 50 characters...  \n10:53\u00a0<sburjan>\u00a0and now I have 10000  \n10:53\u00a0<tmortagne>\u00a0I doubt there is any document with less than 50 characters in its datas  \n10:53\u00a0<tmortagne>\u00a0in last snaoshot you will have 10000  \n10:53\u00a0<tmortagne>\u00a0which is a lot better  \n10:54\u00a0<sburjan>\u00a0nope, I already have yesterday's 5.1-SNAPSHOT. It's from yesterday morning  \n10:54\u00a0<tmortagne>\u00a0sburjan: if you don't have the propertis in xwiki.properties then it's too old  \n10:55\u00a0<sburjan>\u00a0nope, I don't have the new properties  \n10:55\u00a0<tmortagne>\u00a0so you don't have the last version  \n10:56\u00a0<sburjan>\u00a0my version is the latest from http://maven.xwiki.org/snapshots/org/xwiki/enterprise/xwiki-enterprise-jetty-hsqldb/5.1-SNAPSHOT/  \n11:02\u00a0<tmortagne>\u00a0sburjan: then jenkins did not built the last version  \n11:11\u00a0<msmeria>\u00a0has quit  \n11:15\u00a0<msmeria>\u00a0has joined #xwiki  \n11:18\u00a0<msmeria>\u00a0has quit  \n11:26\u00a0<tmortagne>\u00a0has quit  \n11:29\u00a0<tmortagne>\u00a0has joined #xwiki  \n11:37\u00a0<mflorea>\u00a0vmassol: can you help me again with twitter announcement? the automated script is still not working. URL: http://purl.org/xwiki/rn/51RC1  \n11:46\u00a0<vmassol>\u00a0mflorea: yep doing it  \n11:46\u00a0<mflorea>\u00a0thanks  \n11:47\u00a0<vmassol>\u00a0done  \n11:57\u00a0<mflorea>\u00a0vmassol, tmortagne: packager integration tests (and platform build) fail because of this http://pastebin.com/VaU6Rvij . I;ve seen \"Domain already registered org.infinispan\" in the past. Is it because there are multiple instances of XWiki loaded in the same servlet container?  \n11:58\u00a0<tmortagne>\u00a0that's what \"Domain already registered org.infinispan\" is supposed to mean but that could be a bug of infinispan 5.3...  \n11:58\u00a0<mflorea>\u00a0the build fails locally too, so it's not a CI issue  \n12:01\u00a0<tmortagne>\u00a0according to the stack trace it's really when initializing the cache manager so indeed to seems to be several instances issue but I don't see why now  \n12:02\u00a0<tmortagne>\u00a0hmm wait  \n12:02\u00a0<tmortagne>\u00a0this is not the right domain  \n12:03\u00a0<mflorea>\u00a0so maybe the domain is not configured  \n12:03\u00a0<tmortagne>\u00a0xwiki is supposed to use org.xwiki.infinispan  \n12:03\u00a0<tmortagne>\u00a0it is  \n12:03\u00a0<tmortagne>\u00a0but it looks like the configuration file is not taken into account  \n12:04\u00a0<tmortagne>\u00a0but I have a unit test that is supposed to check that, looking  \n12:08\u00a0<vmassol>\u00a0fyi I'm configuring the commons quality job to send data to a sonar server, this is why it's failing, I'll disable email for now till I get it to work fine  \n12:36\u00a0<tmortagne>\u00a0crap I think I found a bug in Infinispan JMX management, again...  \n12:37\u00a0<msmeria>\u00a0has joined #xwiki  \n12:41\u00a0<tmortagne>\u00a0hmm no just unreadable code  \n12:51\u00a0<tmortagne>\u00a0mflorea: actually there is no conf in the context of the packager  \n12:52\u00a0<tmortagne>\u00a0so according to the error there is something using infinispan other than XWiki and initialized before XWiki  \n12:52\u00a0<tmortagne>\u00a0(or XWiki is using two difference componentmanager wit two difference cache factries)  \n12:53\u00a0<mflorea>\u00a0strange  \n12:59\u00a0<sburjan>\u00a0any idea when we'll have a new snapshot for 5.1 ?  \n13:08\u00a0<tmortagne>\u00a0mflorea: I have to go in about 10 minutes and won't be available this afternoon, I can't at this before Monday but what is sure is that infinispan is initialized twice and the second time is from XWiki cache factory so we need to find what is initializing it the first time (can be another tool using infinispan, or for some reason the packager cause the cache component to be initialized twice)  \n13:08\u00a0<mflorea>\u00a0tmortagne: ok, I try to look at it later  \n13:08\u00a0<tmortagne>\u00a0a pity Infinispan is such a pain with JMX  \n13:08\u00a0<tmortagne>\u00a0they just simply log a warning  \n13:09\u00a0<tmortagne>\u00a0we don't care it's not regsitered on JMX server...  \n13:09\u00a0<tmortagne>\u00a0s/they just/they could just/  \n13:10\u00a0<tmortagne>\u00a0it not even about infinispan init, just that JMX can have only one instance for each domain  \n13:16\u00a0<tmortagne>\u00a0has quit  \n13:27\u00a0<tmortagne>\u00a0has joined #xwiki  \n13:28\u00a0<tmortagne>\u00a0mflorea: an idea: the packager plugin does not seems to dispose/clean anything so the issue might simply be that it initialize XWiki several times without disposing it in the same build  \n13:28\u00a0<tmortagne>\u00a0and now I really go before I get hit ;)  \n13:29\u00a0<mflorea>\u00a0:)  \n13:29\u00a0<mflorea>\u00a0thanks for the hint  \n13:29\u00a0<tmortagne>\u00a0has quit  \n13:32\u00a0<vmassol>\u00a0we have several tests that take too long to execute: http://sonar.xwiki.org/drilldown/measures/1?metric=test\\_execution\\_time  \n13:41\u00a0<mflorea>\u00a0has quit  \n13:54\u00a0<tekzilla\\_>\u00a0are the debian packages (using tomcat 6) considered stable ? the setup wizard seems very flaky to me  \n14:05\u00a0<tekzilla\\_>\u00a0is now known as <tekzilla>  \n14:15\u00a0<tekzilla>\u00a0and why dont you package the mysql connector ? there are 130mb of libs, but if i want to switch to mysql i have to search for this 700kb jar ?  \n14:17\u00a0<tekzilla>\u00a0(this was concering the standalone jetty version)  \n14:17\u00a0<tekzilla>\u00a0sorry if this is just a pointless rant..  \n14:19\u00a0<vmassol>\u00a0tekzilla: actually we have various distributions but I think it's a good idea to have only one indeed  \n14:42\u00a0<mflorea>\u00a0has joined #xwiki  \n14:43\u00a0<chalx>\u00a0has joined #xwiki  \n15:29\u00a0<mflorea>\u00a0vmassol: how do you create a release notes page for a new version on xwiki.org? There's no form and I can't find the template..  \n15:29\u00a0<vmassol>\u00a0mflorea: you need to be in the RelaseNotes space  \n15:29\u00a0<vmassol>\u00a0then using Add>Page  \n15:29\u00a0<mflorea>\u00a0ah..  \n15:29\u00a0<mflorea>\u00a0thanks  \n16:23\u00a0<msmeria>\u00a0has quit  \n16:36\u00a0<chalx>\u00a0has quit  \n16:49\u00a0<sburjan>\u00a0has quit  \n17:34\u00a0<vmassol>\u00a0sburjan`: so the solr indexing is fast after all for your right?  \n17:37\u00a0<sburjan`>\u00a0vmassol: I still have to test monday on a new snapshot. But from what I discussed today with Thomas and after doing what he told me to do, I worked fast  \n17:37\u00a0<sburjan`>\u00a0but I didn't use the default settings, I used higher ones  \n17:37\u00a0<sburjan`>\u00a0I'll tell you exactly on monday  \n17:37\u00a0<sburjan`>\u00a0in the meantime I tested on other computers, a MAC and a server, and those were faster (still not as fast as yours :))  \n17:57\u00a0<evalica>\u00a0has quit  \n18:19\u00a0<vmassol>\u00a0yeah I got IT coverage on sonar : http://sonar.xwiki.org/dashboard/index/1 :)  \n18:19\u00a0<vmassol>\u00a0(and overall coverage UT + IT)  \n18:19\u00a0<sburjan`>\u00a0cool !  \n18:19\u00a0<vmassol>\u00a0(so 67.4% on commons)  \n18:27\u00a0<GuillaumeF>\u00a0has quit  \n18:29\u00a0<mflorea>\u00a0has quit  \n18:43\u00a0<Denis>\u00a0has quit  \n18:50\u00a0<vmassol>\u00a0and 74.9% for rendering: http://sonar.xwiki.org/dashboard/index/915  \n19:08\u00a0<tdelafosse>\u00a0has quit  \n19:19\u00a0<sdumitriu1>\u00a0has joined #xwiki  \n19:35\u00a0<abusenius>\u00a0has joined #xwiki  \n19:47\u00a0<sdumitriu>\u00a0has quit  \n19:48\u00a0<sdumitriu>\u00a0has joined #xwiki  \n20:47\u00a0<jbwiv>\u00a0has joined #xwiki  \n20:48\u00a0<jbwiv>\u00a0guys, in our install, if I'm in the wysiwyg editor and I click LInk -> Wiki Page, under the \"My recent changes\" tab I see \"There was an error loading the data\" for all of our users. it renders the wiki unusable. Any idea why this would happen?  \n20:49\u00a0<altker128>\u00a0has joined #xwiki  \n20:50\u00a0<jbwiv>\u00a0and when I click the \"All pages\" tab, I get \"Server returned TRANSPORT\\_ERROR with no error message.\"  \n20:50\u00a0<altker128>\u00a0Hi all. \u00a0Is there any reason in xwiki if I edit a page using 'source' that the page should get 'garbled'? \u00a0If I edit an existing page using Source tab and hit 'Save and View' the page gets very screwed up (I can pastbin example)  \n20:51\u00a0<sdumitriu1>\u00a0has left #xwiki  \n20:52\u00a0<altker128>\u00a0Let me be more clear  \n20:53\u00a0<altker128>\u00a0if I change from WYSIWYG to Source, and do Save&View things are garbled. \u00a0If I edit in Source and click back on WYSIWYG , things look normal.  \n20:59\u00a0<xwikibot>\u00a0has joined #xwiki  \n21:37\u00a0<altker128>\u00a0has quit  \n22:18\u00a0<jbwiv>\u00a0has quit  \n22:29\u00a0<sdumitriu1>\u00a0has joined #xwiki  \n23:08\u00a0<sdumitriu1>\u00a0has quit  \n23:19\u00a0<vmassol>\u00a0has quit\n"}