{"id": "dev:IRC.xwikiArchive20131230", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20131230", "title": "IRC Archive for channel #xwiki on 30 December 2013 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<vmassol>\u00a0has joined #xwiki  \n00:18\u00a0<vmassol>\u00a0has quit  \n01:15\u00a0<vmassol>\u00a0has joined #xwiki  \n01:19\u00a0<vmassol>\u00a0has quit  \n02:15\u00a0<vmassol>\u00a0has joined #xwiki  \n02:20\u00a0<vmassol>\u00a0has quit  \n03:16\u00a0<vmassol>\u00a0has joined #xwiki  \n03:21\u00a0<vmassol>\u00a0has quit  \n03:22\u00a0<UCC>\u00a0has quit  \n04:17\u00a0<vmassol>\u00a0has joined #xwiki  \n04:22\u00a0<vmassol>\u00a0has quit  \n05:18\u00a0<vmassol>\u00a0has joined #xwiki  \n05:22\u00a0<vmassol>\u00a0has quit  \n06:19\u00a0<vmassol>\u00a0has joined #xwiki  \n06:23\u00a0<vmassol>\u00a0has quit  \n07:19\u00a0<vmassol>\u00a0has joined #xwiki  \n07:24\u00a0<vmassol>\u00a0has quit  \n08:20\u00a0<vmassol>\u00a0has joined #xwiki  \n08:25\u00a0<vmassol>\u00a0has quit  \n08:53\u00a0<vmassol>\u00a0has joined #xwiki  \n08:55\u00a0<vmassol1>\u00a0has joined #xwiki  \n08:55\u00a0<vmassol>\u00a0has quit  \n08:58\u00a0<tmortagne>\u00a0has joined #xwiki  \n09:11\u00a0<KermitTheFragger>\u00a0has joined #xwiki  \n09:15\u00a0<vmassol1>\u00a0good morning  \n09:15\u00a0<vmassol1>\u00a0is now known as <vmassol>  \n09:15\u00a0<vmassol>\u00a0back from holidays tmortagne? Hope you had a good time!  \n09:16\u00a0<tmortagne>\u00a0vmassol: yes back, great time, eating too much all that :)  \n09:16\u00a0<tmortagne>\u00a0hope it was good for you too  \n09:16\u00a0<vmassol>\u00a0yeah that's normal ;)  \n09:16\u00a0<vmassol>\u00a0(the eating)  \n09:17\u00a0<vmassol>\u00a0yes good for me too, not too much computer  \n09:24\u00a0<vmassol>\u00a0tmortagne: before going on holidays I noticed an issue with DW/EM. I sent a mail, did you see it?  \n09:25\u00a0<tmortagne>\u00a0vmassol: yes I seen you mail but no idea what it means, it's the first time I see errors like this  \n09:25\u00a0<tmortagne>\u00a0will need to reproduce  \n09:25\u00a0<vmassol>\u00a0ok, I think it's easy to reproduce  \n09:29\u00a0<vmassol>\u00a0regarding http://ci.xwiki.org/job/xwiki-enterprise-test-extension/ I think GD probably made a UI change and forgot to update the tests  \n09:30\u00a0<vmassol>\u00a0changing \"xwiki\" to \"Home\"  \n09:31\u00a0<vmassol>\u00a0hmm not sure, that doesn't look like UI  \n09:31\u00a0<vmassol>\u00a0seems to be coming from:  \n09:31\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Assert.assertEquals(\"Resolving extension [alice-xar-extension 2.1.4] on namespace [xwiki]\", log.get(2)  \n09:32\u00a0<vmassol>\u00a0so someone changed \"xwiki\" to \"Home\" in these messages?  \n09:33\u00a0<tmortagne>\u00a0namespace \"xwiki\" does not make any sense  \n09:33\u00a0<tmortagne>\u00a0should be \"wiki:xwiki\" at least  \n09:34\u00a0<tmortagne>\u00a0ha I know  \n09:34\u00a0<tmortagne>\u00a0it's how the UI renders it  \n09:35\u00a0<tmortagne>\u00a0it's not the actual namespace  \n09:35\u00a0<tmortagne>\u00a0and the UI render the wiki pretty name probably  \n09:35\u00a0<tmortagne>\u00a0so what changed is that GD added a descriptor for the main wiki  \n09:36\u00a0<vmassol>\u00a0ok  \n09:36\u00a0<vmassol>\u00a0so we just need to update the test?  \n09:36\u00a0<vmassol>\u00a0I can do that  \n09:36\u00a0<tmortagne>\u00a0probably yes, if the pretty name of the main wiki in th descriptor is \"Home\"  \n09:38\u00a0<vmassol>\u00a0just checked and it is \"Home\" indeed  \n09:39\u00a0<vmassol>\u00a0fixing  \n09:42\u00a0<j-simard>\u00a0has joined #xwiki  \n09:43\u00a0<lucaa>\u00a0has quit  \n09:44\u00a0<vmassol>\u00a0hmm I don't understand testPUTGETTranslation() in PageResourceTest  \n09:44\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0String[] languages = Locale.getISOLanguages();  \n09:44\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0final String languageId = languages[random.nextInt(languages.length)];  \n09:45\u00a0<vmassol>\u00a0we're picking an ISO language at random  \n09:45\u00a0<vmassol>\u00a0ok I see, we're not checking for a translation  \n09:45\u00a0<vmassol>\u00a0we're just expecting a result whatever the language  \n09:46\u00a0<vmassol>\u00a0which should be the default content I guess  \n09:46\u00a0<vmassol>\u00a0seems we're returning 404 instead of 200, checking code  \n09:46\u00a0<vmassol>\u00a0http://ci.xwiki.org/job/xwiki-enterprise-test-rest/org.xwiki.enterprise$xwiki-enterprise-test-rest/2955/testReport/junit/org.xwiki.test.rest/PageResourceTest/testPUTGETTranslation/  \n09:48\u00a0<vmassol>\u00a0we're pushing a content and getting it, ok got it  \n09:49\u00a0<vmassol>\u00a0so the put failed probably but there was no error message  \n09:51\u00a0<vmassol>\u00a0hmm no, we check for the response code for PUT  \n09:53\u00a0<vmassol>\u00a0interesting thing is that it failed on 2 branches, so must be easy to reproduce. Trying locally  \n09:54\u00a0<vmassol>\u00a0other error from GD: http://ci.xwiki.org/job/xwiki-enterprise-test-webstandards/org.xwiki.enterprise$xwiki-enterprise-test-webstandards/2961/testReport/junit/org.xwiki.test.webstandards.framework/DefaultValidationTest/Validating\\_XHTML\\_validity\\_for\\_\\_space\\_XWiki\\_\\_page\\_XWikiServerXwiki\\_executed\\_with\\_credentials\\_Admin\\_admin/  \n10:16\u00a0<lucaa>\u00a0has joined #xwiki  \n10:25\u00a0<lucaa>\u00a0has quit  \n10:25\u00a0<lucaa>\u00a0has joined #xwiki  \n10:32\u00a0<vmassol>\u00a0tmortagne: actually the message is a bit wrong. We're using a pretty name for the wiki but the message is quite technical with the mention of \"namespace\" instead of \"wiki\". So it looks a bit strange, uneven  \n10:33\u00a0<vmassol>\u00a0Ideally we should say something like: The extension XXX was installed in the wiki YYY where XXX and YYY are pretty names  \n10:33\u00a0<tmortagne>\u00a0vmassol: it's not the real log, it's how the UI transform it  \n10:33\u00a0<tmortagne>\u00a0at the level where this log is generated the code only know about namespaces  \n10:33\u00a0<tmortagne>\u00a0not wikis  \n10:36\u00a0<vmassol>\u00a0sure but then the problem is that the message sgould be provided by the caller  \n10:36\u00a0<vmassol>\u00a0as it does for the pretty name  \n10:36\u00a0<vmassol>\u00a0the code also doesn't know the notion of wiki pretty nale  \n10:37\u00a0<vmassol>\u00a0\\*name  \n10:37\u00a0<vmassol>\u00a0but it still displays it  \n10:37\u00a0<vmassol>\u00a0all I'm saying is that it's not normal to have printed at the same time: \"namespace\" and wiki pretty name  \n10:37\u00a0<vmassol>\u00a0namespace is technical while pretty name isn't  \n10:38\u00a0<vmassol>\u00a0(tmortagne)  \n10:38\u00a0<tmortagne>\u00a0the UI tranform only log parameters bu I don't know exacly how it find that a parameter is a wiki  \n10:38\u00a0<tmortagne>\u00a0it's not just printed, it's supposed to be a link  \n10:39\u00a0<tmortagne>\u00a0mflorea did that to provide as much links as possible in the log  \n10:39\u00a0<vmassol>\u00a0sure and that's good  \n10:39\u00a0<tmortagne>\u00a0now what the link label is is a different issue  \n10:40\u00a0<vmassol>\u00a0the problem is that this should be done not just for parameters  \n10:40\u00a0<vmassol>\u00a0but for the whole logs  \n10:40\u00a0<vmassol>\u00a0which needs to be user-friendly  \n10:40\u00a0<vmassol>\u00a0and displaying same level of information  \n10:40\u00a0<vmassol>\u00a0I don't know how to do it, just mentioning the issue :)  \n10:41\u00a0<vmassol>\u00a0seems we ahve some SOLR issues too: http://ci.xwiki.org/job/xwiki-enterprise-test-rest/2955/consoleFull (search for Exception)  \n10:42\u00a0<vmassol>\u00a0really strange  \n10:42\u00a0<vmassol>\u00a0DBCPConnectionProvider  \n10:43\u00a0<vmassol>\u00a0so using DS  \n10:43\u00a0<vmassol>\u00a0which seems to be null  \n10:43\u00a0<vmassol>\u00a0ah maybe it's on shutdown  \n10:44\u00a0<vmassol>\u00a0and DBCP has released everything already  \n10:44\u00a0<vmassol>\u00a0so it seems SOLR is not stopping quickly enough  \n10:48\u00a0<vmassol>\u00a0seems the queue isn't emptied on shutdown  \n10:48\u00a0<vmassol>\u00a0\\*indexing queue  \n10:51\u00a0<vmassol>\u00a0ok I can reproduce the REST issue, debugging now  \n11:14\u00a0<vmassol>\u00a0actually the test is probably a bit wrong since the wiki is not multilingual\u2026  \n11:22\u00a0<vmassol>\u00a0tmortagne: so I know the problem  \n11:22\u00a0<vmassol>\u00a0LocaleUtils.toLocale(\"he\") returns a locale \"iw\" and when you call locale.tostring() on it you get \"iw\" and not \"he\"  \n11:24\u00a0<tmortagne>\u00a0vmassol: no luck he/iw is one of the \"funny\" few locales that changed at some point  \n11:24\u00a0<tmortagne>\u00a0and Java automatically renamed it to old id  \n11:25\u00a0<vmassol>\u00a0I remember something about this  \n11:25\u00a0<vmassol>\u00a0wasn't it Marius who changed something related to this?  \n11:25\u00a0<tmortagne>\u00a0I did not trick for it in SOLR if that's what you are refering  \n11:25\u00a0<vmassol>\u00a0this isn't SOLR  \n11:25\u00a0<vmassol>\u00a0it's REST tests  \n11:25\u00a0<tmortagne>\u00a0I know it's not SOLR  \n11:26\u00a0<vmassol>\u00a0so we have several choices  \n11:26\u00a0<vmassol>\u00a0we couldb't implement support for legacy locales  \n11:26\u00a0<vmassol>\u00a0\"Locale's constructor has always converted three language codes to their earlier, obsoleted forms: he maps to iw, yi maps to ji, and id maps to in.\"  \n11:26\u00a0<tmortagne>\u00a0I doubt it's important to test that locale in this test  \n11:26\u00a0<vmassol>\u00a0it's not just this test  \n11:26\u00a0<vmassol>\u00a0it'll cause problem whenever someone try to use these locales  \n11:26\u00a0<vmassol>\u00a0the test is correct  \n11:27\u00a0<vmassol>\u00a0so either we say we don't support them  \n11:27\u00a0<vmassol>\u00a0or we need to handle them  \n11:27\u00a0<tmortagne>\u00a0what I don't understand is why now, we use Locale since a while now  \n11:27\u00a0<vmassol>\u00a0it's not now  \n11:27\u00a0<tmortagne>\u00a0you mean this test fail since we use Locale internally ?  \n11:27\u00a0<vmassol>\u00a0here's an example of our code that fails with these deprecated locales:  \n11:28\u00a0<vmassol>\u00a0in XWikiResource.java  \n11:28\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0if (!language.equals(doc.getLanguage())) {  \n11:28\u00a0<vmassol>\u00a0this test will fail  \n11:28\u00a0<vmassol>\u00a0since \"he\" != \"iw\"  \n11:28\u00a0<vmassol>\u00a0but we could improve it easily  \n11:28\u00a0<vmassol>\u00a0by comparing Locales  \n11:28\u00a0<vmassol>\u00a0I'll do that  \n11:28\u00a0<vmassol>\u00a0seems easy enough  \n11:28\u00a0<vmassol>\u00a0wdyt?  \n11:29\u00a0<tmortagne>\u00a0using getLanguage() is wrong anyway  \n11:30\u00a0<tmortagne>\u00a0but again I don't see why this test fail now, is it a new test ?  \n11:33\u00a0<vmassol>\u00a0the test is random  \n11:33\u00a0<vmassol>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0String[] languages = Locale.getISOLanguages();  \n11:33\u00a0<vmassol>\u00a0so it'll work most of the time  \n11:33\u00a0<vmassol>\u00a0except when it uses one of the 3 deprecated languages  \n11:34\u00a0<tmortagne>\u00a0ok, I tough it was using a stable language  \n11:34\u00a0<tmortagne>\u00a0I don't really see the point of having it random  \n11:34\u00a0<vmassol>\u00a0so verify it works for all  \n11:34\u00a0<vmassol>\u00a0which isn't a bad thing  \n11:35\u00a0<tmortagne>\u00a0not really  \n11:35\u00a0<vmassol>\u00a0the proof is that we're now going to fix a bug thanks to it  \n11:35\u00a0<vmassol>\u00a0:)  \n11:35\u00a0<tmortagne>\u00a0random does not mean it will test everything  \n11:35\u00a0<tmortagne>\u00a0to test everything the test should... test everything  \n11:35\u00a0<vmassol>\u00a0and it's less time consuiming that testing \\*all\\* iso languages all the time  \n11:35\u00a0<vmassol>\u00a0that's very long tmortagne  \n11:35\u00a0<vmassol>\u00a0probably hour  \n11:37\u00a0<vmassol>\u00a0grr there's no getLocale() in Document\u2026.  \n11:37\u00a0<vmassol>\u00a0and XWikiResource uses Document instead of XWikiDocument....  \n11:37\u00a0<UCC>\u00a0has joined #xwiki  \n11:38\u00a0<vmassol>\u00a0I can do doc.getDocument() but that costs on PR check  \n11:39\u00a0<vmassol>\u00a0tmortagne: should I add a new Document.getLocale()?  \n11:39\u00a0<tmortagne>\u00a0vmassol: yes  \n11:40\u00a0<tmortagne>\u00a0we need to review public APIs about reference and locales  \n11:41\u00a0<vmassol>\u00a0I'll also deprecate getLanguage()  \n11:42\u00a0<vmassol>\u00a0from Velocity it should be ok  \n11:42\u00a0<vmassol>\u00a0do we have a converter for stinrg to Locale in xwiki-properties btw?  \n11:43\u00a0<tmortagne>\u00a0vmassol: you might get tons of warining if you depracte getLanguage()  \n11:43\u00a0<tmortagne>\u00a0s/warining/warnings/  \n11:43\u00a0<vmassol>\u00a0hmm good point  \n11:44\u00a0<tmortagne>\u00a0vmassol: you said it yourself, we have LocaleUtils.toLocale() ;)  \n11:44\u00a0<vmassol>\u00a0Velocity  \n11:44\u00a0<vmassol>\u00a0you cannot call that from Velocity  \n11:44\u00a0<vmassol>\u00a0but we probably have a converter  \n11:44\u00a0<vmassol>\u00a0(I hope)  \n11:44\u00a0<tmortagne>\u00a0if you meant an automatic converter for Velocity yes there is one  \n11:45\u00a0<tmortagne>\u00a0we are already taking Locale in localization script service  \n11:46\u00a0<vmassol>\u00a0ok cool  \n11:48\u00a0<tmortagne>\u00a0but I tough you were working ok REST resource  \n11:50\u00a0<vmassol>\u00a0I am  \n11:50\u00a0<vmassol>\u00a0just thinking about the consequences of deprecating getLanguages  \n11:50\u00a0<vmassol>\u00a0(in Document)  \n11:52\u00a0<tmortagne>\u00a0it's not really related to getLanguage() since this method return String, it does not take one  \n11:52\u00a0<tmortagne>\u00a0the issue is more with method taking String instead of Locale  \n11:52\u00a0<vmassol>\u00a0I know  \n11:52\u00a0<vmassol>\u00a0but if we start modifying public scripting API to take Locale  \n11:52\u00a0<vmassol>\u00a0we need to be able to create them easily from velocity  \n11:57\u00a0<UCC>\u00a0has quit  \n12:29\u00a0<vmassol>\u00a0weird: \"[INFO] Caused by: java.io.StreamCorruptedException: invalid type code: 5A\"  \n12:29\u00a0<vmassol>\u00a0\"java.lang.RuntimeException: Unexpected exception deserializing from disk cache\"  \n12:29\u00a0<vmassol>\u00a0http://ci.xwiki.org/job/xwiki-platform-5.3.x/40/consoleFull  \n12:29\u00a0<vmassol>\u00a0going to add it to our exception list for false positives, ok?  \n12:41\u00a0<UCC>\u00a0has joined #xwiki  \n12:55\u00a0<vmassol>\u00a0FTR I'm trying to debug http://ci.xwiki.org/job/xwiki-commons-site/  \n12:55\u00a0<vmassol>\u00a0the issue is https://issues.jenkins-ci.org/browse/JENKINS-15344  \n12:56\u00a0<vmassol>\u00a0I don't see the findbugs plugin being used though....  \n12:57\u00a0<vmassol>\u00a0seems it was fixed 11 days ago: https://github.com/jenkinsci/dom4j/pull/4  \n12:58\u00a0<vmassol>\u00a0so will need a while before a new dom4j version is released  \n12:59\u00a0<vmassol>\u00a0ah no this is a patched version used by jenkins  \n12:59\u00a0<vmassol>\u00a0(https://github.com/jenkinsci/dom4j)  \n12:59\u00a0<j-simard>\u00a0has quit  \n12:59\u00a0<j-simard>\u00a0has joined #xwiki  \n13:00\u00a0<vmassol>\u00a0not released yet I think: http://jenkins-ci.org/changelog  \n13:02\u00a0<vmassol>\u00a0anyway going to upgrade jenkins since it's relatively calm this week  \n13:05\u00a0<mrflibbl1>\u00a0has joined #xwiki  \n13:06\u00a0<mrflibble>\u00a0has quit  \n13:11\u00a0<j-simard>\u00a0has quit  \n13:13\u00a0<j-simard>\u00a0has joined #xwiki  \n13:36\u00a0<UCC>\u00a0has quit  \n13:46\u00a0<j-simard>\u00a0has quit  \n13:47\u00a0<j-simard>\u00a0has joined #xwiki  \n13:56\u00a0<polx>\u00a0has joined #xwiki  \n13:58\u00a0<cjd>\u00a0has joined #xwiki  \n13:58\u00a0<cjd>\u00a0is now known as <Guest99330>  \n14:20\u00a0<ekarlso>\u00a0has quit  \n14:24\u00a0<Guest99330>\u00a0has quit  \n14:26\u00a0<cjd\\_>\u00a0has joined #xwiki  \n14:34\u00a0<polx>\u00a0has quit  \n14:35\u00a0<polx>\u00a0has joined #xwiki  \n14:53\u00a0<polx>\u00a0has quit  \n14:55\u00a0<polx>\u00a0has joined #xwiki  \n15:29\u00a0<UCC>\u00a0has joined #xwiki  \n15:36\u00a0<vmassol>\u00a0\"Caused by: org.sonatype.aether.transfer.ArtifactNotFoundException: Could not find artifact org.xwiki.platform:xwiki-platform-store:pom:5.4-SNAPSHOT in local.central (file:///home/hudson  \n15:36\u00a0<vmassol>\u00a0agent/hudson\\_root/workspace/xwiki-platform/.repository)\"  \n15:36\u00a0<vmassol>\u00a0that's why http://ci.xwiki.org/job/xwiki-platform/4770/ failed  \n15:36\u00a0<vmassol>\u00a0we're having this problem quite often  \n15:37\u00a0<vmassol>\u00a0I remember I tried to reproduce locally and couldn't  \n15:42\u00a0<vmassol>\u00a0trying again  \n15:55\u00a0<vmassol>\u00a0ah yes I remember now  \n15:55\u00a0<vmassol>\u00a0last time I concluded it was a maven bug/limitation  \n15:55\u00a0<vmassol>\u00a0I think I even opened a jira issue (or linked to one)  \n16:04\u00a0<vmassol>\u00a0the problem was the use of -amd  \n16:09\u00a0<vmassol>\u00a0http://jira.codehaus.org/browse/MNG-5542  \n16:44\u00a0<UCC>\u00a0has quit  \n16:49\u00a0<cjd\\_>\u00a0has quit  \n17:30\u00a0<sdumitriu>\u00a0has quit  \n17:36\u00a0<sdumitriu>\u00a0has joined #xwiki  \n18:03\u00a0<j-simard>\u00a0has quit  \n18:12\u00a0<tmortagne>\u00a0has quit  \n18:32\u00a0<KermitTheFragger>\u00a0has quit  \n18:57\u00a0<lucaa>\u00a0has quit  \n19:14\u00a0<churina>\u00a0has joined #xwiki  \n19:19\u00a0<churina>\u00a0has quit  \n19:26\u00a0<flexab>\u00a0has joined #xwiki  \n19:27\u00a0<flexab>\u00a0has quit  \n20:55\u00a0<polx>\u00a0has quit  \n21:00\u00a0<polx>\u00a0has joined #xwiki  \n23:15\u00a0<vmassol>\u00a0has quit  \n23:46\u00a0<vmassol>\u00a0has joined #xwiki  \n23:47\u00a0<vmassol>\u00a0has quit  \n23:52\u00a0<vmassol1>\u00a0has quit\n"}