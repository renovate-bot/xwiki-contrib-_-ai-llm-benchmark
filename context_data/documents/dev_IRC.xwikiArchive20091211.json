{"id": "dev:IRC.xwikiArchive20091211", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20091211", "title": "IRC Archive for channel #xwiki - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\nxwiki-bridge - (01:11): \\* joel has set the subject to: XWiki public chat  \nCalebJamesDeLisl left at 04:44 (\":]\"  \nplunden joined #xwiki at 08:04  \nlucaa joined #xwiki at 09:59  \nlucaa left #xwiki at 10:00  \narkub joined #xwiki at 10:01  \nKermitTheFragger joined #xwiki at 10:18  \nEnygma` joined #xwiki at 10:43  \nxwiki-bridge - (11:37): [Vincent Massol] mflorea: hi. Are you here?  \nxwiki-bridge - (11:37): [mflorea] Hi Vincent Massol, yes, I'm here  \nxwiki-bridge - (11:37): [Vincent Massol] (your user is marked offline)  \nxwiki-bridge - (11:37): [mflorea] hmm, strange  \nxwiki-bridge - (11:37): [Vincent Massol] s/offline/away/  \nxwiki-bridge - (11:37): [mflorea] oh  \nxwiki-bridge - (11:37): [mflorea] yes, the window was closed  \nxwiki-bridge - (11:38): [Vincent Massol] ok I've just committed some change for wiki macros  \nxwiki-bridge - (11:38): [Vincent Massol] and I've just realized this has made the wysiwyg editor fails when inserting macros  \nxwiki-bridge - (11:38): [Vincent Massol] but I don't know why  \nxwiki-bridge - (11:38): [mflorea] what changes?  \nxwiki-bridge - (11:38): [Vincent Massol] maybe because the descriptor has changed?  \nxwiki-bridge - (11:38): [Vincent Massol] WikiMacroDescriptor  \nxwiki-bridge - (11:39): [Vincent Massol] I get http://tinypaste.com/8450a  \nxwiki-bridge - (11:39): [mflorea] you changed the API? or just the impl?  \nxwiki-bridge - (11:39): [Vincent Massol] I changed the wiki macro bridge code  \nxwiki-bridge - (11:39): [Vincent Massol] both api (to add the visiblity field) + the impl  \nxwiki-bridge - (11:40): [mflorea] ok, so the exception is thrown on the server  \nxwiki-bridge - (11:42): [mflorea] so it fails at this line:  \nxwiki-bridge - (11:42): [mflorea] for (String category : categoryManager.getMacroCategories(syntax)) {  \nxwiki-bridge - (11:42): [mflorea] the syntax seems to be ok, xwiki/2.0  \nxwiki-bridge - (11:43): [mflorea] so the getMacroCategories(\"xwiki/2.0\") fails for some reason  \nxwiki-bridge - (11:43): [Vincent Massol] all I've changed is to use the Context CM  \nxwiki-bridge - (11:43): [Vincent Massol] in MacroManager  \nxwiki-bridge - (11:43): [Vincent Massol] (and only when it's avail)  \nxwiki-bridge - (11:44): [Vincent Massol] I don't see how this could fail  \nxwiki-bridge - (11:44): [mflorea] then maybe the context CM is not initialized  \nxwiki-bridge - (11:44): [mflorea] this is a ajax request  \nxwiki-bridge - (11:44): [Vincent Massol] ah  \nxwiki-bridge - (11:44): [Vincent Massol] hmmm  \nxwiki-bridge - (11:44): [Vincent Massol] it's a component  \nxwiki-bridge - (11:44): [Vincent Massol] a singleton  \nxwiki-bridge - (11:45): [mflorea] so it must have been initialized at app startup  \nxwiki-bridge - (11:45): [Vincent Massol] yes  \nxwiki-bridge - (11:47): [Vincent Massol] ok I'll try to debug  \nxwiki-bridge - (11:47): [Vincent Massol] in what class is the code above?  \nxwiki-bridge - (11:47): [Vincent Massol] what class/module?  \nxwiki-bridge - (11:48): [Vincent Massol] I'll find it  \nxwiki-bridge - (11:48): [mflorea] http://svn.xwiki.org/svnroot/xwiki/platform/web/trunk/wysiwyg/src/main/java/com/xpn/xwiki/wysiwyg/server/plugin/macro/XWikiMacroService.java  \nxwiki-bridge - (11:48): [Vincent Massol] ok thx  \nxwiki-bridge - (12:09): [Vincent Massol] hmmm I've done something wrong in the implementation of WikiComponentManager  \nxwiki-bridge - (12:09): [Vincent Massol] \u00a0\u00a0\u00a0\u00a0protected String getKey()  \nxwiki-bridge - (12:09): [Vincent Massol] \u00a0\u00a0\u00a0\u00a0{  \nxwiki-bridge - (12:09): [Vincent Massol] \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0return this.documentAccessBridge.getCurrentDocumentName().getSpace();  \nxwiki-bridge - (12:09): [Vincent Massol] \u00a0\u00a0\u00a0\u00a0}  \nxwiki-bridge - (12:09): [Vincent Massol] this would have been ok for a SpaceComponentManager....  \nxwiki-bridge - (12:09): [Vincent Massol] so I need a way to get the current wiki name instead  \nxwiki-bridge - (12:11): [Vincent Massol] hmm I could get it from getCurrentDocumentName().getWiki()  \nxwiki-bridge - (12:11): [Vincent Massol] easy :)  \nxwiki-bridge - (12:11): [mflorea] so the exception was thrown because there's no current doc on the context, because it's an ajax request  \nxwiki-bridge - (12:11): [Vincent Massol] I haven't reached that \u00a0point yet marius but yes that'll be a pb  \nxwiki-bridge - (12:29): [anamarias] why would XWiki.XWikiGlobalRights be used instead of the usual XWiki.XWikiRights attached to a space?  \nxwiki-bridge - (12:34): [Vincent Massol] hmm I have a pb, registerWikiMacros() is done at init time but at that time there's no current doc in the context....   \nxwiki-bridge - (12:35): [Vincent Massol] I guess the pb is that I use getCurrentDoc() to get the current wiki  \nxwiki-bridge - (12:35): [Vincent Massol] we should probably have a way to get the current wiki without going through the current doc  \nxwiki-bridge - (12:36): [Vincent Massol] I'll need a new DAB api for that....  \nxwiki-bridge - (12:36): [Vincent Massol] s/I'll/I may/  \nxwiki-bridge - (12:36): [Vincent Massol] checking  \nxwiki-bridge - (12:38): [Vincent Massol] ah no  \nxwiki-bridge - (12:38): [Vincent Massol] forget this  \nxwiki-bridge - (12:38): [Vincent Massol] there's a better solution  \nxwiki-bridge - (12:46): [tmortagne] Vincent Massol: the current wiki is not necessarily the current document wiki  \nxwiki-bridge - (12:46): [tmortagne] it's two different things  \nxwiki-bridge - (12:47): [Vincent Massol] tmortagne: I'm going to do this for now:  \nxwiki-bridge - (12:47): [Vincent Massol] \u00a0\u00a0\u00a0\u00a0protected String getKey()  \nxwiki-bridge - (12:47): [Vincent Massol] \u00a0\u00a0\u00a0\u00a0{  \nxwiki-bridge - (12:47): [Vincent Massol] \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0// TODO: Since the current wiki is not currently set in the Execution Context, we have to get it from the  \nxwiki-bridge - (12:47): [Vincent Massol] \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0// old XWiki Context.  \nxwiki-bridge - (12:47): [Vincent Massol] \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Map xwikiContext = (Map) this.execution.getContext().getProperty(\"xwikicontext\");  \nxwiki-bridge - (12:47): [Vincent Massol] \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0return (String) xwikiContext.get(\"wiki\");  \nxwiki-bridge - (12:47): [Vincent Massol] \u00a0\u00a0\u00a0\u00a0}  \nxwiki-bridge - (12:47): [Vincent Massol] wdyt?  \nxwiki-bridge - (12:47): [Vincent Massol] (in WikiComponentManager)  \nxwiki-bridge - (12:47): [tmortagne] we don't have any getCurrentWiki or something in the bridge ?  \nxwiki-bridge - (12:48): [Vincent Massol] checking  \nxwiki-bridge - (12:48): [Vincent Massol] I could also add it to the bridge  \nxwiki-bridge - (12:48): [Vincent Massol] no it's not there  \nxwiki-bridge - (12:48): [tmortagne] weird that nobody already had the need for it  \nxwiki-bridge - (12:49): [Vincent Massol] we usually get it from the current doc I guess  \nxwiki-bridge - (12:49): [tmortagne] which is totally wrong...  \nxwiki-bridge - (12:49): [Vincent Massol] there are not a lot of cases where they are different  \nxwiki-bridge - (12:49): [tmortagne] I never seen this  \nxwiki-bridge - (12:49): [tmortagne] current wiki got from current doc  \nxwiki-bridge - (12:49): [Vincent Massol] I can only think of init time right now  \nxwiki-bridge - (12:50): [Vincent Massol] back to the pb  \nxwiki-bridge - (12:50): [Vincent Massol] do you prefer that I add getCurrentWiki() to the bridge?  \nxwiki-bridge - (12:50): [Vincent Massol] it seems slightly better to me  \nxwiki-bridge - (12:50): [Vincent Massol] (not perfect but slightly better)  \nxwiki-bridge - (12:50): [tmortagne] anyone that want to do multiwiki thing will have a context wiki which is not the current document wiki  \nxwiki-bridge - (12:50): [tmortagne] this include many things  \nxwiki-bridge - (12:51): [tmortagne] Vincent Massol: well i never like too much adding things to the bridge but here it's a core information  \nxwiki-bridge - (12:51): [Vincent Massol] ok will send email  \nxwiki-bridge - (12:51): [Vincent Massol] lunch time right now  \nxwiki-bridge - (14:00): [Vincent Massol] sdumitriu, tmortagne: I'd like to fix wiki macros which don't work right now for \"current wiki\" visibility  \nxwiki-bridge - (14:00): [Vincent Massol] sdumitriu: I can't refactor the whole thing right now (see steps 1 to 3 I mentioned in reply to your question)  \nxwiki-bridge - (14:00): [Vincent Massol] right now I see only 2 options:  \nxwiki-bridge - (14:00): [Vincent Massol] - either I use the EC directly in WikiCM with:  \nxwiki-bridge - (14:00): [Vincent Massol] \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0// TODO: Since the current wiki is not currently set in the Execution Context, we have to get it from the  \nxwiki-bridge - (14:00): [Vincent Massol] \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0// old XWiki Context.  \nxwiki-bridge - (14:00): [Vincent Massol] \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Map xwikiContext = (Map) this.execution.getContext().getProperty(\"xwikicontext\");  \nxwiki-bridge - (14:00): [Vincent Massol] \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0return (String) xwikiContext.get(\"wiki\");  \nxwiki-bridge - (14:01): [Vincent Massol] - either I add a getCurrentWiki() in DAB  \nxwiki-bridge - (14:01): [Vincent Massol] and then use it in WikiCM  \nxwiki-bridge - (14:01): [tmortagne] I think i would prefer to have \"getCurrentWiki() in DAB\" to not get the same error you did with current document wiki anymore from others  \nxwiki-bridge - (14:02): [Vincent Massol] ok makes sense + the fact that hardcoded strings are better located in a single place  \nxwiki-bridge - (14:03): [tmortagne] that too  \nxwiki-bridge - (14:03): [Vincent Massol] All that said, we really need to progress on using the EC more and refactoring code to use it rather than the XWC (or find some way so that they are always in sync)  \nxwiki-bridge - (14:03): [tmortagne] yes  \nxwiki-bridge - (14:03): [Vincent Massol] I'll try to find some time to look at that  \nxwiki-bridge - (14:05): [tmortagne] sync is not very easy, only way i see would be to introduce events for changes in context in XWikiContext and ExecutionContext  \nxwiki-bridge - (14:06): [tmortagne] which is not very good theses theses two are supposed to be just map currently and don't have that much logic  \nxwiki-bridge - (14:07): [Vincent Massol] sync could be done by having XWC wrap the EC  \nxwiki-bridge - (14:07): [Vincent Massol] and delegate to it for some information  \nxwiki-bridge - (14:08): [Vincent Massol] both for read and write  \nxwiki-bridge - (14:08): [tmortagne] technically we can easily make XWikiContext -> ExecutionContext sync, problem is that sometime a new XWikiContext is created and used for a short period  \nxwiki-bridge - (14:09): [tmortagne] unless XWikiContext constructor push a new Execution context  \nxwiki-bridge - (14:09): [Vincent Massol] yes  \nxwiki-bridge - (14:09): [tmortagne] and it will never be poped  \nxwiki-bridge - (14:09): [Vincent Massol] hmmm  \nxwiki-bridge - (14:10): [Vincent Massol] indeed that'll be a pb  \nxwiki-bridge - (14:10): [Vincent Massol] we can refactor XWC  \nxwiki-bridge - (14:10): [Vincent Massol] so that it has a private constructor  \nxwiki-bridge - (14:10): [Vincent Massol] and introduce a factory  \nxwiki-bridge - (14:10): [Vincent Massol] I mean methods  \nxwiki-bridge - (14:10): [Vincent Massol] for push/pop  \nxwiki-bridge - (14:10): [mflorea] Vincent Massol, tmortagne: WDYT about macro namespaces, like {{gadget:clock}}? just a thought  \nxwiki-bridge - (14:10): [Vincent Massol] obviouslt that means fixing all code that creates new instances of it  \nxwiki-bridge - (14:11): [tmortagne] then you will break a lot of code that is the code to target by kepping XwikiContext :)  \nxwiki-bridge - (14:11): [Vincent Massol] well not everyone is creating new XWC  \nxwiki-bridge - (14:11): [Vincent Massol] most code just use it without creating new instances  \nxwiki-bridge - (14:11): [tmortagne] mflorea: you can already have macros with this kind of names, just it's not officially namespaces  \nxwiki-bridge - (14:12): [tmortagne] to be more clear \":\" is valid in macro name  \nxwiki-bridge - (14:12): [Vincent Massol] I guess marius question is whether we should make it an official rule  \nxwiki-bridge - (14:13): [Vincent Massol] with a default namespace being empty   \nxwiki-bridge - (14:13): [tmortagne] i don't think we need to do it  \nxwiki-bridge - (14:13): [Vincent Massol] to easiiness of use for \"standard\" macros  \nxwiki-bridge - (14:13): [Vincent Massol] personally I don't know  \nxwiki-bridge - (14:13): [Vincent Massol] I'd need to think more   \nxwiki-bridge - (14:13): [Vincent Massol] right now I also don't think we need it  \nxwiki-bridge - (14:14): [mflorea] ok, I didn't knew : is allowed in macro names  \nxwiki-bridge - (14:15): [Vincent Massol] we allowed a few chars   \nxwiki-bridge - (14:15): [Vincent Massol] <#MACRO\\_NAME: (<XWIKI\\_CHAR>)+ ([\"-\", \"\\_\", \".\", \":\"] (<XWIKI\\_CHAR>)+)\\* >  \nxwiki-bridge - (14:15): [tmortagne] mflorea: FYI: | <#MACRO\\_NAME: (<XWIKI\\_CHAR>)+ ([\"-\", \"\\_\", \".\", \":\"] (<XWIKI\\_CHAR>)+)\\* >  \nxwiki-bridge - (14:15): [Vincent Massol] :)  \nxwiki-bridge - (14:16): [mflorea] :)  \nxwiki-bridge - (14:16): [Vincent Massol] got you!  \nxwiki-bridge - (14:16): [tmortagne] raa i lost  \nxwiki-bridge - (14:16): [mflorea] :)  \nxwiki-bridge - (14:20): [Vincent Massol] guys I need more votes, I'm ready to commit  \nxwiki-bridge - (14:20): [Vincent Massol] sdumitriu: can you please let me know if you're ok  \nxwiki-bridge - (14:32): [Vincent Massol] I need more votes... pretty please.... want to commit! ;)  \nxwiki-bridge - (14:33): [Vincent Massol] committing in 5 minutes....  \nxwiki-bridge - (14:33): [Vincent Massol] countdown started  \nxwiki-bridge - (14:34): [Vincent Massol] (I'll revert in case someone doesn't agree - since we're at beginning of 2.2 it's fine)  \nxwiki-bridge - (14:34): [James Thompson] you guys vote on commits?  \nxwiki-bridge - (14:34): [James Thompson] these major feature type things?  \nxwiki-bridge - (14:34): [Vincent Massol] James Thompson: only when we break public APIs ;)  \nxwiki-bridge - (14:35): [James Thompson] heh  \nxwiki-bridge - (14:35): [Vincent Massol] (well it's not really breaking here, it's adding to it but still it's important since removing is hard on public APIs)  \nxwiki-bridge - (14:35): [Vincent Massol] but otherwise no we implement lazy committing  \nxwiki-bridge - (14:35): [Vincent Massol] http://dev.xwiki.org/xwiki/bin/view/Community/Committership  \nxwiki-bridge - (14:36): [Vincent Massol] \"It's not necessary to send a vote when performing minor or even sometimes substantial modifications provided the author judges everyone would agree to them. This is called lazy consensus. However should someone objects to the code committed, the author must then be prepared to revert it if asked.\"  \nxwiki-bridge - (14:36): [James Thompson] ah  \nxwiki-bridge - (14:37): [Vincent Massol] so technically I wouldn't need a vote but I'm being nice ;)  \nyevlempy joined #xwiki at 14:37  \nxwiki-bridge - (14:37): [Vincent Massol] and we have a non written consensus to vote on important public APIs  \nxwiki-bridge - (14:38): [Vincent Massol] time's up... committing  \nxwiki-bridge - (14:38): [Vincent Massol] so in the end I'm not that nice! :)  \nxwiki-bridge - (14:39): [James Thompson] lol  \nxwiki-bridge - (14:41): [Vincent Massol] mflorea: good news the wysiwyg works again now   \nxwiki-bridge - (14:51): [mflorea] Vincent Massol: cool, so you implemented wiki macro isolation?  \nxwiki-bridge - (14:51): [Vincent Massol] yes  \nxwiki-bridge - (14:52): [mflorea] nice  \nxwiki-bridge - (14:52): [Vincent Massol] there are 3 levels:  \nxwiki-bridge - (14:52): [Vincent Massol] - current user  \nxwiki-bridge - (14:52): [Vincent Massol] - currenr wiki  \nxwiki-bridge - (14:52): [Vincent Massol] - global (all wikis)  \nxwiki-bridge - (14:52): [Vincent Massol] it's easy to add more if we need in the future  \nxwiki-bridge - (14:53): [Vincent Massol] (for ex current space level)  \nxwiki-bridge - (14:53): [Vincent Massol] (or current doc)  \nxwiki-bridge - (14:56): [mflorea] hmm, what do you mean current doc/space? You mean that some macros are allowed only inside a special doc or space  \nxwiki-bridge - (14:56): [Vincent Massol] yes  \nxwiki-bridge - (14:56): [Vincent Massol] I'm not saying we need it  \nxwiki-bridge - (14:56): [Vincent Massol] just imagining some potential use cases  \nxwiki-bridge - (14:56): [Vincent Massol] I doubt we'll need it TBH  \nxwiki-bridge - (14:57): [glerouge] hi guys  \nxwiki-bridge - (14:57): [Vincent Massol] the space one could be needed if some user were using spaces as project delimitations  \nxwiki-bridge - (14:57): [glerouge] has anyone ever met this exception?  \nxwiki-bridge - (14:57): [glerouge] java.sql.BatchUpdateException: Data truncation: Data too long for column 'XWD\\_MINOREDIT' at row 1  \nxwiki-bridge - (14:57): [glerouge] \u00a0 \u00a0 \u00a0 \u00a0 at com.mysql.jdbc.PreparedStatement.executeBatchSerially(PreparedStatement.java:1093)  \nxwiki-bridge - (14:57): [Vincent Massol] (instead of using XEM)  \nxwiki-bridge - (14:59): [sdumitriu] Vincent Massol: Sorry, I was cooking  \nxwiki-bridge - (14:59): [Vincent Massol] glerouge: anything useful here: http://www.google.com/search?q=%22Data+too+long+for+column+%27XWD\\_MINOREDIT%27%22&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a ?  \nxwiki-bridge - (15:00): [Vincent Massol] Pomodoro!  \nxwiki-bridge - (15:01): [sdumitriu] So, I don't understand what's wrong with using the execution context  \nxwiki-bridge - (15:02): [Vincent Massol] sdumitriu: did you see my reply?  \nxwiki-bridge - (15:02): [Vincent Massol] I listed 3 points  \nxwiki-bridge - (15:03): [sdumitriu] 1/ Why? We need the current wiki, isn't that enough for the moment?  \nxwiki-bridge - (15:03): [sdumitriu] 2/ Using the model for this is wrong  \nxwiki-bridge - (15:03): [Vincent Massol] I'm not sure using something intermediary is good  \nxwiki-bridge - (15:04): [tmortagne] sdumitriu: the problem is not really the get current wiki part from Execution context but how to sync it with old way for old code  \nxwiki-bridge - (15:04): [sdumitriu] What does the \\*document\\* model have to do with the current wiki?  \nxwiki-bridge - (15:04): [Vincent Massol] we don't have a Wiki class yet  \nxwiki-bridge - (15:04): [sdumitriu] I know  \nxwiki-bridge - (15:05): [sdumitriu] tmortagne: What synchronization?  \nxwiki-bridge - (15:05): [Vincent Massol] model isn't documetn model  \nxwiki-bridge - (15:05): [sdumitriu] Initially it was  \nxwiki-bridge - (15:05): [sdumitriu] And the idea was to only add methods that we're at least 80% sure will be in the real 2.0 model  \nxwiki-bridge - (15:05): [Vincent Massol] maybe but the new model is about the full model IMOI  \nxwiki-bridge - (15:05): [sdumitriu] (which I think becomes the 3.0 model)  \nxwiki-bridge - (15:06): [Vincent Massol] s/IMOI/IMO/  \nxwiki-bridge - (15:06): [tmortagne] sdumitriu: there is old code getting main wiki from XWikiConetxt and you want that we introduce mwin wiki in ExecutionContext so we have two place whith the exact same information so we need to make sure theses are always the same  \nxwiki-bridge - (15:06): [sdumitriu] Define current wiki  \nxwiki-bridge - (15:06): [sdumitriu] I see 2: Initial wiki corresponding to the request  \nxwiki-bridge - (15:06): [tmortagne] the things we are talking about...  \nxwiki-bridge - (15:07): [sdumitriu] And wiki for the current action, which can be changed when loading documents from another wiki  \nxwiki-bridge - (15:07): [Vincent Massol] there are 2 indeed  \nxwiki-bridge - (15:07): [sdumitriu] The first one doesn't have to be synchronized  \nxwiki-bridge - (15:07): [Vincent Massol] current wiki and current document  \nxwiki-bridge - (15:07): [Vincent Massol] both needs to be synced  \nxwiki-bridge - (15:07): [tmortagne] we are speaking about the context wiki  \nxwiki-bridge - (15:07): [Vincent Massol] since both are stored in the context  \nxwiki-bridge - (15:07): [tmortagne] we don't have two context wiki  \nxwiki-bridge - (15:08): [Vincent Massol] current doc == current doc name = wiki + space + page  \nxwiki-bridge - (15:08): [sdumitriu] We don't right now, but we should  \nxwiki-bridge - (15:08): [tmortagne] current document wiki is only that part of the current document name  \nxwiki-bridge - (15:08): [Vincent Massol] yes  \nxwiki-bridge - (15:09): [tmortagne] so there is only one current wiki  \nxwiki-bridge - (15:09): [Vincent Massol] sure  \nxwiki-bridge - (15:10): [sdumitriu] The current wiki can only be set using the setWiki method  \nxwiki-bridge - (15:10): [tmortagne] setDatabase  \nxwiki-bridge - (15:10): [sdumitriu] It wouldn't be hard to change it so that it pushes the change to the execution context  \nxwiki-bridge - (15:10): [Vincent Massol] and also through XWikiContext.put()  \nxwiki-bridge - (15:10): [tmortagne] setWiki is a wrong name for the singleton XWiki class  \nxwiki-bridge - (15:10): [sdumitriu] Ah, right, it's setDatabase  \nxwiki-bridge - (15:10): [Vincent Massol] (which would be wrong btw but still possible)  \nxwiki-bridge - (15:10): [sdumitriu] My nad  \nxwiki-bridge - (15:10): [sdumitriu] bad  \nxwiki-bridge - (15:11): [sdumitriu] No, it can't be changed using the map  \nxwiki-bridge - (15:11): [Vincent Massol] why not?  \nxwiki-bridge - (15:11): [tmortagne] sdumitriu: as i sais yes it's technically easy but it doe snot work with XWikiConetxt object created in some place just for one action  \nxwiki-bridge - (15:11): [sdumitriu] \u00a0\u00a0\u00a0\u00a0public String getDatabase()  \nxwiki-bridge - (15:11): [sdumitriu] \u00a0\u00a0\u00a0\u00a0{  \nxwiki-bridge - (15:11): [sdumitriu] \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0return this.database;  \nxwiki-bridge - (15:11): [sdumitriu] \u00a0\u00a0\u00a0\u00a0}  \nxwiki-bridge - (15:11): [sdumitriu] this.database is not in the map  \nxwiki-bridge - (15:11): [Vincent Massol] it is  \nxwiki-bridge - (15:11): [Vincent Massol] check setDatabase  \nxwiki-bridge - (15:11): [Vincent Massol] :)  \nxwiki-bridge - (15:11): [sdumitriu] The value in the map is just a read-only mirror  \nxwiki-bridge - (15:12): [Vincent Massol] yes  \nxwiki-bridge - (15:12): [sdumitriu] So putting some value in there doesn't mean anything to the current xwiki-core  \nxwiki-bridge - (15:12): [Vincent Massol] yes you're right  \nxwiki-bridge - (15:12): [sdumitriu] So there really is just one place where setDatabase is used  \nxwiki-bridge - (15:12): [Vincent Massol] I don't even understand why it's put in the map  \nxwiki-bridge - (15:13): [tmortagne] btw why not put it only in the map and remove the variable ?  \nxwiki-bridge - (15:13): [sdumitriu] It was put there so that it can be accessed from the ExecutionContext using the map interface  \nxwiki-bridge - (15:13): [Vincent Massol] you sure?  \nxwiki-bridge - (15:13): [Vincent Massol] so that's something recent?  \nxwiki-bridge - (15:13): [sdumitriu] Yep  \nxwiki-bridge - (15:13): [sdumitriu] I think I did it  \nxwiki-bridge - (15:13): [Vincent Massol] I had not realized  \nxwiki-bridge - (15:13): [Vincent Massol] where is it used?  \nxwiki-bridge - (15:14): [sdumitriu] Not sure  \nxwiki-bridge - (15:14): [Vincent Massol] checking  \nxwiki-bridge - (15:15): [sdumitriu] Btw, we do have two context wikis  \nxwiki-bridge - (15:15): [sdumitriu] XWikiContext.getOriginalDatabase  \nxwiki-bridge - (15:16): [Vincent Massol] I wasn't able to find a usage of \"wiki\" in core for accessing the current wiki  \nxwiki-bridge - (15:16): [tmortagne] it's the original wiki of the request not the context wiki, store it in the xwikicontext does not make it current wiki, it's not supposed to change  \nxwiki-bridge - (15:17): [sdumitriu] Yes, I know  \nxwiki-bridge - (15:17): [sdumitriu] (03:06:23 PM) sdumitriu: Define current wiki  \nxwiki-bridge - (15:17): [sdumitriu] (03:06:37 PM) sdumitriu: I see 2: Initial wiki corresponding to the request  \nxwiki-bridge - (15:18): [tmortagne] hibernate also put database name in the context for its intenal use in virtual mode  \nxwiki-bridge - (15:18): [sdumitriu] (03:07:20 PM) sdumitriu: The first one doesn't have to be synchronized  \nxwiki-bridge - (15:21): [sdumitriu] Vincent Massol: Do you agree with http://jira.xwiki.org/jira/browse/XWIKI-1543 ? Do you think it needs a vote?  \nxwiki-bridge - (15:23): [Vincent Massol] sdumitriu: I need to read and understand  \nxwiki-bridge - (15:25): [Vincent Massol] ok I've replied  \nxwiki-bridge - (15:41): [sdumitriu] Vincent Massol: Failed tests http://hudson.xwiki.org/job/xwiki-platform-core/org.xwiki.platform$xwiki-core-rendering-macro-wikibridge/4425/  \nxwiki-bridge - (15:41): [Vincent Massol] thanks looking  \nxwiki-bridge - (15:53): [sdumitriu] Vincent Massol: Did you really intend to remove MockWikiMacro.java in your previous commit?  \nxwiki-bridge - (15:53): [Vincent Massol] yes  \nxwiki-bridge - (15:53): [sdumitriu] K, just checking  \nxwiki-bridge - (15:53): [Vincent Massol] I had tried to remove it before twice  \nxwiki-bridge - (15:53): [Vincent Massol] and for some reason it kept reappearing  \nxwiki-bridge - (15:54): [Vincent Massol] (I had some pb with IDEA)  \nxwiki-bridge - (15:54): [Vincent Massol] thanks for checking  \nxwiki-bridge - (15:54): [Vincent Massol] btw in case someone asks I had to use @org.junit.Test  \nxwiki-bridge - (15:54): [Vincent Massol] instead of just @Test  \nxwiki-bridge - (15:54): [Vincent Massol] in some commits  \nxwiki-bridge - (15:55): [Vincent Massol] because of an IDEA bug (which is fixed in the next EAP - not out yet)  \nxwiki-bridge - (15:55): [Vincent Massol] http://youtrack.jetbrains.net/issue/IDEADEV-41940  \nyevlempy left at 16:03 (Read error: 110 (Connection timed out)  \nyevlempy joined #xwiki at 16:04  \nxwiki-bridge - (16:04): [Vincent Massol] guys I have to leave now, I'm going to the north of France for the week end. I'll be connected again in 3 hours + over the week end  \nxwiki-bridge - (16:05): [glerouge] bye  \nxwiki-bridge - (16:06): [tmortagne] bon voyage  \nxwiki-bridge - (16:17): [Vincent Massol] thanks, bfn  \nyevlempy left at 16:23 (\"Leaving\"  \nlucaa joined #xwiki at 17:54  \nxwiki-bridge - (17:58): [lucaa] hi guys, I have an issue. I have a document with just an include macro in it. The included page has a velocity script which does some $doc.display() for fields which only have syntax 2.0 in them  \nxwiki-bridge - (17:58): [lucaa] it's all \u00a0displayed fine, but when I parse the document content in an XDOM myself and transform, I get html as text (special character '<', word 'p', special character '>').   \nxwiki-bridge - (17:58): [lucaa] any hints where I should be looking at what I'm doing wrong?  \nlucaa left #xwiki at 17:58  \nxwiki-bridge - (18:11): [tmortagne] lucaa: do you have the right document in the context when you execute transformations ?  \nxwiki-bridge - (18:12): [lucaa] I just debugged now, it seems that the result of {{velocity}} displayed for view \u00a0has a {{html}} around it while mine does not  \nxwiki-bridge - (18:13): [lucaa] I'm still investigating  \nxwiki-bridge - (18:13): [lucaa] I think it's the isRenderingEngine thing  \nxwiki-bridge - (18:13): [lucaa] s/thing/flag/  \nxwiki-bridge - (18:14): [tmortagne] yes isRenderingEngine is here to make diff\u00e9rence between dispaly called from template and display called form document  \nEnygma` left at 18:22 (Read error: 60 (Operation timed out)  \nKermitTheFragger left at 18:59 (\"Leaving\"  \narkub left at 19:30 (Read error: 113 (No route to host)  \nSvenDowiu joined #xwiki at 19:46  \nSvenDowideit left at 19:58 (Read error: 101 (Network is unreachable)  \nSvenDowiu is now known as SvenDowideit ([[email\u00a0protected]](https://dev.xwiki.org/cdn-cgi/l/email-protection)  \nSvenDowiu joined #xwiki at 20:54  \nplunden left at 20:56 (verne.freenode.net irc.freenode.net  \nSvenDowideit left at 21:05 (Read error: 101 (Network is unreachable)  \nSvenDowiu is now known as SvenDowideit ([[email\u00a0protected]](https://dev.xwiki.org/cdn-cgi/l/email-protection)  \nCalebJamesDeLisl joined #xwiki at 21:47  \nSvenDowideit left at 21:53 (verne.freenode.net irc.freenode.net  \nSvenDowideit joined #xwiki at 21:54  \nSvenDowideit left at 22:50 (verne.freenode.net irc.freenode.net  \nSvenDowideit joined #xwiki at 22:51  \nxwiki-bridge - (23:02): [NielsMayer] In 2.1, is there a way to get rid of the top-left icon and label w/ the host/wikiname ? if it says \"xwiki\" that might make sense but when it says \"host\\_xe\\_nielsmayer\\_dot\\_com\" then it's not so pretty  \nxwiki-bridge - (23:03): [NielsMayer] other than just blasting away at the skin code or setting display:none in the CSS on those elements  \nxwiki-bridge - (23:03): [Vincent Massol] NielsMayer: AFAIK we're still discussing how to handle this  \nxwiki-bridge - (23:03): [Vincent Massol] right now you'll need to change the vm file or override it  \nxwiki-bridge - (23:03): [NielsMayer] hi vincent.   \nxwiki-bridge - (23:03): [Vincent Massol] hi niels  \nxwiki-bridge - (23:04): [NielsMayer] that's what i thought... but i'll hold off since i have a lot of work to do till launch  \nxwiki-bridge - (23:04): [Vincent Massol] menuview.vm AFAIR  \nxwiki-bridge - (23:04): [NielsMayer] thanks... actually i'll probably need to mess with menuview once i take off my geek hat and put on my \"dumb user\" hat again  \nxwiki-bridge - (23:05): [Vincent Massol] :)  \nxwiki-bridge - (23:06): [NielsMayer] other than that, 2.1 seems smooth and nice; easy upgrade from 2.0.3  \nxwiki-bridge - (23:06): [Vincent Massol] cool  \nxwiki-bridge - (23:09): [NielsMayer] there's one error that i never bothered tracking down tho (app works anyways): 2009-12-11 11:51:52,267 [http://localhost/xwiki/bin/view/Episodes/www\\_aspenpublicradio\\_com\\_podcasts\\_sp\\_soulpatrol\\_mjspecialjul09\\_mp3] WARN xwiki.XWiki - Error on too many recursive includes for topic Macros.JWPlayer2 \u00a0// 2009-12-11 11:51:54,950  \nxwiki-bridge - (23:09): [NielsMayer] [http://localhost/xwiki/bin/view/Episodes/www\\_aspenpublicradio\\_com\\_podcasts\\_sp\\_soulpatrol\\_mjspecialjul09\\_mp3?xpage=plain&analyzer=VampQmSegmenter%3Asegment] WARN xwiki.XWiki - Error on too many recursive includes for topic Macros.JWPlayer2   \nxwiki-bridge - (23:09): [Vincent Massol] that's usually some #include that create a chain  \nxwiki-bridge - (23:10): [NielsMayer] not sure why it says \"topic\"   \nxwiki-bridge - (23:10): [Vincent Massol] cyclic chain  \nxwiki-bridge - (23:10): [Vincent Massol] topic = page  \nxwiki-bridge - (23:10): [NielsMayer] as it's a document containing a macro  \nxwiki-bridge - (23:10): [Vincent Massol] (that's the old name used by Ludovic at the beginning)  \nxwiki-bridge - (23:10): [NielsMayer] oh  \nxwiki-bridge - (23:10): [NielsMayer] weird thing is last i looked there was no chain  \nxwiki-bridge - (23:12): [NielsMayer] actually the \"loop\" is this: xwiki.ssx.use(\"Macros.JWPlayer2\") // $xwiki.jsx.use(\"Macros.JWPlayer2\")   \nxwiki-bridge - (23:13): [NielsMayer] i.e i have a macros document that contains ssx and jsx and i have \u00a0macro to include that in the macro document. (old version of what gives error: http://nielsmayer.com/xwiki/bin/view/Macros/JWPlayer2?viewer=code )  \nxwiki-bridge - (23:14): [NielsMayer] (i'm going to swap boxes with this 2.1 based version once it's ready)  \nxwiki-bridge - (23:15): [NielsMayer] it's a construct that's survived several upgrades, but after 2.X it started issuing that message (but still works)  \nxwiki-bridge - (23:16): [Vincent Massol] is it in 1.0 syntax?  \nxwiki-bridge - (23:16): [NielsMayer] yes  \nxwiki-bridge - (23:16): [Vincent Massol] I know we had the same pb in the blog app for some pages  \nxwiki-bridge - (23:17): [Vincent Massol] it's now been fixed by moving to 2.0 syntax  \nxwiki-bridge - (23:17): [NielsMayer] is that what prompted the upgrade to 2.0 :-)  \nxwiki-bridge - (23:17): [Vincent Massol] I don't know the details, sergiu worked on it  \nxwiki-bridge - (23:17): [Vincent Massol] not really  \nxwiki-bridge - (23:17): [Vincent Massol] what prompted was to be able to use the new wysiwyg editor  \nxwiki-bridge - (23:17): [Vincent Massol] and no longer that crappy tinymce one we had  \nxwiki-bridge - (23:17): [Vincent Massol] (the one for 1.0 syntax)  \nxwiki-bridge - (23:18): [NielsMayer] i've held off on 2.0ing that since it works and i have a lot of stuff to get working...  \nxwiki-bridge - (23:18): [NielsMayer] oh yes i love tinymce, made \u00a0my life hell at curriki  \nxwiki-bridge - (23:18): [Vincent Massol] :)  \nxwiki-bridge - (23:18): [Vincent Massol] sorry about that!  \nxwiki-bridge - (23:18): [Vincent Massol] I'm glad we fixed it  \nxwiki-bridge - (23:18): [NielsMayer] well curriki's not your fault :-)  \nxwiki-bridge - (23:19): [NielsMayer] no need to apologize... if i could only keep up w/ your pace of devel   \nxwiki-bridge - (23:20): [Vincent Massol] yeah that's good and bad  \nxwiki-bridge - (23:20): [Vincent Massol] bad since it excludes lots of contributors who don't have enough time to work on xwiki and thus cannot follow  \nxwiki-bridge - (23:20): [Vincent Massol] I know the feeling, I have lived it for maven2  \nxwiki-bridge - (23:20): [NielsMayer] well it's just like using fedora... you can stop and it'll work for years, but your upgrade might be hard becauwe theu've done 6 revs since you last looked  \nxwiki-bridge - (23:20): [Vincent Massol] I couldn't follow the work at that time (was doing it in my free time only)  \nxwiki-bridge - (23:21): [Vincent Massol] (I'm talking about dev, not using)  \nxwiki-bridge - (23:22): [NielsMayer] i can't keep up w/ any of it in both dev and using. \u00a0just got totally sidetracked for several weeks of building systems and installing RAID and f12 and making the UPS work during a powerfailure  \nxwiki-bridge - (23:22): [NielsMayer] on the other hand, xwiki runs very nicely on a 3.4G PhenomII w/ 4Gig or Ram :-)  \nxwiki-bridge - (23:23): [Vincent Massol] :)  \nxwiki-bridge - (23:24): [Vincent Massol] got to go  \nxwiki-bridge - (23:24): [Vincent Massol] have fun  \nxwiki-bridge - (23:24): [NielsMayer] thanks for the help, and xwiki too  \n\n"}