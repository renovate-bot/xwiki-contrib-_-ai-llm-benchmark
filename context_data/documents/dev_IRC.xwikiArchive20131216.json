{"id": "dev:IRC.xwikiArchive20131216", "url": "https://dev.xwiki.org/xwiki/bin/view/IRC/xwikiArchive20131216", "title": "IRC Archive for channel #xwiki on 16 December 2013 - XWiki", "collection": "Eval-Large", "mimetype": "text/markdown", "language": "en", "content": "\n<vmassol>\u00a0has joined #xwiki  \n00:53\u00a0<abusenius>\u00a0has quit  \n01:10\u00a0<Denis1>\u00a0has quit  \n04:30\u00a0<Denis>\u00a0has joined #xwiki  \n05:35\u00a0<xwikibot>\u00a0has joined #xwiki  \n05:59\u00a0<Denis>\u00a0has quit  \n07:20\u00a0<sburjan`>\u00a0has quit  \n08:04\u00a0<msmeria>\u00a0has joined #xwiki  \n08:11\u00a0<tmortagne>\u00a0has joined #xwiki  \n08:37\u00a0<j-simard>\u00a0has joined #xwiki  \n09:06\u00a0<vrachieru>\u00a0has joined #xwiki  \n09:18\u00a0<camil7>\u00a0has joined #xwiki  \n09:22\u00a0<ajp>\u00a0has joined #xwiki  \n09:23\u00a0<cjd>\u00a0has joined #xwiki  \n09:59\u00a0<sburjan>\u00a0has joined #xwiki  \n10:02\u00a0<lucaa>\u00a0has joined #xwiki  \n10:13\u00a0<jbernard\\_>\u00a0has joined #xwiki  \n10:39\u00a0<gdelhumeau>\u00a0has joined #xwiki  \n10:41\u00a0<msmeria>\u00a0gdelhumeau: regarding XWIKI-9737: I was unable to reproduce it after restarting my PC  \n10:44\u00a0<Slashman>\u00a0has joined #xwiki  \n10:44\u00a0<gdelhumeau>\u00a0hi msmeria, did you mean XWIKI-9780 ?  \n10:47\u00a0<msmeria>\u00a0gdelhumeau: no. I meant the first issue. On Thursday I created subwikis on 5.3rc1 and when DW kicked in, the Main Wiki - UI all was recommended to be installed  \n10:47\u00a0<msmeria>\u00a0and that's why the Admin user was locally installed on each subwiki  \n10:48\u00a0<msmeria>\u00a0but as I said, I couldn't reproduce it this morning  \n10:48\u00a0<gdelhumeau>\u00a0it is strange, it has been fixed by Vincent & I  \n10:48\u00a0<gdelhumeau>\u00a0And I believe it was before the RC1  \n10:54\u00a0<Denis>\u00a0has joined #xwiki  \n10:55\u00a0<ajp>\u00a0has quit  \n11:04\u00a0<evalica>\u00a0has joined #xwiki  \n11:18\u00a0<evalica>\u00a0has quit  \n11:37\u00a0<evalica>\u00a0has joined #xwiki  \n12:07\u00a0<msmeria1>\u00a0has joined #xwiki  \n12:09\u00a0<camil7>\u00a0it seems to me that my patches broke the CI-build somehow, but I cannot reproduce the problems locally  \n12:09\u00a0<msmeria>\u00a0has quit  \n12:10\u00a0<tmortagne>\u00a0camil7: I don't think so  \n12:10\u00a0<tmortagne>\u00a0xwiki-platform build did not fail and xwiki-platform-5.3.x failure does not have anything to do with your modifications  \n12:12\u00a0<jbernard\\_>\u00a0Hello, do you know where is the default translate page of XWiki 5.1 ? Which one used in the administration panel or for the user profil for exemple.  \n12:13\u00a0<camil7>\u00a0tmortagne: ah, it did not, good to know :)  \n12:14\u00a0<tmortagne>\u00a0jbernard\\_: most standard translations come form ApplicationResources.properties in oldcore jar not from a wiki page  \n12:14\u00a0<camil7>\u00a0jbernard\\_: I guess there is not \"default translation page\", instead the defaults are in the ApplicationResources\\_nn.properties  \n12:14\u00a0<tmortagne>\u00a0s/form/from/  \n12:15\u00a0<tmortagne>\u00a0but if you want to overwrite one you can just put what you want in a translation wiki page (wiki pages have priority over jars)  \n12:16\u00a0<tmortagne>\u00a0well except that priority does not work that well in 5.1  \n12:16\u00a0<tmortagne>\u00a0XWIKI-9732  \n12:19\u00a0<jbernard\\_>\u00a0well, i think i will add the key in an wiki translate page, but i don't know which translate key is.  \n12:19\u00a0<jbernard\\_>\u00a0never mind, i find it  \n12:21\u00a0<camil7>\u00a0you can do something like \u00a0\u00a0\u00a0jar tvf \u00a0webapps/xwiki/WEB-INF/lib/xwiki-platform-legacy-oldcore-5.1.jar \u00a0ApplicationResources.properties \u00a0and search though that file  \n12:21\u00a0<camil7>\u00a0or search on l10n.xwiki.org  \n12:22\u00a0<tmortagne>\u00a0jbernard\\_: when you search for a key you can use l10n.xwiki.org/xwiki/bin/view/L10N/Search  \n12:22\u00a0<tmortagne>\u00a0http://l10n.xwiki.org/xwiki/bin/view/L10N/Search  \n12:26\u00a0<jbernard\\_>\u00a0yes, thanks, i found it :)  \n12:58\u00a0<evalica>\u00a0has quit  \n13:01\u00a0<evalica>\u00a0has joined #xwiki  \n13:28\u00a0<tmortagne>\u00a0has quit  \n13:53\u00a0<jbernard\\_>\u00a0has quit  \n13:54\u00a0<jbernard\\_>\u00a0has joined #xwiki  \n13:58\u00a0<cjd>\u00a0has quit  \n14:09\u00a0<cjd>\u00a0has joined #xwiki  \n14:12\u00a0<Kaisen>\u00a0has joined #xwiki  \n14:21\u00a0<Kaisen>\u00a0Hello, I have a small to big problem with my Xwiki installation. I did a upgrade over the .deb distibution and now I get the error \"HTTP Status 500 - com.xpn.xwiki.XWikiException: Error number 3 in 0: Could not initialize main XWiki context\"  \n14:22\u00a0<Kaisen>\u00a0I check the hibernate.cfg.xml but there everything is fine  \n14:22\u00a0<Kaisen>\u00a0now I don't know what or where to check next  \n14:23\u00a0<vmassol>\u00a0can you paste the full stack trace on pastebin or gist?  \n14:23\u00a0<vmassol>\u00a0(Kaisen)  \n14:24\u00a0<Kaisen>\u00a0from the catalina.out?  \n14:27\u00a0<Kaisen>\u00a0javax.servlet.ServletException: com.xpn.xwiki.XWikiException: Error number 3 in 0: Could not initialize main XWiki context  \n14:27\u00a0<Kaisen> org.apache.struts.action.RequestProcessor.processException(RequestProcessor.java:520)  \n14:27\u00a0<Kaisen> org.apache.struts.action.ActionServlet.process(ActionServlet.java:1913)  \n14:27\u00a0<Kaisen> org.apache.struts.action.ActionServlet.doGet(ActionServlet.java:449)  \n14:27\u00a0<Kaisen> javax.servlet.http.HttpServlet.service(HttpServlet.java:621)  \n14:27\u00a0<Kaisen> javax.servlet.http.HttpServlet.service(HttpServlet.java:722)  \n14:27\u00a0<Kaisen> com.xpn.xwiki.web.ActionFilter.doFilter(ActionFilter.java:121)  \n14:27\u00a0<cjd>\u00a0:)  \n14:27\u00a0<Kaisen> org.xwiki.wysiwyg.server.filter.ConversionFilter.doFilter(ConversionFilter.java:144)  \n14:27\u00a0<Kaisen> com.xpn.xwiki.plugin.webdav.XWikiDavFilter.doFilter(XWikiDavFilter.java:66)  \n14:27\u00a0<Kaisen> org.xwiki.container.servlet.filters.internal.SavedRequestRestorerFilter.doFilter(SavedRequestRestorerFilter.java:208)  \n14:27\u00a0<Kaisen> org.xwiki.container.servlet.filters.internal.SetCharacterEncodingFilter.doFilter(SetCharacterEncodingFilter.java:111)  \n14:27\u00a0<Kaisen>\u00a0root cause  \n14:27\u00a0<Kaisen>\u00a0com.xpn.xwiki.XWikiException: Error number 3 in 0: Could not initialize main XWiki context  \n14:27\u00a0<Kaisen> com.xpn.xwiki.XWiki.getMainXWiki(XWiki.java:424)  \n14:27\u00a0<Kaisen> com.xpn.xwiki.XWiki.getXWiki(XWiki.java:493)  \n14:27\u00a0<Kaisen> com.xpn.xwiki.web.XWikiAction.execute(XWikiAction.java:153)  \n14:27\u00a0<Kaisen> com.xpn.xwiki.web.XWikiAction.execute(XWikiAction.java:129)  \n14:27\u00a0<Kaisen> org.apache.struts.action.RequestProcessor.processActionPerform(RequestProcessor.java:425)  \n14:27\u00a0<Kaisen> org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:228)  \n14:27\u00a0<Kaisen> org.apache.struts.action.ActionServlet.process(ActionServlet.java:1913)  \n14:27\u00a0<Kaisen> org.apache.struts.action.ActionServlet.doGet(ActionServlet.java:449)  \n14:27\u00a0<Kaisen> javax.servlet.http.HttpServlet.service(HttpServlet.java:621)  \n14:27\u00a0<Kaisen> javax.servlet.http.HttpServlet.service(HttpServlet.java:722)  \n14:27\u00a0<Kaisen> com.xpn.xwiki.web.ActionFilter.doFilter(ActionFilter.java:121)  \n14:27\u00a0<Kaisen> org.xwiki.wysiwyg.server.filter.ConversionFilter.doFilter(ConversionFilter.java:144)  \n14:27\u00a0<Kaisen> com.xpn.xwiki.plugin.webdav.  \n14:27\u00a0<Kaisen>\u00a0It is not allways a good feeling to be a newbe  \n14:27\u00a0<Kaisen>\u00a0:)  \n14:28\u00a0<cjd>\u00a0(when you paste in IRC, the content is buffered because of IRC flood controls so it took until just now for the paste to stop coming)  \n14:29\u00a0<camil7>\u00a0these error message normally mean that xwiki has not been initialized for some reason, usually because it could not find a database  \n14:29\u00a0<vmassol>\u00a0\"can you paste the full stack trace on pastebin or gist?\"  \n14:29\u00a0<cjd>\u00a0https://ezcrypt.it/ :)  \n14:29\u00a0<vmassol>\u00a0:)  \n14:29\u00a0<vmassol>\u00a0or any other tool indeed  \n14:30\u00a0<vmassol>\u00a0this doesn't look the full stack trace  \n14:30\u00a0<vmassol>\u00a0s/look/look like/  \n14:30\u00a0<Kaisen>\u00a0https://ezcrypt.it/qD7n#ezu7jMVda30EJQBBtgzGFfgm  \n14:30\u00a0<vmassol>\u00a0the reason is:  \n14:30\u00a0<vmassol>\u00a0com.xpn.xwiki.store.migration.MigrationRequiredException: Since database [xwiki] needs to be migrated, it couldn't be safely used! Please check your configuration to enable required migration for upgrading database from version [43000] to version [53010].  \n14:30\u00a0<vmassol>\u00a0you just need to enable migrations  \n14:30\u00a0<vmassol>\u00a0apparently you disabled it  \n14:31\u00a0<vmassol>\u00a0(since it's enabled by default)  \n14:31\u00a0<Kaisen>\u00a0you mean on side of mysql or xwiki?  \n14:31\u00a0<vmassol>\u00a0xwiki  \n14:31\u00a0<vmassol>\u00a0in xwiki.cfg  \n14:31\u00a0<cjd>\u00a0it's a setting in the xwiki.cfg file, disabling it makes things a bit faster in some cases, enabling it makes things work correctly :)  \n14:31\u00a0<Kaisen>\u00a0I'm not sure if I'm at the right point but I check the option xwiki.store.migration=1  \n14:33\u00a0<vmassol>\u00a0is it commented out?  \n14:33\u00a0<vmassol>\u00a0also check xwiki.store.migration.databases  \n14:33\u00a0<Kaisen>\u00a0\u00a0xwiki.store.migration.databases is commented out  \n14:33\u00a0<Kaisen>\u00a0\u00a0xwiki.store.migration=1 is not commented out  \n14:34\u00a0<vmassol>\u00a0last think to check is: xwiki.store.hibernate.updateschema  \n14:34\u00a0<vmassol>\u00a0(and old property for this)  \n14:35\u00a0<Kaisen>\u00a0it is also commented out  \n14:35\u00a0<Denis>\u00a0Kaisen: not enough of your log in your paste de help, the problem is before, and database not being migrated could be just a consequence  \n14:36\u00a0<Denis>\u00a0s/de/to  \n14:36\u00a0<Kaisen>\u00a0And how do I manually migrated the database?  \n14:37\u00a0<Denis>\u00a0no manual migration possible, database are automatically migrated with a proper startup  \n14:38\u00a0<Kaisen>\u00a0You mean when the tomcat start up?  \n14:38\u00a0<camil7>\u00a0if you stop the server, move away the logfiles and then start the server, it is easier to find the first error message after the start  \n14:39\u00a0<Denis>\u00a0vmassol: very bad surprise with 5.3, just upgrading one or our farm, and after a OOM during DW due to increased needs, I had to restart, and now I get a very strange error: java.lang.RuntimeException: Component manager has not been initialized before lookup for [org.xwiki.model.reference.DocumentReferenceResolver< java.lang.String >] for hint [currentmixed]  \n14:39\u00a0<evalica>\u00a0has quit  \n14:39\u00a0<vmassol>\u00a0Denis: bad news indeed, now we need to see where it's coming from, looks simple enough to fix  \n14:39\u00a0<vmassol>\u00a0usually it means some jar is missing  \n14:39\u00a0<Denis>\u00a0vmassol: seems to be the DavFIlter  \n14:40\u00a0<vmassol>\u00a0It's strangr because I downloaded 5.3 during the week end  \n14:40\u00a0<vmassol>\u00a0and it started well for me  \n14:40\u00a0<Denis>\u00a0vmassol: it has started before, and I was upgrading the UI for all my wikis when it OOM  \n14:41\u00a0<Denis>\u00a0I have increase the Xmx, and restart  \n14:41\u00a0<Denis>\u00a0and I am now stuck with that error  \n14:41\u00a0<vmassol>\u00a0so you think the problem was caused by the half upgrade?  \n14:41\u00a0<vmassol>\u00a0(seems so)  \n14:41\u00a0<Denis>\u00a0what is stange is that I have fully upgraded the UI of the main wiki  \n14:41\u00a0<vmassol>\u00a0but this file should be in some core extensions  \n14:41\u00a0<vmassol>\u00a0ie in WEB-INF/lib  \n14:42\u00a0<Denis>\u00a0and that the error came from the DavFilter  \n14:42\u00a0<vmassol>\u00a0which we don't touch AFAIK  \n14:44\u00a0<Kaisen>\u00a0OK so here is the complete log after deleting it first and restart the server https://ezcrypt.it/sD7n#vGo0Y52xIASvknPGQGuFZz8G  \n14:45\u00a0<Denis>\u00a0vmassol: I also have a Failed to lookup component [org.xwiki.extension.repository.internal.installed.DefaultInstalledExtensionRepository] in the logs, caused by an NPE in \u00a0org.xwiki.extension.repository.internal.installed.DefaultInstalledExtensionRepository.validateDependency(DefaultInstalledExtensionRepository.java:221)  \n14:46\u00a0<vmassol>\u00a0I guess thomas would be the best person to look into this\u2026  \n14:46\u00a0<camil7>\u00a0Kaisen: darn, I see the migration remembers its state in a special table in the DB itself, so it did not attempt to rerun the migration as I thought it would :-/  \n14:46\u00a0<vmassol>\u00a0Denis: I guess you should create some jira about it  \n14:47\u00a0<vmassol>\u00a0I don't know why thomas is not here  \n14:47\u00a0<Kaisen>\u00a0Ensure that these tables are dropped before restarting a failed migration.  \n14:47\u00a0<vmassol>\u00a0he seems to be active today  \n14:47\u00a0<Kaisen>\u00a0but I don't find the tables  \n14:47\u00a0<vmassol>\u00a0too active for my taste :)  \n14:47\u00a0<camil7>\u00a0Kaisen: ah, yes, sounds like a good idea to drop them and retry  \n14:47\u00a0<vmassol>\u00a0(I wouldb't have upgraded so many libs in stabilization release unless they were fixing an important bug)  \n14:48\u00a0<Denis>\u00a0I talk with him earlier this morning than he is gone, I do not know why  \n14:48\u00a0<Kaisen>\u00a0@camil7 but they are already dropped so no way to do it again  \n14:49\u00a0<tmortagne>\u00a0has joined #xwiki  \n14:50\u00a0<camil7>\u00a0commons-compress-1.6 actually seems to fix a but that makes updating via upgrade manager taking ages, because of some silly thing when reading zip files ...  \n14:56\u00a0<Denis>\u00a0Kaisen: your logs should starts with \"INFO \u00a0.HibernateDataMigrationManager - Storage schema updates and data migrations are enabled\"  \n14:56\u00a0<Kaisen>\u00a0You mean the one I post?  \n14:58\u00a0<Denis>\u00a0I means that everything about migration start with that message, what you post happens later  \n14:59\u00a0<camil7>\u00a0Denis: I can see that line in the log, it is just before the errors come raining in  \n15:00\u00a0<Kaisen>\u00a0OK I get a little bit confused. I deleted the log and restart the server. Than I copy everything  \n15:02\u00a0<Denis>\u00a0camil7: the first error there is the one of interest, others are consequences  \n15:03\u00a0<camil7>\u00a0it seems the migration tables need to be flushed, but I cannot find them either in my instance either ... they are definitely not called DATABASECHANGELOG any longer  \n15:04\u00a0<tmortagne>\u00a0camil7: commented on XWIKI-9815  \n15:04\u00a0<camil7>\u00a0tmortagne: thanks I see. Example is coming ...  \n15:04\u00a0<tmortagne>\u00a0thanks  \n15:04\u00a0<Kaisen>\u00a0That is the first error after HibernateDataMigrationManager  \n15:04\u00a0<Kaisen>\u00a0ERROR actDocumentSkinExtensionPlugin - Cannot initialize skin extension class [XWiki.JavaScriptExtension]  \n15:04\u00a0<Kaisen>\u00a0com.xpn.xwiki.XWikiException: Error number 3202 in 3: Exception while reading document [xwiki:XWiki.JavaScriptExtension]  \n15:05\u00a0<Kaisen>\u00a0Here is the rest of the log  \n15:05\u00a0<Kaisen>\u00a0https://ezcrypt.it/tD7n#t5vcL9MpD4zjqLaYKVKY4Pz3  \n15:08\u00a0<camil7>\u00a0Kaisen: the first one is inded the important one. I try to find where the \u00a0\u00a0DATABASECHANGELOGLOCK table has gone, its a long time since I had to look at them  \n15:11\u00a0<Kaisen>\u00a0So you mean that you search now how to reavtivate the migration process?  \n15:14\u00a0<camil7>\u00a0yes, and it seems the info is outdated, the \"migration lock\" is instead done \"in ram\"  \n15:15\u00a0<camil7>\u00a0what value does \"select \\* from \u00a0xwikidbversion\" \u00a0deliver ?  \n15:15\u00a0<msmeria>\u00a0has joined #xwiki  \n15:15\u00a0<Kaisen>\u00a0XWV\\_Verison 43000  \n15:22\u00a0<maxr\\_3>\u00a0has left #xwiki  \n15:22\u00a0<camil7>\u00a0ok, this is at least consistent with the error message :-/  \n15:22\u00a0<Kaisen>\u00a0What I didn'T understand is where it is comming from  \n15:23\u00a0<msmeria1>\u00a0has quit  \n15:23\u00a0<bouquetf>\u00a0has quit  \n15:27\u00a0<Denis>\u00a0Kaisen: have you customized logging ?  \n15:27\u00a0<Kaisen>\u00a0As I'm not sure what you are requesting I would say no  \n15:29\u00a0<Kaisen>\u00a0So I don't change anything on the settings. I run more or less on a \"virgin\" installation from .deb  \n15:30\u00a0<bouquetf>\u00a0has joined #xwiki  \n15:30\u00a0<Denis>\u00a0Kaisen: the situation is really strange because, following the first message, you should always get a migration plan, and you don't, and I cannot explain why currently  \n15:31\u00a0<camil7>\u00a0we are just wondering if there is one error message \"lost somewhere\". on some tomcat setups one can have weird behavior  \n15:31\u00a0<Kaisen>\u00a0Same to me. Run it first on my test system in the same way and it works fine  \n15:31\u00a0<Kaisen>\u00a0than on my other and I get that problem  \n15:32\u00a0<Kaisen>\u00a0I didn't change anything in the tomcat configuration  \n15:32\u00a0<camil7>\u00a0where the error message says is that a DB migration attempt \u00a0... and that should have left an error message somewhere before  \n15:33\u00a0<Denis>\u00a0camil7: would be strange to get the first message and not the plan in the same log ?!?  \n15:33\u00a0<camil7>\u00a0I usually tend to do a \"find /var/log/tomcat6 -mmin -2\" \u00a0\u00a0\u00a0or \u00a0similar after restartign tomcat, to make sure I get all entries in all logfiles .... for some reason tomcat logfiles proliferated  \n15:33\u00a0<Kaisen>\u00a0ok so I will check the log and copy everything before the .HibernateDataMigrationManager message  \n15:33\u00a0<Denis>\u00a0but I know tomcat is sometime strange  \n15:34\u00a0<Denis>\u00a0I used to refer only to the catalina.out to get it all  \n15:34\u00a0<Denis>\u00a0Kaisen, where did you pick the logs ?  \n15:34\u00a0<camil7>\u00a0Denis: actually I know little about how the migration really works ...  \n15:34\u00a0<Denis>\u00a0camil7: I wrote it :)  \n15:35\u00a0<camil7>\u00a0ah, ok :)  \n15:36\u00a0<Kaisen>\u00a0/var/log/tomcat 7/catalina.out  \n15:36\u00a0<Kaisen>\u00a0here a link to the log before the .HibernateDataMigrationManager message https://ezcrypt.it/xD7n#udfNKpBTobwnnZfsJ0hQ860X  \n15:37\u00a0<ekarlso>\u00a0does xwiki use restlet  \n15:37\u00a0<ekarlso>\u00a0?  \n15:37\u00a0<vmassol>\u00a0ekarlso: yes  \n15:38\u00a0<ekarlso>\u00a0vmassol: oh, for what parts?  \n15:39\u00a0<vmassol>\u00a0ekarlso: REST support  \n15:39\u00a0<vmassol>\u00a0(obviously ;))  \n15:39\u00a0<ekarlso>\u00a0vmassol: k  \n15:39\u00a0<ekarlso>\u00a0does xwiki use netty?  \n15:40\u00a0<vmassol>\u00a0nope  \n15:40\u00a0<ekarlso>\u00a0standard threading ?  \n15:40\u00a0<j-simard>\u00a0Hi, is the xar-plugin is able to exclude files from a dependency?  \n15:41\u00a0<j-simard>\u00a0(in Maven)  \n15:42\u00a0<j-simard>\u00a0Because I'm looking for a way to use the default XAR of XWiki but with a light version (and a bit modified too)  \n15:43\u00a0<vmassol>\u00a0j-simard: yes it does  \n15:43\u00a0<vmassol>\u00a0<includes> and <excludes>  \n15:43\u00a0<tmortagne>\u00a0ekarlso: it's also used by SOLR which is used by XWiki  \n15:44\u00a0<tmortagne>\u00a0(restlet)  \n15:44\u00a0<vmassol>\u00a0j-simard: would be great to improve http://dev.xwiki.org/xwiki/bin/view/Community/XARPlugin#HXARMojo if you have a bit of time :)  \n15:44\u00a0<vmassol>\u00a0ekarlso: threading is handled by the container for most parts and we use std threading otherwise yes  \n15:45\u00a0<ekarlso>\u00a0vmassol: what's the benefit of restlet vs jersey toolkit ?  \n15:45\u00a0<j-simard>\u00a0ouch, I'm not sure I can do this kind of thing now :-) I'm still trying to well understanding the logic of Maven!  \n15:45\u00a0<tmortagne>\u00a0ekarlso: we did not really compared  \n15:45\u00a0<vmassol>\u00a0no idea, fabio chose restlet, I guess you could find some proposal email on the list when he made the choice  \n15:45\u00a0<vmassol>\u00a0I think he did tmortagne  \n15:45\u00a0<vmassol>\u00a0but we're not very happy with restlet ATM  \n15:46\u00a0<tmortagne>\u00a0vmassol: we started using restlet a long time ago  \n15:46\u00a0<vmassol>\u00a0it's missing an easy way to add or remove REST resources dynamically  \n15:46\u00a0<tmortagne>\u00a0so whatever comparizon is probable not accurate anymore  \n15:46\u00a0<vmassol>\u00a0so we wish to redo an eval of alternatives  \n15:46\u00a0<ekarlso>\u00a0what version are you on ?  \n15:46\u00a0<j-simard>\u00a0But thanks for the answer about <excludes>  \n15:47\u00a0<cjd>\u00a015:39 < ekarlso> does xwiki use netty? <-- I think one of our dependencies makes use of it, it's in the standard distribution, but we don't make significant use of it (we're just using plain JavaEE servlet)  \n15:48\u00a0<ekarlso>\u00a0ok  \n15:48\u00a0<ekarlso>\u00a0what's the diff of java ee / se ?  \n15:49\u00a0<cjd>\u00a0IIRC EE == more stuff, also more geared toward the server  \n15:49\u00a0<tmortagne>\u00a0we actually use SE, not EE  \n15:50\u00a0<tmortagne>\u00a0EE means SE plus a bunch of standardized commons tools that are supposed to come with the application server itself so that your application is lighter  \n15:57\u00a0<msmeria>\u00a0has quit  \n16:06\u00a0<Denis>\u00a0Kaisen: may you check in your permanent directory, under the job folder, if there isn't any logs about migration? You may grep something like \"data migration\" in all file there.  \n16:06\u00a0<Kaisen>\u00a0@camil7 does the new logs help you to understand what went wrong?  \n16:06\u00a0<camil7>\u00a0Kaisen: ah sorry, I missed them  \n16:09\u00a0<camil7>\u00a0hm, these look \"ok\" - that is, lots of noise when shutting down the server, because migration has not been completed, but then starting up the server looks \"fine\" \u00a0:-/  \n16:09\u00a0<Kaisen>\u00a0@Denis under permanent directory I just have a folder \"status\" with 3 subfolders \"distribution extention solr  \n16:14\u00a0<bouquetf1>\u00a0has joined #xwiki  \n16:14\u00a0<sdumitriu>\u00a0has quit  \n16:14\u00a0<gdelhumeau>\u00a0has quit  \n16:14\u00a0<gdelhumeau>\u00a0has joined #xwiki  \n16:17\u00a0<Kaisen>\u00a0So I'm lost as I'm not able to bring the server to migrate to new database version  \n16:23\u00a0<camil7>\u00a0the odd thing is that often startup errors end up in catalina.yyyy-mm-dd.log \u00a0or even localhost.yyyy-mm-dd.log \u00a0I wish I would have found a pattern to explain when something is written where  \n16:23\u00a0<tmortagne>\u00a0Kaisen: about jobs log, each of the folder you see (or subfolders) contains a status.xml file which is the log of everything hapenning during that job  \n16:25\u00a0<camil7>\u00a0db upgrade is not a job however, or is it ?  \n16:25\u00a0<tmortagne>\u00a0nop it's not  \n16:26\u00a0<tmortagne>\u00a0(maybe it should but that's another discussion :))  \n16:28\u00a0<sburjan>\u00a0tmortagne: ATM I have the same problem on a wiki, when migrating from a 3.1. I will try tomorrow from a vanilla 3.1  \n16:29\u00a0<tmortagne>\u00a0sburjan: not sure what you are talking about  \n16:29\u00a0<tmortagne>\u00a0database migration issues ?  \n16:29\u00a0<sburjan>\u00a0tmortagne: about the fact that db does not migrate when upgrading  \n16:29\u00a0<tmortagne>\u00a0ok  \n16:29\u00a0<camil7>\u00a0when migration is not a job, how can it happen that it does not write its error messages into the catalina.,out :-/ \u00a0... me still lookign at the code ....  \n16:29\u00a0<sburjan>\u00a0same problem as Kaisen  \n16:30\u00a0<tmortagne>\u00a0camil7: migration is lazily triggered when accessing the DB the first time so if the first thing accessing the DB is a job it will grad the migration logs  \n16:31\u00a0<Kaisen>\u00a0So I don't know what is the best way to search to the files for migration but grep -R -l \"migration\" doesn't give a result  \n16:31\u00a0<camil7>\u00a0ah, ok, then its still like the way I remember things are ;) ... now just need to find the darn error in the log  \n16:31\u00a0<tmortagne>\u00a0but I can't think of any job that would both access the DB and be started before a request  \n16:32\u00a0<tmortagne>\u00a0s/grad/grab/  \n16:32\u00a0<tmortagne>\u00a0sburjan: you can reproduce all the time ?  \n16:32\u00a0<tmortagne>\u00a0or is it a bit more random ?  \n16:33\u00a0<camil7>\u00a0one can even see the first http requst starts triggering the migration at: \u00a0[http://localhost:8080/xwiki/bin/view/Main/] INFO \u00a0.HibernateDataMigrationManager - Storage schema updates and data migrations are enabled  \n16:33\u00a0<tmortagne>\u00a0right  \n16:33\u00a0<sburjan>\u00a0tmortagne: I have only one wiki, I don't have the possibility to start over. But tomorrow I will try with vanilla versions  \n16:34\u00a0<tmortagne>\u00a0sburjan: ha sorry I understood wrongly that you had reproduce it with a vanilla XE  \n16:35\u00a0<sburjan>\u00a0tmortagne: nope, I'll try to do that tomorrow  \n16:35\u00a0<Kaisen>\u00a0So if I understand you right. The migration should start every time but doesn't do?  \n16:36\u00a0<camil7>\u00a0yes, it should start every time (and log sais that it did start), and check if the DB is up to date  \n16:37\u00a0<camil7>\u00a0if it is not up to \u00a0date, migrations should be triggered  \n16:37\u00a0<Kaisen>\u00a0maybe a right problem of the xwiki user on the database\ufffd  \n16:37\u00a0<Kaisen>\u00a0?  \n16:38\u00a0<camil7>\u00a0ah, wait, now I got another idea: the migrations got triggered, but they take ages t finish .... would that be an option? Or does xwiki block all requests and we should never see the errors in that case?  \n16:38\u00a0<tmortagne>\u00a0Kaisen: the user does not really matter, migration is part of XWiki initialization, it does not take into account the user  \n16:39\u00a0<tmortagne>\u00a0on a big pre 4.0 wiki, migration could take ages but I think we are supposed to see more that what is in the log  \n16:43\u00a0<camil7>\u00a0ah, yes the \"ages to finish migration\" you indeed create very different errors ... so lets forget about that  \n16:44\u00a0<sdumitriu1>\u00a0has joined #xwiki  \n16:45\u00a0<evalica>\u00a0has joined #xwiki  \n16:49\u00a0<Kaisen>\u00a0Is there a way that I can go back to the previews version?  \n16:50\u00a0<cjd>\u00a0I would recommend (especially before taking any of my advice) to backup the database as it is, even in a non-working state  \n16:51\u00a0<sburjan>\u00a0Kaisen: it seems that your issue affects onlt 5.3. You could try to migrate to a 5.2.2. We will confirm tomorrow if it's something wrong with 5.3  \n16:51\u00a0<sburjan>\u00a0\\*only  \n16:53\u00a0<Kaisen>\u00a0@cjd you mean to run a mysql dump \"mysqldump --add-drop-database --databases xwiki > xwiki.sql\"  \n16:53\u00a0<sburjan>\u00a0has quit  \n16:53\u00a0<cjd>\u00a0mmm that looks about right but make sure to check with the documentation on xwiki.org because I have the memory of a goldfish  \n16:53\u00a0<cjd>\u00a0a small goldfish  \n16:54\u00a0<Kaisen>\u00a0:)  \n16:54\u00a0<Kaisen>\u00a0Just one other question.  \n16:54\u00a0<Kaisen>\u00a0If I want to go back I should only exchange back the files inside the .war?  \n16:54\u00a0<tmortagne>\u00a0has quit  \n16:55\u00a0<cjd>\u00a0as opposed to also exchanging what other file?  \n16:57\u00a0<tmortagne>\u00a0has joined #xwiki  \n16:58\u00a0<sdumitriu1>\u00a0is now known as <Guest46165>  \n16:59\u00a0<Kaisen>\u00a0As I install XWiki only over the .deb I doesn't know how to up or downgrade manually :(  \n16:59\u00a0<Guest46165>\u00a0has quit  \n16:59\u00a0<sdumitriu>\u00a0has joined #xwiki  \n17:01\u00a0<tmortagne>\u00a0Kaisen: you can force a version by adding =myversion to the package name in apt-get command but not sure how apt-get handle downgrade  \n17:03\u00a0<jbernard\\_>\u00a0has quit  \n17:03\u00a0<camil7>\u00a0has quit  \n17:04\u00a0<camil7>\u00a0has joined #xwiki  \n17:11\u00a0<evalica>\u00a0has quit  \n17:13\u00a0<evalica>\u00a0has joined #xwiki  \n17:18\u00a0<camil7>\u00a0has quit  \n17:18\u00a0<sdumitriu>\u00a0has quit  \n17:18\u00a0<bouquetf1>\u00a0has quit  \n17:21\u00a0<sdumitriu>\u00a0has joined #xwiki  \n17:21\u00a0<vrachieru>\u00a0has quit  \n17:23\u00a0<camil7>\u00a0has joined #xwiki  \n17:27\u00a0<cjd>\u00a0has quit  \n17:31\u00a0<cjd>\u00a0has joined #xwiki  \n17:34\u00a0<camil71>\u00a0has joined #xwiki  \n17:35\u00a0<Kaisen>\u00a0Ok I get it back working by \"downgrading\"  \n17:35\u00a0<Kaisen>\u00a0First you need to run apt-get install xwiki-enterprise-common=5.2.2 xwiki-enterprise-tomcat-common=5.2.2 xwiki-enterprise-mysql-common=5.2.2  \n17:36\u00a0<Kaisen>\u00a0and than apt-get install xwiki-enterprise-tomcat7-mysql=5.2.2  \n17:36\u00a0<Kaisen>\u00a0I tried to upgrade after that to 5.3 but it end up in the same way :(  \n17:38\u00a0<camil7>\u00a0has quit  \n17:47\u00a0<camil71>\u00a0finally I can reproduce the migration issue that bugs Kaisen ... at last I think I do  \n17:48\u00a0<vmassol>\u00a0cool  \n17:48\u00a0<camil71>\u00a0Kaisen: I feel you better stick to 5.2.2 for the moment - I understood this works for you ?  \n17:49\u00a0<Kaisen>\u00a0Yes  \n17:49\u00a0<Kaisen>\u00a0I glad that you found something so it is not only related to me  \n17:49\u00a0<Kaisen>\u00a0Thanks in anyway for the help so fare  \n17:49\u00a0<Kaisen>\u00a0far  \n17:52\u00a0<camil71>\u00a0the cool thing is that the database migration has at least failed \"transactional\" - i.e. it has not touched the database at all, so rollback to the previous version is no problem at all, no need to recover from backup  \n17:57\u00a0<Denis>\u00a0has quit  \n18:00\u00a0<Kaisen>\u00a0My luck as I don't have a database update ^^  \n18:03\u00a0<Kaisen>\u00a0has quit  \n18:06\u00a0<tmortagne>\u00a0camil71: unless you use MySQL MyISAM I guess which does not support transacions  \n18:07\u00a0<tmortagne>\u00a0translations  \n18:07\u00a0<tmortagne>\u00a0(but it's not the recommended setup)  \n18:07\u00a0<camil71>\u00a0yes, unless one uses MyISAM, which is not somethign eone shoudl do IMO ;)  \n18:07\u00a0<tmortagne>\u00a0yep but I'm sure many old wikis are on MyISAM since it's the default MySQL engine  \n18:08\u00a0<tmortagne>\u00a0xwiki.org has been moved to innodb last week...  \n18:08\u00a0<vmassol>\u00a0tmortagne: you sure? I thought it was moved to UTF8. We did both?  \n18:08\u00a0<tmortagne>\u00a0yes  \n18:09\u00a0<vmassol>\u00a0ok  \n18:10\u00a0<j-simard>\u00a0has quit  \n18:11\u00a0<tmortagne>\u00a0in any case, most wikis created before we force innodb in empty DB has probably never been moved to innodb  \n18:12\u00a0<tmortagne>\u00a0s/has/have/  \n18:14\u00a0<evalica>\u00a0has quit  \n18:16\u00a0<cjd>\u00a0has quit  \n18:17\u00a0<tmortagne>\u00a0has quit  \n18:23\u00a0<civilian>\u00a0has joined #xwiki  \n18:26\u00a0<civilian>\u00a0has quit  \n18:39\u00a0<vmassol1>\u00a0has joined #xwiki  \n18:40\u00a0<vmassol>\u00a0has quit  \n18:53\u00a0<evalica>\u00a0has joined #xwiki  \n18:55\u00a0<camil71>\u00a0after starting things with the debugger the update does not fail anymore, so I cannot really reproduce it :(  \n19:14\u00a0<sdumitriu1>\u00a0has joined #xwiki  \n19:15\u00a0<camil71>\u00a0oh, now I cannot even reproduce it without the debugger ... obviously I must have messed something up ...  \n19:18\u00a0<camil71>\u00a0however when stepping though the code it seems that the migration calles \"getDatabasesToMigrate()\", which in turn makes a query for all \u00a0xwiki-server object, which in turn calles checkDatabase ... which should not cause any problems, as this just returns ....  \n19:19\u00a0<vmassol1>\u00a0thanks for helping out on this camil71 :)  \n19:19\u00a0<vmassol1>\u00a0(sorry to not have been more availalbe today, I'm myself debugging a problem - the issue with creation of hundreds of wikis)  \n19:19\u00a0<vmassol1>\u00a0is now known as <vmassol>  \n19:21\u00a0<camil71>\u00a0yes, thought so ... and I have to admit this problem defeats me now ... \u00a0actually I cannot reproduce it any more :(  \n19:27\u00a0<molegm>\u00a0has joined #xwiki  \n19:28\u00a0<Slashman>\u00a0has quit  \n19:30\u00a0<molegm>\u00a0has quit  \n19:34\u00a0<camil71>\u00a0ok, I guess I must have messed up my installation or something like that, as I cannot reproduce the problem any longer even after several attempts. will give it another try tomorrow ...  \n19:35\u00a0<gdelhumeau>\u00a0has quit  \n19:36\u00a0<camil71>\u00a0has quit  \n19:44\u00a0<vmassol>\u00a0has quit  \n19:47\u00a0<podbolotov>\u00a0has joined #xwiki  \n19:49\u00a0<podbolotov>\u00a0has quit  \n19:51\u00a0<lucaa>\u00a0has quit  \n19:55\u00a0<badsite>\u00a0has joined #xwiki  \n20:00\u00a0<evalica>\u00a0has quit  \n20:02\u00a0<badsite>\u00a0has quit  \n20:14\u00a0<evalica>\u00a0has joined #xwiki  \n20:16\u00a0<Denis>\u00a0has joined #xwiki  \n20:21\u00a0<abusenius>\u00a0has joined #xwiki  \n20:41\u00a0<jtafurth|away>\u00a0is now known as <jtafurth>  \n20:44\u00a0<jtafurth>\u00a0is now known as <jtafurth|away>  \n20:48\u00a0<vmassol>\u00a0has joined #xwiki  \n21:06\u00a0<lucaa>\u00a0has joined #xwiki  \n21:16\u00a0<evalica>\u00a0has quit  \n21:41\u00a0<lucaa>\u00a0has quit  \n21:57\u00a0<evalica>\u00a0has joined #xwiki  \n22:27\u00a0<vmassol>\u00a0has quit  \n22:30\u00a0<lucaa>\u00a0has joined #xwiki  \n22:53\u00a0<vmassol>\u00a0has joined #xwiki  \n22:57\u00a0<vmassol>\u00a0has quit  \n22:57\u00a0<vmassol>\u00a0has joined #xwiki  \n23:21\u00a0<evalica>\u00a0has quit  \n23:40\u00a0<Denis>\u00a0has quit  \n23:44\u00a0<vmassol>\u00a0has quit  \n23:58\u00a0<vmassol>\u00a0has joined #xwiki\n"}